Ipigital Imagc Processing，Third Fdition在数字图像处理领域，本书作为主要教材已有30多年。就像由Gonzalez和Wintz编写的1977年版和1987由Gonzalez和Woods编写的1992年版和2002年版那样，这一版也是我们用心为学生和教师准备的。年版、、学生和自学者的广泛调意、这一版已做了大量的修订与更新。新增内容基于对32个国家的134所高校的教师、与时俱进、可读性高，并缩出了大单具想采际楼义的例子、视盖的国像处理颁城包括双度变经和空同德波，频率域中的傅里0叶变换和滤波、国像结强、图像复原、计算机断层、模糊集合、彩色图像处理、小波、图像和视频压缩、形态学处理果像分割、图像描述、目标识别。相关图书新特 性一为使读者更早地接触虫基础内容，。对介绍性概念进行了修订一修订和更新了关于灰度变换、空间域相关、卷积及它们在空间滤波中数字阁像处理的应用的讨新增了关开楼糊集合及其在图像处理中的应用的过论一扩充了关于离散傅里叶十变换和频率域处理的内容一扩充了关于计算机断层的内容13五世一对小波尊节进行了较大的修订。ISBN 978-7-121-10207-3一扩充了关于数据压缩的一章，包括新的压缩技术、数字视频压缩压缩标准和水印处理。勤扩充了关干形态学重建、灰度形态学和现代形态学算法的内容一扩充了关于Marr-Hidreth边缘检测算法和坎尼边缘检测算法的内容。扩充了关于图像阈值处理的内容一给出了许多新例子，包括400余幅新图像和200多幅新图表。扩充了习题集，包禽了80多道新习题。更新了参考文献。本书网站ww尽管本书完全自成体系，但近来全新改版的配套网站为读者提供了额外的支持，实验项目建议、课堂演示幻灯片等。这些支持包括所选习题的答案、多教师手册可提供给采用本书作为教材的教师。For sale n ditbutonte mainandof hna exclusivelylexcepPEARSONTaiwan. hong Kong SAR and Macau SAR）APearsonEd co此版本仅限在中国大陆发行。策划编辑:谭海平全责任编辑：马济取学：谭海平责任美编：孙焱津定价：79.00元本书贴有激光防伪标志，凡没有防伪标志者，属盗版图书数字图像处理第三版Digital Image Processing, Third EditionRafael C. Gonzalez著Richard E. Woods阮秋琦等译阮宇智重子工常出版柱Publishing House of Electronics Industry北京・BEIJING在数字图像处理领域，本书作为主要教材己有30多年。版本是作者在前两版的基础上修订而成的，是前两版的发展与延续。除保留了前两版的大部分内容外，根据读者的反馈，作者在13个方面对本书进行了修订，因而本书特色新增了400多畅图像、、200多幅图表及80多道习题，融入了近年来数字图像处理领域的重要进展，鲜明且与时俱进。全书仍分为12草，即绪论、数字图像基础、灰度变换与空闸滤波、频率域滤波、图像复原与重建、彩色图像处理、小波和多分辨率处理、图像压缩、形态学图像处理、图像分割、表示与描述、、目标识别。本书的读者对象主要是从事信号与信息处理、通信工程、电子科学与技术、信息工程、自动化、计算机科学、生物工程、、生物医学工程、、物理、化学、医学、遥感等领域的大学教师和科技工作者、研究亏技术、、地球物理、大学本科高年级学生及工程技术人员。priginal editin nied Digial Image FPocessin. Thrd BEition,9780132345637 b Rfael C. Gonzalz, Richard EWoods published by Pearson Educat. nc,pulingas PTPearson Educaton. Incy PEARSON EDUCATiON ASIA LTD. and PUBLISHnNG HOuSE OF ELECTROChina edition INDUSTRY, Copyright 2011.This edition is manufactured in the People's Republic of China and is auithorized for SrsonEAucoion铭生教育出版集团)授予电子工业出版社。未经出版者预先书面许可，本书中文简体字翻译版由 Pears不得以任何友式复制或抄袭本书的凭何梁幼・本书封面贴有Pearson Education 培生教育出版集团)激光防伪标签，无标签者不得销售。版权贸易合同登记号图字：01-2008-1832图书在版编目(CIP)数据(美)伍兹(Woods, R.E)著、阮秋琦等译.数字图像处理:第3版7(美)冈萨雷斯(Gonzalez R. C.)，北京:电子工业出版社，2011.6国外电子与通信教材系列）书名原文：Digital lmageProcessng, Third EditioISBN 978-7-121-110085lI. OD冈…2伍…阮;・…数字图像处理一高等学校一教材TV.OTN911.73.①数・…中国版本图书馆CIP数据核字(2010)第100944号策划编辑:谭海平责任编辑:谭海平叫北京东光印刷厂江三河市皇庄路通装订厂电子工业出版社出版发行:北京市海淀区万寿路173信箱邮编100036：787× 10921/1640.75字数：1095 千字彩插：2下、印张:次・2011年6月第1次印刷定价:：79.00元凡所购买电子工业出版社图书有缺损问题，请向购买书店调换。若书店售缺，请与本社发行部联系，联系及邮购电话:(0108854888。质量投诉请发邮件至ztsepheicomcn，盗版侵权举报请发邮件至dbpheicomc服务热线：（010 88258888。2001年7月间,电子工业出版社的领导同志邀请各高校十几位通信领域方面的老师，商量引进国外教材问题。与会同志对出版社提出的计划十分赞同，大家认为，这对我国通信事业、特别是对高等院校通信学科的教学工作会很有好处。教材建设是高校教学建设的主要内容之一。编写、出版一本好的教材，意味着开设了一门好的课程，甚至可能预示着一个崭新学科的诞生。20 世纪40年代MIT林肯实验室出版的一套28本雷达丛书，对近代电子学科、特别是对雷达技术的推动作用，就是一一个很好的例子。我国领导部门对教材建设一直非常重视。20世纪80年代，在原教委教材编审委员会的领导下汇集了高等院校几百位富有教学经验的专家，编写、出版了一一大批教材;很多院校还根据学校的特点和需要，陆续编写了大量的讲义和参考书。这些教材对高校的教学工作发挥了极好的作用。近年来，随着教学改革不断深入和科学技术的飞速进步,有的教材内容已比较陈旧、落后，难以适应教学的要求，特别是在电子学和通信技术发展神速、可以讲是日新月异的今天，如何适应这种情况，更是必须认真考虑的问题。解决这个问题，除了依靠高校的老师和专家撰写新的符合要求的教科书外，引进和出版一些国外优秀电子与通信教材，尤其是有选择地引进一批英文原版教材，是会有好处的年多来，电子工业出版社为此做了很多工作。他们成立了一一个“国外电子与通信教材系列"项目组，选派了高有经验的业务骨干负责有关工作,收集了230余种通信教材和参考书的详细资料.调来了100余种原版教材样书，依靠由20余位专家组成的出版委员会，从中精选了40多种，内容丰富，覆盖了电路理论与应用、信号与系统、数字信号处理、微电子、通信系统、电磁场与微波等方面，既可作为通信专业本科生和研究生的教学用书，也可作为有关专业人员的参考材料。此外，这批教材，有的翻译为中文，还有部分教材直接影印出版，以供教师用英语直接授课。希望这些教材的引进和出版对高校通信教学和教材改革能起一一定作用。在这里，我还要感谢参加工作的各位教授、专家、老师与参加翻译、编辑和出版的同志们。各位专家认真负责、严谨细致、不辞辛劳、不怕琐碎和精益求精的态度，充分体现了中国教育工作者和出版工作者的良好美德。随着我国经济建设的发展和科学技术的不断进步，对高校教学工作会不断提出新的要求和希望。我想，无论如何，要做好引进国外教材的工作，一定要联系我国的实际。教材和学术专著不同既要注意科学性、学术性，也要重视可该性，要深人浅出，便于读者自学；引进的教材要适感高校教学改革的需要,针对目前一一些教材内容较为陈旧的问题,有目的地引进一一些先进的和正在发展中要与国内出版的教材相配套，安排好出版英文原版教材和翻译教材的比例。的交叉学科的参考书；要我们务力使这赛教材能尽量满足上述要求・希望它们能放在学生们的课米上，发探一定的作用。最后，预祝“国外电子与通信教材系列”项目取得成功，为我国电子与通信教学和通信产业的发展培土施肥。也恳切希望读者能对这些书籍的不足之处、特别是翻译中存在的问题，提出意见和建议，以便再版时更正。吴人水矛中国工程院院士、清华大学教授“国外电子与通信教材系列”出版委员会主任录图像变换非言…2.6.8概率方法56数字图像处理的起源小结・57参考文献使用数字图像处理领域的实例…………………伽马射线成像132入X射线成像。灰度变换与空间滤波第3章62紫外波段成像…………引言………………………可见光及红外波段成像背景知识3.1微波波段成像10灰度变换和空间滤波基础“3.1.1无线电波段成像・10.3.6关于本章中的例子.3.7，使用其他成像方式的例子・一些基本的灰度变换函数3.2数字图像处理的基本步骤…………………图像反转图像处理系统的组成3.2.2对数变换小结……17.2.3幂律(伽马)变换……3.2.4、分段线性变换函数直方图处理……………洗3.33.3.1引言・直方图均衡直方图匹配(规定化）视觉感知要素2.1083202.1.15.3.3眼明中图像的形成“3.3.4 在图像增强中使用直方图统计2.1.2空间滤波基础・383.4亮度适应和辨别….1.3光和电磁波谱.4.1图像感知和获取空间相关与卷积订线性滤波的向量表示2.3.13.4.3使用单个传感器获取图像……空间滤波器模板的产生…932.3.2使用条带传感器获取图像3.5平滑空间滤波器……2.3.3使用传感器阵列获取图像简单的图像形成模型…平滑线性滤波器.3.4 3.5.13.5.2统计排序(非线性)滤波器。……图像取样和量化欢锐化空间滤波器……取样和量化的基本概念972.4.1 基础数字图像表示使用二阶微分进行图像锐化一空间和灰度分辨率………34.4.3 3.6.2.4.4 图像内插……: 100像素间的一些基本关系…3.6.3非锐化掩蔽和高提升滤波8使用一阶微分对(非线性)图像锐相邻像素: 101邻接性、连通性、区域和边界・…距离度量……3:7混合空间增强法…… 103.5.33.8使用模糊技术进行灰度变换和2.6数学图像处理中所用数学工具的介绍…阵列与矩阵操作…空间滤波105.6.1二线性操作与非线性操作.6.22.6.3算术操作3.8.2。 模糊集合论原理集合和逻辑操作…463.8.3模糊集合应用…… 1102.6.419空间操作・3.8.4使用模糊集合进行灰度变换………1162.6.5・ 15・17低通滤波的其他例子17419使用频率域滤波器锐化图像:176参考文献・19理想高通滤波器…120布特沃斯高通滤波器4.93高斯高通滤波器……:178第4章124频率城的拉背拉斯算子・引言・1244.9.5钝化模板、高提升滤波和高频背景……124强调滤波欢4.1.1傅里叶级数和变换简史4.9.6同态滤波关于本章中的例子……4.1.2选择性滤波・4.10基本概念…254.10.1带阻滤波器和带通滤波器25.2.1陷波滤波器.10.2弘6傅里叶级数+.11冲激及其取样特性…26.2.3.11二维DFT的可分性…187连续变量函数的傅里叶变换…1284.11.2用DPFT算法计算IDFT30快速傅里叶变换(FFT）4.11.331取样和取样函数的傅里叶变换・关于滤波器设计的一些注释…….11.4314.3.1取样…1904.3.2取样函数的傅里叶变换132135137第5章图像复原与重建由取样后的数据重建(复原函数138单变量的离散傅里叶变换(DFT）引言……由取样后的函数的连续变换得图像退化/复原过程的模型噪声模型……1385.2140取样和频率间隔间的关系・… 97两个变量的函数的扩展…141.2.2一些重要的噪声概率密度函数周期噪声。……维冲激及其取样特性5.2.35.2.4哪电参数的估计…42.5.3维取样和二维取样定理……只存在噪声的复原一一空间滤波4.5.4143图像中的混淆均值滤波器……二维离散傅里叶变换及其反变换・5.3.2 统计排序滤波器。…… 205二维离散傅里叶变换的一一些性质5.3.3148自适应滤波器…空间和频率间隔的关系1484.6.1用频率域滤波消除周期噪声平移和旋转4.6.21485.4.12111485.4.215054..6.4陷波滤波器…544.6.5傅里叶谱和相角・最佳陷波滤波……213157.6.6二维卷积定理5.5、位置不变的退化5.6二维离散傅里叶变换性质的小结159估计退化函数……2184.6:.7频率域滤波基础………………1615.6:1图像观察估计・:2184.7:1 频率域的其他特性…1615.6.2试验估计.7.2频率域滤波基础・1625.63建模估计.73165频率域滤波步骤小结逆滤波・最小均方误差(维纳)滤波……4.7.4166222使用频率域滤波器平滑图像…… 194.85.9约束最小二乘方滤波…2244.8.1理想低通滤波器…169.82布特沃斯低通滤波器5.11 由投影重建图像……4.8.3高斯低通滤波器……… 28计算机断层(CT)原理2325.113投影和雷登变换连续小波变换・2357.3.3傅里叶切片定理.11.4236使用平行射线束滤波反投影的重建・5.11.57.2二维小波变换…5.11:6。使用扇形射线束滤波反投影的重建・240322小波包2446330考文献・245参考文献"330习题彩色图像处理第6章249第日章图像压缩249334引言249彩色基础・5.1基础知识5.2编码冗余RGB彩色模型3.1.1257空间冗余和时间冗余3.1.26.2 CMY和CMYK彩色模型257不相关的信息…8.1.35.23HSI彩色模型-3382628.1.4。图像信息的度量伪彩色图像处理5.32623406.3.1图像压缩模型…欢灰度到彩色的变换8.1.66.3.2图像格式、容器和压缩标准8.1.7全彩色图像处理基础""""些基本的压缩方法・8.22685.5霍夫曼编码…8.2.1.3.1补色算术编码.2.3彩色分层273351Lzw 编码色调和彩色校正・.5.4 欢行程编码275直方图处理276平滑和锐化"""""5.6.2.7276比特平面编码…359彩色图像平滑5.6.1块变换编码……36彩色图像锐化.6.2 373预测编码基于彩色的图像分制279279.2.10 小波编码HSI彩色空间的分割数字图像水印……279RGB向量空间中的分割・.7.2…………彩色边缘检测281参考文献彩色图像中的噪声283.8习题……284285形态学图像处理第9草"285知言286习题……402预备知识2.1小波和多分辨率处理……腐蚀和膨胀・… 404第了意2899.2.1引言2.2.2289膨胀背景….32.3对偶性图像金字塔2907.1.1开操作与湖操作4072922.4297一些基本的形态学算法・多分辨率展开*002.5边界提取412300级数展开2.5.1301孔洞填充2.5.2连通分量的提取304小波函数 416维小波变换参考文献细化粗化418习题.5.7骨架裁剪420.5.8引言514形态学重建+21.5.9l1.1表示三值图像形态学操作小结……426.5.101.1.1边界追踪・314灰度级形态学28链码……5161.2428.6.1腐蚀和膨胀使用最小周长多边形的多边形近似5181.3开操作和闭操作……4302.6.2其他多边形近似方法…2.6.3些基本的灰度级形态学算法431标记图灰度级形态学重建………2.6.4边界线段…1.1.6小结・…骨架525边界描绘子1 1.2438习题……些简单的描绘子1.2.1第10章图像分割1.2.2形状数528443傅里叶描绘子升言12.3基础知识10.11.2.4统计矩点、线和边缘检测…10.211.31.3.1些简单的描绘子4471.2.2孤立点的检测…拓扑描绘子… 5321.3.20.2.3线检测449纹理边缘模型・450不变矩0.2.4使思丰分量进行描绘0.2.5基本边缘检测……………45910.2.6 更先进的边缘检测技术550关系描绘子0.2.7边缘连接和边界检测467小结10.3阈值处理…………………参考文献4760.3.习题……基础知识4760.3.2基本的全局阈值处理478第12意用Osu方法的最佳全局阈值处理…0.3.3升言用图像平滑改善全局阈值处理0.3.448312.1模式和模式类10.3.5利用边缘改进全局阈值处理……12.2基于决策理论方法的识别……・………………4870..多网值处理0.3.7可变阈值处理…4882.2.2最佳统计分类器 5640.3.812.2.3神经网络・57010.449312.3结构方法区域生长49310.4.1区域分裂与聚合・10.4.212.3.2 串匹配用形态学分水岭的分割10.5497小结背景知识…… 4970.5.1参考文献0.5.2水坝构建“498习题…0.5.3附录A像压宿编码表0.5.:4、标记的使用10.6502分割中运动的应用…嘉路录已参老主直10.6.1空间域技术东克城10.6.2频率域技术……504… 620小结…・ 18・第1章绪百闻不如一见。无名氏引言数字图像处理方法的重要性源于两个主要应用领域：改善图示信息以便人们解释；为存储、输和表示而对图像数据进行处理，以便于机器自动理解。本章有几个主要目的：(1)定义我们称之为；（2)从历史观点回顾图像处理的起源；(3)通过考察一些主要的应用领域，给出图像处理领域的范围；图像处理技术状况的概念；；（4)简要讨论数字图像处理中所用的主要方法；（5)概述通用目的的典型图像处理系统的组成；(6)列出公并发表的数字图像处理领域的一些图书和文献。什么是数字图像处理幅图像可定义为一个二维函数fGx, ),其中x和y是空间(平面)坐标，而在任何一对空间坐标(x,y)处的幅值f称为图像在该点处的强度或灰度。当元y和灰度值f是有限的离散数值时，我们称该图像为数字图像。。数字图像处理是指借助于数字计算机来处理数字图像。注意，数字图像是由有限数量的元・、每个元素都有一个特定的位置和幅值。素组成的，。这些元素称为图画元素、图像元素或像素。像素是广泛用于表示数字图像元素的术语。。在第2章，我们将用更正式的术语来考虑这些定义。1，所以，图像在人类感知中扮演着最重要的角色并不奇怪。然而，视觉是人类最高级的的感知与人类不同，成像机器几乎可以覆盖从伽马射线到无线电波、类的感知仅限于电磁波谱的视觉波段，与的整个电磁波谱。它们可以对非人类所习惯的那些图像源进行加工，这些图像源包括超声波、电子显微镜和计算机产生的图像。。因而，数字图像处理涉及很宽泛的各种各样的应用领域。关于图像处理正于哪里或其他相关领域（如图像分析和计算机视觉)从哪里开始，在创造人之间并没有一一致的看法。有时，用处理的输入利输出内容都是图像这一规范来界定图像处理的范围。我们认为这有点局限，是人为的界定。例如，在这种定义下，甚至像计算一幅图像的平均灰度(结果为个数字)这样简单的任务都不能算是图像处理。。另一方面，有些领域(如计算机视觉)的最终目标是使用计算机来模拟人的视觉，包括理解并根据视觉输入采取行动等。该领域本身是人工智能(AI)的一。人工智能领域处在其发展过程的初级阶段，它的发展比预期的慢得多。分支，其自的是模仿人类智能。图像分析(也称为图像理解)领域则处在图像处理和计算机视觉之间。の每页下方阴影椎中的数字表示译文对应的原书页码、索引中的页码为原书页码编者注从图像处理到计算机视觉的这个连续统一体内并没有明确的界限。-种有用的范例是在。然而，这个连续的统一体中考虑三种典型的计算处理，即低级、中级和高级处理。低级处理涉及初级操作，如降低噪声的图像预处理、对比度增强和图像尖锐化。低级处理以输入、输出都是图像为特征。中级处理涉及诸多任务，譬譬如(把一幅图像分为不同区域或目标的)分割，减少这些目标物的描述，、以使其更适合计算机处理及对不同目标的分类(识别)。中中级图像处理以输入为图像但输出是从这些图像中提取的特征（如边缘、轮廓及各物体的标识等)为特点。最后，高级处理涉及“理解”已识别目标的总体就像在图像分析中那样，以及在连续统一体的远端执行与视觉相关的认知功能基于上述讨论我们可以着到，图像处理和图像分析之间合乎逻辑的重叠部分就是图像中各个区域或目标的识别这一领域。这样，在本书中，我们就将数字图像处理界定为其输入和输出都是图像的，另外，包含从图像中提取特征的处理，直至包括各个目标的识别。。作为一个澄清这些概念的说处理，明，我们考虑文本自动分析这一一领域。获取包含有文本的区域的一一幅图像，对该图像进行预处理，提取(分割)各个字符，以适合于计算机处理的形式描述这些字符，识别这些个别字符，这些都在本书界定的数字图像处理范畴内。理解一页的内容可能要根据“理解”词句的复杂度从图像分析领域甚至计算机视觉来考虑。这很快就会变得很明显，就像我们已定义的那样，数字图像处理可成功地用于具有特殊社会和经济价值的广泛领域。后面各章中给出的概念是这些应用领域中所用方法的基础1.2数字图像处理的起源数字图像的最早应用之一是在报纸业，当时，图片第一次通过海底电缆从伦敦传往纽约。早在20世纪20年代曾引人巴特兰（Bartlane)电缆图片传输系统，把横跨大西洋传送一幅图片所需的时间从一个多星期减少到了3小时。为了用电缆传输图片，首先使用特殊的打印设备对图片编码，然后，在接收端重构这些图片。图1.1就是用这种方法传送并利用装有打印机字体的电报打印机模拟中间色调还原出来的图像这些早期数字图片视觉质量的改进中的初始问题涉及打印过程的选择和亮度等级的分布。。用于得到图1.1所际示图像的打印方法到1921年底就被彻底淘汰了，转而支持一种基于照相还原的技术，在电报接收端使用究孔纸带来还愿图片。12显示了使用这种方法得到的一幅图像。与图11相比，它在色调质量和分辨率方面的改进都很明显。图1.11921年由电报打印机采用特殊字体在编码纸带图1.21922年在信号两次穿越大西洋后，由穿孔纸带得到的数字图片(原图像由 McCFarlane 提供）上产生的数字图片(原图像由McFarlane 提供早期的巴特兰系统可以使用5个不同的灰度级来编码图像。到1929年，这一能力已增大到15级。图1.3所示的这种典型图像就是用15级色调设备得到的。。在这一时期，由于引入了一-种使用编码图片纸带调制光束而使底片感光的系统，，因而明显地改善了还原过程。D本书后面提供的参考文献按作者姓氏的字母顺序列出。，但并不认为它门就是我们定义的数字图像处理,，因为创建这些图像时并。因此，数字图像处理的历史与数字计算机的卡涉及计算。发展密切相关。事实上，数字图像要求非常大的存储和计算能力，因此数字图像处理领域的发展必须依靠数字计算机及数据存储、显示和传输等相关支撑技术的发展。计算机的概念可追溯到5000)多年前亚洲算盘的发明。更近一一些，过去两个世纪以来已有的发展也奠定了我门今天称之为计算机的基础。然而，我们称之为现代计算图1.3美国将军潘兴和法国元帅福熙的照片机的基础还要回溯到20世纪40年代由约翰・冯・诺依曼该照片未加修饰，是在1929年从伦提出的两个重要概念：（1)保存程序和数据的存储器；敦到纽约使用15级色调设备通过电(2)条件分支。这两个概念是中央处理单元(CPU)的基缆传送的(原图像由 McFarlane提供)础，今天，它是计算机的心脏。从冯・诺依曼开始，，已有的一系列重要的进展使得计算机强大到足以用于数字图像处理。简单地说，这些进展可归纳为如下几点：（1 1948年美国贝尔实验室发明了晶体管；（2) 20 世纪年代和 20世纪 60年代高级编程语言 COBOL (Common TBusiness-oriented Language)和 FORTRANGFormulaTraslato的开发；（3)1958年美国德州仪器公司发明了集成电路(IC)；(420 世纪60年代早期操作系统的开发；（5)20世纪 70年代早期Intel公司开发了微处理器(由中央处理单元、存储器和(6) 1981年 BM 公司推出了个人计算机；（7)元器件的逐步小型化，输入/输出控制组成的单一芯片)；（随着20世纪70年代末大规模集成电路(LD开始出现,20 世纪80年代出现了甚大规模集成电路(VLSD现在出现了超大规模集成电路(ULSD。伴随着这些进展，数字图像处理的两个基本需求一一大容量存储和显示系统领域也随之快速发展。第一台功能强大到足以执行有意义图像处理任务的大型计算机出现在20世纪60年代初。我们今天称之为数字图像处理的诞生可追溯至这一时期这些机器的使用和空间项目的开发。这两大发展的结合把人们的注意力集中到数字图像处理概念的潜能上。利用计算机技术改善空间探测器发回的图像的工作始于1964年美国加利福尼亚的喷气推进实验室(加里福尼亚，，帕萨第那)。当时由“徘徊者7号卫星传送的月球图像由一台计算机进行了处理，以校正航天器上电视摄像机中各种类型的图像畸变。客 1.4显示了由“徘徊者7号”于1964年7月31日上午(东部百天时间)9点09分在撞击月球表面前约17分钟时摄取一张月球图像「网状标记用于第2章讨论的几何校的第一这也是由美国航天器拍摄的第一幅月球图像。“徘徊者积累的图像处理方法可作为增强和复原图像方法的基“探索者”登月飞行、“水手号”火星飞越任务及础，譬如“阿波罗”载人登月和其他任务在空间应用的同时，，数字图像处理技术在20 世纪60年代末和20世纪 70年代初开始用于医学成像、地球资源遥感监测和天文学等领域。早在 20世纪 70年代发明的计算机图1.4 美国航天器传回的第张月球照片它是由“徘徊者7号”探测器在撞轴向断层术、简称为计算机断层(CTD，是图像处理在医学击月球表面前17分钟于美国东部诊断领域最重要的应用之一。计算机轴向断层术是一种处时间1964年7月31日上午9点09理方法，在这种处理中，检测器环围绕着一个物体(或病分拍摄的(原图像由NASA提供）人)，并且一个与该环同心的X射线源(与检测器环同心)绕着物体旋转。X 射线穿过物体并由环中对面的检测器进行收集。当X射线源旋转时，重复这一过程，这些算法使用感知的数据来重建通过物体的“切片”图像。。当物体沿垂直于检测一些算法组成,析层由一系列这样的“切片"，这些切片组成该物体内部的三维再现。断层摄影术是器环的方向运动时，就产生一由 Godfey N Hunsfiel先生和Alan M.Cormack教授分别发明的。由于这项发明、，他们共同获得了有趣的是，X射线是1895年由 WilhemConrad Roentgen(威廉・康拉德・伦琴)1979年的诺贝尔医学奖。。发现的，由于这一发现，他获得了了 1901年的诺贝尔物理学奖。今天，这两个相差近100年的发明引领着图像处理的一一些最重要的应用。从 20世纪60年代至今，图像处理领域一直在生机勃勃地发展。除了医学和空间项目应用外，数字图像处理技术现在已用于更广泛的范围。计算机方法用于增强对比度或将灰度编码为彩色，以便于解释工业、医学及生物科学等领域中的X射线图像和其他图像。地理学者使用相同或相似的技术从航空和卫星成像中研究污染模式。图像增强和复原方法用于处理不可修复物体的退化图像，或太昂贵以至于不可复制的实验结果。在考古学领域，使用图像处理方法已成功地复原了模糊的图片，这些图片是丢失或损坏的稀有物品的唯一现有的记录。在物理学和相关领域，计算机技术通常用于增强如高能等离子和电子显微镜等领域的实验图像。类似地，图像处理技术也成功地应用在天文学、生物学核医学、法律实施、国防及工业领域中。这些例子说明图像处理的结果主要用于人类解译。。本章开始时曾提到，数字图像处理技术的第二个主要应用领域是解决机器感知的问题。在这种情况下，兴趣在于以更适合计算机处理的形式从图像中提取信息的过程。通常，该信息类似于人类用于解译一幅图像内容的视觉特性。例如，机器感知中使用的信息类型的例子有统计矩、傅里叶变换系数和多维距离度量。在机器感知中，使用图像处理技术的典型问题是自动字符识别、、产品装配线和检测的工业机器视觉、军事识别、指纹的自动处理血样分类、用于天气预报和环境评估的航空图像与卫星图像的机器处理。。计算机价格性能比X射线和、万维网和互联网规模的不断扩张及网络通信带宽的提高，为数字图像处理技术的持续发的不断下降、展提供了前所未有的机会。下一节中将说明某些这样的应用领域。使用数字图像处理领域的实例1 .3今天，几乎不存在与数字图像处理无关的技术领域。这里讨论的范围只能覆盖其应用领域的小部分。然而，由于篇幅的限制，本节的内容无疑将围绕数字图像处理的广度和重要性展开。本节将介绍一些应用领域，其中每个领域都要使用后续各章中讲解的常用数字图像处理技术。本节中所示的许多图像会在本书后面给出的多个例子中引用。所显示的所有图像都是数字图像。牧字图像处理的应用领域多种多样，所以本书在组织形式上力图覆盖该技术领域的广度。阐述数字图像处理应用范围的一一种最简方法是根据信息源来分类(如可见光或X射线等)。在今天的应用F，最主要的图像能源是电磁能谱，其他主要图像能源包括声波、超声波和电子(以用于电子显微镜中的电子束形式)。用于建模和可视化的合成图像由计算机产生。。本节简要讨论如何生成各种类别的图像及这些图像适用的领域。把图像变换为数字图像的方法则在下一章中讨论。以电磁波谱辐射为基础的图像是我们最熟悉的、特别是X射线和可见光谱波段的图像。电磁波可定义为以各种波长传插的正弦波:或视为无质量的粒子流，每个粒子以波的形式传播并以光的速度运动。每个无质量的粒子包贪一定的能量(或一束能量)，每束能量称为一个光子。如果光谱波段根据光子能量进行分组，则可得到图1.5所示的光谱，范围从伽马射线(最高能量)到无线电波(最低能量）如图所示，加底纹的条带表明了这样一个事实，即电磁波谱的各个波段之间并没有明确的界线，而是由一个波段平滑地过渡到另一个波段无线电波加马射线X射线紫外线可见光红外线根据光子能量排列的电磁波谱图1.5伽马射线成像.3.1伽马射线成像的主要用途包括核医学和天文观测。在核医学中，这种方法是将放射性同位素注，当这种物质衰变时就会放射出伽马射线，然后用伽马射线检测仪收集到的放射线来产生射到人体内，图像。图1.6(a)显示了一・幅使用伽马射线成像得到的人体骨骼扫描图像。这类图像用于骨骼病变的定位，譬如感染或肿瘤。图1.66b)显示了另一种主要形态的核成像，称为正电子放射断层(PET)，其原理与1.2节中提及的X射线断层相同。然而，与使用外部X射线源不同，它给病人注入放射性同位素司位素衰变时放射出正电子。当正电子遇上一个电子时，两者湮没并放射出两束伽马射线。检测到这些射线后，就可利用断层技术的基本原理创建断层图像。。图1.66b)所示的图像是构成病人三维再现图像序列中的一幅图像。这幅图像表明脑部和肺部各有一个肿瘤，即很容易看到的小的白色团块。大约在15 000年前，天鹅星座中的星球发生大爆炸，产生了一团过热的稳定气云(即天鹅星座环)该气云以彩色阵列形式发光。图1.6(c)显示了在伽马射线波段成像的天鹅星座环。与图1.6a)和图1.6）不同，该图像是利用被成像物体的自然辐射得到的。最后，图1.6(d)显示了一幅来自核反应堆真空管的伽马辐射图像，在图像的左下方可以看到较强的辐射区。伽马射线成像实例图1.6a)骨骼扫描图像;(bD PET图像；(e)天鹅星座环图像；(dD来自反应堆真空管的伽马辐射(亮点）2「图回由G.E Mdicy sSses公司提供，图)由CTIPETStems公司的MihaelLrasey博士提供,东、图(心)由NASA提供，图(d)由密歇根大学的Zong He和Davia K Wehe教授提供」1.3.2 X射线成像X射线是最早用于成像的电磁辐射源之一一。最熟悉的X射线应用是医学诊断，但是X射线还被[31广泛用于工业和其他领域，如天文学。用于医学和工业成像的X射线是由X射线管产生的，X射线。阴极加热释放自由电子，这些电子以很高的速度向阳极流动，、当电子管是带有阴极和阳极的真空管而X一个原子核时，，能量被释放并形成X 射线辐射。。X 射线的能量由另一边的阳极电压控制，l。图1.7(a)显示了一幅大家熟悉的位于X射线源和对X射射线的数量由施加于阴极灯丝的电流控制。线能量敏感的胶片之间的病人胸部图像。X射线的强度受射线穿过病人时的吸收量调制，最终能量落一样的。。在数字射线照相术中，在胶片上并使胶片感光，这与光使得胶片感光的原理是一，数字图像可用两种方法得到：（1)使用数字化的X射线胶片；（2)X射线穿过病人身体后直接落到某个装置上(譬如荧光屏)，该装置把X射线转换为光信号。然后，转换而来的光信号由高灵敏度的数字系统捕获。第2章和第4章将详细地讨论数字化问题图1.7X射线成像实例：（a)胸部X射线图像；(b)主动脉造影图像；（c)头部CT图像；（d)电路板图像；(e)天鹅星座环图像「图(a)和图(c)由Vanderbilt大学医学中心辐射学与放射学系的.Davi Riekens博土提供，图(6)由密歇根大学医学院解削学分部的 Tomus R、Gest博士提供，图(d)由Lixi公司的Joseph E.Pascente先生提供，图(e)由NASA提供丁血管照相术是对比度增强辐射成像领域中的另一一个主要应用。该过程用于得到血管的图像(称为血管造影照片)。-根导管(柔软且中空的小管)插人动脉或静脉，，导警穿过血管并被引导到要研究的当导管到达所研究的部位时・将X射线造影剂注入导管。这会增强血管的对比度，并可以让区域。放射线学者观察到任何病变或阻塞。。图1.7(b)显示了一个主动脉血管造影照片的例子。在图像的左下可以看到插入到血管中的导管。。注意，在图像中，可看到造影剂流向肾脏时大血管的强烈对比效万，中果。正如第2章将要讨论的那样，血管照相术是数字图像处理的主要应用领域，在该领域，图像相减用于进一步增强被研究的血管。X射线在医学成像中的另一个重要应用是计算机轴向断层(CAT）。由于该技术的分辨率和三维能力，CAT扫描早在20世纪70年代第一次付诸使用时就引起了医疗手段的革命。正如1.2 节提到的那样，每幅 CAT图像都是垂直穿过病人的一个“切片”，当病人纵向移动时可产生大量的“切片"，这论些图像组合在一起就构成了人体内部的三维描绘图像，其纵向分辨率与切片数量成正比。图1.7(c)显一幅典型的头部CAT切片图像。小丁与刚刚讨论的有些类似的技术也可用于工业处理，但通常使用的是更高能量的X射线。图1.7(d）显示了一块电路板的X射线图像。这样的图像是X射线在上百种典型工亚应用中的代表性图像，。当元件可被X射线穿透时，，CAT扫描很有用，于检测电路板中的制造缺陷，如元件缺失或断线等。譬如塑料元件，甚至更大的物体，如固体推进剂火箭发动机。图1.7(e)显示了天文学中X射线成像的个例子。这幅图像是图1.6(Cc)中的天鹅星座环，但此时是X射线波段成像。.3.3紫外波段成像紫外“光””的应用多种多样，包括平板印刷术、工业检测、显微镜方法、激光、生物成像和天文观测等。我们仅用显微镜方法和天文观测作为例子来说明这一波段的成像。紫外光用于荧光显微镜方法中，这是显微镜方法中发展最快的领域之一荧光是在 19世纪中叶发现的一一种现象。当时，当紫外光直接照射到矿物质上时，首次发现荧石发出了荧光。紫外光本身并不可见，但当紫外辐射光子与荧光材料内原子中的电子碰撞时，它把电子提高到较高的能级，随后受激电子释放到较低的能级并以可见光范围内的低能光子形式发光。荧光显微镜方法的基本任务是用激发光照射一个样品，然后从较强的激发光中分离出较弱的荧光，这样，仅有辐射光到达人眼或以允许检测足够的对比度而得到照射在暗背景上的荧光区。非荧光材料的背景越暗，其他检测器，・设备越有效。荧光显微镜方法在研究可产生荧光的材料时的确是一种很优秀的方法，无论是以它们的自然形式(原发荧光)，还是经化学处理后具有荧光能力(次生荧光)。图1.8(a)和图1.8 6b)显示了使用荧光显微镜方法所得到的典型结果。图1.8 (a)显示了普通玉米的荧光显微镜图像，图1.8 (b)显示了被一种谷类疾病“黑穗病”感染了的玉米图像，黑穗病是草、洋葱、高粱等被700多种寄生真菌感染后出现的一种严重的病害，因为玉米是世界上最主要的食品来源之一。图1.8(e)显示了在病害。玉来黑穗病是紫外波段的高能区域成像的天鹅星座环。紫外光成像实例:a)普通玉米图像；（b)患黑穗病的玉米图像；（e)天鹅星座环图像冬1.8[ 图(a)和图(b)由佛罗里达州立大学的Michael W.Davidson博士提供，图(C)由NASA提供」1.3.4可见光及红外波段成像由于电磁波谱可见光波段在所有波段中是我们最熟悉的，因此，这一波段的成像应用领域远远超过其他波段的成像应用领域就不足为奇了。红外波段常用于与可见光相结合成像，为便于说明，本节把可见光和红外光合并在一起讨论。下面的讨论将涉及光显微镜方法、天文学、遥感、工业和法律实施等方面的应用图1.9显示了一些可见光显微技术得到的图像。这些例子涵盖了从制药和微检测到材料特征的范甚至仅在显微镜方法中，其应用领域如此之多，以至于不能在这里详细列出。当然，把这些图像书。用于从增强到测量这些范围概念化可能并不困难。(b)已放大40倍的胆固醇；（C)已放图1.9光显微镜图像实例：（a)已放大250倍的紫杉酚(抗癌剂)；大60倍的微处理器；a)已放大600倍的镍氧化物胶片；(e)已放大1750倍的音频CD 表面：(D已放大450倍的有机超导体(这些图像由佛罗里达州立大学的Michael W. Davidson博士提供）一个主要应用领域是遥感，遥感通常包括可见光和红外波谱范围的一可见光处理的另一一些波段。表1.1显示了NASA的LANDSAT 卫星中的所谓主要波段。LANDSAT卫星的主要功能是从空间获得并传送地球的图像，其目的是监测该行星的环境条件。波段用波长来表示，I um等于10*m(我们讨论的是电磁波谱的波长范围，第2章将详细讨论)。注意表1.1中每个波段的特征与用途。为了阐述这类多光谱成像的基本性能，考虑图1.10，它为表1.1中的每个频谱波段显示了一幅图像。成像区域是美国华盛顿特区，包括建筑物、道路、植被和穿过城市的主要河流(波拖马可河)等特人口中心地区的图像常被用来评估人口增长和变迁方式、污染及其他有害环境的因素。可见光和红外光特征之间的区别在这些图像中是十分明显的。例如，在波段4和波段5中，从其周围环境可以看出如何较好地界定河流。表1.1NASA的LANDSAT 卫星的主要波段皮段号长(um水体有最大的穿透性0.45-0.52适用于度量植物活力0.52-0.60植被辨别0.63-0.690.76-0.90主物团和海岸线测绘.55-.5襄和植被含水量壤温度，热量测绘2.08-2.35广物测绘图 1.10美国华盛顿特区的LANDSAT 卫星图像。图中的数字与表11中的波段号对应(图像由NASA提供)虽然超声波成像常用于制造业但这一技术最为熟知的应用是在医学领域，特别是妇产科。在妇产科，医以确定其发主对未出生的胎儿成像，。这一检测的副产品是育的健康状况。。箭头指向碳氢化合物（油或气)的油气地震模型的剖面图像。确定胎儿的性别。超声波图像是利用图1.19阱(图像由美国Sandia国家实验室的Curis Ober博士提供下面的基本步骤生成的:超声波系统(一台计算机、由超声波源和接收器组成的超声波探头及一台显示器)向人体发射高频(1-5 MHz)声波脉冲声波传入体内并碰撞组织间的边界(举例来说，就是流体和软组织之间的边界，及软组织和骨骼之间的边界)一部分声波反射回探头；一部分声波则继续传播，直到它们到达另一个边界并被反射。反射波被探头拾取并传给计算机。计算机根据声波在组织中的传播速度（1540 m/s)和每个回波的返回时间，计算从探头到组织或器官边界的距离。系统在屏幕上显示回波的距离和亮度，形成一幅二维图像在典型的超声波成像中，每秒钟有上百方个脉冲与回波发出和接收。探头可沿身体表面以不同角度运动，以便得到各种观察图像。。图1.20显示了几个例子冬1.20超声波成像示例:Ca)胎儿图像；(b)胎儿的另一一幅观察图像；；（c)甲状腺图像；(d)有损伤的肌肉层图像(原图像由Siemnems Medical Sstems公司的Utasound Group提供)我们继续使用电子显微镜方法的某些例子来讨论成像方式。电子显微镜的功能与光学显微镜只不过是用一个聚焦的电子波束代替光束形成图像标本。电子显微镜的操作包括下面儿个基本步骤：由电子源产生一个电子流、用正电势朝着标本加速。该电子束用金属小孔和电磁透镜限制并聚焦为一个细的单色波束。一然后使用，个磁透镜将单色电子束聚焦到样本上。年样杰内部产生交互照射并影响电子束。这些交互作用和影响被检测并转换为一一幅图像，这种方式与光被物体反射或吸收的方式样。所有电子显微镜均执行这些基本步骤。五透射电子显微镜(TEM)的工作原理很像一台幻灯片投影仪。投影仪发射出一束透过幻灯片的13光：当光通过幻灯片时，它由幻灯片的内容调节。这一发射出的光束然后被投射到观察屏上、形成幻灯片的放大图像。除了发射的是一个电子束通过样本(相当于幻灯片)之外，TEM 以相同的方式工作。穿过样本的部分电子束被投射到荧光屏上，而电子与荧光物质的相互作用就产生了光，从而得到，扫描电子显微镜(SEM)实际上扫描电子束并记录每一位置上电子束与样可观察的图像。。另一方面，一幅完整的图像由通过样本的电子束光栅扫描形成,本的相互作用。这会在荧光屏上产生一个点・。电子与荧光屏相互作用并产生光。SEM 适合于“大块”样品，而TEM要求这非常像电视摄像机。非常薄的样品电子显微镜有非常高的放大能力。光学显微镜的放大倍数限制在 1000左右，电子显微镜的放大倍数可达到1000或更大。图1.21显示了两幅由于过热而造成损坏的样本图像。Ca)因过热而损坏的钨丝放大250倍的SEM图像(注意左下方的碎片)；b)已损坏集成电图1.21路的2500倍SEM 图像白色纤维是由热破坏造成氧化的结果[图a)由俄勒冈大学地质科学系的Michal Shaffer先在生提供。图(Gb)由加拿大McMaster大学的JM. Hudak博士提供」下面我们通过简略浏览一些图像来结束对成像模式的讨论，这些图像不是来自物理对象，而是。分形是由计算机生成图像的显著例子L1997D。基本上，分形只不过是一种基本用计算机产生的。模式根据某些数学规则的迭代复制。例如、“贴瓷砖”是产生分形图像的最简方法之一个方块可一步细分为4个更小的方块，等等。为了填充每个小方块，根细分为4个小方块，每个小方块又可进些漂亮的瓷砖图像可用这一方法产生。当然，几何形状可以是任意的。。例如・分据规则的复杂性，形图像可以从一个中心点向外辐射生长。。图1.22 （a)显示了使用这种方法生成的分形图像。图1.22 （6)一幅分形图像（“月球表面”），1它为前述章节所用过的空间图像提供了一个有趣的模拟。正示了另一图122(a)-(b)分形图像;Cc)-(aD由所示物体的三维计算机模型生成的图像〔图Ga)和图()由BSwatmore学P院的Mliss DBinde先生提供、图(G)和图(G)由NASA提供」分形图像朝着具有艺术性的，并根据某一规则的子图像元素生长的数学公式表示的方向发展。它们有时会用做随机纹理。。借助于计算机生成更结构化的图像依赖于三维建模。。三维建模是图像处理和计算机图形学的交义领域，也是许多三维可视化系统(如光模拟器)的基础。图1.22 （e)和图1.22 d显示了计算机生成的图像例子。因为愿始物体是以三维方式创建的，所以可以在任何角度由三维物体的平面投影来生成图像。这种类型的图像可用于医学培训及其他主要应用，如刑事法庭和需要产生特45五殊效果的场合.4数字图像处理的基本步骤把后续各章涉及的内容划分为1.1 节定义的两个主要类别是有帮助的：：一类是其输入和输出都是图像；另一类是其输入可能是图像但输出是从这些图像中提取的属性。这种组织结构总结于图1.23中。该图并不意味着每种处理都用于图像。。相反，目的是给出所有方法的一个概念，这些方法可以针对不同的目的、不同的目标运用于图像。这一节的讨论也可以看成是本书其余部分内容的综述。这些处理的输出通常为图像“A福形态学处理彩色图像处理品海四。男%第轿,知识库品海表示和描述间题域宁日标识别图像获取数字图像处理的基本步骤，方框中指出的章号是方框中讨论内容的位置K1.23图像获取是图1.23 中的第一步处理。1.3 节的讨论给出了关于数字图像起源的一些提示。这个主一些贯穿全书的基本数字图像的概念。注意、图题在第2章中将更具体地进行研究，这一章还要介绍一象获取与给出一幅数字形式的图像一样简单。通常，图像获取阶段包括图像预处理，譬如图像缩放图像增强是对一一幅图像进行某种操作，使其结果在特定应用中比原始图像更适合进行处理一词在这里很重要，因为一开始增强技术就建立在面向问题的基础之上。例如，对于增强X射线图像十分有用的龙法・对于增强电磁波谱中红外波段获取的卫星阁像可能就不是最好的方法。当为视觉解释而处理一幅图像时，观察者就是特殊方法工作好坏没有图像增强的通用的最终裁判者。增强技术是如此多种多样，以至于有众多不同的图像处理方法，因此在没有广泛背景介绍的情况下，在一章中组织出适合于增强技术有意义的主体是很困难的。基于这个原因，也基于图象处理领域的初学者通常看到图像增强应用在视觉上是很吸引人的、有趣的且理解起来相对简单的所以在第2章、第3章和第4章中，，当我们介绍新概念时，都会以图像增强作为例子。后两章中的内容涉及许多用于增强图像的传统方法。因此，使用来自图像增强的例子介绍早些章节阐述的新图像处理方法、不仅节省了本书处理图像增强的额外章节，而且更重要的是，对于向新学习者介绍本书早期处理技术细节也是有效的方法。然面，正像您将看到的本书其余内容的进展那样，这些章节阐述的内容可应用于比图像增强宽泛得多的问题。图像复原也是改进图像外观的一一个处理领域。然而、与图像增强不同、图像增强是主观的，而图像复原是客观的；在某种意义上说，、复原技术倾向于以图像退化的数学或概率模型为基础。另一方面，增强以什么是好的增强效果这种人的主观偏爱为基础。彩色图像处理已经成为一个重要领域，因为互联网上数字图像的使用在在不断增长。第6章涵论15盖了许多彩色模型和数字域的彩色处理的基本概念。在后续各章中彩色也是提取图像中感兴趣特征的基础。小波是以不同分辨率来描述图像的基础。i。特别是，本书中为图像数据压缩和金字塔表示使用了小波，，在这里，图像被成功地细分为较小的区域。正如其名称指出的那样，压缩指的是减少图像存储量或降低传输图像带宽的处理。虽然存储技术在过去的 10年里已有明显改进，但对于传输能力我们还不能这样说。。尤其在互联网的应用上更是如此，互联网是以大量图片内容为特征的。。多数计算机用户都很熟悉(也许并未注意)图像压缩所用的图像文件扩展名，如JPG文件扩展名用于JPEG(联合图片专家组)图像压缩标准。形态学处理涉及提取图像分量的工具，这些分量在表示和描述形状方面很有用。正如I.1 节所指出的那样，这一章的内容将从输出图像处理到输出图像属性处理的转换开始。分割过程将一幅图像划分为它的组成部分或目标。通常，自动分割是数字图像处理中最困难的壬务之一。成功地把目标逐一识别出来是一-个艰难的分割过程。另一方面，很弱的且不稳定的分割算法几乎总是会导致最终失败。通常，分割越准确，识别越成功。表示与描述几乎总是在分割阶段的输出之后，通通常这一输出是未加工的像素数据，这些数据不是构成一个区域的边界(即分隔一个图像区域与另一个图像区域的像素集合)，就是构成该区域本身的所有点。无论哪种情况，把数据转换成适合计算机处理的形式都是必要的。首先，必须确定数据是应表示为一条边界还是应表示为整个区域。如果关注的是外部形状特征，譬如角点和拐点，，则表示为边界是合适的。如果我们关注的是内部特性，例如纹理或骨架形状，则区域表示是合适的。。在某些应用中，这些表示彼此是互补的。选择一种表示仅是解决把原始数据转换为适合计算机进行后续处理的形式一部分。。为了描述数据以使感兴趣的特征更明显，必须确定一种方法。描述又称为特征选择，涉及提取特征，它可得到某些感兴趣的定量信息，或是区分一组目标与其他目标的基础。识别是基于目标的描述给该目标赋予标志(譬如“车辆”）的过程。如1.1 节详细介绍的那样，我门通过阐述识别个别目标的方法来结束数字图像处理的讨论。到目前为止，我们还没有谈到关于先验知识及图1.23 中知识库与各个处理模块之间的关系的内容有关问题域的知识已经以知识库的形式编码并存入图像处理系统中。这一知识可能像一幅图像详细描述区域那样简单，在这里定位已知的感兴趣的信息，可将限制性的搜索引导到要寻找的信息处。知识车也可能相当复杂，如材料检测问题中所有主要缺陷的相关列表，或者包含变化检测应用中一个区域的高分辨率卫星图像的图像数据库。除了引导每个处理模块的操作外，知识库还要控制模块之间的交王。这一特性由图1.23中处理模块和知识库之间的双头箭头表示，而单头箭头则用于连接处理模块。虽然没有专门地讨论图像显示，但要记住图像显示是很重要的，观察图像处理的结果可在图1.23中的任何阶段的输出处执行。还应注意，不是所有的图像处理应用都需要图1.23给出的复杂交互。事在某些情况下甚至并不需要所有这些模块。例如，用于人眼视觉解释的图像增强就很少要求使用K图1.23中的任何其他步骤。然而，通常随着图像处理任务复杂性的增加，需要做更多处理才能解决问题。1.5图像处理系统的组成20 世纪80年代中叶，世界各地售出的各种型号的图像处理系统，基本上都是由许多主机及与这些主机配套的外设组成的。20世纪80年代末 90年代初，市场已转为将图像处理硬件设计为与工业标准总线兼容，并能配合工程工作站机箱和个人计算机的单板形式。除了降低成本外，这一市场转型还如催化剂一样催生了大量的新公司，这些公司的任务是开发用于图像处理的软件。虽然针对如处理卫星图像的大规模图像应用的大型图像处理系统一一直在出售，但趋势是朝着小型化和通用化的小型机并带有专用图像处理硬件的混合型系统方向发展。。图1.24显示了用于数字图像。下面几段讨论每个组件的功能，从图像感知开始。处理的一个典型通用系统的组成。。第关于感知，需要两个部件来获取数字图像。网华个部件是物理设备,，该设备对我们希望成像的目标辐。第二个部件称为数字化器，数字化射的能量很敏感。计算机大容量存储图像显示器器是一种把物理感知装置的输出转换为数字形式的设备。例如，在数字视频摄像机中，，传感器产生一个与签特光强成正比的输出，数字化器把该输出转换为数字数留像处理软件硬拷贝据。这些主题包含在第2章中。专用图像处理硬件通常由刚刚谈到的数字化器与图像传感器执行其他原始操作的硬件「如算术逻辑单元(ALUD、算术逻辑单元对整个图像并行执行算术与逻辑且成，运算。如何使用 ALU的一个例子是与数字化一样快图1.24通用图像处理系统的组成的图像取平均操作，这一操作的目的是降低噪声。种类型的硬件有时称为前端子系统，其显著特点是速度快。换句话说，该单元执行要求快速数据吞吐的功能(譬如以30帧/秒的速率来数字化和平均视频图像)，典型的主机不能胜任该工作。图像处理系统中的计算机是通用计算机，其范围从 PC到超级计算机。有时在专门应用中也采用特殊设计的计算机，以达到所要求的性能水平。但是，这里感兴趣的还是通用图像处理系统。在这些系统中，几乎任何配置较好的PC对于离线图像处理任务都是适合的。图像处理软件由执行特定任务的专用模块组成。。一个设计优良的软件包还包括为用户写代码的能力，例如，最小化就可以使用专用模块。更完善的软件包允许那些模块的集成，并至少用一种计算机语言编写通用软件命令集。大容量存储能力在图像处理应用中是必需的。。一幅图像的尺寸是1024× 1024 像素，每像素的灰度是。在处理几千幅甚至儿百万幅图像时，在图像处理系如果图像不压缩，则需要1MB的存储空间。比特，女。图像处理应用的数字存储分为三个主要的类别：（1)处理统中提供足够的存储空间将是一个极大的挑战。；（2)关系到快速调用的在线存储；（3)档案存储，其特点是不频繁访间。存储是以字期间的短期存储;节(8比特)、存节(1000字节)、兆字节(100万字节)、吉字节(10亿字节)或太字节(TB)来计量的。提供短期存储的一种方法是使用计算机内存。另一种方法是采用专用的存储板，，这种存储板称为帧缓存，它们可以存储一帧或多帧图像并可快速访问，通常以视频速率(30帧/秒)访问。。后一种方法实质上允许瞬时缩放、滚动(垂直移动)和摇动(水平移动)图像。帧缓冲器通常放在专用图像处理硬件。在线存储通常采用磁盘或光介质存储。在线存储的关键特性参数是对存储数。如图1.24所示。据的访问频率。最后，档案存储是以大容量存储要求为特征的，但无须频繁访问。放在类似于投币电唱机的盒子内的磁带和光盘是通常使用的档案存储介质。今天使用的图像显示器主要是彩色电视监视器(更好一些的是平面屏幕)。监视器由图像和图形显示卡的输出驱动、它们是计算机系统的一个集成部分。对于图像显示应用不可能没有这样的要求，即作为计算机系统的一部分，其显示卡应满足商用性要求，在有些情况下还要求立体显示。立体显示是采用戴在用户头上的目镜上嵌有的两个小的显示屏的头盔来实现的。用于记录图像的硬拷贝设备包括激光打印机、胶片相机、热敏装置、喷墨装置和数字单元，如cD-ROM等。胶片的分辨率最高、但纸作为书写材料是首选的介质。为了表现图像，图像可显示在透明胶片上，或者使用图像投影设备显示在数字介质中。后者作为图像表现的标准正在被逐步接受的，在图像传输中主要考虑的问题是带宽。在专用网络中，这不是一个典型问题，但通过互联网的远程通信就不总是有效的了。幸运的是，随着光纤与其他宽带技术的发展，这一状况正在迅速得到改善小结本章呈现的材料的主要目的是对数字图像处理的起源、重要意义、该技术当前及未来的应用领域提供概括性的介绍。由于篇幅所限，本章中涉及主题的覆盖面必然不太全面，但是在数字图像处理的知识宽度和应用范围方面应该已经给读者留下了一个清晰的印象。。在后面的章节中，将进行图像处理的理论和应用方面的阐述，并提供大量的实例，以进一步理解这些技术的应用。学完本书的最后章后，读者应能了解数字图像处理领域的大多数当前研究进展情况。参考文献后续各章末尾的参考资料致力于那些章节讨论的特定话题，并在本书末尾对参考书提供了线索。然而，为了在这一章集中汇总一下关于图像处理和相关主题的材料，我们采用不同的方式列出主要杂志。这里还提供了一个书目列表，以便读者可以快速了解本领域的历史和当前的发展动态。这一章引用的参考材料主要是图像处理方面的一般性的、易于理解的已出版文献。关于图像处理及相关题目的主要参考杂志包括：EE Trasactions on lmage Processing: EEE Transclnellgence; Paten Reconitin Puttem Recognitio Lter; Journal ef the Optical Sociey of Mmerica（1984年前)；lournal of the Optical Society of America-A: Optics, Image Science and Vision; Optical Engineering; AppliedOpics Information Processng； IEEE Transaction on Medical Imaging: Joumal of Electronic Imaging； IEETransactions on Information Theory; LE Trasactions on Communications; IEEE Transactions on AcousticsSpeechad signl Presg: reeing o l1EE，以及1980年前的1EEETractins n Compuer专刊。国际光学工程协会(SPIE)的出版物也很重要。下面按出版年份反序列出了包含有数字图像处理补充材料的书籍(偏重于近年来出版的书籍)。这些书籍给出了该领域过去30多年来的发展概述，同时选择了各种形式的论著。它们的覆盖范围从基础理论的教科书，到提供技术综述的手册，以及包含该领域当前研究的代表性材料的编辑书籍。Prinsland Lis-:.M. 001. Meial mging. sigalsa Sysem PrenicHall, Upper Saddle Rivcr, NJBezek,. C.e aL.201.uzxy Models ad Algorims for Puem Recoion amage Processing, Springcr, New York.Davies. E. R. [2005]. Machine Vision: Theory, Algorithms, Practicalities,Morgan Kauf-mann, San FrancisRangayyan. R. M. 2051. Biomnedical Image Analysis, CRC Press, Boca Raton, FLUmbaugh S.E.[20051. Computer Imaging: Digital Image Analysis and Processing.CRCPress, Boca Raton, FL.Snyder, W. E. and Qi, Hairong [20041]. Machine Vision, Cambridge University PressKlette, R. and Rosenfeld, A 2004] Digital Gieometry-Geometric Methods fo DigitalPicture Analysis, Morgan Kaufmann, San Francisco, CA.S and Gray,R. M.[20041. Stochastic lmage Processin, Kluwer Academic/PlenumPublishers New Yorkoie.、.2031. Morphological Image Analysis: Pinciples and Applicais.Znd ed. R. and Lotuf,R.A.203 Hands-on MorphologSPIE-The International Society for Optical Engineering, Bellingham, WA.Woods, R.jonzForsyth, D. F. and Ponce,J [20021. Computer Vision--A Modern Approach,PrenticeDuda, R.0. Hart, P. E. and Stork, D. G. [201. Pater Clsification, 2nd ed., JohnWiley & Sons, New York.Pratt, K. [201] Digial Image Processing, rd ed.,John Wiley & Sons New York.Ritter, G.[201. HLandbook of Computer Visin Algorihms ilmage Algebra, CRC Press, Boca Raton, FELShapiro.L.g.and Stockman, G.C.[2001]. Compuer Vion,Prentic Hall Upper SaddleRiver, NJDougherty: E.R,(ed:) 20]. Random Processesfor Image and Signal ProcessingEtienne,E.K,and Nachtegael,M. eds).[20] uzzy Techniques in Image Processng.Springer-Verlag, New York.s,J., Vincent, L.-,and Bloomberg, D.S.(eds). [20]. Mathematical Morphologywnd Is Aplications to Image and Signal Processing,Kluwer Academic PublishersBoston, MA.Mallt. A. H.[2000]. Computational Vision, The MIT Fress, Cambridge, MAMarchand-Mallet S and Sharaiha, Y M [200. Binary Digial Imge Processing:AMitra, S. K, and Sicuranza, G.L (eds)） 2000]. Nonlinear Image Processing, AcademicPress, New YorkEdelman, S,[19991. Representaion and Recogniion in Vision, The MIT Pess Cam-bridge, MA.nd,T M.and Kiefer,R.W.[1999J. emote Sensing and Image Interpretation, JohnWiley & Sons, New York.Mather, R.M. 19:.Compuer Proessin of Remotely Sensed Images: An IntroductionJohn Wiley & Sons New YorkRuss,J. C.[1999] The Image Processing Handbook, 3rd ed. CRC Press, Boca Raton, FLSmirnox,A.[1999|. Pocessing of Mutidimensional Signals, Springer-Verlag. New YorkSonka, M Havac,Yn ole.19 mage Pocsing Aalsad CompuerYision, PWS Publishing, New York.Haskell,.B G, and Netravali,AM17. igial Pictures: Represenaion, Compressionnd Siandards, Perseus Publishing, New York.Jahns.1997. illse Roesin:CocetsAkoitm a Sciemit Aaplictions, Springer- Verlag. New YorkBracewell R.N.[1995. 7wo-Dimensional lmaging.Prenice Hal. Uppe Saddl River, NUSid-Ahmed. M.A. 1951. Image Processing: Theory Algoriuhims and ArchiecturesMcGraw-Hil, New York.Mitiche,A.[1941. Computational Analysis of Visual Motion, Perseus Publishing. New YorkBaxes, G.A.[19941. Digial lIma, John Wiley& Sons, New York.Gonzalez, R. C and Woods R. E. [1992]. Digial Image Processing, Addison-WesleyReading, MA.k,R. M. andHaraliPratt, W.K [1991 Digial lmage Processing, 2nd ed., Wiley-nterscience, New York.p-Dimensional Signal and Image Pocessing, Prentice Hall, Upperle River, NJJain, A. K [19891. Fiundamentals of Digital Image Processing, Prentice Hall, UpperSaddle River, NJschalkoff. R .,|19891. Digial lmage Processing and Compuer Vision, John Wiley &Sons, New YorkGiardina, C. R. and Dougherty.E.R.[19881. Morphological Methods in lmage and SignalProcessing, Prentice Hall Upper Saddle River, NJ.Levine, M. D. [1985]. Vision in Man and Machine, McGraw-Hill, New York.sera J. 1982]. Image Analysis and Mahematical Morphology, Academic Press, NewYork.Ballard.,D.,H. and Brown, C. M [1982]. Computer Vision, Prentic Hall pper SaddleRiver, NJFu.x.1821- yicic Pruem Reconiona Apiais. renic Hall PeSaddle River,NJ.Nevatia, R.[19821. Macine Perception,Pentice Hall Upper Saddle River, NJLrali .1831.43grims fo Graphics ad lmagePoesng,Compuer SicncPress Rcvile MD.Rosenfeld, A.and Kak,A: C. [1981] Digital Picture Pocessing, 2nd ed. vols.1 & 2.Academic Press, New York.fall E.L.[19791. Compuer Image Pocesin and Recogniion,Academic Press. New York.Gonzalez, R. C. and Thomason, M. .[1978]. Syntactic Pautern Recogniion: An Inurcvs H.C. and Hunt,B.R.[1977. Digial Image Restoraion, Prentice Hall UpperSaddle River, NJPavlids T.[1977]. Structural Pattem Recogniion, Springer- Verlag, New YorkAndrews, H C. [1970]. Compuer Techniques in lmage Processing, Academic PressNew York第2章要想成功，就必须弄清基础问题亚里士多德引言本章的主要目的是介绍本书所用到的数字图像处理的一一些基本概念。2.1 节简述人类视觉系统的机理，包括眼中图像的形成及对亮度的适应和鉴别能力。2.2 节讨论光、、电磁波谱的其他分量及它们的成像特点。2.3 节讨论成像传感器及怎样使用它们产生数字图像。。 2.4节介绍均匀图像取样及灰度量北的概念。。该节中讨论的其他主题包括数字图像表示、图像中取样数和灰度级变化的影响、空间和灰度分辨率的概念，以及图像内插的原理。。2.5 节处理像素间的各种基本关系。。最后，2.6节介绍本书用到的主要数学工具。该节的第二个目的是帮助愈开始积累一些在各种基本图像处理任务中如何运用这些工具的感觉。这些工具及其应用范围在需要时将在本书的剩余部分再扩展。2.1视觉感知要素虽然数字图像处理这一领域建立在数学和概率公式表示的基础之上，但人的直觉和分析在选择种技术而不选择另一一种技术时会起核心作用，这种选择通常是基于主观的视觉判断做出的。因此，将大概了解人类的视觉感知作为学习本书的起点是合适的。鉴于这一主题的复杂性和宽泛性，这里仅涉及人类视觉的最基本方面。特别是，我们的兴趣在于人类形成并感知图像的机理和参数。。我们的兴一些因素来了解人类视觉的物理限制。因此，人类与电子成像设备相比，趣还在于通过数字图像处理的一在分辨率和对光照变化的适应能力方面不仅有趣，从实践的角度来看也很重要2.1.1人眼的结构图2.1显示了人眼的一一个简化水平剖面。。眼睛的形状近似为一一个球体，其平均直径约为20 mm。三层薄膜包围着眼睛:：角膜与巩膜外壳、脉络膜和视网膜。角膜是一一种硬而透明的组织，覆盖着眼请的前表面。与角膜相连的巩膜是一层包围着眼球其余部分的不透明的膜。脉络膜位于巩膜的正下方。脉络膜包含有血管网，它是眼睛的重要滋养源。即使是对脉络膜表面并不严重的损害，也有可能严重地损害眼睛，引起限制血液流动的炎症。脉络膜外壳着色很重，因此有助于减少进入眼内的外来光和眼球内反向散射光的数量。脉络膜的的最前面分为睫状体和虹膜。股的收缩和扩张控制着进入眼睛的光量。虹膜中间的开口(瞳孔)的直径是可变的，范围大约在2-8 m虹膜的前面包含有眼睛的可见色素，而后面则包含有黑色色素。睫状肌晶状体由同心的纤维细胞层组成，并由附在睫状体上的纤维悬挂着。晶晶状体包含60% -70%的水、5%的脂肪和比眼睛中任何其他组织都多的蛋白质。建状小带晶状体由稍黄的色素着色，其颜色随着人的年龄的。在极端情况下，晶状体会过于混浊，增大而加深。视轴这通常是由白内障等疾病引起的，可能导致低下的彩色辨别能力和视觉清晰度的损失。晶状体吸收大玻璃体约 8%的可见光谱，，对短波长的光有较高的吸收率。见网膜在晶状体结构中，蛋白质吸收红外光和紫外光，吸央凹收过量时会伤害眼睛眼睛最里面的膜是视网膜，它布满了整个后部脉络膜。当眼睛适当地聚焦时，，来自眼睛外部物体的内壁。。由视网膜表面分布的不连续的光在视网膜上成像。感受器提供了图案视觉。有两类光感受器:的光，死图2.1人眼剖面简图锥状体和杆状体。每只眼睛中的锥状体数量在600700 万之间。它们主要位于视网膜的中间部分，和称之为中央凹。且对颜色高度敏感。用这些锥状体，人可以充分地分辨图像细节，因为每个锥状体都连接到首身的神经末梢。肌肉控制眼球转动直到感兴趣的物体图像落到中央回上。锥状体视觉称为白昼视觉或亮视觉。杆状体的数量更多：约有 7500 -15 000万个杆状体分布在视网膜表面。由于分布面积较大而且几一个神经末梢，因此减少了这些感受器感知细节的数量。杆状体用来给出视野内的个杆状体连接到般的总体图像。它们没有彩色感觉、而对低照明度敏感。例如，在白天呈现鲜明色彩的物体，在月光下都没有颜色，因为此时只有杆状体受到刺激。这种现象称为暗视觉或微光视觉。图 22显示了右眼中通过眼睛光神经出现区的剖面的杆状体和锥状体密度。在这一区域由于没有感受器而导致了所谓的盲点(见图2.1)。除了这一区域，感受器的分布是关于中央凹径向对称的。感受器密度根据距中央凹的度数来度量(即离开视轴的度数，它由视轴和通过晶状体中心并相交于视网，图2.2中的锥状体在视网膜的中心最密(在中央凹的中心区域)。还莫的一条直线的夹角度量)。注意，应注意到，从该中心向外到偏离视轴大约20*处，杆状体的密度逐渐增大，然后向外到视网膜的极限边缘处，密度逐渐下降。二特获社视网膜中杆状体和锥状体的分布图2.2中央凹本身是视网膜中直径约为1.5 mm的圆形凹坑。然而，为便于后续的讨论，我们把它近。这样，为解释的灵活性，我们可以把中央凹着成是大小似为方形或矩形敏感元素的阵列会更有用。为1.5 mm×I.5 mm的方形传感器阵列。在视网膜这一一区域中,锥状体的密度大约为150 000个/mm一近似，眼睛中最高敏感区域的锥状体数量约为37000个。从自然分辨能力的角度看，恰好县于这一方一个中等分辨率的电荷耦合元件(CCD)成像芯片果有的元素教量相当・接收器阵列杰大于5.mmx尽管人类整体的智慧和视觉经验的能力使得这种比较有些肤浅，但记住，人眼分辨细节能力S mm。尽的进一步讨论与当前电子成像传感器当然是可比较的。2.1.2眼睛中图像的形成在普通照相机中，镜头有固定的焦距，各种距离的聚焦是通过改变镜头和成像平面间的距离实，则与此相反；晶状体和成现的，胶片放置在成像平面上(数码相机情况下是成像芯片)。在人眼中，像区域(视网膜)之间的距离是固定的，实现正确聚焦的焦距是通过改变晶状体的形状来得到的。睫状体中的纤维可实现这一功能，，在远离或接近目标物时纤维会分别变扁或加厚晶状体。晶状体中心和视网膜沿视轴的距离大约是17 mm。焦距约为14~17 mm，在眼睛放松且聚焦距离大于3m时，焦距约为17 mmc图2.3中的几何关系说明了如何得到一幅在视网膜上形成的图像的尺度。例如，假设一个人正在见看距其100 m处的高为15m的一棵树。令h表示视网膜图像中该物体的高度，由图2.3的几何形状可以看出15/100= h/17或h=2.55 mmn。正如2.1.1 节指出的那样，视网膜图像主要聚焦在中央凹区域。然后，光接收器的相对刺激作用产生感知，把辐射能转变为电脉冲，最后由大脑解码。人眼观看一棵棕榈树的图解，点C是晶状体的光心图2.3强闪光亮度适应和辨别2.1.3，所以因为数学图像作为离散的灰度集来显示，眼睛对不同亮度级别之间的辨别能力在显示图像处理结果中是一个重要的考虑因素。人的视觉系统能够适应的光强度级别范围是很宽的从暗阈值到强为光约有10个量级。实验数据指出，主观亮度(即由人的视觉系统感知的亮度)是进入人眼的光强的对数函改心图2.4.中画出的光强度与主观亮度的关系曲线说暗视觉一特性。。长实线代表视觉系统能适应的光强范明了这一老视觉。在亮视觉中,，该范围大约是10°。。由暗视觉逐渐过日。暗闽值渡到亮视觉的近似范围约为0.001-0.1mL(朗伯)（在对光强的对数(mL）l mL)，图中画出了该范围内这一适图2.4显示了特殊适应级别的主观亮度感知范围应曲线的两个分支。数字图像基础23解释图 2.4中描述的令人印象深刻的动态范围的基本要点是视觉系统不能同时在一个范围内工确切地说，它是通过改变其整个灵敏度来完成这一较大的变动的，这就是周知的亮度适应现象眼睛可以同时辨别的不同强度级别的总范围与整个适应范围相比是很小的。对于任何给定的条件集合、视觉系统的当前灵敏度级别称为亮度适应级别，例如，它可能对应于图2.4中的亮度局。较短的交义线表示当眼睛适应这一强度级别时人眼所能感知的主观亮度范围。注意、这一范围是有一定限制的，级别B,或低于级别B,的剌激都被感知为不可辨别的黑色该曲线的上部实际上不受限制，但如果延伸太远也会失去意义，因为高得多的强度将会把适应能力提高到比B,更高的水平。在任何特定的适应级别上，人眼辨别光强变化的能力也是值得考虑的因素。。用于确定人类视觉系统亮度辨别能力的一一个著名实验，由一个注视对象和大到足以使其占有全部视野的均匀发光区组一区域是一个典型的漫反射体，，譬如不透明玻璃，使用强度1可变的一一个光源从后面照向该漫反射体。在该视野中增加一个照射分量AI，形成一个持续时间很短的闪烁，该闪烁以均匀光场中央的圆形方式出现，，如图2.5所示。如果么1不够亮，，则目标不变，表明没有可觉察的变化。当A1逐渐加强时，目标会给出肯定的响“是”，指出一个可觉察的变化。最后，当△1足够强时，目标将始终给出肯定的响应“是”业AI.71称为韦伯比，其中△。是在背景照明为1时可辨别照明增量的50%。A1./1值较小意味着可辨别强度较小的百分比变化，这表示亮度辨别能力“较好”。。相反，△1.71较大意味着要求有较大强度的百分比变化，这表示亮度辨别能力““较差”作为 log1的函数，log AI.71曲线具有图2.6所示的一般形状。这一曲线表明，，在低照明级别亮度辨别较差(韦伯比大)，且它会随着背景照明的增加而明显改善(韦伯比降低)。曲线中的两个分支反映了这样一个事实，即在低照明水平情况下，视觉由杆状体执行，在高照明水平情况下(表示较好的辨别能力)，视觉由锥状体执行。+ A1图2.5用于表征亮度辨别的基本实验设置图2.6作为强度函数的典型韦伯比如果背景照明保持恒定，并且代替闪光的其他光源的强度现在允许从不能觉察逐渐变化到总可以被觉察，典型的观察者可以辨别总共12级到24级的不同强度变化。一个人观。粗略地看，该结果与一置单色图像中的任意一点时所觉察到的不同强度的数量相关。这个结果并不意味着一幅图像可以由这样少的强度值来表示，说明，即眼睛能够检测到用不足24级强度表示的单色图像中的令人讨厌的轮廓效应。两种现象清楚地表明感知亮度不是简单的强度的函数。第一种现象基于这样一个事实，即视觉系统往往会在不同强度区域的边界处出现下冲”。虽”现象。图 2.7 4a)显示了这种现象的一个典型例子。然条带的强度恒定，但在靠近边界处我们实际上感知到了〔见图2.7 (c）]。这些看起来带有毛边带有毛边的亮度模式[的带称为马赫带，厄恩斯特・马赫于1865年首次描述了这实际亮度现象。它与这样一个事实有关，即第二种现象称为同时对比，感知区域的亮度并不简单地取决于其强度，如图 2.8所示所有的中心方块都有完全相同的强度。然而，随着背景变得更亮.它们在眼睛里会变得更暗。。一个更熟悉的例子是张纸，-张纸放在桌子上时，看上去似乎比较白，，而当我们使用它遮多知亮度住眼睛来直视明亮的天空时，它看起来会总是呈现黑色。人类感知现象的另一些例子就是错觉，在错觉中，睛填充了不存在的信息或者错误地感知了物体的几何特点。图2.9给出了一一些例子。在图2.9(a)中，正方形的轮廓看起来很清楚，尽管图像中并没有定义这样一一个图形的直线马赫带效应图解图2.7在图 2.96b)中可以看到相同的效果,，只是这次是一一个圆；注一个完整的圆的错觉。图29(0)中的两条水平线段的长度相同，但看起来意，仅有几条直线就足以导致一条显得比另一条短。最后、图2.90中.45*方向的所有直线都是等间距的平行线、然而画有交义影线就产生了错觉，觉得这些线不再平行。错觉是人类视觉系统的一种特性，但这一特性尚未被人类完全了解。图2.8同时对比的几个例子。。所有的中心方块都有相同的强度，但随着背景的变亮，它们看起来逐渐变暗图2.9些典型的错觉光和电磁波谱2.2电磁波谱在1.3节中已做过介绍，现在我们更详细地研究这一一主题。1666年，艾萨克・牛顿发现,，而是由一端为紫色而另一端为红色的连当一束太阳光通过一个玻璃棱镜时，，显示的光束不再是白光，续色谱组成。如图2.10所示，我们感受到的可见光的彩色范围只占电磁波的一一小部分。在波谱的一一端是无线电波，其波长是可见光波长的几十亿倍。波谱的另一一端是伽马射线，其波长比可见光小几百万倍。。电磁波谱可用波长、频率或能量来描述。波长()和频率(v)的关系可用下式描述数字图像基础25(2.2-1）人=clv其中c是光速(2.998×10* m/s）。电磁波谱的各个分量的能量由下式给出:E= hv(2.2-2）其中h是普朗克常数。波长的单位是米(m)，最常用的单位是微米(表示为Jm=10*m)和纳米l uim =表示为nm10*m)。频率用赫兹(Hz)来度量，1 Hz表示正弦波每秒1个周期。常用的能量单位是电子伏特。个光子的能量（电子伏特）90'工外线无线电波紫外线射线加马射线可见光谱D.4 × 100.7 × 10*红外线紫外线紫色蓝色绿色橙色电磁波谱。为为便于解释，可见光谱已被放大，但请注意，可见光谱是电磁波谱中相当窄的一部分图2.10电磁波可以看成是以波长入传播的正弦波（见图2.11)，或者可以着成是没有质量的粒子流，每个拉子以波的模式以光速传播和移动。每个无质量的粒子包含一定的(一束)能量，每束能量称为一个光子我们从式(2.2-2)可以着出能量与频率成正比，因此更高频率(更短波长)的电磁现象的每个光子携带有更多一个波长的图形表示图2.11。这样，无线电波有低能量光子，微波比无的能量。线电波具有较多的能量，红外波还要多，然后是可见光、紫外线、X射线和最后的伽马射线，其中伽马射线的能量最高，这就是伽马射线对活体组织危害很大的原因。一种特殊的电磁辐射，它可以被人眼感知。为便于讨论，把可见光谱(彩色)段扩展后示于七是图2.10(第6章将更详细地讨论彩色)。电磁波谱的可见光波段的跨越范围约为0.43 um(紫色)-0.79颜色(或电磁波谱的其他分量)不是突然终正的，而是混合平滑地过渡到另一种颜色的，如图2.10所示。人感受一个物体的颜色由物体反射光的性质决定。以所有可见波长相对平衡地反射光的物体，对观察者而言是白色的。然而，一个物体在可见光谱的有限范围内反射时会呈现各种颜色色调。例如、绿色物体反射波长范围为500-570 nm的光，而吸收其他波长的大部分能量。65没有颜色的光称为单色光或无色光。单色光的唯一属性是它的强度或大小。因为感知单色光的强度从黑色到灰色变化，最后到白色，灰度级一词通常用来表示单色光的强度。在后续讨论中，我们[67将交替地使用强度和灰度级这两个术语。从黑到白的单色光的度量值范围通常称为灰度级，而单色图像常称为灰度图像正如前面指出的那样，彩色光的电磁能谱跨越0.43 um(紫色)-0.79 um红色)的范围。除了频率之外，有三个基本量用于描述彩色光源的质量：发光强度、光光通量和亮度。发光强度是从光源流出能。用流明数(Im)度量的光通量给出观察者从光源感受到的能量。量的总量，通常用瓦特(W)来度量。如，从远红外光谱范围的光源发射出的光具有实际意义的能量，但观察者却很难感知到它。。它的光通量几乎是零。最后，如2.1节所讨论的那样，亮度是光感知的主观描绘子，它实际上不能度量。它具本体现了强度的无色概念、，是描述彩色感觉的参数之一继续图2.10的讨论，，我们注意到电磁波谱的短波长的一端是伽马射线和X射线。正如1.3.1节讨论的那样，伽马辐射对医学和天文学成像很重要，对核环境中的辐射成像也很重要。硬(高能)X射线用于工业应用中。胸透和牙科使用的X射线位于X射线频段的低能(软)端。软X射线波段过渡到远紫外线的区域，而远紫外区域又与较长波长的可见光谱混合。逐步移向更高的波长，我们会遇到红外这使得它在依靠“热特性””成像的应用中非常有用。红外波段靠近可见光波段，，红外波段会辐射热,而该波段的另一谱的部分称为近红外区域,一端称为远红外区域。。远红外区域的后部与微波频段混合。、I这个波段是众所周知的微波炉的能源，但它还有许多其他用途，包括通信与雷达。最后，无线电波段包括电视、调幅收音机和调频收音机。。在更高的能级，从某些天体发出的无线电信号在天文观测中很有用。1.3节给出了刚才讨论的多数波段成像的例子。原理上，如果可以开发出一种传感器来检测由一种电磁波谱发射的能量，那么我们就可以在该一个物体的电磁波的波长必须小于等波段上对感兴趣的事件成像。但要注意的一点是，要求“看到”于物体的尺寸。例如，水分子直径的量级是10"m，若要研究该分子，则需要一个能在远紫外或软X射线范围发射的光源。。这个限制与传感材料的物理特性一起确立了成像传感器功能的基本限制，譬、红外线和其他传感器如今天所用的可见光、虽然成像主要以电磁波发射的能量为基础，但这并不是生成图像的唯一方法。例如，如1.3.7 节讨论的物体反射的声波也可用于形成超声波图像。其他的主要数字图像源是电子显微镜的电子束和用于图形与可视化的合成图像。2.3图像感知和获取我们感兴趣的多数图像都是由“照射”源和形成图像的“场景”元素对光能的反射或吸收而产生的。把“照射”和“场景”加上引号是为了强调这样一个事实，即比我们所熟悉的一个可见光源每天照射普通的三维场景情况更一般。例如，照射可能由电磁能源引起，如雷达、、红外线或X射线系统。。但是，正如前面指出的那样，照射也可以由非传统光源(如超声波)甚至由计算机产生的照射模式产生主。类似地、场景元素可能是熟悉的物体，但它们也可能是分子、沉积岩或人类的大脑依赖光源的特性，照射被物体反射或透射。、第一一类例子是从平坦表面反射。第三类例子是为了产幅X射线照片，让X射线透过病人的身体。换器上(如荧光屏)，光光转换器再把能量转换为可见光。电子显微镜和某些伽马成像应用就使用这种万法图2.12显示了用于将照射能量变换为数字图像的三种主要传感器配置。原理很简单：通过将输入电能和对特殊类型检测能源敏感的传感器材料相组合，把输入能源转变为电压。输出电压波形是传感器的响应，・通过把传感器响应数字化，从每一个传感器得到一个数字量。在这一节中，我们将关注图69像感知和生成的主要方式。图像数字化将在2.4节中讨论。第2章能量滤光器传感材料电源输入V/一输出电压波形图通拉Ga单个成像传感器：Gb)条带传感器；（e)阵列传感器约2.12使用单个传感器获取图像2.3.1图2.12(a)显示了单个传感器的部件。也许最熟悉的这类传感器是光二极管，它由硅材料构成，并且其输出电压波形与入射光成正比。在传感器前面用一个滤光器改善选择性。例如，，光传感器前面的绿色(通过)滤光器有利于彩色谱的绿波段光通过。因此，传感器输出的绿光比可见光谱中的其他分量要强为使用单一良、在传感器和成-传感器产生二维图像像区域之间必须有x方向和y方向的相对位移。图2.13转动传感器工一个用于高精度扫描的配置・，其中底片安装在示出个鼓上，鼓的机械转动提供了一个维度的位移。单个传感器安装引导螺杆上，飞它提供与转动相垂直的方向线性运动上的移动。因为机械运动可高精度地控制，所以这一增量县传感器完鳖地从左一方胶片每旋转到石线性移动一次，物由菌像的一行法是得到高分辨率图像的一和-种廉价方法(但速度较慢)单个传感器通过运动来生成二维图像图2.13另一种类似的机械配置使用一个平面床，，传感器则在两个方向线性移动。。这些类型的机械数字化仪有时称为微密度计。使用单个传感器成像的另一个例子是将一个激光源和传感器放在一起。使用镜子来控制扫描模式的发射光束，并将反射的激光信号引导到传感器。。这种配置也可使用条形或矩形传感器获取图像，这种配置将在后续两节中加以讨论2.3.2使用条带传感器获取图像比单个传感器更常用的几何结构是由内嵌传感器形式组成的传感器带、如图2.126)所示。该传惑器带在一个方向上提供成像单元。。垂直于传感器带的运动在另一方向上成像，如图 2.14(a)所示。这是大多数平板扫描仪中使用的排列方式。感知设备可能内嵌有4000个或更多的传感器。。内嵌传感器常用于航空成像应用中，，在这种应用中，成像系统安装在一架飞行器上，飞行器以恒定的高度和速度飞过被成像的地区。。可响应各种电磁波谱波段的一维传感器带按垂直于飞行方向来安装。。成像传感器带一次给出一一幅图像的一行，传感器带的运动完成二维图像的另一个维度。透镜和其他聚焦方法用于把扫描区域投影到传感器上。以圆环形方式安装的传感器带用于医学和工业成像，以得到三维物体的剖面（“切片”)图像如图2.14(b)所示。一个旋转的X射线源提供照射、射线源对面的传感器则收集穿过物体的X射线能量(很明显，这些传感器必须对X射线敏感)。这就是1.2 节和1.3.2 节中指出的医学和工业计算机轴向断层(CAT)成像的基础。注意，传感器的输出必须由重建算法处理，重建算法的目的是把感知数据数字图像处理(第三版）转换为有意义的剖面图像(见5.11节)。换句话说，图像不可能单靠传感器的运动直接得到；它们需要进一步的处理。。由图像堆叠组成的三维数字物体是由物体与传感器环在相垂直方向的运动产生的。。照射源、传感于 CAT原理的其他成像模式包括核磁共振成像(MRD和正电子发射断层(PET)成像。器和图像的类型是不同的，但概念上它们与图2.14(b)中所示的基本成像方法非常相似。线性运动赛增量・输出图像的成像区城图像重建线性运动三维物体的剖面图像专感器条带三维物体X射线源多专感器环(a)使用一个线性传感器带获取图像；(b)使用一个环形传感器带获取图像图2.142.3.3使用传感器阵列获取图像图2.12(c)显示了以二维阵列形式排列的单独的传感器。大量的电磁波和一一些超声波传感装置常以阵列形式排列。。这也是我们在数字摄像机中所看到的主要排列方式。这些摄像机的典型传感器是ccD 阵列，这种阵列可制造为具有很宽范围的传感特性，并能封装为具有4000×4000个单元或更多单元的稳定阵列。CcCD.传感器广泛用于数字摄像机和其他光敏设备中。每个传感器的响应正比于投射到传感器表面的光能总量，这一特性被用于天文学和其他要求低噪声图像的应用中。通通过让传感器累积输入光信号超过几分钟甚至几小时的方法，可达到减少噪声的目的。上因为图2.12 (c)所示的传感器阵列是二维的，故其主要优点是通过将能量聚焦到阵列表面，以得到一幅完整的图像。很明显，像前面两节中讨论的传感器排列的运动是不需要的。这样的传感器阵列所用的主要方法示于图2.15。。该图显示了来自照射源的能量是场景元素的反射如本节开始提到的那样，该能量也可以通过场景元素透射)。图2.15(c)所示成像系统执行的第一个功全某些情况下，我们直接对源成则成像系统的前端是一个光学透镜，该透镜把观察的场景投影到透镜的像，就像得到太阳的图像一聚焦平面上，如图2.15(0所示。。与焦平面重合的传感器阵列产生与每个传感器接收到的光的总量成正比的输出。。数字或模拟电路扫描这些输出，并把它们转换成模拟信号，然后由成像系统的其他部分数字化，输出是一幅数字图像，如图2.15(e)的图解所示。把一幅图像转换为数字形式是2.4节的主题。在处理过程中或是作为解译的结简单的图像形成模型2.3.4图像灰度可以为负值。例如移向雷达系统的物年雷达成像中・正像在1.1节中介绍的那样，我们用形如f(rx, y)的二维函数来表示图像。在空间坐标(α、y)处，・厂的值或幅度是一个正的标量，其物理。这样:.二幅速度图像就可编码意义由图像源决定。兰一幅图像由物理过程产生时，其亮度值正比于为既有正值又有负值。在存储和显示图像时，我们通常会标定灰度物理源（如电磁波)所辐射的能量。因此，（(x,y)一定是非零的和有以便最小的负值变为0(灰度标定将限的，即在2.6.3 节介绍)。0< f(x,y)<～。(2.3-1）数学图像基础Be d O照射（能量）湖(数字化后的）图像成像系统内部）图像平面汤景元素图2.15数字图像获取过程的一个例子:a)能量(“照射”）源；D场景元素；(c)成像系统；（d)场景到图像平面的投影；（e)数字化后的图像函数f(x,y)可由两个分量来表征：（1)入射到被观察场景的光源照射总量；；（2)场景中物体所反。这两个分量分别称为入射分量和反射分量，且分别表示为i(G,y)和八(x,y)。两个函数射的光照总量。作为一个乘积合并形成几x)。即(2.3-2）f(x, y)=i(x,y)r(x, y）其中，12.3-3）D<i(x,y)<o02.3-4）D<r(x,y)<1式(2.3-4)指出反射分量限制在0(全吸收)和1(全反射)之间。ic.x，)的9性质取决无照射源，而As的性质则取决于成像物体的特性。注意，这种表示方式还可用于照射光通过一个媒体形成图像的情况，如胸透X射线照片。在这种情况下，我我们应该用透射系数代替反射函数，但其限制应该与式(2.3-4)相同，且形成的图像函数会建模为式(2.3-2)中的乘积。列2.1照射和反射的一些典型值・式(2.3)和式(2.3-4)中给出的值是理论界限。、下面的平均数值用数字说明了ix, )）的。对于可见光，些典型范围。在晴朗的白天，，太阳在地面上可能会产生超过90 00 Im/m-的照度。。在有云的百天，这个数值下降到100 Im/mr。在晴朗的夜晚，满月情况下的照度大约为0.1 Imlm"。。商用办公室的典型照度约、下面是r(x,y)的一些典型值：黑天鹅绒为0.01，不锈钢为0.65，白色墙为0.80.为100 Im/m。类似地,渡银金属为0.90，雪为0.93。令单色图像在任何坐标(（x。Jy）处的强度（灰度)表示为2.3-5）2= /(~0， Jo）由式(2.3-2)到式(2.3-4)可知2的取值范围为Lm 61≤ L(2.3-6理论上，仅要求L为正，而要求L、为有限值。实际上，参照前面提到的办公室的平均照度和反射值范围，我们希望Lmin =10和L= 1000作为没有附加照明的室内值的典型限制。区间[Lim u, 1称为灰度级(或强度级)。实际情况下常常令该区间为[0,L-1]，其中4=0为黑色，0=L-1在灰度级中为白色。所有中间值是从黑色到白色之间变化的灰度色调。数学图像处理(第三版）图像取样和量化2.4由前一节的讨论，、我们看到有多种获取图像的方法，但在所有这些方法中我们的目的是相同的，就是从感知的数据生成数字图像。多数传感器的输出是连续的电压波节中关于取样的讨论较为直这些波形的幅度和空间特性都与感知的物理现象有关。为了产生观。第4章将深人探讨该主题。我们需要把连续的感知数据转换为数字形式。这种转幅数字图像，换包括两种处理：取样和量化。2.4.1取样和量化的基本概念图2.16说明了取样和量化的基本概念。图2.16(a)显示了一幅连续图像f，我们想把它转换为数字形式。一幅图像的x和y坐标及幅度可能都是连续的。为将它转换为数字形式，必须在坐标上和幅度。对坐标值进行数字化称为取样，对幅值数字化称为量化。上都进行取样操作。宝生成一幅数字图像：a)连续图像；b)连续图像中从A到B的一图2.16描线，用于说明取样和量化的概念；(G)取样和量化；の)数字扫描线图2.16(6)中的一维函数是图2.16 (a)中沿线段AB的连续图像幅度值(灰度级)的曲线。随机变化是由图像噪声引起的。为了对该函数取样，我们沿线段AB等间隔地对该函数取样，如图2.16(e)所示。每个样本的空间位置由图形底部的垂直刻度指出。样本用放在函数曲线上的白色小方块表示。这样的一组离散位置就给出了取样函数。然而，样本值仍(垂直)跨越了灰度值的连续范围。为了形成数字函数，灰度值也必须转换(量化)为离散量。图2.16(c)的右侧显示了已分为8个离散区间的灰度标<，范围从黑到白。垂直刻度标记指出了赋予8个灰度的每一个特定值。通过对每一样本赋予8个离散灰度级中的一个来量化连续灰度级。赋值取决于于该样本与一一个垂直刻度标记的垂直接近程度取样和量化操作生成的数字样本如图2.16)所示。从该图像的顶部开始逐行执行这一过程，则会产丰一幅二维数字图像。图216意味着除了所用的离散级数外，量化所达到的精度强烈地依赖于取样信号的噪声。按刚刚讨论的方式取样、假设我们有一幅在两个坐标方向上和幅度上都连续的图像。实践中・B取样方法由用于生成该图像的传感器配置决定。如图2.13所示，当一幅图像由单个传感单元与机械运数字图像基础动相结合生成时，传感器的输出可用前面讨论的方式量化。。然而，，空间取样是通过选择各个机械增量的数量并在取样处激活传感器来收集数据完成的。机械运动可以非常精确地实现，，因此从原理上讲，吏用这种方法对一一幅图像取样可以到达的精细程度并没有限制。实践中，取样精度的限制由其他因素央定，譬如系统的光学元件的质量。当我们使用带状传感器来获取图像时，带中传感器的数量决定了图像中一个方向上的限制。另个方向上的机械运动可控制得更精确一，但试图在一个方向上实现超过另一个方向上被传感器数量限制的取样密度是没有意义的。对传感器输出的量化就完成了产生数字图像的过程。，没有运动且当传感阵列用于图像获取时，阵列中传感器的数量决定了两个方向上的取样限制。传感器输出的量化与前述相同。。图2.17说明了这个概念。图2.17(a)显示了投影到一个阵列传感器平面上的连续图像。。图2.17(b)显示了取样和量化后的图像。很明显，数字图像的质量在很大程度上取决于取样和量化中所用的样然而，正如 2.4.3 节中表明的那本数和灰度级。样，在选择这些参数时，图像内容是一个重要图2.17（a)已投影到一个传感器阵列上的连续图像；(b)图像取样和量化后的结果的考虑因素。数字图像表示2.4.2令f(s,1)表示一幅具有两个连续变量s和1的连续图像函数。如前一节解释的那样，通过取样和量化，我们可把该函数转换为数字图像。假如我们把该连续图像取样为一个二维阵列f(x.y)，该阵列包含有M行和八列，其中(x,y)是离散坐标。为表达清楚和方便起见，我们对这些离散坐标使用整数值：x=0.1,2,.…,M -1和y=0.1,2, ….,N-1。这样，数字图像在原点的值就是了f(0,0)，第一行中下一个坐标处的值是f(0,1）。。这里，符号(0,1)表示第一一行的第二个样本，它并不意味着是对图幅图像的坐标张成的实平面部分称为空间域，x和y称为空间变量或空间坐标。如图2.18所示，有三种基本方法表示f(, y)。图2.18 (a)是一幅函数图，用两个坐标轴决定空间位置，第三个坐标是以两个空间变量x和，为函数的f(灰度)值。虽然我们可以在这个例子中用该图来准断图像的结构，但是，通常复杂的图像细节太多，以至于很难由这样的图去解译。在处理的元素是以(x,y, 2)三坐标的形式表达的灰度集时，这种表示是很有用的，其中x和y是空间坐标，z是f在坐际（(x,y)处的值。在2.6.4 节中，我们将探讨这种表示。图2.18(b)是更一般的表示。。它显示了f(x,y)出现在监视器或照片上的情况。这里，每个点的灰变与该点处的f值成正比。该图中仅有三个等间隔的灰度值。如果灰度被归一化到区间[0,1]内，那么图像中每个点的灰度都有0,0.5或1这样的值。监视器或打印机简单地把这三个值分别变换为黑色灰色或白色、如图2.18 6b)所示。第三种表示是将f(rx,y)的数值简单地显示为一一个阵列(矩阵)。在这全例元中,的大小为690960个元素，或360,0个数子。很清萄，打印整介矩阵是很麻烦的，且传达的信息也不多。然而，在开发算法时，当图像的一部分被打印并作为数值进行分析时，这种表示相当有用。图2.18(c)以图形方式传达了这一概念。由前面几节的讨论，我们可得出一个结论，即图2.18 (b)和图2.18（c)中的表示是最有用的。图像显示允许我们快速地观察结果。数值阵列用于处理和算法开发。以公式形式，我们可将一个M×N的数值阵列表示为32f 0,0）f(0. 1）f(,0）fd.12.4-1）f(x, y)J(M -1,.0）/(M -1, 1）f(M -1, N-1)1幅数字图像。右边是一一个实数矩阵，，该矩阵中的每个元素称该式的两边以等效的方式定量地表达了一为图像单元、图像元素或像素。图像和像素这两个术语将在全书中表示数字图像及其元素。（a)画为表面图形的图像；（b)显示为可视灰度阵列的图像；（Cc)显示图2.18为一个二维数值阵列的图像(0,0.5和1分别表示黑色、灰色和白色)在某些讨论中，使用传统的矩阵表示法来表示数字图像及其像素更为方便:410.16o.M-10,04.N-12.4-2）uM-1,显然因此式(2.4--1)和式(2.4-2)是相同的矩阵。我们甚至可以将图像表示一个向量v。例如，尺寸为MN ×i的列向量由，的第一M个元素作为A的第一列来构成,M个元素作为第二列，等等。我们也可以使用A的行代替列来形成这样的一个向量。只要一致，哪种表示都是有效的。简要地回顾图2.18,注意到，数学图像的原点位于左上角，其中正x轴向下延伸，正y轴向右延这种方便的表示基于这样的事实：许多图像显示(譬如电视显示器)扫描都是从左上角开始的,一行。更重要的事实是矩阵的第一个元素按惯例应在阵列的左上角，因此，将一次向下移动(x.)的原点选择在左上角于数学上是讲得通的。记住，这种表示是您所熟悉的标准的右手笛卡儿坐标系统。我们仅说明了指向下方和指向右方的坐标轴来代替向右和向上的坐标轴。有时，，以更正式的数学术语表达取样和量化可能会很有用。令Z和尺分别表示整数集和实数集取样处理可看成是把y平面分为一个网格的过程，网格中每个单元的中心的坐标是笛卡儿积Z2中的对尤系，，Z*是所有有序元素对(z,z,）的集合，z,和z,是Z中的整数。因此，如果(x,y)是Z′中的整数，且/是把灰度值(即实数集R中的一个实数)赋给每个特定坐标对(x,y)的一个函数，则了Cx.,)元O回忆可知，右手坐标系统是这样一种系统：当正x轴方向向右时，在大拇指竖直向上时、正，轴的方向为垂直于：轴的中指方向。如图 2.18a)所示，事实上这是我们的图像坐标系统情形。33就是一幅数字图像。。显然，，这种赋值过程就是前面描述的量化处理。。如果灰度级也是整数(此时及后续章节中通常为这种情况)，则用Z代替R，然后，数字图像变成通常:将L个灰攻俱省放套间0,个二维函数，且它的坐标和幅值都是整数。对于计算或算法开数字化过程要求针对 M值、、N值和离散灰度级数乙做出判定。些值都会被缩放到用于图像存对于M和N，除了必须取正整数外没有其他限制。然而，出于存储和储和显示的整数区间0,.L-1量化硬件的考虑，灰度级数典型地取为2的整数次幂，即= 2*(2.4-3）我们假设离散灰度级是等间隔的,且它们是区间[0,L内的整数。有时，由灰度跨越的值域非正式地称为动态范围。这一术语在不同的场合有不同的用法。这里我们将图像系统的动态范围定义为系统中最大可度量灰变与最小可检测灰度之比。作为一条规则，上限取决于、下限取决于噪声(见图2.19)。基本上，动态范跑和度，围由系统能表示的最低和最高灰度级来确定，因此，是图像具有的动态范围。与这一概念紧密联系的是图像于比度，我我们定义一幅图像中最高和最低灰度级间的灰图2.19显示了饱和度和噪声的一幅图像。饱和度变差为对比度。当一幅图像中像素可感知的数值有高的是指超过这个值的灰度级将被剪切掉这动态范围时，那么我们认为该图像具有高的对比度。相样的一个最高值(注意整个饱和区域反，具有低动态范围的图像就很呆滞，看上去像冲淡了具有恒定的高灰度级)。这种情况下的噪灰度。第3章将更加详细地讨论这些概念。声表现为粒状纹理模式。噪声，特别是存储数字图像所需的比特数b为较暗图像区域(譬如攻瑰的茎)中的噪b = M ×N×k(2.44声，掩盖了可检测的最低真实灰度级当M =N时，该式变为b= NPk2.4-5）表2.1中显示了N和k取不同值时需要用来存储方形图像的比特数。括号中的数字表示对应于每个人值的灰度级数。当一幅图像有2*个灰度级时，实际上通常称该图像为一幅“k比特图像”。例如，256个可能的离散灰度值的图像称为8比特图像。注意，大小为1024×1024或更高的8比特图像的存储需求是很重要的。表2.1N和k取不同值时存储所需的比特数。L是灰度级数N/k20L =3 (4L = 8)4亿 = 16)5 4L = 32）7L = 128）8 L = 256)1亿 = 2）3202420485 1203 0724 0965 1447168819264319212 2884 09616 38420 4804 57628 6722 76881 92016 3842 76849 1525 53614 688131 07225655 536196 608327 680458 752131 072393 216524 2885i2262 14424288048 5761 572 864786 4321 310 7201 835 0082 097 152024i 048 5762.097 1523145 7284 194 3045 242 8806 291 4567 340 0328 388 60820484 194 3048 388 60812 582 91216 777 21620 971 52025 165 82429 369 12833 554 43216 777 21633 554 43250.31 64867,108,86483 886 080100 663 296117 440 512134 217 7288192 67 108 864134 217 728201 326 592469 762 048536 870 912268,435,456335 544 320402 653 184空间和灰度分辨率2.4.3直观上看，空间分辨率是图像中可辨别的最小细节的度量。在数量上，空间分辨率可以有很多方法来说明，其中每单位距离线对数和每单位距离点数(像素数)是最通用的度量。假设我们用交替的黑色和白色垂直线来构造一幅图形，其中线宽为W个单位(W可以小于1)。线对的宽度就是2W，单位距离有1/2W 个线对。例如，如果一条线的宽度是0.1 mm，每单位距离(mm)就有5个线对。泛使用的图像分辨率的定义是每单位距离可分辨的最大线对数量(譬如每毫米100个线对)。每单位距离点数是印刷和出版业中常用的图像分辨率的度量。在美国，这一度量通常使用每英寸点数(dpi)束表示，例如，一个质量概念，报纸用75 dpi的分辨率来印刷，杂志是133 dpi，光鲜的小册子。为给您是175 dpi，，您正在看的书页是以 2044 dpi印刷的。一段中的关键点是空间分辨率的度量必须针对空间单位来规定才有意义。图像大小本身并不。如果没有规定图像包含的空间维数，那么我们说一幅图像的分辨率为会告诉我们全部内容。024×1024像素是没有意义的。尺寸本身只是在图像容量间做比较时才有帮助。例如，带有 20兆像素成像芯片的 CCD 数字摄像机与8兆像素的摄像机相比有较高的分辨细节的能力，假定两部摄像机都配备了可比较的镜头，，并在相同的距离拍摄可比较的图像。类似地，灰度分辨率是指在灰度级中可分辨的最小变化。我们有值得考虑的关于产生数字图像，但是对于灰度级来说这并不真实。基于硬件考虑、的样本数的判断，，正如前一节中提到的那样，灰度级数通常是2的整数次幂。最通用的数是8比特，在某些特殊的图像增强应用中，用16比特也是必要的。灰度量化用32比特是很罕见的。有时，我们会发现使用10比特或12比特来数字化图像灰度级的系统，但这些系统都是特例而不是常规系统。不像空间分辨率必须以每单位距离为基础才有意义而灰度分辨率指的则是用于量化灰度的比特数。例如，通常说一幅被量化为256级的图像有8比特的灰度分辨率。。因为灰度中可分辨的真实变化不仅受噪声和饱和度值的影响，也受人类感知能力的影响见 2.1 节)，所以说一幅图像有8比特的灰度分辨率并不比以灰度幅值为1/256的固定增量量化为8比特的系统能力的规定有更多的内容。下面的两个例子分别说明了图像尺寸和灰度分辨率对可分辨细节比较的效果。在本节稍后，我们将讨论决定感知图像质量中的两个参数是如何相互影响的。列2.2降低图像空间分辨率的效果说明。图2.20显示了降低一一幅图像的空间分辨率的效果。图2.20(a)到(d)显示了分辨率分别为1250 dpi.。很自然，低分辨率的图像与原图像相比要小。例如，原图像的大小为300 dpi, 150 dpi和72 dpi的图像3692×2812像素，但72 dpi图像是一个大小为213×162的阵列。为便于比较，所有的小图像都放大到了原图像的大小(采用 2.4.4 节中讨论的放大方法)。这对较小图像的归靠来说稍微有些对等之意，因此，我门可就可见细节做可比性的说明。图2.20(a)和图220(6)之间有一些较小的视觉差别，最明显的差别是大的黑针稍微有点失真。然而，图2.20(6)的大部分还是可以接受的。事实上，300 dpi 是书籍印刷所用的最小空间分辨率。因此，这里我门不能期望看到很大的不同。图2.20(c)显示了可见的退化(例如，计时器的圆形边缘和右侧指向60处的小针)。图20(0显示了图像中多数可见特征的退化。如4.4节中讨论的那样，当以这样低的分辨率印印刷和出版业会使用一些“技巧”刷时，（例如，像素尺寸的局部变化)来产生比图2.20(d)更好的结果。此外，如244 节所示，选择所用的内插方法也可以改进图220的结果。列2.3改变数字图像中灰度级数的典型效果。在这个例子中，我们保持样本数恒定，而将灰度级数以2的整数次幂从 256 减少到2。图2.21(a)是数字图像基础幅大小为452×374的CT投影图像，它以k.=8(256个灰度级)显示。这样的图像是通过将X射线源固定在一个位置，然后在任何期望的方向生成二维图像来得到的。投影图像用于指导设置CT扫描仪的参数包括倾斜角、切片数和范围。图2.21 6b)到图2.21 (h)是在保持图像大小为452×374像素不变的情况下，比特数从k=7减小到k=时得到的图像。256级、128级和64级灰度图像对于所有实用目的在视觉上的效果是相同的。然而,图2.21 (d所示的32灰度级图像中，在恒定或接近恒度灰度区域(尤其在头盖骨处)内有一组不易察觉的细小山脊状结构。这种效果是由数字图像的平滑区域中的灰度级数不足引起的，通常称为伪轮廓，之所以这样称呼是因为这些山脊状结构类似于地图中的地形轮廓。。伪轮廓通常在以16或更少级数的均匀设置的灰度级显示的图像中十分明显，，如图2.21(e)到图2.21 Gh)所示的图像为方便起见，作为一个粗略的经验规则，假设数值为2的脂数次幂、一般来说、尺寸为256×256像素、64灰度级、印刷在大小为Scm × S cm的版式上的图像是具有最低空间和灰度分辨率的图像，一般认为没有令人讨厌的取样棋盘格和伪轮廓。终2.20降低空间分辨率的典型效果。图像分别以(a) 1250 dpi，(b) 300 dpi，(C)150dpid0 72 dpi来显示。为清楚起见，图像添加了黑色的细边框，它们不是数据的一部分图2.21Ga)大小为452×374的256灰度级图像；b)～(a)保持图像大小不变的同时以灰度级128,.64和32显示的图像e)-Cb)以16.8.4和2灰度级显示的图像(原图像由Vanderbilt大学医学中心辐射学与放射学系的 David R. Pickens博士提供）8例2.2和例23中的结果说明了分别改变》和k时对图像质量产生的影响。然而，这些结果也仅仅部分地回答了改变N和人如何影响图像的问题，因为我们还未考虑这两个参数之间可能存在的任何关系。Huangi196.51早期的研究试图通过实验来量化同时改变N和人时对图像质量所产生的影响一组主观测试组成，采用了类似于图 22中所示的图像。妇女脸庞图像是包含较少细节的一实验由一幅有代表性的图像，摄像师图像包含了中等程度的细节，人群图像相比之下包含有大量的细节。图22Ga)具有少量细节的图像:b)具有中等程度细节的图像(图像由麻省理工学院提供)；（c)具有大量细节的图像通过改变》和k，生成了一一组这三种类型的图像，然后要求观察者主观地按图像的质量对图像排序。最终结果以从平面中的等偏爱曲线形式汇总(图2.23中显示了对应于图2.22中图像的平均等偏爱曲线)。Mk 平妇女脸庞图像一幅图像、语该图像的八值和人值等于该的每一点表示一位于等偏爱曲线上的点对应于有相等的主点的坐标。经影师图像观判定质量的图像。实验发现等偏爱曲线倾向于向右但这三类图像的等偏爱曲线形状与图2.23中上方移动，所示的那些曲线类似。。这并不意外，因为曲线向右上方群图像移动仅意味着更大的》值和k值，而这又意味着更好的图像质量。当前讨论内容的关键是当图像中的细节增加时，偏爱曲线会变得更加垂直。这一结果表明，对于有大量图2.23图2.22中三类图像的典型等偏爱曲线细节的图像，，可能只需要较少的灰度级。例如，。图2.23中对应于人群图像的等偏爱曲线接近垂直。这指出当》值固定时，这类图像的感觉质量与所用的灰度级数(对于图2.23所示的灰度级范围)是近似独立的。更有趣的是，还要注意，另两类图像在样本数增加的某些间隔内感觉质量保持相同，但灰度级数实际上降低了。对于这一结果，最可能的原因是k的减小倾向于对比度的明显增加，人们通常感受到图像质量改善了的视觉效果。2.4.4图像内插内插是在诸如放大、收缩、旋转和几何校正等任务中广泛应用的基本工具。这一节我们的主要目标是介绍内插并用它调整图像的大小(收缩和放大)，这是基本的图像重取样方法。在诸如旋转和几何校正的应用中，内插的用法将在2.65 节讨论。在第4章，我们还将回到这一主题，以详细地讨论图像重取样。从根本上看，内插是用已知数据来估计未知位置的数值的处理。我们用一一个简单的例子开始讨论该话题。假设一一幅大小为500×500像素的图像要放大1.5倍到750×750像素。一种简单的放大方法是创建一个假想的750×750网格，它与原始图像有相同的间隔，然后将其收缩，使它准确地与原图数字图像基础像匹配。显然，收缩后的750×750网格的像素间隔要小于原图像的像素间隔。为了对覆盖的每点赋以灰度值，我们在原图像中寻我最接近的像素，并并把该像素的灰度赋给750× 750网格中的新像当我们完成对网格中覆盖的所有点的灰度赋值后，就把图像扩展到原来规定的大小，得到放大后的图像。刚刚讨论的方法称为最近邻内插法，因为这种方法把原图像中最近邻的灰度赋给了每个新位置12.5 节将正式讨论邻近像素)。这种方法简单，但是，本节稍后将显示该方法有产生不希望的人为缺陷的倾向，如某些直边缘的严重失真。。由于这一原因，实际上该方法并不常用。更实用的方法是双线性内插，在该方法中，我们用4个最近邻去估计给定位置的灰度。令(x,y)为我们想要赋以灰度值的位置(把它想象为前面描述的网格点)的坐标，并令vXx,y)表示灰度值。对于双线性内插来说，赋值是由下面的公式得到的：与该方法名称相反的是、双线性内插不是一种线性内插方法，因为(2.4-6）v(x, y)=ax+by +cxy +d其中包含有y项。其中，4个系数可由4个用(α,y)点最近邻点写出的未知方程确定。正如愈马上将看到的那样，双线性内插给出了比最近邻内插好得多的结果，但随之而来的是计算量的增加。一种复杂度较高的方法是双三次内插，它包括16个最近邻点。赋予点(x,.)的灰度值是使用下式得到的：2.4-7）V(x,y)0 j=0其中，16个系数可由16个用C,y)点最近邻点写出的未知方程确定。观察式(2.4-7)，如果求和的上下限分别为0和1，则则其简化为式(2.4-6)的形式。通常，双三次内插在保持细节方面比双线性内插相对要好。双三次内插是商业图像编辑程序的标准内插方法，例如 Adobe Photoshop和CorelPhotopainto例2.4用于图像收缩和放大的内插方法的比较。图2.24(a)是与2.20(d)相同的图像，它是由图2.20(a)中分辨率为1250 dpi的图像先将分辨率降低到72 dpi(大小由原来的3692×2812收缩到213×162像素)，然后将该缩小的图像再放大到原来的尺寸得到的。图2.20(4)是采用最近邻内插法进行收缩与放大产生的。正如前面讨论的那样，图2.24()的结果比较差。图2.246b)和图2.24 (c)是采用相同的过程，但分别采用双线性内插和双三次内插收缩和放大得到的。使用双线性内插得到的结果较最近邻内插有重大改进。双三次内插的结果较双线性内插的结果稍，它们都是由最近邻内插方法通过收缩与放大得到的。我们败清晰前面讨论的结论是分辨率降低到150 dpi时，图像开始显现退化。图2.24()与图2.24(0)分别显示了使用尽管分辨率从1250 dpi降低到了150 dpi，但与原图双线性内插和双三次内插收缩和放大图像的结果。io像相比，这两种内插方法再次显示了其强大的性能。与以前一样，双三次内插得到了稍微清晰一些的结果。在内插中，有可能采用更多的邻点和更复杂的技术，如采用样条和小波，在某种情况下、可以得到比刚刚讨论的方法更好的结果。对于三维图形（Wtt1993]、 Shirley[2002])和医学图像处理. u.:99保留精细细节是一个特别重要的考虑，对于一般目的的数字图像处理，较Lehmann少考虑额外的计算负担是合理的，所以双线性内插和双三次内插是人们选择的典型方法。38图2.24（a)降低到72 dpi，并使用双线性内插方法将其放大到原大小(3692×2812像素)的图像。图像与图2.20(d)相同；Gb)使用双线性内插收缩和放大的图像；（c)与图像(b)相同但使用双三次内插的图像、（D-(0相同的图像序列，但它们是收缩到150dp而不是收缩到724Pp将图2.24(e)和()与原图2.20a)比较，特别是后者的图像[图2.24(0)与图2.20(c)相同」2.5像素间的一些基本关系在这一节，我们考虑数字图像中像素间的几个重要关系。。正如前面提及的那样，图像由（(x,y）表示。当在本节中引用某个特殊的像素时，我们通常会使用小写字母，如p和。相邻像素2.5.1位于坐标(x,y)处的像素p有4个水平和垂直的相邻像素，其坐标由下式给出：(x+1, J),(x-1, y),(x,y+1),(x, y-1D这组像素称为，的4邻城，用ML.”）表示。每个像素距Lx:.2一个单位距离，如果Gx,)位于图像的边界上，则p的某些相邻像素位于数字图像的外部。我们将在第3章处理这个问题。p的4个对角相邻像素的坐标如下：(x+1 y+1),(x+1. y-1),(x-1, y+1),(x-1, y-)并用Np(p)表示。。这些点与4个邻点一起称为，的8邻域，用XA2)表示。与前面一样，如果(x.)）位于图像的边界上，则Np(p)和Ns(p)中的某些邻点会落入图像的外边。邻接性、连通性、2.5.2区域和边界令V是用于定义邻接性的灰度值集合。。在二值图像中，如果把具有1值的像素归诸于邻接像素{11。在灰度图像中，概念是一样的，但是集合V一般包含有更多的元素。例如，具有可能的灰度值范围为0到255 的邻接像素中，集合V可能是这256个值的任何一一个子集。考虑三种类型的邻接：数字图像基础39如果g在集合NA(p)中，则具有，中数值的两个像a) 4邻接。素p和4是4邻接的。集仓的交与并。。假设有集命.A和固则具有V中数值的两个像(b） 8邻接。如果q在集合Ns(p)中、回忆可知它们的交集是既在集仓公中又在集合员中的成员的元素集索p和g是8邻接的。这两个集合的并集是集合A的成员邻接(混合邻接)。如果(6)g在NA(p)中，、或(iq在Np(P）集合阳的成员或两者的成员的元素中，且集合NApnNAq)中没有来自，中数值的像素，则集。详细讨论见264 节。具有V中数值的两个像素p和q是m邻接的。。混合邻接的引入是为了消除采用8邻接时产生的二义性。例如，考混合邻接是8邻接的改进。虑图2.254a)中对于V= {}的像素排列。位于图2.25 6)上部的3个像素显示了多重(二义性)8邻接，如虚线所示。这种二二义性可以通过m邻接消除，如图2.25 (c)所示。从具有坐标(x,y)的像素，到具有坐标(s.）的像素，的通路(或曲线)是特定的像素序列，其坐标为(%，Jb).(×，Y), ，（X,，J)m）且像素其中(x, Y6)=(rx,J),(×,，J,)=(s,1D)，Cx. ）和.:.22》对于1S，是邻接:8的。在这种情况下，n是通路的长度。如果图 2.25(a)像素的排列；(b) 8邻接像素(邻接性由虚线所C×:2. .%.2)、则通路是闭合通路。示。注意二义性:)m邻接；の0采用8邻接时，以依据特定的邻接类型定义4邻接、8邻接两个值为1的区域是邻接的；（e)如果在区域和或 m邻接。例如，如图2.25 (b)所示，右上背景闸采用8邻接、则加圆圈的点是仅赋1值的点和右下点之间的通路是8通路,而图2.25 (c）像素的边界点的一部分；（D1值区域的内部边界不中的通路是m通路。形成闭合通路，但其外部边界可以形成闭合通路令S是图像中的一个像素子集。如果S的全部像素之间存在一个通路，则可以说两个像素p和g在S中是连通的。对于S中的任何像素p，如果S仅有一个连通分量，则集合S称为连通集。S中连通到该像素的像素集称为S的连通分量。一个像素子集。如果R是连通集，则称R为一一个区域。两个区域，如果它们联令R是图像中的一合形成一个连通集，则区域R,和R,称为邻接区域。不邻接的区域称为不连接区域。在谈到区域时，。为使我们的定义有意义，必须指定邻接的类型。例如，如果仅使用8我们考虑的是4邻接和8邻接。，则图2.25 (d)中的两个区域(由1组成的)是邻接的(根据前一段的定义，两个区域之间不存在邻接时，通路，它们的并集不是连通集)。假设一幅图像包含有K个不连接的区域，即R,k =1,2, …,，K，且它们都不接触图像的边界少令R,代表所有K个区域的并集，并且令(R,”代表其补集(回忆可知，集合s的补集是不在s中的点的集合)。我们称R,中的所有点为图像的前景，而称(R,”中的所有点为图像的青景。区域R的边界(也称为边缘或轮廓)是这样的点的集合，、这些点与R的补集中的点邻近。换一和种方式说,个区域的边界是该区域中至少有一个背景邻点的像素集合。这里再强调一一下，我们必须指定用于定义邻接的连通性。例如,图2.256(e)中被圈出的点如果在区域及其背景间使用4连通，就不是1值区域边界的成员。基于这一规则，为处理这种情况，一个区域及其背景中的点之间的邻接要根据8连通来定义。如D进行这种假设的目的在于避免处理特殊情形。这样做不会丧失一般性，因为如果一个或多个区域接触到图像的边界，我们可简单地使用1像素宽的背景值边界来填充图像。数字图像处理(第三版）前述定义有时称为区域的内边界，以便与其外边界相区分，外边界对应于背景边界。在开发追踪边界的算法时这一区别很重要。这种算法为了保证结果形成一一个闭合通路，通常是沿外边界确立的。在图2.25(fD中，1值区域的内边界是该区域本身。这一边界并不满足先前给出的闭合通路的定列如，-方面，区域的外边界确实形成了一一个围绕该区域的闭合通路。如果尺恰巧是整幅图像(我们假设这幅图像是像素的方形集合)，则边界由图像第一一行、最后一列的像素集合来定义。这个附加定义是需要的，因为一幅图像超过边界范围之外和最后没有邻点。正常情况下，当我们提到一幅图像的子集，并且区域边界中任何与图一个区域时，指的是像边缘吻合的像素都作为区域边界的一部分全部包含于其中。边缘的概念在涉及区域和边界的讨论中常常遇到。然而，这些概念之间有一个关键区别・有限区域的边界形成一条闭合通路，并且是“整体”概念。正如第 10章详细讨论的那样，边缘由具有某些超过预先设定的阈值的导数值的像素形成。这样，边缘的概念就是基于在进行灰度级度量时不连续点的“局部”概念。把边缘点连接成边缘线段是可能的，并且有时以与边界对应的方法连接线段,但并不总是这样。边缘和边界吻合的一个例外是二值图像的情况。根据连通类型和所用的边缘算子(在第10章中讨论)，从二值区域提取边缘与区域边界是一样的，这很直观。在概念上，我们在第10章才会接触到，把边缘考虑为灰度不连续和边界是闭合通路是有帮助的。2.5.3距离度量对于坐标分别为(x,J). 6.，）和(0,w)的像素p9和z，如果a） DLp, 4)>0〔D(p,49)=0，当且仅当p=41(b）D(p,4) = D0(q,p)且(e） D(p.2)< D(p,9)+ D(4,.2)。则D是距离函数或度量。p和q间的欧几里得(欧氏)距离定义如下：D.0.0=[α-5 +(y-0°下2.5-1）对于距离度量，距点(x,y)的距离小于或等于某个值r的像素是中心在(x,y)且半径为r的圆p和q间的距离D。(又称为城市街区距离)由下式定义：12.5-2）DA(p, q)=|x-s|+|y-1在这种情况下，距(x,y)的距离D,小于或等于某个值，的像素形成一一个中心在(x,y)的菱形。例如，距中心点(x,y)的距离D.小于或等于2的像素，形成固定距离的下列轮廓：其中D。=1的像素是（(,y)的4邻域p和g间的D。距离(又称为棋盘距离)由下式定义:2.5-3）在这种情况下，距(x.y)的如,距离小于或等于某个值，的像素形成中心在(x,)的方形。例如，距中心点(x,y)的D,距离小于或等于2的像素形成下列固定距离的轮廓：其中D。=1的像素是(x,J)的8邻域。注意，p和q之间的D。距离和D。距离与任何通路无关，通路可能存在于各点之间，因为这些距。然而，如果选择考虑m邻接，离仅与该点的坐标有关。，则两点间的D距离用点间的最短通路定义。在这种情况下，两个像素间的距离将依赖于沿通路的像素值及其邻点值。例如，考虑如下排列的像素并假设p，P,和p的值为1，口和p,的值为0或1:P4P3PzPi假设我们考虑值为1的像素邻接[即V={1}1。如果p和p,是0,则p和p.间的最短m通路的长度（D距离)是2。如果六是1，则p2和p将不再是m邻接的(见m邻接的定义)，并且最短m通路的长度变为3通路通过点，他”2，)。类似地课论、如果公是1(县公是0).，在这种情况下，此时最短的m通路距离也是3。最后，如果六和p都为1，，则p和p,间的最短m通路的长度为4，在这种情况下，通路通过点pPP八。八。2.6数字图像处理中所用数学工具的介绍这一节有两个主要目的：（1)向您介绍我们在本书中所用的各种数学工具；（2)通过把它们用于各种基本图像处理任务来帮助您开始建立如何使用这些工具的“感觉"。它们之中的一些在后续讨论中将被使用多次。。在后面的章节中，我们将根据需要来扩展这些工具的范围及应用。在继续阅读前、建议读者从阵列与矩阵操作2.6.1杰书网站上的 Tuoril部的分下载并学以复习材料。复习材料鸟挺关无包含一幅或多幅图像的阵列操作是以逐像素为基础执行的。本章矩阵和向量、线性系统、集合论和的面我们曾提到，图像可以等价地被看成是矩阵。事实上，在很多情概率的简介性知识兄下，图像间的操作是用矩阵理论执行的(见2.6.6 节)。基于这个原因，阵列与矩阵操作间的区别必须搞清楚。例如，考虑下面的2×2图像：h412b141buD2 」这两幅图像的阵列相乘是h1小“1如122」L az1521az2522工另一方面，矩阵相乘由下式给出:41向1山+4p2D241212 +4122021+a22b-21b2z2_42101z +azz2293我们假设阵列操作贯穿全书，除非另做说明。。例如，当我们谈到，意味着每个像素均一幅图像的求幂时，进行求幂操作；一幅图像除以另一幅图像时，，意味着在相应的像素对之间进行相除，等等。当我们谈到42线性操作与非线性操作2.6.2图像处理方法的最重要分类之一是它是线性的还是非线性的。考虑一般的算子H，该算子对于，产生一幅输出图像g(x,y)：给定的输入图像f(x.,y)，2.6-1）H[f(x, y)]= g(x, y）如果(2.6-2HLa,fC. )+4 ,(x.y)]=a,HI[f(x. )]+a,H[ ,Jx.y)=4,(×, )+04,8/(x.)）个线性算子，其中α,a,，f,(x,y)和了,(x,)分别是任意常数和图像(大小相同)。三则称H是式(2.6-2）指出输出是线性操作，因为两个输入的和与分别对输入进行操作然后再求和得到的结果相同。。另外,输入乘以常数的线性操作的输出与乘以该常数的原始输入的操作的输出是相同的。第一个特性称为加性，第二个特性称为同质性作为一个简单的例子，假设从是求和算子工，即该算子的功能是对输入简单地求和。为检验其我们从式(2.6-2)的左侧开始，并且试图证明它与右侧相等：线性，我Z。,/(*:.+ 芝。,/x艺[α,6(.)+,/(x.)]=2这些是阵列求和，而不是图像的4艺/(.+4,2/(x.）单幅图像所有元素的求和。因此・的求和是该图像本身。= 4:8(×J)+a,8,(x,y）其中第一-步遵循求和是分布式的这样一个事实。因此，左边的展开等于式(2.6-2)的右边，从而我们得出该求和算子是线性的这一一结论另一方面，考虑最大值操作，其功能是在图像中寻找像素的最大值。针对这一一目的，证明该操作是非线性的最简方法是寻找一一个测试式(2.6-2)时失败的例子。考虑下列两幅图像:|和:.-12并假设令α,=1和4,=-1。为了对线性进行测试，我们再次从式(2.6-2的左侧开始：3沙 ma {-2二=-max{0)||+(-D下一步，做右边，我们得到0}+(-i)max=3+(-17=-4(l)max在这种情况下，式(2.6-2)的左边和右边并不相等，因此我们证明了通常求最大值的操作是非线性的。正如懋在后面三章中将要着到的那样，特别是在第4章和第5章中，，线性操作特别重要，因为它们是以大量的可用于图像处理的理论和实践结果为基础的。非线性系统很难被很好地理解，因此其应用范围受到了更多的限制。然而，在后面的几章中，我们会碰到一一些性能远优于线性操作的非线性图像处理操作。2.6.3算术操作图像间的算术操作是阵列操作，如2.6.1 节中讨论的那样，其意思是算术操作在相应的像素对之间执行。4种算术操作表示为96s(x,J)= f(x, y)+ 8(x,y）d(x, y) = f(x, y)-g(x,y）12.6-3）p(x,y)= f(x, y)× g(x,J）v(x, y)= /(α,J)+g(x, y）它可理解为是在了和g中相应的像素对之间执行操作，其中x=0,1.2,.…,M9 =0,1,2.….-1。通常，M和X是图像的行和列。很清楚，、s，d,p和v是大小为MxN的图像。注意、按照刚才定义的方式，图像算术操作涉及相同大小的图像。下面的几个例子指出在数字图像处理中，算术操作起着重要的作用。针对降噪的带噪图像相加(平均)。例2.5令g(x,J)是无噪声图像了(x,y)被加性噪声n(x,y)污染后的图像，2.6-4)g(x, y)= f(x, y)+7(x, y)一对坐标(x,y)处，噪声是不相关的"，并且其均值为零。以下步骤的目的是通过一组带噪这里假设在每图像{A6.2的相加减少噪声。如果噪声满足刚才声明的约束，那么可以证明(见习题220)，如果图像(x,y)是通过对K幅不同的噪声图像进行平均形成的：京(x, )=8(Cx,Jy）2.6-5）然后，遵循E{营(x,J)}= (x, y）(2.6-6）和(2.6-7)oic.，式中E{g6x. )}是家的期望值，OGie.，和oix.分别是营和，在所有坐标(、y处的方差。在平均图像中的任意一点处的标准差(方差的均方根)是2.6-8Pg(x,y）随着K的增大，式(2.6-7)和式(2.6-8)指出，，在每个位置G,y)处的像素值的变化(就像方差或标准差度量的那样)将减小。因为E{g(x, y)}= /(x,y)，这意味着在求平均过程中所使用的带噪图像的数量增加时，g（G,)将逼近（Cx,。实际上，为了避免输出图像带来模糊和其他人为缺陷，图像g(x, )必须已配准(对齐)。图像平均的一种重要应用是在天文学领域，在该领域，由于在非常低该例中显示的图像米自称为NGC3314的 Pai 星系、由NASA的哈勃的照度下成像常常会导致传感器噪声，以至于单幅图像无法分析。图2.26(a）空间望远镜拍摄。NC 3314,商地球显示了一幅8比特图像、其中加入了均值为0、标准差为64个灰度级的高约14亿光年，位于南半球长蛇座方斯噪声模拟退化。这些典型的低照度条件下获取的图像，对所有实用目的向。最亮的几颗星在由星尘组成的前星系的中心处形成了风车形状。来说都是不可用的。图2.26 6b)～D显示了分别对5，10。 20,.50.和100幅图D回忆可知，均值为m的随机变量文的方差定义为Ekz-mj、其中瓦}是该参量的期望值。两个随机变量,和z，的协方差定义为瓦(,-m,x,-m,)1。如果变量是不相关的。则它们的协方差为零。由K=50得到的结果已经相当清晰。图2.260)的图像是由100幅带像平均的结果。我们看到，图12.26(e)，噪图像平均得到的结果，与图2.26 (e）比较仅稍微有些改进。相加是连续积分的离散形式。在天文观测中，一种与刚刚描述的方法等同的处理是使用 CCD（见2.3.3节）或类似传感器的累积能力，通过长时间地观察同一场景来达到降噪的目的。冷却也常常用于降低传感器噪声。然而，最终结果类似于对一组噪声数字图像进行平均操作。图2.26(a)被加性高斯噪声污染的 Galaxy Pair NGC3314图像；(b)～(f)分别对5, 10,.20,50,100幅噪声图像平均的结果(原图像由NASA提供)列2.6增强差别的图像相减。图像相减经常用于增强图像之间的差。例如，图2.27(6)中的图像是通过把图2.27 (a)中的每一个像素的最低有效比特置。得到的。在视觉上，这些图像都不可辨别。然而，如图2.27(G)所示，从一幅图像减去另一幅图像，则清楚地显示了它们的差别。在差值图像中，黑(の)值指出了在该位置图2.27(a)和图2.27 (b）之间没有差别。作为另一个例子，我们简单地讨论称之为模板模式放射成像的医学成像领域，这是图像相减在商业上成功的和高受益的应用。考虑如下形式的图像差:(2.6-9)g(x,y)= f(x, y)-h(x,y）在这种情况下，模板人Gx.y)是病人身体一个区域的X射线图像，该图象由放在X射线源对面的、强化了的电视摄像机(代替传统的X射线像分割，图像分割是第10章的主题。胶片)获取。过程由以下几步组成：将一种X射线造影剂注人病人的血流中，摄取一系列与Mx,y)解剖区域相同的所谓的活体图像R「它们的样品表示为C:,2)，从一一系列注射过造影剂的活体图像中减去模板A,J)。从每一幅活体图像中减去模板的最终结果是这样的区即出现在输出图像积(x.y)中用以区分（Gx.y)和Akx, )之间的差别的区域，目的是增强细节。因为图像可以按电视速率获取，这一过程基本上给出了一段显示造影剂怎样在被观察区域通过动脉传番的影片。图2862a)显示了在碘介质注射到血流中前，病人头部上方的一幅模板的X射线图像，图28 6)是在主射碘介质后得到的一幅活体图像。图2.28(C0)是图28a)与图2.86)的差。在这幅图像中，一些细的血管结构清晰可见。图2.28 (d)的差别很清楚，它是由(C)增强了对比度后得到的(下一一章中将讨论对比度增强）。图2.28 0)是介质在大脑内怎样通过血管传播的一幅清晰的“图”第2章众)华盛顿特区的红外图像;)将图像(D)中的每冬|2.27个最低阶比特置0得到的图像；（G)两幅图像的差，为清楚起见，图像已标定到区间[0,2551 b c d数字减影血管造影：（a)模板图像；b)活体图像；（e)图(a)和图(b)的差值图像；图2.28(a)增强后的差值图像〔图(a)和图(6)由荷兰Utecht大学图像科学研究所医学中心提供」列2.7使用图像相乘和相除来校正阴影图像相乘(或相除)的一一种重要应用是阴影校正。假设一个成像传感器产生可由f(C,y)表示的完美图像与阴影函数hrx, y)的乘积来建模的图像，，即g(x,J)= f(x, y)h(x, y)。如果h(x,J)已知，那么我们可以使用众αx,)的反函数〔即g(, )hkx,y)」乘以感知图像的方法得到了(x,y)）。如果Akx,y)）未知，但图象系统可以访问，我们可以通过对具有恒定灰度的目标成像得到一个近似的阴影函数。当传感器不可用时，我们常常如在9.6节讨论的那样直接从图像估计阴影模式。图2.29显示了阴影校正的一个例子。图像相乘的另一种普通应用是模板操作，也称为感兴趣区域（ROI）操作。图2.30中说明的处理仅将莫板图像与一幅给定的图像相乘，模板图像的 ROI 区域为1，其他区域为0。模板图像中的ROI可能不正一个，虽然由于实现容易而常常使用矩形形状，但ROI的形状可以是任意的。图2.29阴影校正:）鲁丝及其支撑物的明影EM图像，该图像放大了近130倍:D阴影模式:(c)图(6的倒数与图(a)相乘的结果(原图像由俄勒冈Eugene大学地质科学系的Michae SaSffer提供）在结束这一节的讨论之前，对图像算术操作的实现做些评述是有益的。。实际上，大多数图像使用8比特显示(即使24比特的彩色图像也是由分立的三个8比特通道组成的)。这样，我们认为图像的灰度值范围为0-255。当图像以标准格式存储时，如TIFF或JPEG，图像的灰度值将自动转换到该范围。然而，转换所用的方法取决于所用的系统。例如，两幅8比特图像以不同的取值范围可以是最小的-255到最大的+355、图像之和的值可能在。到510的范围。许多较件包在把图像转换为8比特46图像时，仅简单地把所有的负值转换为0、而把超过255 的值转换为255、给定一一幅图像f，保证图像我们执行操作间算术操作的整个值域落入某个固定比特数的方法如下。首先，=f -minG f）(2.6-10(a)牙齿的X射线数字图像；(b)使用填充物隔离牙齿的ROI模图2.30板(白色对应于1，黑色对应于0)；(C)图(a)和图(6)相乘的结果该操作生成其最小值为0的一幅图像。然后，执行操作(2.6-11）/.=KLfm /max(fm)]亥操作生成一一幅标定的图像f。，其值在[0,K]范围内。在处理8比特图像时，置K=255，我们得到一幅灰度范围从0到255的全部8比特的满标度图像。。类似的方法可用于16比特或更高比特的图像，我们还有额外的要求，即需要将一个较小的数这种方法可用于所有的算术操作。在执行除法操作时，加到除数图像的像素上，，以避免用0去除。集合和逻辑操作2.6.4在这一节，我们简单介绍一些重要的集合和逻辑操作。我们还将介绍模糊集合的概念基本集合操作令A为一一个实数序对组成的集合。如果 =4,.4a）是A的一个元素，则将其写成2.6-12）ie A司样，如果a不是A的一个元素，则写成2.6-13）不包含任何元素的集合称为空集，用符号0表示。集合由两个大括号中的内容表示，即{・}。例如，当我们将一个表达式写成C={wlw=-d,d∈ D}，所表达的意思是：集合C是元素w的集合，而w是通过用-1与集合D中的所有元素相的形式时，乘得到的。该集合用于图像处理的一种方法是令集合的元素为图像中表示区域(物体)的像素的坐标(整数序对)如果集合A中的每个元素又是另一个集合B中的一个元素，则称A为B的子集，表示为(2.6-14)Ac B两个集合A和B的并集表示为(2.6-15）C= AUB这个集合包含集合A和B中的所有元素。类似地，两个集合A和B的交集表示为(2.6-16）D = A|1B这个集合包含的元素同时属于集合A和B。。如果A和B两个集合没有共同的元素，则称这两个集合是不相容的或互斥的。此时，数字图像基础An8=0(2.6-17）一定义，给定应用的所有集合元素是对于该应全集V是给定应用中的所有元素的集合。根据这一用所定义的全部成员。例如，如果处理实数集合，，则集合的全集是实数域，它包含所有的实数。在图像处理中，我们一般将全集定义为包含图像中所有像素的正方形。表示为集合A的补集是不包含于集合A的元素所组成的集合，<2.6-18A* ={wlwe A}集合A和B的差表示为A-B，定义为A-B={wlwe A,we B}= AnB"(2.6-19我们可以看出，这个集合中的元素属于A，而不属于B。例如，我们可以根据U并做集合的差操作来定义A°，即A° =0-A。图2.31说明了前述概念，全集是包含在所示正方形中的坐标的集合，并且集合A和B是包含在所示边界内的坐标的集合。在每一幅图中，集合操作的结果用灰色显示舰。在前面的讨论中，集合成员是以位置(坐标)为基础的。当处理图像时，一个隐含的假设是集合内所有像素的灰度是相同的，因为我们还没有定义关于灰度值的集合操作(即我们还未指定两个集合的交集中的灰度是什么)。图2.31所示操作的唯一方，如果包含这两个集合的图像是方法可以这样确定，值的，在这种情况下，我们可以说集合成员是基于坐标的，并假设这两个集合的所有成员具有相同的灰度。我们将在下一节做更详细的讨论。图2.31(a）二维空间中的两个坐标集合A和B；(b)A和B的并集；（c)A和B的交集；dDA的补集；（e)A和B的差。在6)到(e)中，阴影区域表示指定集合操作的成员在处理灰度图像时，，前述的概念就不适用了，因为我们必须指定来自集合操作结果的所有像素的灰度。事实上，正如您将舍38节和18.6.中看到的那样，灰度值的并集操作和交集操作通常分别定义为相应像素对的最大和最小，而补集操作定义为常数与图像中每个像素的灰度间的两两之差。我们处理相应像素对的事实告诉我们，灰度级集合操作是如2.6.1节定义的阵列操作。下面的例子是涉及灰度级图像的集合操作的简单说明。。我们将进一步讨论上面两节提到的概念。例2.8图像灰度的集合操作。令灰度级图像的元素用集合A来表示，如2.4.2节提到的那样，这些元素是三元组形式(x,y,z)，其中x和，是空间坐标，z是灰度。我们可以将A的补集定义为A* ={(x, y.K-2)1(α, y,2)e A}，它简单地表明像素集合A中的灰度已从常数K中减去。该常数等于2*-1，其中k是用于表示z的灰度的比特数。令A表示图2.32 a）中的8比特灰度图像，，并且假设我们想要用集合操作形成一个负A。简单地形成集合A,=4°{(x. ,255-2)(X.9.)= A}。注意，坐标依日，因此A,是与A大小相同的图像。图232の)示出了这一结果。O式(2.6-12至式(2.61中的操作是代数集的基础、它从AU B=.RUA和A.B=BnA这样的交换律开始，形成了集合操作105的广泛理论基础。尽管代数集的处理超出了当前讨论的范围，但读者应了解这一点。两个灰度集合A和B的并集可定义为集合AU8={max(a,blae A,be B也就是说，两个灰度集合(图像)的并集是一个由空间相应元素对间的最大灰度形成的阵列。再一次注意。正如说明的那样，假设A仍表示到坐标同样不变，因此A和B的并集是大小与这两幅图像相同的图像。图2.320)中的图像，并且令B表示与A大小相同的方形阵列、但其中所有的z值等于A中元素的平均灰变m的3倍。图2.32(C)显示了执行这种并集操作的结果，其中所有超过3m的值呈现为A的值，而所有其他像素的值为3m，，即中间灰度值。图2.32灰度级图像的集合操作：（a)原图像；；Gb)使用补集操作得到的负像；(o)图(a与常数图像的并集(原图像由C.E Medicl sysems公司提供逻辑操作在处理二值图像时，我们可以把图像想象为像素集合的前景(1值)与背景(O值)。然后，如果我们将区域(目标)定义为由前景像素组成，图2.31中说明的集合操作就变成了二值图像中目示坐标间的操作。。处理二值图像时，OR、AND和 NOr逻辑操作就是指普通的并、交和求补操其中“逻辑一词来自逻辑理论，在逻辑理卡，论中，1代表真，0代表假考虑由前景像素组成的区域(集合)A和，就这两个集合的 OR(或)操作结果不是属于A，是属于B，或者属于两者。AND操作是共同属于4和B的元素的集合。集合A的NOT操作是不中的元素的集合。因为我们要处理图像，果A是给定的前景像素的集合，那么 NOTA)是图像中不在A中的所有像素的集合，这些像素是涉及前景(白色像素的逻辑操作的说明。背绿像素，并有可能是其他前景像素。我们可以图2.33色代表二进制数0，白色代表二进制数1。将该操作想象为：把A中的所有像素转换为0(黑线不是结果的一部分，仅作为参考显示色)，并把所有不在A中的元素转换为1(白色)。数字图像基础49图2.33说明了这些操作。注意，显示该操作结果的第4行是前景像素集合，它属于A但不属于B,这就是式(2.6-19)中集合差的定义。图中的最后一行是 XOR(异或)操作的结果，该结果是属于A或B，前述操作是区域间的操作，很清楚，的前景像素的集合，但不是两者的前景像素的集合。可以说，、区域可以是不规则的和大小不同的。。这与早些时候讨论的灰度级操作对立了，前面的灰度操作是阵列操作并要求空间维数相同。。也就是说，，灰度集合操作涉及整个图像，而不是图像的区域。我们仅在实现AND,OR和NOT逻辑算子时需要涉及理论知识，因为这三个算子是功能完备的英句话说，，任何其他逻辑操作都可以仅用这三个基本函数执行，如图2.33中的第4行所示，在这里我们用AND和NOT实现了差集操作。逻辑操作广泛用于图像形态学处理，这是第9章的主题。模糊集合“干脆”的概念，在这种意义下，元素要么是要么不是集合中的成员。前述的集合和逻辑结果是这在某些应用中受到严重限制。考虑一个简单的例子。假如我们希望把世界上的所有人分为年轻人和非年轻人。使用“干脆”的集合，令U代表所有的人，令A是U的子集，我们把它称为年轻人集合为了形成集合A，我们需要一个隶属度函数，该函数可以对U中的每个元素(人)赋1值或0值。果U中的元素赋值为1，则该元素就是A的--个成员，否则就不是A的一一个成员。因为我们是在处理二值逻辑，隶属度函数简单地定义为一个阈值，低于该阈值的人考虑为年轻人，高高于该阈值的人考想为非年轻人。假如我们定义任何20岁或更年轻的人是年轻人。我们面临一一个直接的困难：年龄为20岁零1秒的人将不是年轻人集合的成员。。这一限制出现在我们用于分类年轻人年龄的阈值上。什么是我“年轻"门意味的”需要更多的灵活性，即需要从年轻到非年轻逐步过渡。模糊集合理论使用隶属度函教来实现这种概念，，该函数在数值1(定义为年轻)和0(定义为非年轻)之间逐步过渡。。使用模糊集合，我们可以声明一个人的年轻度为50%(年轻和非年轻过渡的中间)。换句话说，年龄是一个不精确的概而模糊逻辑提供处理这种概念的工具。我们将在3.8节中详细探讨模糊集合。2.6.5空间操作空间操作直接在给定图像的像素上执行。我们把空间操作分为三大类：（1)单像素操作；（2)邻域操作；（3)几何空间变换。*(z单像素操作我们在数字图像中执行的最简单的操作就是以灰度为基础改变单个像素的值。这类处理可以用一个形如下式的变换函数T来描述::=7(z)(2.6-20）其中，z是原图像中像素的灰度，s是处理后的图像中相应像素的(映射)灰度。例如，图2.34示出了得到一图2.34用于得到8比特图像的负图像的灰图2.32 6b)中的图像是利用集幅8比特负图像的变换，图度变换函数。虚线箭头显示了任意合操作得到的。我们将在第3章中讨论指定灰度变换功输入灰度值z到对应输出值。的变换能的一些技术。邻域操作今S.代表图像（中以任意一点(x:)为中心的一个邻域的坐标集。邻或处理在输出图像。中的相同坐标处生成一个相应的像素，该像素的值由输人图像中坐标在S。内的像素经指定操作决定。例如，2.6-27）式(2.6-27)有时称为向量范数，我们看到，这是式(2.5-1)定义的二二维欧氏距离的通式。表示为|-a在后面的章节中，我们将多次使用距离计算。像素向量的另一个重要优点是由下式表用示的线性变换：2.6-28A(z -a）分量图像3其中、A是大小为mXn的矩阵,z和是分量图像2（绿色）n×1大小的列向量。正如您将要学到的那样,分量图像1（红色）这种类型的变换在图像处理中有很多有用的图2.38三幅RGB分量图像中的相应像素值形成一个向量用途。如式(2.4-2)表示的那样，整个图像可当做矩阵(或向量)来处理，这是在解决大量数字图像处理，我们可以把一幅大小为M×N的图像描述为一个MN×1维向量，问题时有重要意义的事实。例如，方法是用图像的第一一行作为该向量的前》个元素，第二行作为下》个元素，等等。用这种方法形成的图像，我们可以表达应用更广范围的、、下列表示的图像线性处理::= Hf +n2.6-29）其中，了表示输入图像的MN×I向量，n表示一个M×N噪声模式的MNxI向量，g表示处理后图像的MN ×1向量，H是用于对输入图像进行线性处理的MNV xMNV矩阵(见2.6.2节关于线性处理的介绍)。例如，像在5.9 节将要讨论的那样，使用式(2.6-29)为图像复原开发一整套通用技术是可能的。年下一节中，我们会再次接触矩阵这一主题，并在第5章、第8章、第11章和第12章显示矩阵在图像处理中的其他用途。2.6.7图像变换到目前为止，讨论的所有图像处理方法都是直接在图像像素上进行操作，即直接工作在空间域在有些情况下、通过变换输入图像来表达图像处理任务，在变换域执行指定的任务，之后再用反变换返回到空间域会更好。随着本书学习的深入，您会遇到许多不同的变换。表示为T(u,)的二维线性变换是一类特别重要的变换，其通用形式可表达为T(u, D)=.f(x,J)r(Kx,y,u,，)）:2.6-30）x=0 y=0其中，f(x,y）是输入图像，广Kx. .从,)称为正变换核，式(2.6-30对u=0,1, 2,・, M -1和，=0,1,2.…,N-1进行计算。与以前一样，x和y是空间变量，M和N是f的行和列，u和，称为变换变量。T(u,)称为f(x,y)的正变换。给定T(u,)后，我们可以用T(u,)）的反变换还原了(x,))f(x, y）_T(u, D)s(x, J,u,，v）(2.6-31）其中，x =0.,2,.…,M -1,y=0,1,.2.…,W-1,5(X,J,u，）称为反变换核。式(2.6-30)和式2.6-31起称为变换对。图2.39显示了在线性变换域执行图像处理的基本步骤。首先，变换输入图像，然后用预定义的操作修改该变换，最后、输出图像由计算修改后的变换的反变换得到。这样，我们可以看出，该过程是从空间域到变换域，然后返回到空间域第2章R[Tu,D)T(u,D-g(x, y）反变换空间域空间域变换域图2.39线性变换域中操作的一般方法变换域图像处理。例2.11图 2.40显示了图2.39 中步骤的一一个例子。在这种情况下，所用的变换是傅里叶变换，在本节稍后我们将简单提一下它，第4章将对其进行详细介绍。图2.40(a)是一幅被正弦干扰污染了的图像，图2.406b)是该图像傅里叶变换的幅度，它是图2.39中第一阶段的输出。正如急将在第4章学习的那样，空间域中的王弦干扰在变换域以较亮的脉冲方式出现。在这种情况下，脉冲是图2.40(b)中可见的圆形模式。图2.40(c)最示了一个模板图像(称为滤波器)，白和黑分别代表1和0。对于该例子，图2.39第二个方框内的操作是变换的结果与模板相乘，以可靠地消除干扰脉冲。图2.40(d)显示了最终结果，该结果是通过计算修改后的变换的反变换得到的。事实上，您恰好可以看到基准标志(淡淡的十字)，它用于图像对准。D被正弦干扰污染了的图像)傅里叶变换的畅度。・显示了干扰能量脉冲e)用于消图2.40除能量脉冲的模板；d)计算修改后的傅里叶变换的反变换的结果(原图像由NASA提供如果(2.6-32）r(x, y, u, )= 7(x, u)15(y, D)则称变换核是对称的，从而有那么所谓的正向变换核是可分的。另外，、如果不（(x,y)等于。(x.y)，(2.6-33）r(x,y,u,V)=7(X,u)7(y, V）在前面的公式中，若用s代替r，则同样的说明适用于反变换核。例211中讨论的二维傅里叶变换有如下正、反变换核:(2.6-34）r(x, J,u,V)=e和(2.6-35）s(x, y,u,V)=MN其中，j=./-1，因此这些核是复数。将这些核代入式(2.6-30)和式(2.6-31)给出的通用变换公式中・可得出离散傅里叶变换对：(2.6-360工=0 y=0和岁岁(2.6-37）f（(x, y)=7116从基础意义上说、这些公式在数字图像处理中是很重要的，在第4章中，我们将投入更多的篇幅从基本原理入手推导它们，然后在较宽的应用范围使用它们。证明傅里叶核的可分性和对称性并不困难(见习题2.25)，并且可分的和对称的核允许用一维傅里叶变换计算二维傅里叶变换(见习题2.26）。当变换对的正、反变换核满足这两个条件，且了(x,y)是大小为M ×M 的方形图像时，式(2.6-30)和式(2.6-31)可表示为矩阵形式：(2.6-38）1 = AFA其中、F是包含元素（(x,y)的M×M矩阵「见式(2.4-2)]A 是有元素α, =(.)的M ×M矩阵，T是M ×M变换的结果，其值为T(u, b),u,，=0,1,2,,…, M -1。为得到反变换,我们用反变换矩阵B前乘和后乘式(2.6-38):BTB = BAFAB(2.6-39）则如果B=41，F = BTB12.6-40）则用式(2.6-40该式指出 F[其所有元素均等于f(x,y)丁可完全由其正向变换复原。。如果B≠ A"可得到一个近似：F = BAFAB2.6-41）除了傅里叶变换之外，些重要的变换,如沃尔什变换、哈达玛变换、离散余弦变换、、哈尔变或等价地用式4.6382和式2.-40的形式可用式(2.6-30)和式(2.6-31)的形式描述，换和斜变换等，・描述。。我们将在后续章节讨论这些变换和其他类型的图像变换。概率方法2.6.8概率以很多方式用于图像处理工作中。最简单的方式是当我们以分关于概率论的简介，请读者通机量处理灰度值时。例如，,L-1表示一幅查阅本书网站上的Tutoras部分。M ×N大小数字图像中所有可能的灰度值，则在给定图像中灰度级z。出现的概率p(kz,）可估计为(2.6-42）P(Zk）=MNn是灰度。在图像中出现的次数，，MV是像素总数。显然，其中，12.6-43）旦我们知道了P(zp），就可以得出许多重要的图像特性。例如，平均灰度由下式给出：三・ks。(2.6-44类似地，灰度的方差是2.6-45）z-m" p(Zx）方差是z值关于均值的展开度的度量，因此它是图像对比度的有用度量。通常，随机变量z关于均值的第n阶矩定义为L.,（Z)=-m)" P(z）(2.6-46）118邱我们看到，Ho(z)=1,山(z)=0且A2(z)=0'。反之，均值和方差对于图像的视觉特性有明显的直接数字图像基础关系，高阶矩更敏感。例如一个正三阶矩指出其灰度倾向于比均值高，负三阶矩则指出相反的条件，并且零三阶矩告诉我们灰度近似相等地分布在均值的两侧。这些特性对于计算目的很有用，但它们一股不能告诉我们更多图像外观的内容。例2.12图像灰度对比度度量时标准差值的比较。图2.41显示了分别展示低、中、高对比度的三幅8比特图像。在这方差的单位是灰度值的平方。三幅图像中，像素灰度的标准差分别是14.3, 31.6和49.2个灰度级。相应比较对比度值时，我们通常替代使的方差值分别是204.3, 997.8,2424.9。两组数值告诉我们相同的内容，但和标准差口(方差的均方根)，因为其维数直接取决于灰度值。这三幅图像可能的灰度值范围是[0,255],与该范围相关的标准差值与方差相比要直观得多。图2.41展示了(a)低对比度、b)中对比度和(c)高对比度的图像在本书的进展中，慈将看到，在开发图像处理算法中，概率的概念起着核心角色的作用。。例如，在第3章，我们利用式(2.6-42)的概率度量推导灰度变换算法。在第5章中，我们使用概率和矩阵公式开发图像复原算法。在第10章中，概率被用于图像分割，而在第11章中，我们用概率描述纹理。在第12章中，我们以概率公式为基础，导出最佳目标识别技术。到目前为止，我们已经讨论了将概率应用到单幅二维图像上的单个随机变量(灰度)的问题。果考虑序列图像，我们可能解释成为时间的第三个变量。处理这一附加复杂性的工具是随机图像处理一词来自希腊语，其大意是在处理结果中随意地瞄准目标)。我们可以进"stochastic"一步将整个图像考虑为一个空间随机事件(相对于一个点)。基于这一概念所需要的处理工具是来自随机域的技术。在5.8 节中，我我们将给出一个例子，说明如何像随机事件那样处理整个图像，但关于随机过程和随机域的讨论超出了本书的范围。。本节末尾提供的参考文献是阅读这些主题的起点。小结本章内容为后续讨论提供了主要的背景知识。对人类视觉系统的论述虽然简单，但提供了人眼感知图像信息能力的一个基本概念。关于光和电磁波谱的讨论是理解本书所用的许多图像来源的基础。类似地，2.3.4节给出的图像模型也是第4章中称为同态滤波图像增强技术的基础。2.4 节介绍的取样和内插的概念是您在实践中可能遇到的许多数字现象的基础。当愈掌握了傅里叶变换和频率域的概念后，在第4章中我们还将回到取样及其分支问题的讨论。2.5 节介绍的概念是基于像素邻域处理技术的基本组成部分。例如，如下一章和第5章所示的那邻城处理友法是许多图像增强和复原过程的核心。在第2章中、我们将采用邻城操作对阁像做形态学处理，在第10章中，，我们用邻域处理进行图像分割，在第11章中，我们用它们进行图像描述在应用力面，邻域处理由于处理速度快，且硬件和/或固件实现简单，故在图像处理商业应用方面得到了人们的偏爱。1192.6 节的内容在愈阅读全书时始终很好地为您提供帮助。虽然讨论的水平确实是介绍性的，但对l12058。正如在该节中我们提到的那样，介绍的那些工具在后续章节于您建立数字图像处理的概念是合适的。中是必需的。不是一个章节或附录这样一一个地方就能对数学概念充分地论述，您将发现，在后续章节中对来自2.6节的数学工具进行必要的扩展，及如何运用它们解决图像处理的问题来说更有意义。参考文献2.1 节中有关人眼结构的阅读资料可在 Atchison和Smith[20001及 Oystrf199中找到。阅读资料见et1970)的经典书籍也很重要。Borm和Wof191是讨论光和电磁波理论的基本参考资料。电磁能传播包含在Felsen和Marcuvit[1994]的详细论述中。图像感知领域非常宽泛且发展非常快。。关于光传感器和其他成像传感器的一一个优秀信息源是国际光学工程学会(SPIE)。下面是SPIE在这一一领域具有代表性的出版物：Blouke等人[2001]、Hoover和Dotyl19961及 Freeman[1987]的著述。2.3.4 节给出的图像模型来自 Oppenheim, Schafer和 Stockham[1968]的论著。该节中所用的照度值和反射值的参考文献是(ESNA光学手册)IESMA Lighig Halboo-201提供的。关于图像取样及其一些效成]。我们将在第4章中更详细地讨论这个主题。。2.4.3节提到的譬如混淆效应)的其他读物见 Bracewelt1951作为取样和量化的函数的感知图像质量方面的早期实验是由Huang1965]报告的。在降低图像取样数和灰度、如Papamarkos和Asalakist200]的例证级的同时，尽量减少随之而来的退化仍是当前人们感兴趣的主题，关于图像收缩和放大方面的进一步读物见Sid-Ahmedt1995, Unser 等人1995], Umbaugh[2005]和Lehman，见Rosenfeld 和 Kak1982,Marchand-Maillet和 Sharaiha等人[1999]的文献。2.5 节涵盖主题的进一步读物，20001及 Ritter和WilsonL20011提供的材料。图像处理中关于线性系统(见2.6.2 节)的附加读物可在Caslean1996中找到。使用图像平均来消除噪声的方法(见2.6.3 节)由 Kohler和Howel1963]首次提出。关于随机变量求和的均值和方差的期望值的。图像相减(见2.6.3 节)是一一种广泛用于检测变化的通用图像处理工具。为使得图像相才料见 Peebles[ 1993]。咸有意义，配准被减图像是必要的,或者必须识别出由于移动导致的人为缺陷。由Mejering等人1999.,001」撰写的两篇论文给出了用于实现这些目的的技术。2.6.4节的基本参考文献是 Cameron2005]。这一主题的更高级的读物见Tourlks2003]的著作。关于模糊集合的介绍见3.8节和第3章中的相关参考文献。单点和邻域处理(见2.65 节)的进一步细节见3.2 节到3.4 节及第3章中关于这些主题的参考文献。关于几何空间变换见Wilbeg 901的材料。Noble和Danie198]的著述是矩阵和向量操作2.6.6 节)的基本参考材料。关于傅里叶变换(见2.6.7 节5）的详细讨论见第4章，数字图像处理中使用的其他类型变换的例子见第7章、第8章和第11章。关于概率和随机变量(见2.8 节)的基本介绍见Pebls193 Ppouis9的著述是该话题的更进一步论述。。关于随机和随机域图像处理的基础材料，见Rosenfeld和Kak[1982], Jihne2002]和Won及Gray[2004]的著述zalez, Woods和 Bddins2004]的书籍。本章中给出的许多技术的软件实现细节见 Gonz→标有星号的习题的详细答案可在本书的网站上找到该网站上还习题包含有基于本章内容建议的项目。如果纸上的一一个打印点离眼睛0.3.m远、请采用纯几何方法，估计眼晴使用2.1节提供的青景信息，2.1能辨别的最小打印点的直径。为简单起见，假设在中央凹处的像点变得远比视网膜区域的感受器(锥一步假设中央凹可建模为直径为1.5 mm的圆形阵状体)的直径小时，视觉系统已不能检测到该点。进一120列，并并且锥状体间的间隔在该阵列上均匀分布Lzi第2章当我们在白天进入一家黑暗的剧场时，在能看清并找到空座时要用一段时间适应。2.1 节描述的视2.2觉过程在这种情况下起什么作用？虽然图2.10中未显示，但交流电的确是电磁波谱的一部分。美国的商用交流电频率是 77 HL。-波谱分量的波长是多少米？一个研究细胞、细菌、病毒和蛋白质边界形状的图像系统前端。在这种情况下，前端由光2.4父计源和相应的图像摄像机组成。要求围成各个类别的圆形的直径分别为25 um, 0.5 um, 0.05 um和0.005 pm。Ga）能用单个传感器和摄像机解决这一成像向题吗？如果回答是肯定的，试给出照射波长和所需的摄影机类型。这里的“类型”指的是摄像机最敏感的电磁波谱波段(譬如红外波段)。b）如果(a)中您的回答是否定的，那么愈建议采用哪种类型的照明光源和相应的图像传感器？指出(a)中所要求的光源和摄像机。要用最少数量的照明光源和摄像机解决这个问题。“解决这个问题”是指能够分别检测直径为25 pum,0.5 um, 0.05 um和0.005 um的环形细节。4 mmnx14 mr的CCD摄像机芯片有2048× 2048个元素，将它聚焦到相距0.5 m远的一个方形平坦区域。该摄像机每毫米能分辨多少线对？摄像机配备了一一个35 mm镜头。（提示：成像处理模型如图2.3所示，但使用摄像机镜头的焦距替代眼睛的焦距。-家汽车制造商想在一条限量版跑车生产线上将一一些零件自动安放到跑车的保险杠上。这一部件就是彩色坐标，为选择合适的保险杠零件，机器人需要知道每辆车的颜色。模型有4种颜色：蓝色、绿色、红色和白色。。请提出一种基于成像的解决方案。您怎样解决自动确定每辆跑车颜色的问题？记住，在选择零件时价格是最主要的考虑因素。假设中心在(×, y）的平坦区域被一个强度分布为2.7的光源照射。为简单起见，假设该区域的反射是恒定的并且等于1.0，令K= 255。如果图像使用人七特的强度分辨率进行数字化，且眼睛可检测相邻像素间的4种灰度突变，请问k取何值时会出现可见的伪轮廓？画出习题2.7中k=4时的图像。: 2.9数字数据传输通常用波特率度量，其定义为每秒钟传输的比特数。通常，传输是以一个开始比特个字节(8比特)的信息和一个停止比特组成的包完成的。利用这些事实，回答下列间题:a）使用33.6K波特的调制解调器传输一幅大小为2048×2048的256灰度级的图像，需要几分钟寸间"b）波特率为3000K时，这是典型的电话DSL(数字用户线)的媒体速度，传输要用多长时间？高清晰度电视(HDTV)使用1080条水平电视线隔行扫描来产生图像(每隔一行在显像管表面画2.10线，每两场形成一帧，每场用时 1/60秒)。图像的宽高比是16:9。在水平行数固定的情况下，求图像的垂直分辨率。。一家公司已经设计了种图像获取系统，该系统由 HDTV图像生成数字图像。在该系统中、每条(水平)电视行的分辨净与图像的宽高比成正比，彩色图像的每个像素都有24比，红色、绿色、蓝色图像各8比特。这三幅原色图像形成彩色图像。。存储90分钟持的灰度分辨率，部 HDTV电影需要多少比特?考虑两个图像子集S和S。，如下页右图所示。对于V={1}、确定这两个子集是(a)4邻接的、(6)8邻2.11接的，还是(C)m邻接的?*2.12提出将一个像素宽度的8通路转换为4通路的一种算法。提出将一个像素宽度的m通路转换为4通路的一种算法。2.13参阅2.5.2节末尾的讨论，在该讨论中，我们将背景定2.14义为(R,”，即图像中所有区域的并集的补集。。在呆些：°：应用中，定义一个像素(R,)°的子集为背景是有利的，该子集不是孔洞像素区域(非正式地，认为孔洞是由区域像素围绕着的背景像素子集)。如何修改这一定义，以便从(R,”中排除孔洞像素？像“背景是非孔洞像素的(R,°像素的子集”这样的答案是不能接受的。（提示：利用连通性这一概念。）考虑右图的图像分割。2.15 a)令V={0,1,2}，计算p和g间4、8和m通路的最短长度。如果在这两点间不存在一个特殊通路，试解释原因。b)令V={2,3,4}，重复问题(a)。女（a）对于点p和g间的D。距离等于这两点间最短4通路的情况，给出需2.16 1(p)3要的条件。(b）这个通路唯一吗对于D。距离，重做习题2.16。2.17-些算子，其功能是在一个很小的子图像区域S中计算像素值的总和。证明这女2.18在下一章，将讨论一些算子都是线性算子。个数集的中值弓定义为这样一一个值，该数集中的一2.19一半数值比它小，另一半数值比它大。例如，数集{2,3,8,20,21,25,31}的中值是20。试证明计算子图像区域S的中值的算子是非线性的。2.20证明式(2.6-6)和式(2.6-7)的正确性。〔提示：从式(2.6-4)开始，并且利用这样一个事实：个和的期望值就是期望值的和。考虑两幅8比特图像，它们的灰度级跨越从0到255的全部范围。2.21a）讨论从图像(1)中重复减去图像(2)的限制效应。i。假设结果仍然用8比特表示。，会产生不同的结果吗？b）如果颠倒图像的顺序，2.22图像相减通常用于在生产线上检测缺失的元件。方法是存储一幅对应于正确组装的“金”图像；理想情况下，如果新产品组装正确，则差值应为零然后，从相同产品的传入图像中减去该图像。对于缺失元件的产品，在不同于金图像的位置，差值图像将不为零。在实际中，您认为在什么条件下使用这种方法工作才是合适的?2.23参考图2.31，画出集合(A* - B)U(B-A)。★(a）玉心）给出下图中集合A,从C中所示的阴影集合的表达式。每幅图中的阴影区域组成一个集合，因此应该对这三幅图的每一个阴影区域给出一一个表达式。.24使用三角形区域替代四边形区域时，所得到的类似于式(2.6-24)和式(2.6-25)的等式是什么？2.25证明式(2.6-34)和式(2.6-35)中的傅里叶核是可分的和对称的。数学图像基础:2.26证明具有可分性、对称性的二维变换核可以用(1)沿输入的行(列)的一维变换来计算；接着(2)用第一步结果的列(行)的一一维变换来计算2.27家工厂生产半透明的微型聚合物方形产品。要求进行100%视觉检测来严格控制质量，工广管理者发现人工检测越来越昂贵，于是检测改为半自动方式。在每个检测位置，机械装置把聚合物方形产品放在一一盏灯的上方，灯位于光学系统的下方，该光学系统产生方形产品的放大图像，图像完全落在大小为80 mmx× 80 mm的观察屏上。缺陷以暗的斑点的形式出现，检测者的工作是观察如果在屏幕上一个样品中出现了多个直径大于或等于 0.8 mm的黑色斑点，则丢弃该样品。屏幕。，如果能找到一种全自动的处理方法，利润将提高 50%。。她还相信项目的成功会是她管理者相信，升迁为法人的阶梯。经过大量调研之后，管理者确定了解决这一问题的方法，即用CCD电视摄像机去观察每个检测屏幕，并把摄像机的输出送到能够检测斑点的图像处理系统中，测量它们的直径，并触发以前由检测员操作的接收和丢弃按钮。她可以找到一个系统，，只要最小的缺陷在数字图像中至少为 2×2像素的区域发生，就可以完成该工作。假设管理者聘任愈来帮助她确定摄像机和镜头系统的参数，但要求慈使用现有的元件。对于镜头，假设该约束条件意味着任何25 mm, 35 mm五焦距的整数倍。对于摄像机，这意味着分辨率为512×512像素、1024×1024像素或2048×2048像素。这些摄像机中的各个成像元素是大小为8um x8 um的方形，成像元素间的间距。对于该应用，摄像机要远贵于镜头，因此该问题应以选择镜头为基础，尽可能使用最低分pmo一名顾问，请您提供一份书面建议，对您的结论给出合理且详细的分辨率的摄像机来解决。作为一析。使用习题2.5中建议的相同成像几何。124灰度变换与空间滤波是透过光线看阴影还是透过阴影看亮度。它的与众不同之处在于，龙引I言术语空间城指图像平面本身，这类图像处理方法直接以图像中的像素操作为基础。这是相对于变换域中的图像处理而言的，正如2.6.7 节所介绍的和第4章将要详细讨论的那样，，变换域的图像处理首先把一幅图像变换到变换域，在变换域中进行处理，，然后通过反变换把处理结果返回到空间域，灰度变换在图像的单个空间域处理主要分为灰度变换和空间滤波两类。。正像本章您将了解到的那样，象素上操作，主要以对比度和阈值处理为目的。。空间滤波涉及改善性能的操作，如通过图像中每一像素的邻域处理来锐化图像。接下来几节我们将讨论一些经典的灰度变换和空间滤波技术。我们还将讨论模糊技术的某些细节，，以便允许我们在灰度变换和空间滤波算法的公式化表示中并入不太精确的以知识为基础的信息。3.1背景知识灰度变换和空间滤波基础3.1.1本节讨论的所有图像处理技术都是在空间域进行的。由2.4.2 节的讨论，我我们知道空间域就是简单的包贪图像像素的平面。如2.6.7.节定义的那样・与（第4章的主题）频率城相反，空闸域技术真接在图像像素上操作，例如，对于频率域来说，，其操作在图像的傅里叶变换上执行，，而不针对图像本身。正如您将在阅读全书的过程中了解到的那样，某些图像处理任务在空间域中执行更容易或更有意义，而另一些任务则更适合使用其他方法。通常，空间域技术在计算上更有效，且在执行上需要较少的处理资源本章讨论的空间域处理可由下式表示:3.1-1）g(Cx,) =7[f(x,J)]8(.）是处理后的图像、T是在点(Kx.y)的其中f(x,y)是输入图像，有时也使用其他形状的邻域・圆的数字近似。但矩形邻域是到目邻域上定义的关于了的一一种算子。算子可应用于单幅图像(本章中我前为止最好的邻城,因为它们在计们的主要关注点)或图像集合，例如，如2.63 节中讨论的那样，为降算机上实现起来更为容易127灰度变换与空间滤波。图3.1显示了式(3.1-1)在单幅图像上的基本实现。所示氐噪声而对图像序列执行逐像素的求和操作。的点（Gx,y)是图像中的一个任意位置，包含该点的小区域是点(x,y)的邻域，如2.6.5 节解释的那样。典型地，邻域是中心在(x,y)的矩形，其尺寸比图像小得多。图3.1中给出的处理由以下几步组成：邻域原点从一原点一个像素移动，对邻域中的像素应用算子T个像素向另一并在该位置产产生输出。这样，对于任意指定的位置(x,y)，输出图像g在这些坐标处的值就等于对f中以(x,y)为原点的邻域应用算子T的结果。例如，假设该邻域是大小为3×3的正方形，算子T定义为“计算该邻域的平均灰度”图像广考虑图像中的任意位置，譬如(100,150)。假设该邻域的空间域原点位于其中心处，则在该位置的结果g(100,150）是计算图3.1空间域一幅图像中关于点(x,Jy)的，再除以9（即由邻域包f(100, 150)和它的8个邻点的和，3×3邻域。邻域在图像中从一个像个素围的像素灰度的平均值)。然后，邻域的原点移动到下到另一个像素移动来生成一幅输出图像个位置，并重复前面的过程,，产生下一一个输出图像g的值，该处理从输入图像的左上角开始，以水平扫描的方式逐像素地处理，每次一行。典型地，当该邻域的原点位于图像的边界上时，部分邻域将位于图像的外部。此时，不是在用了做指定的计算时忽略外侧邻点，就是用0或其他指定的灰度值填充图像的边缘。被填充边界的厚度取决于邻域的大小。在3.4.1节中，我们将再回到这一问题就像我们在3.4 节中详细讨论的那样，刚刚描述的过程称为空间滤波，其其中，邻域与预定义的操作起称为空间滤波器(也称为空间掩模、核、模板或窗口)。在邻域中执行的操作类型决定了滤波处理的特性。最小邻域的大小为1×1。在这种情况下，g仅取决于点(x,y)处的了值，而式(3.1-1)中的7则成一个形如下式的灰度(也称为灰度级或映射)变换函数：为一=T(r）(3.1-2)其中，为表达方便，令r和s分别表示变量，即g和f在任意点(x,y)处的灰度。例如，如果T(r)有如图3.2(a)所示的形式，对f中每一个像素施以变换产生相应的g的像素的效果将比原始图像有更高的对比度，即低于k的灰度级更暗，，而高于k的灰度级更亮。这种技术有时称为对比度拉伸(见3.2.4。在该技术中，低于人的r值被变换函数压缩在一个较窄的范围s内，接近黑色；而高于k的r值。很明显，灰度值，经映射得到了相应的值s。。在如图 3.2(b)所示的极限情况下，T(r）刘与此相及。。这种形式的映射称为闽值处理函数。有些相当简单但功能强大的处理方一幅两级(二值)图像。，可以使用灰度变换函数用公式加以表达。在这一章中，我们主要使用灰度变换函数来进行图像增在第10章中，我们将使用灰度变换函数来进行图像分割。其结果仅取决于一个点处的灰度的方法有时称为点处理技术，与此相反，本节早些时候讨论的方法则称为邻域处理技术。3.1.2关于本章中的例子虽然灰度变换和空间滤波覆盖了相当宽的应用范围，但本章中的多数例子是图像增强应用。增强处理是对图像进行加工，使基结果对于特定的应用比原始图像更仓适的一种处理。“特定”一词在文里很重要，一开始就确定增强技术是面向问题的。。例如，对于增强X射线图像非常有用的方法，比可能并不是增强由电磁波谱中远红外波段拍摄的图像的最好方法。图像增强没有通用的“理论”当为视觉解释而处理一幅图像时，观察者将是判定一种特定方法好与坏的最终裁判员。在处理机器感知-种给定的技术很易于量化。例如，在自动字符识别系统中，最合适的增强方法就是可得到最好时，识别率的方法，这里不考虑一种方法较另一种方法的计算量的要求。s = 7(r）1(r）图3.2灰度变换函数：a)对比度拉伸函数；(b)阈值处理函数然而，不管应用或使用过的方法，图像增强是视觉上最具吸引力的图像处理领域之一理所当然地，图像处理的初学者通常会寻找重要的且理解起来相对简单的增强应用。因此，使用图像增强的列子来说明本章中论述的空间处理方法，不仅可以节省本书中处理图像增强的额外的章节，而且更重要的是对初学者介绍空间域处理技术的细节的更有效方法。正如您将要看到的那样，随着本书的进程,本章叙述的基本内容可用于比图像增强宽得多的范围些基本的灰度变换函数3.2灰度变换是所有图像处理技术中最简单的技术。和。分别代表处理前后的像素值。如前一节指出的那样，这些值与s=T()表达式的形式有关，其中7是把像素值r映射到像素值s的一种变换。由于我们处理的是数字量，所以变换函数的值通常存储在一一个一维阵列中，，且从r到s的映射是通过查我表实现的。对于8比特环境，包含T的值的一个查找表将有256条记录。作为关于灰度变换的介绍，考虑图3.3，该图显示了图像增强常用的三类基本函数：线性函数(反转和恒等变换)、对数函数(对数和反对数变换)和幂律函数(n次幂和n次根变换)。恒等函数是最般的情况，其输出灰度等于输入灰度的变换，在图3.3中包括它仅仅为了完整性考虑。3.2.1图像反转使用图3.3中所示的反转变换，可得到灰度级范围为[0, L-1]的一幅图像的反转图像，该反转图像由下式给出:(3.2-1）使用这种方式反转一幅图像的灰度级，可得到等效的照片底片。这种类型的处理特别适用于增强嵌入在一畅图像的暗区域中的白色或灰色细节，特别是当黑色面积在凡寸上点主导地位时。3.4.显示厂个例子。原图像是一幅数学乳房X射线照片，其中显示有一小块病变。尽管事实上两幅图在视觉内容上都一样，但应注意，在这种特殊情况下，分析乳房组织时使用反转图像会容易得多。对数变换3.2.2图3.3中的对数变换的通用形式为(3.2-2）s =clog(1+r）第3章灰度变换与空间滤波。图3.3中对数曲线的形状表明，该变换将输入中范围较窄的低灰度值其中c是一个常数，并假设r≥0。映射为输出中较宽范围的灰度值,，相反地，对高的输入灰度值也是如此。我们使用这种类型的变换来扩同时压缩更高灰度级的值。反对数变换的作用与此相反。展图像中的暗像素的值，反转变换3L/4第n次根第n次幂反对数变换恒等变换输入灰度级广・些基本的灰度变换函数。所有曲线已被缩放到适合显示的范围图3.3图3.4(a)原始数字乳房X射线照片；(b)使用式(3.2-1)给出的反转变换得到的反转图像(图像由G.E Medical Systems 公司提供)具有图3.3所示对数函数的一般形状的任何曲线，都能完成图像灰度级的扩展/压缩，但是，下节讨论的幂律变换对于这个目更为通用。对数函数有个重要特征，，即它压缩像素值变化较大的图像的。像素值有较大动态范围的一一个典型应用说明是傅里叶频谱,，这将在第4章中讨论。现在，动态范围。我们只关注图像的频谱特征。通常，频谱值的范围从0到10°，甚至更高。尽管计算机能毫无向题地上理这一范围的数字、但图像的显示系统通常不能如实地再现如此大范围的灰度值。因而，最终结果是许多重要的灰度细节在典型的傅里叶频谱的显示中丢失了作为对数变换的说明，图3.5Ga)显示了值域为0.～1.5×10°的傅里叶频谱。当这些值在个8比特系统中被线性地缩放显示时，最亮的像素将支配该显示，频谱中的低值(恰恰是重要的)将损失掉。|131|图35(a)中相对较小的图像区域，鲜明地体现了这种支配性的效果，而作为黑色则观察不到。。替代这种显示数值的方法，如果我们先对这些频谱值应用式(3.3-2（此时c=1），那么得到的值的范围就变为图13.5(6)显示了线性地缩放这个新值域并在同一个8比特显示系统中显示频谱的结果。。由这些图片可以看出，与与未改进显示的频谱相比，这幅图像中可见细节的丰富程度是很显然的。我们在关于图像处理的出版物中所着到的绝大多数傅里叶频谱都用这种方式标定过。i o图3.5(a)傅里叶频谱;（b)应用式(3.2-2)中的对数变换(e=1)的结果幂律（伽马）变换3.2.3幂律变换的基本形式为(3.2-3）s = cr’其中c和y为正常数。有时考虑到偏移量(即输入为0时的一个可度量输出)，式(3.2-3)也写为s=c(r+e)”。然而，，偏移量一般是显示标定问题，因而作为一个结果，通常在式(3.2-3)中忽略不计。对于不同的y值，与r的关系曲线如图3.6所示。与对数变换的情况类似，部分y值的幂律曲线将较窄范围的暗色输入值映射为较宽范围的输出值，相反地，对于输入高灰度级值时也成立。然而，与对数函数不同的是，我们注意到，随着r值的变化，将简单地得到一族可能的变换曲线。正如所预期的那样，在图3.6中，我们看到，y >1的值所生成的曲线和y<1的值所生成的曲线的效果完全相反。最后，我们注意到式(3.2-3）在c==7=1时简化成了恒等变换。.673L/4L-1132输入灰度级广不同，值的s=ccr”曲线(所有情况c=1)。所有曲线均已被缩放到适合于显示的范围图3.6灰度变换与空间滤波67、打印和显示的各种设备根据幂律来产生响应。书于图像获取、习惯上，幂律方程中的指数称为伽马[故在式(3.2-3)中使用这一符号]。用于校正这些幂律响应现象的处理称为伽马校正。例如，阴一个指数变化范围约为1.8 ～ 2.5的幂函数。极射线管(CRT)设备有一个灰度-电压响应，，该响应是，这种显示系统产生的图像往往要比期望的图像暗。这图 3.6中，用7 = 2.5时的参考曲线，，我们看到,。图3.7(a)显示了一一幅输入到监视器的简单灰度斜坡(渐变)图像。如期望的那个结果在图3.7加以说明。样，监视器表现了输出比输入暗，，如图3.7(6)所示。。在这种情况下，伽马校正很简单。我们需要做的只，即进行:="5二是将图像输入到监视器前进行预处理，r”变换。结果如图3.7(c)所示。当输入到相同的监视器时，这一伽马校正过的输入产生外观上接近于原图像的输出，如图3.7(d)所示。。类似的分析也适用于其他图像设备，如扫描仪和打印机。唯一的不同是随设备而定的伽马值(Poynton[1996）。a日在监视器上观察到的原图像原图像伽马校正先愿石题秘量点烈餐美经伽马校正后的图像的经伽马校正后的图像图3.7(a)亮度斜坡图像；の)具有伽马值为25的模拟监视器上观察到的图像；（C)经伽马校正后的图像；(の)在同一监视器上观察到的经伽马校正后的图像。比较图(d)和图(a）如果所关注的是在计算机屏幕上精确显示图像，则伽马校正是很重要的。不恰当校正的图像看起不是太亮，就是太暗。试图精确再现彩色也需要伽马校正的一些知识，因为改变伽马值不仅会改变亮度，而且会改变彩色图像中红、绿、蓝的比率。。随着数字图像在互联网上商业应用的增多，在过去几年里，伽马校正逐渐变得越来越重要。为流行网站创建被几百万人浏览的图像是很平常的事，因为大多数浏览者会有不同的监视器和/或监视器设置。有些计算机系统甚至会内置部分伽马校正。此外，目前一步复杂化了。由于这些限制，当在网站中存的图像标准并不包含创建图像的伽马值，因此，问题进诸图像时，一种合理的方法是用伽马值对图像进行预处理，此伽马值代表了在开放的市场中，在任意给定时间点，各种型号的监视器和计算机系统所期望的“平均值”例3.1使用幂律变换进行对比度增强。除伽马校正外，幂律变换在通用对比度操作中也很有用。图3.8 )显示了人体胸部以上脊椎骨折错位和髓受到影响的一幅核磁共振CMIRDK像。在胸椎垂直中心附近，即图中从上往下约14处、骨折显而易见。由于所给图像整体偏暗，因而需要扩展灰度级。这可以使用指数为分数的幂律变换来完成。使用13式323）给出的幂律变换来处理图3.860，得到示于图中的其他几幅图像。对应于图(6)到图(D)的伽马值分别为 0.6, 0.4和0.3(e始终为1)。我们注意到，随着伽马值从0.6减小到0.4，更多的细节变得可见了，背景中的细节得到了进一步增强，但对比度会降低到图像开始有轻微“冲当伽马值进一步减小到0.3时，一点，尤其是在背景中。比较所有的结果,我们看到在对比度和可辨别细节方面的最好增淡”外观的那一个近似极限点，低于该值对比度会下降到令人难强在r=0.4时。。在这幅特定的图像中，。Y =0.3的值是以接受的水平。主b图3.81而y分别等于0.6,0.4, 0.3时应用式(3.2-3(a)人体脊椎骨折的核磁共振图像(MRI)；给出的变换的结果(原图像由 Vanderbit大学医学中心辐射学与放射学系的 David R Pickens博士提供)幕律变换的另一个说明・例3.2一个与图3.8a)相反的间题。要处理的图像现在有“冲淡”的外观，这表明灰度级的图3.9(a)显示了一压缩是必需的。这可以用式3.2-)并令Y>1来完成。令Y=3.0.4.0和5.0时、图3.9a)的处理结果如图3.960到(d)所示。伽马值取3.0和 4.0时，可得到合适的结果，且后者由于有较高的对比度而显示出更令人满意的效果。Y=5.0时得到的结果中有些地方太暗，因而丢失了一些细节。如左上方主路左侧的暗色区域就是这样的一个例子。ib c d图3.9a)航拍图像;(6)~(d)令c=1且y分别等于3.0,4.0和5.0时应用式(3.2-3)给出的变换的结果(此例的原图像由NASA提供)分段线性变换函数3.2.4对前面三节中所讨论方法的一个补充方法是使用分段线性函数。分段线性函数较我们已经讨论过的函数类型的的主要优点是分段线性函数的形式可以是任意复杂的。事实上，正如愈马上将要看到的那样、些重要变换的实际实现可仅由分段函数来明确地表达。分段函数的主要缺点是它的技术说明要求用户输入。对比度拉伸最简单的分段线性函数之一是对比度拉伸变换。低对比度图像可由照明不足、成像传感器动态范围太小，甚至在图像获取过程中镜头光圈设置错误引起。。对比度拉伸是扩展图像灰度级动态范围的137处理，因此，它可以跨越记录介质和显示装置的全部灰度范围。灰度变换与空间滤波图3.10(a)显示了一个用于对比度拉伸的典型变换。形状。如果，=s且,=52，则变换为一一线性函数,，将产生则变换变为阈值处理函数，并产生一幅二值图像，如图3.2(b)所示。且S2 =L-1，贝(r,s）和(z,S2）的中间值产生输出图像的不同程度的灰度级扩展，从而来影响输出图像的对比度。一般情况下，假设八S，且..S5，函数是单值的且单调递增的。这一条件保持了灰度级的次序，从而避免了在处理后的图像中产生人为的灰度错误。2, 52）5L. /4L72日L/4L/231./4 L输入灰度级广对比度拉伸:a)变换函数的形式；b)低对比度图像、c)对比度拉伸的结果；d)阈值处理图3.10的结果(原图像由位于堪培拉的澳大利亚国立大学生物科学研究院的Roger Heady 博士提供)图3.10(6)显示了一幅8比特低对比度图像。。图3.10(C)显示了对比拉伸后的效果，得到该效果的参数大灰度级。因此，变换函数把灰度级由其原范围线性地拉伸至整个范围[0,L-1]。最后，图3.10(d)显示厂使用前面定义的:.=.m.0.)和1:2. .L-12的阁值处理两数后的结果，，其中，m是图像的平。作为这些结果的基础的原图像是电子显微镜扫描的放大约700倍的花粉图像。均灰度级。灰度级分层突出图像中特定灰度范围的亮度通常是重要的，其应用包括增强特征，如卫星图像中大量的水和X射线图像中的缺陷。通常称之为灰度级分层的处理可以有许多方法实现，但是它们中的大多数是两种基本方法的变形。一种方法是将感兴趣范围内的所有灰度值显示为一一个值(譬如“白色”），而一个值(譬如“黑色””）。如1A)）所示、该变换产生了幅二值图像。第将其他灰度值显示为另一种方法以图3.11 6)所示的变换为基础，使感兴趣范围的灰度变亮(或变暗)，而保持图像中的其他灰度级不变。图图 3.11a)这一变换突出了范围[A.)内的灰度，而将所有其他灰度降低到了一个更低的级别；b)这一变换突出了范围[A,B]内的灰度，而保持所有其他灰度级不变例3.3、灰度级分层・图3.12(a)是一幅靠近肾脏区域的大动脉血管造影照片(见1.3.2 节对这幅图像更详细的解释)。该例的目的是使用灰度级分层来突出主要血管，使其更亮一些，如同注射造影剂的效果那样。图3.12(b)显示了使用图3.11(a)给出的变换的结果，所选范围接近数值的顶端，，因为感兴趣的范围比背景亮。该变换的最终结果是血管和肾脏部分显现白色，而其他灰度显示为黑色。这种类型的增强产生了一一幅二值图像，这对于研究(用于检测血管堵塞的)造影剂的流动是很有用的。一方面，如果我们的兴趣在于研究感兴趣区域的实际灰度值，则可使用图3.116b)中的变换另图3.126)显示了使用这样一个变换后的结果：近似等于平均灰度的中等灰度区域的灰度范围设置为黑色，而其他灰度保持不变副这里，我们看到主血管和肾脏区域部分的灰度级色调保持不变。当我们的兴趣是测量系列图像中造影剂随时间流动时，这种结果是很有用的。图 3.12(a)大动脉血管造影照片；(b)使用图3.11 a)中说明的分层变换的结果，所选的重要灰度范围为灰度级的高端；（c)使用图3.11 6b)中的变换的结果，所选区域置为黑色，以便血管和肾脏区域的灰度保持不变(原图像由密歇根大学医学院的Thomas R、 Gest博士提供）比特平面分层像素是由比特组成的数字。例如，在256级灰度图像中，每个像素的灰度是由8比特(也就是1个代替突出灰度级范围，我们可突出特定比特来为整个图像外观作出贡献。如图3.13说子节)组成的。一幅8比特图像可考虑为由8个1比特平面组成，其中平面1包含图像中所有像素的最低明的那样，阶比特，而平面8包含图像中所有像素的最高阶比特。个8比特字节6特火面8最高阶比特）光面K最低阶比特）图3.13幅8比特图像的比特平面表示图3.14(a)显示了一幅8比特灰度图像，，图3.14(6)到图3.14(i)是其8个1比特平面，图3.14(6)对应于最低阶比特。很明显，。个高阶比特平面，特别是最后两个比特平面，包含了在视觉上很重要的大多数数据。低阶比特平面在图像中责献了更精细的灰度细节。。原图像有一个灰度为194的灰色边。140创注意，对应于某些比特平面的灰度边界是黑色(0)，而其他灰度边界是白色(1)。为了解其原因，考虑灰度变换与空间滤波个像素，譬如，1，图3.14(a)的最低边界的中部。从最高阶平面开始，这些比特平面中的相应像素的值分别为11000010,它是十进制数194的二进制表示。原图像中任意一个像素的值，可以类似地由这些比特平面中对应的二进制像素值来重建。幅大小为500×1192像素的8比特灰度图像、)-C0D比特平面！到8图3.14其中比特平面，对应于最低阶比特。。每个比特平面都是一幅二值图像根据灰度变换函数，显示一幅8比特图像的第8个比特平面并不困难，它可用阈值灰度变换函数处理输入图像得到二值图像，该函数将0-127之间的所有灰度映射为0，而将128-255 之间的所有灰度映射为1。图3.146D)中的二值图像就是使用这种方式得到的。得到生成其他比特平面的灰度变换函数的方法，将作为一一个练习留给读者(见习题3.4）把一幅图像分解为比特平面，对于分析图像中每个比特的相对重要性是很有用的，这一处理可帮助我们确定用于量化该图像的比特数的充分性。此外，这种类型的分解对图像压缩(第8章的主题)在图像压缩中，重建一幅图像时所用的平面要比全部平面少。例如，图3.15(a)显示了使用也很有用，1。重建是使用第，n个平面的像素乘以常数2”北特平面8和比特平面7重建的一幅图像。来完成的。巴第n个有意义的二进制比特变换成十进制相比，这并没有做更多的事。所用的每个比特平面与一相应的常数相乘，然后将所有的比特平面相加得到灰度图像。这样，为得到图3.15 (a)，我们用 128乘以比特平面8，月用64乘以比特平面7，然后把这两个比特平面相加。虽然原图像的主要特征被复原了，但重建后的图像显得有些平淡，特别是在背景区域。这并不奇怪，因为两个平面仅能产生4个不同的灰度级。。把平面（加入到重建中可改善这种情况，如图3.15(6)所示。注意，该图像的背景有可感知的伪轮廓。这一效应可通过在重建中加入第5个平面来显著降低，如图 3.15（(e)所示。在重建中使用更多的平面对图像的外观不会有更大的贡献。因而，我们可以得出这样的结论：存储4个高阶比特平面将允许我们以可接受的细节来重建原图像。存储这4个平面代替原始图像可减少50%的存储量(不考虑存储体系结构问题）4 3.15a使用比特平面8和7重建的图1像:.便用比特平面8,7和6重建的图像、(6)使用比特平面8,7,6和5重建的图像。将图(GO与图3.14 a)进行比较直方图处理3.3灰度级范围为I0,L-1]的数字图像的直方图是离散函数A(rx)）=。，其中，是第人级灰度值,是图像中灰度为，的像素个数。在实践中，经常用乘积MV表示的图像像素的总数除它的每个分量来归一化直方图，通常M和N是图像的行和列的维数。因此，归一化后种关于基本概率论的简要回1, …，L-1。简单地说，的直方图由(x ）=./M个给出，其中人=0，顾，请读者参阅本书的网站。p0x）是灰度级，在图像中出现的概率的一个估计。归一化直方图的听有分量之和应等于1。直方图是多种空间域处理技术的基础。直方图操作可用于图像增强，如本节所示。除了提供有用的图像统计资料外，在后续章节中我们还会看到直方图中的固有信息在其他图像处理应用中也非常有用，如图像压缩与分割。直方图在软件中计算简单，而且有助于商用硬件实现，因此已成为实时图象处理的一种流行工具。作为灰度变换的直方图处理的介绍，我们考虑图 3.16，它是图 3.10所示的以4个基本灰度级为特征：暗图像、亮图像、低对比度图像和高对比度图像。。图的右侧显示了与这些图像对应的直方的花粉图像:凡。每个直方图的水平轴对应于灰度值。，垂直轴对应于值人(rx)）=。或归一化后的值()=n。 （MN这样，直方图就可以简单地被看成是人z)”对应于，或(2.2.MV对应于，的图形。，在暗图像中，直方图的分量集中在灰度级的低(暗)端。类似地，亮图像直方图的我们注意到，分量则倾向于灰度级的高端。低对比度图像具有较窄的真方图，且集中于灰度级的中部。对于单色图，好像灰度被冲淡了一样。最后，我们看到，高对比度图像中直方图的分量覆盖了象，，这意味着暗淡，而且像素的分布没有太不均匀，只有少量垂线比其他的高许多。直观上，可以得很宽的灰度级范围，：若一幅图像的像素倾向于占据整个可能的灰度级并且分布均匀，则该图像会有高对比出这样的结论:度的外观并展示灰色调的较大变化。最终效果将是一幅灰度细节丰富且动态范围较大的图像。很快将会证明，仅仅依筝输入图像直方图中的可用信息就可开发出一一个变换函数来自动地实现这种效果。直方图均衡3.3.1考虑连续灰度值，并用变量r表示待处理图像的灰度。通常，我们假设r的取值区间为[0,L-1]，r=L-1表示白色。在r满足这些条件的情况下，我们将注意力集中在变换形式且r=0表示黑色，s =7(r),0≤r≤L-(3.3-1）上(灰度映射)，对于输入图像中每个具有r值的像素值产生一个输出灰度值s。我们假设a)） T(r)在区间0≤r≤L-1上为单调递增函数・。(b）当0≤r≤L-1时，0≤T(r) ≤L-1。在稍后讨论的一些公式中，我们用反函数-=7"(s), 0 <s≤L--1(3.3-2）在这种情况下，条件(a)改为Ca）T(r)在区间0≤r≤L-1上是一个严格单调递增函数。O如果对于公之人有02750)、则称威数T()）是单调递增的。如果对于公>万有T(p>7(,），、则称函数T(，是严格单调44递增的。类似的定义适用于单调递减函数。灰度变换与空间滤波老图像的直方图高对比度图像的直方图4种基本的图像类型：暗图像、亮图像、低对比度图像和高对比度图像，以及与它们相对应的直方图图3.16条件(a)中要求T(广)为单调递增函数是为了保证输出灰度值不少于相应的输入值，防止灰度反变换时产生人为缺陷。。条件(b)保证输出灰度的范围与输入灰度的范围相同。最后，条件（a’）保证从・到r的反映射是防止出现二义性图3.17(a)显示了满足条件(a)和(b)的一一个变换函数。一对一的，这里我们看到，多值映射到单值是可能的，并且仍然满足这两个条件。也就是说，单调变换函数执行当从，到。映射时，这是很完美的。然而。如果我们想要唯一对一或多对一一映射。兰一地从映射的值恢复r值(反映射由反向箭头表示)，图3.17(a)就存在一个问题。一图3:17.中的反晚射是可能的，但是，。,的反映射是一个范围的值，通常，要防止由。,恢复原始的，值的问题。如图 3.17(b)所示，TXr)要求是严格单调的，以保证反映射是单值的(即两个方向上的映射都是-对一的)。这是我们在本章后面推导一一些重要直方图处理技术的理论要求。因为在实践中我们处理的是整数灰度值，必须把。因此：当严格单调不满足时。我们就要使用寻找最接近整数匹所有结果四舍五入为最接近的整数值。配的方法来解决非唯一反变换的问题。例3.8对此给出了说明。/4tr单个值单个值单个值多个值图3.17(a)非单调递增函数，显示了将多个值映射为单个值的方式；(b)严格单调递增函数。这是一一个双向的一一映射幅图像的灰度级可看成是区间[0,L-1]内的随机变量。随机变量的基本描绘子是其概率密度函数(PDF)。。令p,(r）和p,(s)分别表示随机变量，和s的概率密度函数，其中p的下标用于指示，和力。是不同的函数。。由基本概率论得到的一个基本结果是，如果p,.()）和T(r)已知，，且在感兴趣的值域上T(r)是连续且可微的，贝则变换(映射)后的变量s的PDF可由下面的简单公式得到：drP.6s)= p,(r)(3.3-3）这样，我们看到，输出灰度变量s的 PDF就由输入灰度的PDF和所用的变换函数决定「回忆可知广和s由T(r)关联起来。在图像处理中特别重要的变换函数有如下形式：=T(r)=(L-1]。pP,(w)dw(3.3-4）其中，w是积分的假变量。公式右边是随机变量广的累积分布函数(CDF)。。因为PDF总为正，，回忆个函数的积分是该函数下方的面积，遵循式(3.3-4)的变换函数满足条件(a)，因为函数下的下，一面积不随r的增大而减小。当在该等式中上限是r（L-1)时，则积分值等于1(PDF曲线下方的面积总是1)，所以。的最大值是(L-1)，并且条件(b)也是满足的。我们由基本积分学中的莱布尼茨准则知道，关于上限的定积分的导数是被积函数在该上限的值，即=dT(r1S=L-1品LJ. ,ow ] -Dp,.c）(3.3-5）dr把dr/ds的这个结果代入式(3.3-3)，并记住概率密度值为正，得到up.6s)= p,r)= p,(r)0≤s≤L-1(3.3-6）(L-Dp,(r从该公式的最后一行中的p,(S)可知，这是个均匀概率密度函数。简而言之，我们已证明执行式(3.3-4)的灰度变换将得到一个随机变量s，该随机变量由一个均匀 PDF表征。特别要注意，由该式可知T(r取决于，,(》，但正如式(3.36)所指出的那样，得到的p,(s）始终是均匀的，它与p,(r）的形式无关。图3.18说明了这些概念。146灰度变换与空间滤波i D式(3.3-4）图3.18一个任意的PDF；(b)对所有灰度级r应用式(3.3-4)中的变换的结果。具有均匀PDF的结果灰度s与r的PDF的形式无关例3.4式(3.3-4)和式(3.3-6)的说明。为牢记这一概念，考虑下面这个简单的例子。假设图像中的(连续)灰度值有如下 PDF：0≤r≤L-1其他从式(3.3-4)有一.二s=T(0)=L-)],。P,(NOdw=-假设我们接着使用这个变换得到一幅灰度为。的新图像：。也就是说、。值是通过求输人图像的相应灰度值的平方，然后除以L-D形成的。例如，考虑一幅L=10的图像，并且假设输入图像中任意位置(x,y)处的像素有灰度r=3。则新图像中在该位置的像素是s=7(r)=73/9=1。我们可以把p,(r)代人式(3.3-6)，并用s=r-(L-1)这样的事实验证新图像中的灰度的PDF是均匀的，即dr一品名J一D,(s)= p,(r)Tdsl其中，最后一步遵循了这样一个事实，即，是非负的并且假设L>1。正如所期望的那样，结果是一个均匀的PDF。对于离散值，我们处理其概率(直力图值)与求和来替代处理概率密度函数与积分"。正如前面提到的那样，一幅数字图像中灰度级，出现的概率近似为p,(r,)=元k =0,1,2,3.3-7）MN'其中,MMV》是图像中像素的总数，”。是灰度为，的像素个数，L是图像中可能的灰度级的数量(即对8比特图像是256)。正像本节开始说明的那样，与，相对的p,(r）图形通常称为直方图。式(3.3-4)中变换的离散形式为*. =70% =4L-D区A0,)=k =0,1,2, ….,L-1(3.3-8）MNO 先前声明的单调性条件同样适用于离散情形。我们简单地将变量的值限制为离散值这样，已处理的图像(即输出图像)通过式(3.3-8)将输入图像中灰度级为，的各像素映射到输出图像中灰度级为。的对应像素得到。在这个公式中，变换(映射) T(r）称为直方图均街或直方图线性变换。不难证明(见习题3.10)该变换函数满足本节前面所述的条件(a)和(b列3.5直方图均衡的简单说明。一个简单的例子来说明直方图均衡的工作原理是有帮助的。假设一幅大小为在继续之前，通过一64×64像素(MN = 4096）的3比特图像(L=8)的灰度分布如表3.1所示，其中灰度级是范围[0,L-1]= [0, 7中的整数。大小为64×64像素的3比特数字图像的灰度分布和直方图值表3.1PA70 = ./MN假设图像的直方图如图3.19(a)所示。直方图均衡变换函数的值使用式(3.3-8)得到。。例如，*. =7(6)=72P,0,)=72,6)=1.33类似地，有: =7(x)=7p,.(y)=7 ,.%)+7p,(+)=3.08及s.=4.55. 5 =5.67.s4 =6.23,5. =6.65, 6 =6.86, 5,= 7.00。该变换函数的形状为阶梯形状，如图3.196)所示。在这一点上，s值一直是分数，因为它们是通过求概率值的和产生的，因此我们要把它们近似为最接近的整数：s. =3.08→35 = 6.65→74.55.→5= 6.86→7S3 =5.67-这些是均衡后的直方图的值。很明显，只有5个不同的灰度级。因为。=0被映射为。=1，在均衡后的图像中有790个像素具有该值(见表3.1)。另外，在图像中有1023个像素取s=3这个值，有850个像素取$2=5这个值。然而，，和，,都被映射为同一个值6，所以在均衡后的图像中有(656+329= 985个像素取这个值。类似地，在均衡后的图像中有（24.+122+8)=448个像素取7这个值。使用M/=4096除这些数就得到了图3.19()所示的均衡后的直方图。因为直方图是PDF的近似，，而且在处理中不允许造成新的灰度级，所以在实际的直方图均衡应用中・很少见到完美平坦的直方图。因此，不像连续的情况，通常不能证明离散直方图均衡会导致均匀的直方图。然而，正像意将很快着到的那样，式(3.3-8)具有展开输入图像直方图的趋势，均衡后的图像的灰度。最终结果是增强了对比度。级跨越更宽灰度级范围。在本节前面、讨论了县有覆盖整个灰度范围的灰度值的许多优点。除了产生有这样的趋势的灰度之外，刚才推导的方法还有一个额外的优点，即它是完全“自动的”。换句话说，给定一幅图像.灰度变换与空间滤波直方图均衡化的处理仅涉及执行式3.3-82、该式以可直接从已知图像提取的信息为基础，而不需要更多的参数说明我们还注意到实现该技术所要求的计算的简单性。PsSk）P,(rk）7.0).25.15lr）0.10.050.053比特《8个灰度级)图像的直方图均衡示例：（a)原始直方图；Gb)变换函数；Cc)均衡后的直方图图3.19从s回到r的反变换形式表示为(3.3-9)k =0,1,2,(Ssk)，可以证明(见习题3.10)，只要灰度级r,k =0,1, 2, …,L-1在输入图像中一个也不缺，即图像直方图中没有哪个分量为0，反变换就满足条件(a)和(b)。尽管反变换不用于直方图均衡，但它在下一节研究的直方图匹配方案中起核心作用。例3.6 直方图均衡。图3.20左边一列显示了来自图3.16的4幅图像一列显示了对每一幅图像执行直方图均衡后的中间一结果。从上到下的前三种结果显示了重要的改进效果。正如所预期的那样，直方图均衡对第四幅图像未产生太大的效果，这是因为这幅图像的灰度已经扩展到了全部灰度级范围。图3.21显示了用于产生图3.20中均衡后的图像的变换函数。这些函效是使用式(3.3-8)产生的。很明显，变换(4)的形状近似为线性形状，这指出输入被映射为近似相等的输出。图3.20中的第三列显示了均衡后的图像的直方有趣的是，尽管这些直方图不同，但直方图均衡后的图像本身在视觉上却是非常相似的。但这并非，因为左边一列图像之间的差异仅仅是对是不希望的,比度上的，而不是内容上的。换句话说，因为图像有相同的内容，直方图均衡导致的对比度增强足以补偿图像在视觉上难以区分灰度级的差别。在给出原始图像间的重要对比度差别后，该例说明了直方图冬3.20左边一列：来自图3.16的图像。均衡作为自适应对比度增强工具的强大作用。中间一列：均衡后的相应图像。。石边一列：中间一列图像的直方图直方图匹配(规定化）3.3.2150如前所述，直方图均衡能自动地确定变换函数，该函数寻求产生有均匀直方图的输出图像。需要自动增强时，这是一种好方法，因为由这种技术得到的结果可以预知。并且这种方法实现起来Lusi数字图像处理(第三版）我们将在本节中指出，对于某些应用，采用均匀直方图的基本增强并不是最好的方法。特也很简单。别地，有时我们希望处理后的图像具有规定的直方图形状可能更有用。这种用于产生处理后有特殊直方图的方法称为直方图匹配或直方图规定化。(.3）图 3.21直方图均衡的变换函数。变换(1)到(4)是使用式(3.3-8由图3.20左边一一列图像(从上到下)的直方图得到的现在我们暂时回到连续灰度，和z(看成是连续随机变量)，并令n,(r)和p,(z）表示它们所对应的连续概率密度函数。在这种表示方法中，r和z分别表示输入图像和输出(已处理)图像的灰度级。而p,(2)是我们希望输出图像所具有的指定概率密度函数。们可以由给定的输入图像估计p,(r），一个有如下特性的随机变量:令s为一(3.3-10)s =T(r)=(L-1)]。p,(w)dw其中，如前面一样，w为积分假变量。我们发现这个表达式是式(3.3-4)给出的直方图均衡的连续形式。接着，我们定义一个有如下特性的随机变量z:(3.3-11）其中，1为积分假变量。由这两个等式可得G(2)=T(r)，因此z必须满足下列条件： G"[T(r)1=G"(s）(3.3-12）且由输入图像估计出p,(r），变换函数T(r)就可由式(3.3-10)得到。类似地，，因为p,(z)已知，变换函数G(z)可由式(3.3-11)得到。式(3.3-10)到式(3.3-12)表明，使用下列步骤，可由一幅给定图像得到一幅其灰度级具有指定概幸密度函数的图像：由输入图像得到p,(r)，并由式(3.3-10)求得s的值使用式(3-11)中指定的PDF求得变换函数G(z)。求得反变换函数z=G"(s）；因为z是由s得到的，所以该处理是。到z的映射，而后者正是我们期望的值。首先用式(3.3-10)对输入图像进行均衡得到输出图像；该图像的像素值是。值。对均衡后的图.50像中具有。值的每个像素执行反映射:.G"(s），得到输出图像中的相应像索。当所有的像素都处理完后，输出图像的 PDF将等于指定的PDF。第3章列3.7直方图规定化。假设采用连续灰度值，并假设一幅图像的灰度 PDF为p,0)=27(L-1P，0≤/<(L-1)，对于其他一个变换函数，使得产生的图像的灰度 PDF是p,.60=32*0L-D'，0<:6(L-D，寻找一值有p,(r)=0 4而对于其他z值有p,(z)=0首先，我们对区间[0,L-1]寻找直方图均衡变换：.=T(0)=4L-DJ。P,()dw=(L-1）由定义可知，对于范围[0,L.-1]外的值，该变换为0。输入灰度值的平方除以(L-1-将产生一幅灰度为。并具有均匀PDF的图像，因为这是早些时候讨论的直方图均衡变换。我们感兴趣的是具有规定直方图的图像，因此，我们在[0,L-1]区间寻找下一个直方图均衡变换:J。P-(w)dwG(z)=(L-1)(L-17由定义可知在该区间外这个函数也为0。最后，我们要求 G(2)=s，1但G(2)=2/(L-n)；因此z2/L-1* =s，并且有2=14-03.1"”如果我们用(L-D)乘以直方图均衡过的每一个像素，取该乘积的13 次幂，结果将是一幅我们所期望的图像，该图像在区间[0,L-1]内z的灰度的PDF为p,()=32/(L-n)因为s=r-/L-D，我们可以直接由输入图像的灰度r生成z:z=[L-1)s”-[L-DrP1(L-1(L-1)]这样，原图像中每一个像素值的平方与(L-1)相乘，然后再取该乘积的13 次幂，将得到其灰度级z具有规定PDF的图像。我们着到，均衡输入图像的中间一步可以跳过；我们需要的是得到将，映射为。的变英函数T(r)。然后，这两步可以合并为从r到z的一步变换。正如前边的例子所示，直方图规定化在原理上是简单的。在实践中，个共同的困难是寻找T(r)和G"的有意义的表达式。幸运的是，在处理离散量时，问题可被大大简化。这里仅希望得到-个近似的直方图，所以，付出的代价与直方图均衡一样。然而，不管这些，可以得到一些非常有用的结果，尽管结果是粗糙的近似。式(3.3-10)的离散形式是式(3.3-8)中的直方图均衡变换，为方便起见，我们重写如下：(3.3-13）与前面一一样，其中MV是图像的像素总数，n,是具有灰度值，的像素数，乙是图像中可能的灰度级数。类似地，给定一个规定的s。值，式(3.3-11)的离散形式涉及计算变换函数G4,)=4L-D艺,.45）(3.3-14)i=0对一个q值，153G(z,)= 5(3.3-15）其中，P.(z）是规定的直方图的第立个值。与前面一样，我们用反变换找到期望的值。(3.3-16）一个s值给出一个z值；这样，就形成了从s到z的一个映射。换句话说，该操作对每实践中，我们不需要计算G的反变换。因为我们处理的灰度级是整数(如8比特图像的灰度级是人0到255)，，使用式(3.3-14)计算g=0,1,2,.…,L-1时的所有可能G值是一件简单的事情。标定这些并四舍五入为区间[0,L-1]内的最接近整数。将这些值存储在一个表中。然后，给定一个特殊的意，我们是从0开始计数的)，故6s是式(3.3-15)的最优解。这样，给定的s值就与z6s关联在一起(即规定的。值将映射为zs）。因为z项是用于规定的直方图,(z)作为基础所用的灰度，它遵循我们将找到每个。值到z,值的映射，它们是式(3.3-15)的最接近的解。这些映射也是直方图规定化问题的解。回忆s。是直方图均衡后的图像的值，我们可以总结直方图规定化过程如下:计算给定图像的直方图 p,()，并用它寻找式(3.3-13)的直方图均衡变换。把。四舍五入为范围[0,L-1]内的整数。用式(3.3-14)对4=0,1, 2,…,L.-1计算变换函数G的所有值，其中p,(z;)是规定的直方图的值。把G的值四舍五人为范围I0, L-11内的整数。将G的值存储在一个表中。对每一个值s。,人 =0.1.2.,L-1，使用步骤2存储的G值寻找相应的z,值，以使G(z,)最接，并存储这些从s到z的映射。当满足给定s,的z,值多于一个时(即映射不唯一时)，按近sx，贯例选择最小的值。首先对输入图像进行均衡，然后使用步骤3找到的映射把该图像中的每个均衡后的像素值。映射为直方图规定化后的图像中的相应z,值，形成直方图规定化后的图像。正如连续情况那样，均衡输入图像的中间步骤是概念上的。它可以用合并两个变换函数T和G"跳过这一步，如例3.8所示。如早些时候提到的那样，对于满足条件(a'）和(b)的G"，G必须是严格单调的，根据式(3.3-14)它意味着规定的直方图的任何p-(z,)值都不能为零(见习题3.10)。当工作在离散数值的情况时，该条件可能不满足的事实并不是一个严重的实现问题，如上面的步骤3中指出的那样。下面的例子用数字兑明了这一情况。例3.8直方图规定化的一个简单例子。再次考虑例3.5中大小为64×64的假设图像，其直方图重复显示在图3.22a)中。希望变换该直方图，以便使其具有表3.2中第二列规定的值。图3.226)显示了该直方图的大概形状。表3.2规定直方图和实际直方图(第三列的值来自例3.8中的计算结果）规定的口。(亿实际的p,(z208.00.00,15蓝菜L55第3章810.102.10图3.22一幅3比特图像的直方图；（b)规定的直方图；c)从规定的直方图得到的变换函数；(a)执行直方图规定化的结果。请比较图(6)和图(d过程的第一步是得到标定的直方图均衡后的值，就像在例3.5中那样：56 =7S3 =6 Ss =787 =7S1=3接着，我们使用式(314)来计算变换函数G的所有值：G(zo)=7,八,(z)=0.0类似地，有G4z)=72A46,)=71"ko)+ a,)1= 0和G(z,)=0.00,G(z4)=2.45,G(zs)=5.95,G(z,)=1.05,G(z,)=4.55,G(z,)=7.00如例35那样，要把这些分数值转换为有效区间[0,7]内的整数。结果是G(z)= 0.00→0 G(k4)= 2.45→2G4L)=0.00一2。G(z)=0.00-→0G(z6)=5.95今6G(z)=1.05→1G(z)=7.00→7这些结果总结在表3.3中，变换函数画在图3.22（c)中。观察发现G并不是严格单调的，所以违反了条件(a’）。因此，我们使用算法的步骤3中描述的方法来处理这种情况。在过程的第三步中，我们找到z,的最小值，所以值G(z,）最接近s。我们对每一个s值这样做，以“生从s到z所需要的映射。例如，、50=1，我们看到G(z)=1，在这种情况下，这是完美的匹配，因此找们看对应。→乙。也就是说，，直方图均衡后的图像中的每个值为1的像素映射为直方图规定化后的图[755像中(相应位置上)的值为3的像素。继续采用这一方法，我们得到表3.4中的映射。157数学图像处理(第三版）将所有的岛。值映射到相应的z,值表3.3变换函数G关于z的所有表3.4可能值(已四舍五入并排序.0=元.=6在过程的最后一步中，我们使用表3.4中的映射把真方图均衡后的图像中的每个像素映射为新创建的直方图规定化图像中的相应像素。结果直方图的值列在表3.2的第三列，直方图画在图322 4)中。 P-(Gz,）的值是使用例3.5中的相同过程得到的。。例如，我们在表3.4中看到,s=1映射为z=3，在直方图均衡后的图像中有790个像素取1值。因此，P-(kz)= 790/4096=0.19。虽然示于图3.22（)中的最终结果并不完全与规定的直方图匹配，但我们达到了将灰度明确地移向灰度级高端的目的。正如早些时候提到的那样，得到直方图均衡后图像的中间步骤对于解释该过程是有帮助的，但它并不是需要的。相反，我们可以在表中的第三列列出从r到s的映射和从s到z的映射。然后，我们使用这些映射把原始像素直接映射到直方图规定化后的图像的像素。例3.9直方图均衡与直方图匹配的比较。图3.23(a)显示了火星卫星(Phobos)图像，，该图像由 NASA的火星表面探测器拍摄。图3.23(6b)显示了图32340的真力图。图像的大部分是暗色区域，产生了像素集中于灰度级暗端的直方图的特点。乍看之下，会得到直方图均衡化是增强该图像的一个好办法的结论，以便使暗区域的细节更清楚。下面的讨论将证明事实并非如此。128灰度图 3.23(a)由NASA的火星表面探测器拍摄的火星卫星(Phobos)图像；G)直方图(原图像由NASA提供)图324a)显示了由图.3.236)所示直方图得到的直方图均衡变换汇式3.3:8或式53.3-131。这个变换函数最相关的特征是它从灰度0快速上升到接近190。这是因为输入直方图中有大量的像素灰度接近0。、”以获得直方图的均衡效果时，最终结果是把非常窄的暗像素区间映当这种变换应用于输入图像的灰度，射到输出图像灰度级的高端。因为输入图像的大量像素在此区间有精确的灰度值，，所以我们希望结果是“冲淡”。如图3.246)所示，情况确实如此。该图像的直方图示于图3.24(c)。注具有明亮、外观的图像。意，所有灰度级基本上都偏向了灰度范围的上半部。灰度变换与空间滤波渝入灰度7.00 老灰度图3.24(a)直方图均衡的变换函数；的外观)；(c)图(b)的直方图由于图3.24a)中变换函数的问题是由原图像中大量灰度接近于。的像素引起的，一种合理的方法是修改图像的直方图，以便使其不再有这一属性。图3.25 (a)显示了一个人为规定的函数，该函数保持了原有直方图的基本形状，但在图像灰度暗区的灰度值却有更平滑的过渡。将这个函数取样为256个等间隔的离散值，就生成了所需的规定的直方图。使用式(3.3-14)从这一直方图得到的变换函数G(z)，，该变换，由式(3.3-16)(使用前面讨论的逐步过程得到)导出的反变换函在图3.25 (6)中标注为变换(1)。类似地，数G"s)在图3.25(6)中标注为变换(2)。图3.25 (e)中增强后的图像是把变换(2)用于图 3.24 (b)中直方图均衡化后的图像的像素得到的。比较这两幅图像可以看出，在使用直方图均衡得到的结果的基础上，直方图规定化图像的改进是很明显的。注意,原始直方图的细小改变会使图像的外观得到显著改进。图3.25 (d显示了图3.25(C)的直方图。该直方图最容易辨别的特征是其低端已向右移向灰度级的较亮区域(但并不过分)，这正是我们所希望的。到目前为正，虽然我们对直方图规定化已经很清楚了，但在结束这一节之前，我们要强调直方图规定化在大多数时候都是试凑过程。这正像前边的例子中我们所做的那样，个可用的指导路线是书手边的问题学习。但是，有时可能会遇到这样的情况，即定义平均”直方图的外观，并把它作为一种直接的处理。然而，一般来说，并没有规规定的直方图。在这种情况下，直方图规定化就变成了一定直方图的规则，对于任何一个给定的增强任务都必须借助于实际分析。局部直方图处理3.3.3前两节讨论的直方图处理方法是全局性的，在某种意义上，像素被基于整幅图像的灰度分布的变换函数修改。虽然这种全局方法适用于整个图像的增强，但存在这样的情况，增强图像中小区域的细158节也是需要的。这些区域中，，一些像素的影响在全局变换的计算中可能被忽略了，因为全局变换没有必要保证期望的局部增强。解决方法是以图像中每个像素的邻域中的灰度分布为基础设计变换函数手王(a)规定的直方图；(b)变换；图3.25(c)使用曲线(2)映射得到的输入灰度增强图像；d)图(G)的直方图王5.50灰度前面描述的直方图处理技术很容易适应局部增强。该过程是定义一一个邻域，并把该区域的中心个像素移至另一个像素。在每个位置，计算邻域中的点的直方图，并且得到的不是直方图均衡化就是规定化变换函数。这个函数最终用于映射邻域中心像素的灰度。然后，邻域的中心被移至个相邻像素位置，并重复该过程。当邻域进行逐像素平移时，由于只有邻域中的一一行或一列改变、所以可一步移动中，以新数据更新前一一个位置得到的直方图(见习题3.12)。这种方法与区域每移动像素位置就计算邻域中所有像素的直方图相比有明显的优点。有时用于减少计算量的另一种方法是使韦非重叠区域，，但这种方法通常会产生我们不希望的效应。“棋盘”列3.10局部直方图均衡。图3.26 (a)显示了一幅大小为512×512的8比特图像，初看之下，该图像在灰色背景上包含5个黑色方块。图像有轻微的噪声，但是噪声感觉不到。图3.26 6)显示了全局直方图均衡的结果。当用直方图均黄平滑噪声区域时，情况经常如此。该图像显示噪声明显地增强了。然而，除了噪声之外，图3.26)与原图像相比并未显示新的重要细节，只是不明显地给出了左上方和右下方方块中包含有一个物体。图3.26）是使用大小为3×3的邻域的局部直方图均衡得到的。这里，我们看到了包含在暗色方块中的物体。这些物体的灰度值太接近大方块的灰度，而且它们太小，全局直方图均衡化不足以影响这些细节的显示。灰度变换与空间滤波85冬 3.26（a)原图像；の)全局直方图均衡的结果；（c)使用大小为3×3的邻域对图(a)应用局部直方图均衡的结果在图像增强中使用直方图统计3.3.4直接从直方图获得的统计参数可用于图像增强。令，表示在区间[10,L-1]上代表灰度值的一一个离散随机变量，并令u)表示对应于，值的归一化直方图分量。如前面指出的那样，我们可以把p(r）看成是得到直方图的那幅图像的灰度，出现的概率的估计。像2.6.8 节讨论的那样，r关于其均值的n阶矩定义为(3.3-17）A,(r）-my" p(Tr）其中，m是r的均值(平均灰度，即图像中像素的平均灰度)：找们遵守使用m 来表示均值的约。请不要将它与用于表示一一个大x D(r）(3.3-13）小为mxn的邻域的行数的相同符号混淆，因为在表示邻域的行数时，我们也遵守了符号表示约定。二阶矩特别重要：从L(r)=r-m) p(r）(3.3-19）我们将该表达式称为灰度方差，通常用α’表示《回忆一下，标准差是方差的平方根)。均值是平均灰度的度量，方差(或标准差)是图像对比度的度量。显然，一旦从给定的图像得到了直方图，用前边的表达式就很容易计算所有的矩。在仅处理均值和方差时，实际上通常真接从取样值来估计它们，而不必计算真方图。近似地，这些估计称为取样均值和取样方差。它它们可以根据基本的统计学由下面熟悉的形式给出：:7(x.）(3.3-20）式（3.3-21中的分母有时写为1而不是MN。这样做的目ESurax-的是获得方差的一个所谓的无偏3.3-21）*=0 =0但是、我们对式(3.3.21和武(33192在后一公式中的真方图其中，x=0,.1,2.…,M -1, y=0,1,2,…,N-1。换句话说，众所周式(3.3:21)使用的同一幅图像计知，一幅图像的平均灰度可以由求所有像素的灰度值之和并用图像中致更感兴趣。因此,我们要求MN，项。对于实际大小的的像素总数去除而得到。。类似的解释适用于式(3.3-21）。如下面的例任何图像，差别可以忽略不计。子所示,使用这两个公式得到的结果等同于使用式(3.3-18)和式(3.3-19)lu63得到的结果，，前提是这些公式中使用的直方图是由式(3.3-20)和式(3.3-21)中使用的同一一幅图像计算得到的。例3.11直方图统计计算・在继续讨论之前，通过一一个简单的数字例子巩固一一下概念是有必要的。考虑下面的大小为5×5的2比特图像：像素由2比特表示；因此，L=4且灰度级在[0,3]范围内。。总像素数是25，因此，直方图分量为=0.28=0.24、p(ro)=p(7)=22:=0.28,=0.20P02)=其中，p(n)中的分子是具有灰度级，的图像中的像素数。我们可用式(3.3-18)计算图像中灰度级的平均值：p(r)=(00.24+0.28+(20.28+(30.20 =.4令f(x,y)表示前面的5×5阵列，使用式(3.3-20）我们得到f(x,y)=1.44 y=0如期望的那样，结果一致。类似地，使用式(3.3-19)或式(3.3-21)得到的方差相同(均为1.1264)。我们考虑用于增强目的的均值和方差的两种应用。全局均值和方差是在整幅图像上计算的，对于全面灰度和对比度的总体调整是有用的。这些参数的一种更强有力的应用是局部增强，在局部增强中，局部均值和方差是根据图像中每一像素的邻域内的图像特征进行改变的基础。令(x,J)表示给定图像中任意像素的坐标，S.,表示规定大小的以(x,y)为中心的邻域(子图像）该邻域中像素的均值由下式给出：3.3-22iPs.（v）富其中，Ps。是区域S中像素的直方图。该直方图有L个分量，对应于输入图像中L个可能的灰度值然而，许多分量是0，具体取决于S,的大小。例如，如果邻域大小为3×3且L.=256，那么该邻域的直方图的256个分量中仅1和9之间的分量非零。这些非零值将对应S。中的不同灰度数(在3×3区域中可能的不同灰度的最大数是9，最小数是1)。类似地，邻域中像素的方差由下式给出：3.3-23）=0164和前面一样，局部均值是邻域S,中平均灰度的度量，局部方差(或标准差)是邻域中灰度对比度的度灰度变换与空间滤波量。对邻域、我们可写出类似于式(320)和式(3.3-21)的表达式，即简单地对邻域中的像素值求和并除以邻域中的像素数。正如下面的例子说明的那样，使用局部均值和方差进行图像处理的一一个重要方面是它的灵活性，它们提供了简单而强有力的基于统计度量的增强技术，而统计度量与图像的外观有紧密的、可预测的关系。列3.12使用直方图统计的局部增强。一根绕在支架上的钨丝的SEM(扫描电子显微镜)图像。图像中央的钨丝及其支架很图3.27(a)显示了一清楚并很容易分析。在该图像的右侧即图像的暗侧，有另一一根钨丝的结构，但几乎不能察觉到，其大小和特征当然也不容易辨认。通过对比度操作进行局部增强是解决这种图像中包含部分隐含特征问题的理想方法图 3.27(a)放大了约130倍的钨丝的SME图像；b)全局直方图均衡的结果；；(C)使用局部直r先生提供)方图统计增强后的图像(原图像由俄勒冈大学地质科学系的Michael Shaffer在这种特殊情况中，向题是增强暗色区域，但同时尽可能保留明亮区域不变，因为明亮区域并不需-种增强方法，这种方法能分辨暗区域与亮区域的不同要增强。我们可以使用本节介绍的概念来阐明一司时只增强暗区域。判断一一个区域在点G,y)是暗还是亮的方法是把局部平均灰度ms。与表示为me并称之为全局均值的平均图像灰度进行比较。。这种量可使用整个图像并用式(3-18)或式(3.3-20)得到。这样，我们就有了增强方案的基础：如果m,。. komc，其中如是一个值小于1.0的正常数，那么我们将把点Kx,y)处的像素考虑为处理的候选点。因为我们感兴趣的是增强低对比度的区域，所以还需要一种度量方法来确定一个区域的对比度是否可作为增强的候选点。因此，、如果αs,。s kzo。，则则认为在点(x,y)）处的像素是增强的候选点，其中α。是由式(3.3-19)或式(3.3-21)得到的全局标准差，人为正常数。如果我们的兴趣是增强亮区域，则该常数大于 1.0，对于暗区，则小于1.0。最后，我们需要限制能够接受的最低的对比度值，否则该过程会试图增强标准差为零的恒定区域。因此，我们通过要求ko ≤Os,，k<人，对局部标准差设置一个较低的限制值。满足局部增强所有条件的一个位于点(x,y)处的像素，可简单地通过将像素值乘以一个指定常数E来处理，以便相对于图像的其他部分增大(或减小)其灰度值。。不满足增强条件的像素则保持不变。以上增强方法可总结如下:含（(x,y)）表示在图像任意坐标(x,y)）处的像素值，而令g(x.y)）表示这些E・f(x,))。ms,S kome且koeSos.,<kaOc(3.3-24）8(x,y)=Lf(x,y)其他其中，如前所述、E.如:，和如是规定的参数：m。是输人图像的全局均值：α。是输入图像的标准差。.64参数ms。和O。分别是局部均值和标准差。按惯例，M和N是图像行和列的维数。数字图像处理(第三版）式(3.3-24)中选择参数需要做一些试验，以熟悉一幅给定的图像或一类图像。泉。在这种情况下，通常，常常选择下列数值：E== 4.0,人。=0.4,k =0.02和k, =0.4。之所以对E选择相对较低的值 4.0.原因在于当E与将被增强区域(暗色区域)中的灰度相乘后，结果仍会趋于灰度级的暗端，从而保持图像的视觉平衡。选择的如值比全局均值的一一半略小，因为我们观察一幅图像时，，我们了解到需要增强的区域确实比一半还要暗。类似的分析可指导人和k值的选择。这些常数的选择通常并不困难，但这些全局平均值的一明确的选择必须以对具体增强问题的逻辑分析为指导。最后，为保留细节和尽量减少计算负担，局部区域S,的大小应尽可能小。因此，我们选择大小为3×3的小区域。作为比较的基础，我们使用全局直方图均衡增强一一幅图像。。图3.276)显示了这一结果。暗区域被改进了，但辨别细节还是很困难、亮区域也变化了，这是我们不想做的事情。图3.27(C)显示了使用上面描述的局部统计方法处理的结果。该图像与图3.27a)中的原图像或图3.276)中经直方图均衡后的结果相比、我们注意到，图3.27(e)的右边显示出了明显的细节。观察该例子，暗灯丝中的脊线现在非常清楚。值得左侧的亮灰度区域被完整地保留了，这是我们的初始目的之一主意的是，3.4空间滤波基础在这一节，我们介绍空间滤波图像处理的几个基本概念。空间滤波是图像处理领域应用广泛的主要工具之一。因此，我们应充分理解这些基本概念。正如在本章开始时提到的那样，本节的例子多数涉及使用空间滤波来增强图像。空间滤波的其他应用将在后面几章中讨论。滤波一词借用于频域处理，频率域处理是下一章的主题，在下一章中，“滤波”是指接受(通过)。例如，通过低频的滤波器称为低通滤波器。低通滤波器的最终效果是模糊或拒绝一定的频率分量。平滑)一幅图像。我们可以用空间滤波器(也称为空间掩模、核、模关于线性的讨论、请参阅2.6.2 节板和窗口)直接作用于图像本身而完成类似的平滑。事实上，如第4章所示，线性空间滤波与频率域滤波之间存在一一对应的关系。然而，空间滤波可提供相当多的功能,就像您稍后将要看到的那样，它们还可用于非线性滤波，而这在频率域中是做不到的。空间滤波机理3.4.1在图3.1中，我们简单解释过，空间滤波器由(1)-一个邻域(典型地是一个较小的矩形)，（2)对该邻域包围的图像像素执行的预定义操作组成。滤波产生一一个新像素，新像素的坐标等于邻域中心的坐际，像素的值是滤波操作的结果・。。滤波器的中心访问输入图像中的每个像素，就生成了处理(滤波)后的图像。如果在图像像素上执行的是线性操作，则该滤波器称为线性空间滤波器。否则，、滤波器我们重点关注线性滤波器，然后，说明某些简单的非线性滤波器。就称为非线性空间滤波器。首先，我5.3 节将包含更多的非线性滤波器及其应用的更全面的内容。图3.28说明了使用3×3邻域的线性空间滤波的机理。在图像中的任意一点(x,y)，滤波器的响应g(x,y)是滤波器系数与由该滤波器包围的图像像素的乘积之和：g(x, y)= w(-1,-1),f(x-1,y-1)+ w(-1,0)f(x-1, y)+:・+w(0,0) f(x,y)+…+ w1,1),f(x+1, y+1）退明显，滤波器的中心系数w(O,0)对准位置(x,y)的像素。对于一个大小为mxn的模板，我们假设m = 2a+1且n=2b+1，其中a,b为正整数。这意味着在后续的讨论中，我们关注的是奇数尺寸的滤）速波源后的像春货通带会颗输新创建经像中9对旗位算、以容纳滤波的结果。建波后的像素代替原图像中对应位置的自的情形很161少见，因为这会在改变图像内容的同时执行滤波操作灰度变换与空间滤波39波器，其最小尺寸为3×3般来说，使用大小为mxn的滤波器对也可以使用偶数尺寸的滤当然，大小为M×N的图像进行线性空间滤波，可由下式表示:安器，或使用混合有偶数凡尺寸的滤波器，但是、使用奇数尺Sw6s,1) /(x+s,y9+10）g(x,y)三因为滤波器的中・心洛在整数值上其中，x和y是可变的，以便w中的每个像素可访问f中的每个像素。图像原点纽像像素留像f(x, y-1）JGx,Jy下万比图 3.28使用大小为3×3的滤波器模板的线性空间滤波的机理。表示滤波器模板系数的坐标所选择的形式简化了线性滤波的表达式3.4.2空间相关与卷积在执行线性空间滤波时，，必须清楚地理解两个相近的概念。一个是相关，，另一个是卷积。如前节描述的那样，相关是滤波器模板移过图像并计算每个位置乘积之和的处理。。卷积的机理相似，但滤波器首先要旋转180°。解释这两个概念的区别的最好方法是举一个例子。我们从一个一维示例开始图3.29(a)显示了维函数f和一个滤波器w，图3.29(6)显示了执行相关的起始位置。我们主意到的第一件事情是存在未覆盖的部分函数。该问题的解决办法是在了的任意一侧补上足够的0，如果滤波器以便使w中的每一个像素都可访问到f中的每一个像素。零填充并不是唯一的选择。例如的尺寸是m，那么我们需要在f的一侧补m-1个0。图 3.29（Ce)显示我红可在工的两侧复制第一个元素和一个值是如图 3.29(C)所示的初始位适当填允过的函数。相关的第一元素和最后一个元东置的f和w的乘积之和(乘积之和为0)。这相当于位移X=0。为了得为填充使用镜像后的值到相关的第二个值，我们把w向右移动一一个像素位置(位移x=1),并计算乘积之和。结果还是.0。事实上，当x=3时才第一次出现非零结果，在这种情况下，w中的8覆盖f中的1，相关的结果是8。按这种方法进行，我们可以得到图3.29(R)中的全部相关结果。注意，|167x取了12个值(即。=01.2.，11使w滑过，、以便w中的每一个像素访问了中的每一个像素。通90常，我们喜欢使用大小与f相同的相关阵列，在这种情况下，我们将全部相关结果裁剪到原函数大小如图3.29 (h)所示。卷积钼关原点原点旋转了180°的・0 0 0 10 0 0 1 0 0 0 01)0 0 11 0 0 0 02 3 2开始位置对齐零填充co 。 。 99。01 00。 06。。6D 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0（k）2 3 2 82 3 2 1(d） 0 0。。。 。01 0 0 0 0 0 0 000 0 0000 0 1 0 0 0 0 0 0 0 0(0）8 2 3 2 12 3 2 8一移动一次后的位置(e）O 0 0 0 0001 00 0 0 0 0 0 0 0 0 0 0001 0 0 0 0 0 0 0 0(m）2 3 2 83 2 3 2 1移动四次后的位置f） 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 02 3 2 88 2 3 2最终位置全部相关结果全部卷积结果0 0 0 8 2 3 2 1 00002 3 2 8 0 0000 0 00）裁剪后的相关结果戈剪后的卷积结果 8 2 3 21 0 0 3 2 8 0 0h)P）图3.29具有离散单位冲激的滤波器的一维相关与卷积的说明有两个要点需要注意，第一，相关是滤波器位移的函数。从前一一段的讨论可知，换句话说，相关的第一个值对应于滤波器的零位移、第二个值对应于一一个单元位移，等等。第二，滤波器w与包含有全部，和单个1的函数相关，得到的结果是w的一。我们将包含单个1一个拷贝，，但旋转了180°而其余都是0的函数称为离散单位冲激。因此，我们得出结论：一个函数与离散单位冲激相关，在该冲激位置产生这个函数的一一个翻转的版本。卷积的概念是线性系统理论的基石。正如您将在第4章学到的那样，卷积的基本特性是某个函数与某个单位冲激卷积，得到一个在该冲激处的这个函数的拷贝。在前一段中我们着到，相关操作也一个拷贝，但该拷贝旋转了180°。因此，如果我们预先旋转滤波器，并执行相同的滑动导到函数的乘积求和操作，就应该能得到希望的结果。如图3.29右边一列所示的注意，旋转180等同于水平翻转那样，情况的确如此。由此，我们着到，为了执行卷积，我们需要做该函数。然后执行相关中的相同操作。正如其结果一个函数旋转180°的是把一所示，我们旋转两个函数的做法没有区别。169如图3.30所示，前面的概念很容易扩展到图像。对于大小为mxn的滤波器，我们在图像的顶部和弟3章1-1行0，在左侧和右侧填充n-1列0。在这种情况下・m和”等于3，因此、如图30.0）底部至少填充m-我们用两行0填充图像的项部和底部，用两列0填充图像的左侧和右侧。。图3.30(6)显示了执行所示，我图 3.30e)显示了裁剪后相关操作的滤波器模板的初始位置，图3.30(d)显示了所有相关操作的结果。的相应结果。再一次注意到，结果旋转了180°，与前面一样，。对于卷积，我们预先旋转模板，然后使用刚才描述的方法对乘积做滑动求和操作。图3.30(f)到(Gh)显示了在二维情况下，旋转180°等同。懋再次看到，一个函数与一个冲激卷积，在该冲激的位置复制节宋个坐标轴再次翻转模板。了这个函数。。这很清楚，如果滤波器模板是对称的，相关和卷积将得到相同的结果。真充后的厂京点了(x,y）全部相关结果战剪后的相关结果后的卷积结果全部卷积结果:的w图3.30二维滤波器与二维离散单位冲激的相关(中间一行)和卷积(最后一行)。为便于视觉分析，0显示为灰色替代包含单个1，如果图 3.30 中的图像f包含，完全相等的区域，当w位于f的区域的一化后)的值将是最大的。这样，正像您将在第12章看到的那样，相关还可以中心时，相关函数(归用于寻找图像中的匹配以公式形式总结一一下前面的讨论一个大小为mx”的滤波器wx,y)与一一幅图像f(x,y)做相关操作，可表示为wαx,)女/(,y)，它由上一节末尾列出的公式给出，为方便起见我们重写如下上艺s.0/6+.+）wx./(,= (3.4-1）170|这一等式对所有位移变量。和y求值，以便w的所有元素访问/的每一个像素，其中我们假设了已被a =(m-1)/2.5=(n-D/2，同时，为表示方便，我们假设适当地填充。正如早些时候解释的那样，n和n是奇整数。w(x,y)和f(Cx.y)的卷积表示为wx.Jy)* （(x,)D。它由下式给出:类似地，通常，合含义明确的情况找们用(3.4-2）w(x,y)女f(x, y)=w(s,n)f(rx-s,y-1)西数s:、，而不利:的结果。参见前一节末尾的等其中等式右侧的减号表示翻转f(即旋转180°）。为简化符号表示，我例如，式和式(3.5-12们遵循惯例，翻转和移位w而不是f。结果是一样的。与相关一样，该式也对所有位移变量x和y求值，因此，的每一个元素访问f中的每一个像素，声同样我们也假设f已被适当地填充了。您可以对3×3模板展开式(3.4-2)，并自己证明使用该式的结果与图3.30中的例一样的。在实践中，我们常常用一一个算法实现式(3.4-1)。如果我们想要执行相关，可将w输入广是到算法中；如果要执行卷积，可将旋转180°后的w输入到算法中。反过来，如果代之以执行式(3.4-2也是可用的如之前提及的那样，卷积是线性系统理论的基础。我们将在第4章中学到，一个函数与单位冲激的卷积，相当于在单位冲激的位置处复制该函数，这一特性在大量重要的推导中扮演核心的角色我们将在第4章关于傅里叶变换和卷积定理的内容中再次回顾卷积。然而，不像式(3.4-2)，我们将要处理的卷积是相同尺寸的。公式的形式是一样的，但求和限不一样。使用相关或卷积执行空间滤波是优先选择的方法。事实上，因为无论是式(3.4-1）还是式(3.4-2),都可以通过简单地旋转滤波器去执行其功能，重要的是在给定的滤波任务中，按对应于期望操作的方式来指定滤波器模板。本章中的所有线性空间滤波结果都基于式(3.4-1)。您很可能会遇到卷积滤波器、卷积模板或卷积核这些术最后，我们指出，在图像处理文献中，按惯例，这些术语用来表示一种空间滤波器，并且滤波器未必用于真正的卷积。类似地，模板与图像的卷积通常用于表示我们刚刚讨论的滑动乘积求和处理，而不必区分相关与卷积间的差别。更合适的是，它通常用于表示两种操作之一这一不太严密的术语是产生混淆的根源。3.4.3 线性滤波的向量表示当我们的兴趣在于相关或卷积的模板的响应特性R时，有时写成乘积的求和形式是方便的:关于向量和矩阵的基本知(3.4-3）R=WZ,+W2.++*mZn请读者查阅本书网站上的识，utorials 部分。一个大小为mxn的滤波器的系数，z为由滤波器覆盖的相其中w项是应图像的灰度值。。如果我们的兴趣是使用式(3.4-3)来做相关，我们可用给定的模板。。为了使用相同的公式进行卷积操作，，如上节描述的那样，我们可以简单地把模板旋转180°。它意味着式3.4-3)对特定的坐标对G）是成立的。在下一一节中，您将了解为什么这一表示法对于描述给定的线性滤波器的特性是方便的。图3.31作为一个例子，图3.31显示了一个带有标号的普通3×3模板。在这普通3×3滤波器模板的另一种表示种情况下，式(3.4-3变为171BO因为登帮满足交换律，故有w以.,*/,- *,*w4x,，相关则不满足交换律，这一点可通过般到32930中函数的顺序看出。第3章933.44）其中，w是由模板的系数形成的9维向量，z是由模板包含的图像灰度形成的9维向量空间滤波器模板的产生3.4.4个模板系数，这些系数是根据该滤波器支主成-个大小为mxn的线性空间滤波器要求指定mn持什么样的操作来选择的，记住，我们使用线性滤波所能做的所有事情是实现乘积求和操作。例如，假设我们想要将图像中的这些像素替换为以这些像素为中心的3×3邻域的平均灰度。在图像中任意位置(Gx,y)的灰度平均值是以(x,y)为中心的3×3邻域中的9个灰度值之和除以9。令z,i=1.2.,9表示这些灰度，那么平均灰度为但该式与系数值为w, =1/9的式(3.4-4)相同。换句话说，使用系数为1/9 的3×3模板进行线性滤波操作可实现所希望的平均。正如我们在下一节中将要讨论的那样，这一操作将导致图像平滑。在下面几节中，我们讨论基于这种方法的其他几个滤波器模板。在某些应用中，我们有一个具有两个变量的连续函数，其目的是基于该函数得到一个空间滤波模板。例如，一个具有两个变量的高斯函数有如下基本形式:hkx,y)=e 其中，o是标准差，并且，通常我们假设坐标：和，是整数。譬如，为了从该函数产生一个大小为3×3的滤波器模板，我们关于其中心进行取样。这样，就有w,=4-.-2:2.41:.0.…w. = 4(1. D。使用类似的方式可产生一个mxn滤波器模板。回顾一下，二维高斯函数具有钟形形状,并且其标准差控制钟形的“"紧度”产生非线性滤波器要求我们确定邻域的大小，以及将对包含在邻域内的图像像素执行的操作例如、回忆可知最大操作是非线性的见2.6.2节)，、以一幅图像中任意一点α,y)为中心的一一个5×5最大滤波器得到 25个像素中的最大灰度值，并将该值赋给处理后图像中位置为(α,y)的像素。非线性滤波器功能非常强大，正如我们在本章稍后和第5章中所显示的那样，在某些应用中它可执行超出线性滤波器能力的功能。平滑空间滤波器3.5平滑滤波器用于模糊处理和降低噪声。模糊处理经常用于预处理任务中，例如在（大）日标提取之前去除图像中的一些琐碎细节，以及桥接直线或曲线的缝隙。通过线性滤波和非线性滤波模糊处理，可以降低噪声。3.5.1平滑线性滤波器平滑线性空间滤波器的输出(响应)是包含在滤波器模板邻域内的像素的简单平均值。这些滤波器有时也称为均值滤波器。正如前节提到的那样，，也可以把它们归入低通滤波器。173|平滑滤波器的基本概念非常直观。它使用滤波器模板确定的邻域内像素的平均灰度值代替图像[174中每个像素的值，这种处理的结果降低了图像灰度的“尖锐”变化。由于典型的随机噪声由灰度级94常见的平滑处理应用就是降低噪声。。然而，由于图像边缘(几乎总是的急剧变化组成，因此一幅图像希望有的特性)也是由图像灰度尖锐变化带来的特性，所以均值滤波处理还是存在着不希望有的边缘模糊的负面效应。。另外，这类处理的其他应用包括如2.4.33节讨论过的由于灰度级数量不足而引起的伪轮廓效应的平滑处理。，其中“不相关”是指均值滤波器的主要应用是去除图像中的不相关细节，与滤波器模板尺寸相比较小的像素区域。这将在这一一节稍后的应用中加以说明。第一个滤波器产生模板下方的标准像素平均值。把模板系图3.32 显示了两个3×3平滑滤波器。数代入式(3.44)即可清楚地看出这一点：R是由模板定义的3×3邻域内像素灰度的平均值。注意，代替上式中的1/9，滤波器的系数全为“I”这里的概念是系数取Ⅰ值时计算更有效。在滤波处理之后，整个图像除以 9。一个mxn模板应有等于 I/mn的归一化常数。所有系数都相等的空间均值滤波器有时称为盒状滤波器。图3.32所示的第二个模板更为重要一些。该模板产生所谓的加权平均，使用这一术语是指用不同的系数乘以像素，即一一些像素的重要性(权重)比另一一些像素的重要性更大。在图3.32(b)所示的模板F，处于该模板中心位置的像素所乘的值比其他任何像素所乘的值都要大，因此，在均值计算中为该象素提供更大的重要性。。其他像素如同是模板中心距离的函数那样赋以成反比的权重。由于对角项离中心比离正交方向相邻的像素(参数为√2)更远，所以它的权重比与中心直接相邻的像素更小。赋予F心点最高权重，然后随着距中心点距离的增加而减小系数值的加权策略的目的是在平滑处理中试图峰低模糊。我们也可以选择其他权重来达到相同的目的。然而，图3.32 (b)所示模板中所有系数的和等于 16，对于计算机计算来说是一个有吸引力的特性，因为它是2的整数次幂。在实践中，由于这些模板在一幅图像中任何一一个位置所跨过的区域很小，通常很难看出使用图3.32中的各种模板或类似方式进行平滑处理后的图像之间的区别。ab图3.32两个3×3平滑(均值)滤波器模板。每个模板前面的乘数等于1除以所有系数之和，这是计算平均值所要求的参见式(3.4-1)，幅M×》的图像经过一个大小为mxn(m和n是奇数)的加权均值滤波器滤波的过程可由下式给出：w心S, ).f(x+s, y+1）(3.5-1）2wSs,1）上式中的参数见式(3.4-1)中的定义。正如前面说过的那样，它可以这样理解，即一幅完全滤波的图像是通过对:=0:1.2，M-1和x.1.2元.M-1执行式3.5-1得到的。式(3.5-1中的分母部分1741简单地表示为模板的各系数之和，它是一一个仅需计算一次的常数。L第3章灰度变换与空间滤波例3.13使用各种尺寸模板的图像平滑。与滤波器模板尺寸有关的图像平滑效果如图3.3）所示，图中显示了一一幅原图像以及分别用尺寸为m=35, 9,15和35像素的方形均值滤波器得到的相应平滑结果。这些结果的主要特点如下:：当m =3时，可以观察到在整幅图像中有轻微的模糊，但正如所希望的那样，当图像细节与滤波器模板近似相同时，图像中一些细节受到的影响比较大。例如，图像中的3×3与5×5黑方块、较小的字母“a”和细颗粒噪声，与图像的其他部分相比，要更模糊一些。注意，噪声显著地降低了，字母的锯齿状边缘也令人满意地被平滑了=5时的结果基本类似，但模糊程度稍微有所增加。在m= 9时，可以明显地看出图像更加模糊，而且有 20%的黑色圆圈几乎不能像在前三幅图像中那样与青景明显地区分开来，这表明当目标的灰度与其相邻像素的灰度接近时，，会导致模糊目标的混合效应。m =15和35时，，就图像中目标物的尺寸来说,一些小物体。已属极端情况。。这种极端类型的模糊处理通常用于去除图像中的。例如，在图3.35 (6)中，三个小方框、两个小圆圈以及大部分噪声矩形区域已融入到背景中。注意，在这幅图中还有明显的黑的边界。这是我们用0(黑色)填充原图像的边界，经过滤波后再去除填充区域的结果。某些黑色混入了所有滤波后的图像，但对于使用较大滤波器平滑的图像，这就成为问题了。口LLLdda a a a a aapa a a a a a aa中Saaa aa a a电康藻品花流d e「图3.33(a)大小为500×500像素的原图像；（b)-GD)用大小分别为m=3,5,9,15和35的方形均值滤波模板平滑处理的结果。顶部的黑色方块大小分别为3,5.9, 15,25,35,45和55个像素，它们的边界相隔25个像素。底部字母的大小在10点到24点之间，增量为2个点；顶部的最大字母为60点。。垂直线段条宽为5个像素，高为100个像素，线条间距为20个像素。圆的直径为25个像素，它们的边界相隔15个像素，灰度级为0%到100%的黑色范围内，以20%增加。图像背景为黑色的10%。噪声矩形区域大小为50×120像素正像早些时候提到的那样，空间均值处理的一一个重要应用是为了对感兴趣的物体得到一一个粗略的描述而模糊一幅图像，这样，那些较小物体的灰度就与背景混合在一起了，较大物体变得像“斑点'而易无检测。模板的大少由那些明将磁入背景中的物体尺寸米决烷。作为实例・考虑虚34.0)，是绕地轨道上的哈勃望远镜拍摄的一幅图像。。图3.34(6b)显示了应用15×15均值滤波器模板对该图像处理后的结果。我们可以看到，，图像中的一些部分或者融入背景中，或者其亮度明显降低了。像这样利用阈值处理并基于物体亮度来消除某些物体的操作是很典型的。。使用等于模糊图像最高亮度 25%的阈值，并用图3.2(6)的阈值函数处理的结果示于图3.34(c)中。将该结果与原图像比较，我们看到,考虑图像中最大、最亮物体的表达方式是合理的。图3.34(a)来自哈勃太空望远镜的大小为528×485像素的图像；（b)由15×15均值模板滤波过的图像;；（c)对图(b)进行阈值处理后的结果(原图像由NASA提供）3.5.2统计排序(非线性)滤波器统计排序滤波器是一种非线性空间滤波器，这种滤波器的响应以滤波器包围的图像区域中所包含的像素的排序(排队)为基础，然后使用统计排序结果决定的值代替中心像素的值。这一类中最知名的滤波器是中值滤波器，，正如其名暗示的那样，它是将像素邻域内灰度的中值(在中值计算中包括原像素值)代替该像素的值。中值滤波器的使用非常普遍，这是因为对于一定类型的随机噪声，它提供种优秀的去噪能力，而且比相同尺寸的线性平滑滤波器的模糊程度明显要低。中值滤波器对处理脉冲噪声非常有效，该种噪声也称为椒盐噪声，因为这种噪声是以黑白点的形式叠加在图像上的。个数值集合的中值与是这样的数值，即数值集合中有一半小于或等于与，还有一半大于或等于为了对一幅图像上的某个点进行中值滤波处理，首先将邻域内的像素分类排序，确定其中值，并将中值赋予滤波后图像中的相应像素点。例如，对于一一个3×3邻域，其中值是第5个最大的值，而在一个5×5邻域中，中值就是第 13个最大的值，，等等。当一个邻域中的一些像素值相同时，所有相等的值都可以作为中值。假如，在一一个3×3邻域内有一系列像素值（10,20,20,20, 15, 20,20, 25, 100对这些值排序后为(10, 15, 20, 20, 20,20, 20, 25, 100)，那么其中值就是20。这样，中值滤波器的主要功能是使拥有不同灰度的点看起来更接近于它的相邻点。事实上，我们使用mxm中值滤波器来去除那些相对于其邻域像素更亮或更暗并且其区域小于mf /2（滤波器区域的一半)的孤立像素族。在这种“去除””的意思是强制为邻域的中值灰度。较大的族所受到的影响明显较小。情况下，在图像处理中，尽管中值滤波器是使用得最为广泛的统计排序滤波器，但并不意味着它是唯的。中值象征一系列像素值排序后的第 50%个值，但根据基本统计学可知，排序也适用于其他不同的情况。例如，可以取第100%个值，即所谓的最大值滤波器，这种滤波器在搜寻一幅图像中的最亮点时非常有用。-个3×3的最大值滤波器的响应可以由公式R= max {z。1k =1.2.,9}给出。相反，取第 0%个值的滤波器就是所谓的最小值滤波器,，它可用于相反关于百分比的内容，请参铜1035 *的目的。中值、最大值、最小值和其他非线性滤波器将在5.3节中详细介绍。利用中值滤波降噪・列3.14图3.35 a)显示了一幅被椒盐噪声污染的电路板的X射线图像。为了说明这种情况下的中值滤波器处理效果比均值滤波器更好。我们在图3.356b)中显示了用3×3邻域均值模板处理噪声图像的结果，而在图3.35 (e)中显示了用3×3中值滤波器处理噪声图像的结果。均值滤波模糊了图像，并且噪声去除性能也很差。在这种情况下，中值滤波要远远优于均值滤波是很明显的。通常，中值滤波比均值滤波更适合去除椒盐噪声。灰度变换与空间滤波华出品品品器兴品品(a)被椒盐噪声污染的电路板X射线图像；(b)用3×3均值模板降嗓后的图像；Cc)用图3.353×3中值滤波器降噪后的图像(原图像由Lixi公司的Joseph E. Pascente先生提供）锐化空间滤波器3.6锐化处理的主要目的是突出灰度的过渡部分。图像锐化的用途多种多样，应用范围从电子印刷和医学成像到工业检测和军事系统的制导等。在上一节中，我们了解到，图像模糊可通过在空间域用象素邻域平均法实现。因为均值处理与积分类似，在逻辑上，我们可以得出锐化处理可由空间微分来实现这一结论。。事实上，的确如此，且本节将讨论由数字微分来定义和实现锐化算子的各种方法。基本上・微分算子的响应强度与图像在用算子操作的这一点的突变程度成正比，这样，图像微分增强边缘和其他突变(如噪声)，而削弱灰度变化缓慢的区域。3.6.1基础在以下两节中，我们将分别详细讨论基于一阶和二阶微分的锐化滤波器。在讨论具体滤波器之我们先回顾一下数字意义上微分的某些基本性质。为简化说明，我们主要集中讨论一阶微分的性质。我们最感兴趣的是恒定灰度区域中，，突变的开始点与结束点(台阶和斜坡突变)及沿着灰度斜坡处章看到的那样，这些类型的突变可以用来对图像中的噪声点、线与边的微分性质。正如愈将在第 10缘建模。这些图像特性过渡期的微分性质也很重要。数字函数的微分可以用不同的术语定义。也有各种方法定义这些差别。然而，对于一阶微分的任可定义都必须保证以下几点：（1)在恒定灰度区域的微分值为零；；(2)在灰度台阶或斜坡处微分值非零;3)沿着斜坡的微分值非零。类似地，任何二阶微分的定义必须保证以下几点：（1)在恒定区域微分值为令；(2)在灰度台阶或斜坡的起点处微分值非零；(3)沿着斜坡的微分值非零。因为我们处理的是数字量，其值是有限的，故最大灰度级的变化也是有限的、、并且变化发生的最短距离是在两相邻像素之间。对于一维函数f(x)，其一阶微分的基本定义是差值节中，我们将会回到在10.2.1式(3.61)，并给出由泰勒级数推导中(3.6-1）= f(x+1D-f(众）出它的力法。现在。我们只须把它当做一个定义来接受即可。其中，为了与三维图像函数了（Kx.y)的微分保持一致，我们使用了偏学数符号六。对于二维函数，我们将沿着两个空间轴处理偏微分。当前讨论的空间微分的应用并不影响我们试图采用的任何方法的本质。很清楚，当函数中只有一个变量时，/0 /ar、对于二阶微分，这同样也成立。我们将二阶微分定义为如下差分：arf179(3.6-2）-= f(x+1)+ f(x-1)-2f(x）180很容易验证这两个定义满足前面所说的条件。为了解这一点，并考察数字函数一阶和二阶薇分间的异司点，，考虑图3.36中的例子。・段扫描线。小方块中的数值是扫描线中的灰度值，它们作为黑点图3.36(6)(图的中间)显示了一画在上方的图 3.36(a)中。。用虚线连接这些点是为了帮助我们着得更清楚。。正如图中所示，扫描线包个灰度斜坡三个恒定灰度段和一个灰度台阶。圆圈指出了灰度变化的起点和终点。用前面两个定义计算出的图3.36 6b)中扫描线的一阶微分和二阶微分画在图3.36 c)中。当在点x处计算一阶微分一个点的函数值减去该点的函数值L。因此，这是一个“预测未来”的操作。。类似地，为时，我我们用下了在x点计算二阶微分，在计算中我们使用前一个点和下一一个点。为了避免前一一个点和下一个点处于扫描线之外的情况，我们在图3.36中显示了从序列中第二个点到倒数第二个点的微分计算。灰度过渡恒定灰度工斜坡台阶6|6|5|4|3|2|1百描线[5|6|6|6|6r微分介微分图3.36一幅图像中一一段水平灰度剖面的一维数字函数的一阶微分和二阶微分表示一的说明。在图(a)和图(c)中，为便于观看，已用虚线将数据点连接起来让我们从左到右横贯剖面图，考虑一阶微分和二阶微分的性质。首先，我们遇到的是如图3.36 6b)和(c)所示的恒定灰度区域，一阶微分和二阶微分都是零，因此，两者都满足条件(1D)。接着，我们遇到紧随台阶的一一个灰度斜坡，并且我们注意到在斜坡起点和台阶处的一阶微分不为零，类似地，，在斜坡和台阶的起点和终点的二阶微分也不为零；因此，两个微分特性都满足条件(2)。最后，我们看到，两个微分特性也都满足条件3)，因为对于斜坡来说一阶微分不是零、二阶微分是零。请注意斜坡或台阶的起点和终点处二阶微分的符号变化。事实上，我们在图3.36 c0中看到，在一个台阶的过渡中、连接这两个值的线段在两个端点的中间与水平轴相交。。正如在第 10章中我们将要看到的那样，零交又对于边缘定位是非常有用的数字图像中的边缘在灰度上常常类似于斜坡过渡，这样就导致图像的一阶微分产生较粗的边缘.lsz」因为沿着斜坡的微分非零。另一方面，二阶微分产生由零分开的一个像素宽的双边缘。由此，我们灰度变换与空间滤波正得出结论，二阶微分在增强细节方面要比一阶微分好得多，这是一个适合锐化图像的理想特性。像在本节稍后将要了解的那样，二阶微分比一阶微分执行上要容易得多，所以，我们开始主要注意二阶微分拉普拉斯算子3.6.2使用二阶微分进行图像锐化在这一节，我们考虑二维函数二阶微分的实现及其在图像锐化处理中的应用。。在第10章中，我们将再回到微分问题上来，广泛用于图像分割。。这种方法基本上是由定义一个，在第10章我们将把它广二阶微分的离散公式，然后构造一个基于该公式的滤波器模板组成的。。我们最关注的是一种各向同性滤波器，这种滤波器的响应与滤波器作用的图像的突变方向无关。也就是说，各向同性滤波器是旋转不变的，，即将原图像旋转后进行滤波处理给出的结果与先对图像滤波然后再旋转的结果相同。一个二维图可以证明(Rosenfeld and Kak[1982)，最简单的各向同性微分算子是拉普拉斯算子。像函数了(Gx,y)的拉普拉斯算子定义为afdff7f f(3.6-3)oy因为任意阶微分都是线性操作，所以拉普拉斯变换也是一个线性算子。为了以离散形式描述这一一公式，我们使用式(3.6-2)的定义，记住，我们必须支持第二个变量。在x方向上，我们有ff= /(x+1,y)+ (x-1.,)-2/(αx.y）(3.6-4)类似地，，在y方向上我们有(3.6-5）小y遵循这三个公式，两个变量的离散拉普拉斯算子是所以，Vff(x, y)= f(x+1,.y)+ f(x-1,J)+ f(x,y9+1)+ f(x, y-1)-4/(x,y）(3.6-6）这个公式可以用图 3.37(a)的滤波模板来实现，该图给出了以90°为增量进行旋转的一个各向同性结实现机理与3.5.1节中给出的线性平滑滤波器一样。我们在这里只是简单地使用了不同的系数。对角线方向也可以这样组成：在数字拉普拉斯变换的定义中，在式(3.60中添入两项、即两个。每个新添加项的形式与式(3.6-4)或式(3.6-5)类似，只是其坐标轴的方向沿着对角线方向各加一个。对角线方向。由于每个对角线方向上的项还包含一个-2f(*.)、所以现在从不同方向的项中总共应减去-8(x,y)。图37(6)显示了执行这一新定义的模板。。这种模板对45°增幅的结果是各向同性的。您在实践中可能常见图37(6）和(d)所示的拉普拉斯模板。它们是由我们在式(3.6-4)和式(3.6-5)中，但是，当将拉普拉斯滤波后的图像与与其他图像合并(相加或相减)时，必须考虑符号上的差别。由于拉普拉斯是一种微分算子，因此其应用强调的是图像中灰度的突变，并不强调灰度级缓慢雯化的区域。这将产生把浅灰色边线和突变点叠加到暗色背景中的图像。将原图像和拉普拉斯图像叠-起的简单方法，可以复原背景特性并保持拉普拉斯锐化处理的效果。。正如上一段中讲到的那样,已住所使用的拉普拉斯定义是很重要的。如如果所使用的定义具有负的中心系数，那么必须将原图像减去经拉普拉斯变换后的图像而不是加上它，从而得到锐化结果。所以，我们使用拉普拉斯对图像增强18的基本方法可表示为下式:3.6-7g(x,y)= f(x, y)+c[V'f(x,Jy)」其中，（(x,y)和g(x,y)分别是输入图像和锐化后的图像。如果使用图3.37()或图37(6)中的拉普拉斯滤波器，则常数c一，如果使用另外两个滤波器，则常数c=1图 3.37(a)实现式(3.6-6)所用的滤波器模板；b)用于实现带有对角项的该公式的扩展的模板；（c)-(aの实践中常用的其他两个拉普拉斯实现使用拉普拉斯的图像锐化。列3.15一幅月球北极的稍微模糊的图像。图3.38 6b)显示了使用图3.376b)中的拉普拉斯模图 3.38 (a)显示了板对该图像滤波后的结果。由于拉普拉斯图像中既有正值又有负值，并且所有负值在显示时都修剪为0，所以图像的大部分是黑色的。个典型的标定拉普拉斯图像的方法是对它的最小值加一个新的代替。的最小值，然后将结果标定到整个灰度范围[0,L-1]内，如同式(2.6-10)和式(2.6-11)中解释的那样。图3.38 C)是用这种方法标定过的图像。注意，该图像的支配特性是边缘和灰度的不连续处。前述的黑色背景由于标定现在已变成灰色。这一呈现浅灰色的外观是被适当标定的典型拉普拉斯图像。图3.38 (4)显示了在c=-1时使用式(3.6-7)得到的结果。该图像的细节比原图像更清晰。将原图像加到拉普拉斯的处理结果中，可以使图像中的各灰度直得到复原，而且通过拉普拉斯增强了图像中灰度突变处的对比度。最终结果是使图像中的细节部分得到了增强，并良好地保留了图像的背景色调。最后，图3.38 (e)显示了使用图3.376b)中的滤波器重复前述过程处理的结果。在这里，我们注意到图3.38 0)的清晰度的重要改进。因为使用了图3.37 (6)的滤波器导致在对角方向上产生了额外的区别(锐化)，这并不意外。像图3.38(4和图3.38(e)显示的这些结果使得拉普拉斯成为锐化数字图像的一种工具。a bc d c图3.38(a)月球北极的模糊图像；(D)未标定的拉普拉斯滤波后的图像；Cc)标定的拉普拉斯滤波后的图像:(dの用图3.37a)中的模板锐化后的图像；(e)用图3.376)中的模板锐化后的图像(原图像由NASA提供3.6.3非锐化掩蔽和高提升滤波在印刷和出版界已用了多年的图像锐化处理过程是从原图像中减去一幅非锐化(平滑过的)版本。这个称为非锐化掩蔽的处理过程由下列步骤组成：模糊原图像从原图像中减去模糊图像(产生的差值图像称为模板)184将模板加到原图像上。lus5]友度变换与空间滤波101非锐化掩蔽以公式形式描述如下。令f(x, y)表示模糊图像，首先，我们得到模板：(3.6-8）原始信号然后，在原图像上加上该模板的一一个权重部分：8(X,y)= f(x,J)+k* mast(x,y）(3.6-9）重常，玉我们会在上式中包含一一个权重系数k(k ≥0)。模糊后的信号k =1时，我们得到上面定义的非锐化掩蔽。当k>1时，亥处理称为高提升滤波。选择k<1则不强调非锐化模版的贡献。纯化模板图3.39解释了非锐化掩蔽是如何工作的。。图3.39(a)中的灰度剖面图可以解释为通过垂直边缘的水平扫描线，垂直边缘是图像中从暗区到亮区的过渡。图3.396）显示了平滑后的结果，为了参考，该结果叠加在原始信锐化后的信号号(显示为虚线)上。图3.39(c)是非锐化模板，，它是从原始信号中减去模糊信号得到的。通过将该结果与对应于图图 3.39非锐化掩蔽机理的说明：(a)原始信号；3.36a)中斜坡的图3.36 (c)中的部分比较，我们注意到,6)模糊信号，为便于参考，原始信号使图3.39(c)中的非锐化模板与我们使用二阶微分得到的结用虚线显示；（c)非锐化模板；（d)将果非常相似。图3.39(d)是最后锐化的结果，它是通过把图(Cc)和图(a)相加得到的锐化后的信号模板加到原始信号上得到的。。现在强调(锐化)了信号中出现灰度斜率变化的点。观察添加到原信号中的负值。这样，如果原图像有任何零值，或如果选择的人值大到足以使模板峰值大于原信号中的最小值时，那么最终的结果可能会存在负灰度。负值将导致边缘周围有暗的晕轮，如果k足够大，将产生不好的结果。列3.16使用非锐化掩蔽进行图像锐化图 3.40(a)显示了一幅在暗灰背景上稍微有点模糊的白文本图像。图3.406b)是使用大小为5×5且 =3的高斯平滑滤波器得到的结果(见3.4.4节)。图3.40(c)是使用式(3.6-8)得到的非锐化模板。图3.40(）「式(3.6-9),人 =1]非锐化模板得到的结果。该图像较原图像稍微有点改进，但是，我们可以做得更老用好。图3.40(e)显示了使用式(3.6-9)并且令k= 4.5的结果，这是我们可用的最大可能值，并且在最终结果中始终保持所有值为正。该图像与原图像相比有重大的改进。DIP-XEDIP-XEPXEDIP-XE DIP-XEi bc d e图3.40(a)原图像；b)使用高斯滤波器模糊的结果；（c)非锐化模板；a)使用非锐化掩蔽的结果；(e)使用高提升滤波的结果使用一阶微分对(非线性)图像锐化一一一梯度3.6.4图像处理中的一阶微分是用梯度幅值来实现的。对于函数了(x,)，了在坐标(x,y)处的梯度定义为二维列向量文0.2.5节将详细讨论梯度。欢我们仅对使用梯度幅值锐化图像感Vr e grad ）=(3.6-10）1811sz]数学图像处理(第三版）该向量具有重要的几何特性，即它指出了在位置(rx,y)处f的最大变化率的方向。向量Vf的幅度值(长度)表示为M(rx,J)），即M(x.y)= mag(Vf)= √/8:+83它是梯度向量方向变化率在(x,y)处的值。注意，M(x,y)是与原图像大小相同的图像，，它是当x和y允许在了中的所有像素位置变化时产生的。。在实践中，该图像通常称为梯度图像(或含义很清楚时，可简称为梯度)因为梯度向量的分量是微分，所以它们是线性算子。然而，该向量的幅度不是线性算子，因为求幅度是做平方和平方根操作。另一方面，式(3.6-10)中的偏微分不是旋转不变的(各向同性），而梯度向量的幅度是旋转不变的。在某些实现中，用绝对值来近似平方和平方根操作更适合计算:M(x. )=|8.|+|83.6-120该表达式仍保留了灰度的相对变化，但是通常各向同性特性丢失了。然而，像拉普拉斯的情况那样，在下面章节定义的离散梯度的各向同性仅仅在有限旋转增量的情况下被保留了，它依赖于所用的近似微分的滤波器模板。正如结果那样，用于近似梯度的最常用模板在90°的倍数时是各向同性的。这些结果与我们使用式(3.6-11)还是使用式(3.6-12)无关，因此，如果我们选择这样做，使用后一公式对结果并无影响。正如在拉普拉斯情况下那样，我们现在对前面的公式定义一个离散近似，并由此形成合适的滤波模板。。为简化下面的讨论，我们将使用图 3.41 （a)中的符号来表示一个3×3区域内图像点的灰度。例如，使用图3.28中引人的符号，含中心点石表示任意位置(:处的（(x.)，z表示为f(x-1,y-1)；等等。正如3.6.1 节指出的那样，满足3.6.1 节声明的条件的对一一阶微分的最简近似是在早期数字图像处理的研究中，由Robertst165]提出的其他两个定=(z.-zs)和g,=（Z。义使用交叉差分：(3.6-13）8.=(Z。-zs)和g, =(2%-z6）如果我们使用式(3.6-11)和式(3.6-13)，我们计算梯度图像为M(x.)=[E,-3） +(2。-.)°(3.6-14）如果我们用式(3.6-12)和式(3.6-13)，则(3.6-15）M(x,)) =|3.- 3.1+|4。- 21按之前的描述方式,很容易理解x和y会随图像的维数变化。式(3.613)中所需的偏微分项可以用图3.416中的两个线性滤波器模板来实现。这些模板称为罗伯特交叉梯度算子。偶数尺寸的模板很难实现，因为它们没有对称中心。。我们感兴趣的最小模板是3×3模板。使用以z。为中心的一个3×3邻域对g,和g,的近似如下式所示:温=(2,+24+3)-4,+2元.+25）S.=(3.6-16）中(3.6-17）=(石.+22% +Z,)-(石+2z4+z,）这两个公式可以使用图3.41.42和图3.41(6)中的模板来实现。使用图3,4 d)中的模板实现的3×3图像区域的第三行和第一行的差近似x方向的偏微分，另一一个模板中的第三列和第一列的差近似了y方问的微分。用这些模板计算偏微分之后，我们就得到了之前所说的梯度锅值。例如，将g,和g,代189第3章入式(3.6-12)得到(3.6-18）+22. +z,)-(z,+22 +z3)|+1M(Cx, y) =|(z,+图3.41 (d)和图3.41 (e)中的模板称为 Soble算子。。中心系数使用权重2的思想是通过突出中心点的作，注意，图3.41所示的所有模板中的系数总和为0,用而达到平滑的目的(第10章中将详细介绍该思想)。表明灰度恒定区域的响应为0。这正如微分算子的期望值那样，老图3.41（a)一幅图像的3×3区域(z是灰度值)；b)-(e)罗伯特交叉梯度算子；(Gの～(e)所有的模板系数之和为零，如微分算子预料的那样正如之前提到的那样，g,和g,的计算是线性操作，因为它们涉及微分操作，因此可以使用图3.41中的空间模板如乘积求和那样实现。使用梯度进行非线性锐化是包括平方和平方根的M(x,y)）的计算，或者使用绝对值计算代替，所有这些计算都是非线性操作。该操作是在得到g.和g,线性操作后执行的操作例3.17使用梯度进行边缘增强。梯度处理经常用于工业检测，不是辅助人工检测产品缺陷，就是更为通用地作为自动检测的预处理。我们将在第10章和第11章对此做更多的介绍。考虑一个简单的例子来展示梯度法如何用于增强缺陷并消除慢变化背景的特性是有益的。在这个例子中，增强用做自动检测的预处理步骤，而而不用于人为分析。图3.42(a)显示了一幅隐形眼镜的光学图像，a b它由设计用于突出缺陷的发光装置来照明，例如4点钟方向和5点钟方向眼镜边界中的两个边缘缺陷。图3420)显示了使用式3612及图341(0与图3.41 (e)中的两个Sobel模板得到的梯度图像。在该图像中，边缘缺陷清晰可见，并且还有附加的优点，即灰度不变或变化缓慢的图案阴影被去除了，从而简化了自动检测所要求的计算任图3.42Ca)隐形眼镜的光学图像(注意4点钟和。梯度处理还可以用于突出灰度图像中看不见的5点钟方向边界上的缺陷)；b) Sobel梯度小斑点(这样的小斑点可能是外来物、保护液中的气原图像由Perceptics公司的Pete Sites 提供泡或眼镜中的小缺陷)。在灰度平坦区域中增强小突变的能力是梯度处理的另一个重要特性。混合空间增强法3.7到目前为止，除了一些特殊情况，如带有阈值处理(图3.34)的混合模糊，我们主要关注的还是单的增强法。通常，为了达到令人满意的结果，对给定的任务需要应用多种互补的图像增强技术。。在本节，我们将通过一个例子来说明怎样将本章中提到的多种图像增强方法结合起来，从而完成困难的图像增强任务。191图3.43 a)所示的图像是一幅人体骨骼核扫描图像，常用于检查人体疾病，如骨骼感染和肿瘤我们的目的是通过图像锐化突出骨骼的更多细节来增强图像。由于图像灰度的动态范围很窄并且有很高的噪声内容，所以很难对其进行增强。对此我们采取的策略是，首先用拉普拉斯法突出图像中的小细节然后用梯度法突出其边缘。。平滑过的梯度图像将用于掩蔽拉普拉斯图像(关于掩蔽的说明见图 2.30)，稍。最后，我们将试图使用灰度变换来增大图像的灰度动态范围。后会对此简短说明。。该图像使用与图 3.43(b)显示了使用图3.37 (d)中的滤波器得到的原图像的拉普拉斯操作的结果。图3.38（c)相同的技术标定过(只为便于显示)。然后，根据式(3.6-7)，简单地将图3.43 a)与图3.43 6)。只要看一下图3.43 6)中的噪声水平，就可以预料到，如果J一幅经过锐化过的图像目加就可以得到一点可以在图3.43 (e)中得到证实。于是可立。然而，中值滤波器是一种非线性滤波器，它有可能刻想到，降低噪声的一种方法是使用中值滤波器。改变图像的性质。这在医学图像处理中是不能接受的。图3.43a)全身骨骼扫描图像；b)图(a)经拉普拉斯操作后的结果；；(C)将图(a）和图(b)相加得到的锐化图像；d) K(a)经Sobel梯度处理后的结果g h到3.43(续)(e)使用5×5均值滤波器平滑后的Sobel 图像；（(n由图(Cc)和图(e)相乘形成的掩蔽图像；（g)由图(a)和图(G)求和得到的锐化后的图像；仙)对图(g)应用幂律变换得到的最终结果。请将图(p与图a)比较(原图像由G.E.Meticl sSsns公司提供)种方法是使用原图像梯度操作的平滑形式所形成的一个模板。这种方法的动机很直接，并且基于3.6.1 节中讲过的一。拉晋拉斯操作作为一种二阶微分算子，在图像细节一阶和二阶微分的性质。193的增强处理方面有一定的优点，在增强细节方面它是最好的。但这会导致它产生比梯度操作更多的噪灰度变换与空间滤波声。这些噪声在平滑区内域更令人讨厌，因为在这些区域它非常显眼。梯度变换在灰度变化的区域(灰度斜坡或台阶)的平均响应要比拉普拉斯操作的平均响应更强烈。梯度操作对噪声和小细节的响应要，而且可以通过均值滤波器对其进行平滑处理而进一步降低。这时，其思路比拉普拉斯操作的响应弱，是对梯度图像进行平滑处理并用拉普拉斯图像与它相乘。在这种情况下，可以将平滑后的梯度图像着成是一个模板图像。乘积会保留灰度变化强烈区域的细节，同时降低灰度变化相对平坦区域的噪声。这种处理可以粗略地着成是将拉普拉斯操作与梯度操作的优点相结合。。将结果加到原图像上，就可以得到最终的锐化图像图3.434)显示了原图像使用式(3.6-12)给出的Sobel梯度操作的结果。分量g,和g,分别使用图 3.41 (d)和图3.41 (e)中的模板获得。正如所期望的那样，该图像中的边缘要比拉普拉斯图像中的边缘突出许多。图3.43 (e)中平滑后的梯度图像是使用大小为5×5的一个均值滤波器得到的。。为便于显示、两幅梯度图像已与拉普拉期图像相同的方式进行了标定。因为梯度图像的最小可能值是0.故标定后的梯度图像中背景是黑色的，而不是标定后的拉普拉斯图像中的灰色。图3.43(d和图3.43 (e)比图 3.43(6)亮的事实再次表明，，具有重要边缘内容的梯度图像的值一般要比拉普拉斯图像的值高。拉普拉斯图像与平滑后的梯度图像的乘积显示在图3.43 6)中。注意强边缘的优势和可见噪声的相对减少，这是使用一幅平滑后的梯度图像来掩蔽拉普拉斯图像的关键目的。将乘积图像与原图像相加就产生了图3.43(g)所示的锐化图像。与原图像相比，该图像中大部分细节的清晰度的增加都很明显。单独使用拉普拉斯操作或者梯度操作不可能达到这种类型的改进。包括肋骨、脊椎骨、骨盆及颅骨心以上讨论的锐化过程从感知方法上没有影响图像灰度的动态范围。这样，，增强处理任务的最后步就是增大锐化后图像的动态范围。正如 3.2 节和3.3 节中详细讨论的那样，有很多可以完成这目标的灰度变换函数。从3.3.2 节的结果可以知道，对类似此处灰度分布比较暗的图像进行直方图均衡的效果似乎并不好。直方图规定化可能是一种解决方法，但待处理图像的暗特性用幂律变换处理更好。由于我们希望能够扩展灰度范围，所以式(3.2-3)中的y值必须小于1。通过用这一公式进行一实验后，我们得到了图3.43 0)所示的结果，此时r= 0.5.c=1。将这幅图像与图3.43g)相比较，我们可以看到图 3.43 .0)中出现了许多重要的新细节。围绕着手腕、手手掌、脚踝和脚擎区域都是这种效果的很好例子。人体的整个骨架结构也很显著，包括手臂骨和腿骨。我们还注意到，人体轮廓及人体组织的清晰度不高，这是由于通过扩大灰度动态范围显现细节的同时也增大了噪声，但图 3.43(6)与原图像相比还是显示出了视觉效果的显著改进。刚才讨论的方法是有代表性的处理形式，为了达到那些用一种方法无法实现的效果，可以把多种方法结合起来。得到期望结果所使用的方法取决于应用。在这个例子中，所示图像类型的最终用户很可能是放射线学者。。但也存在超出我们讨论范围的多数原因，如物理学家就不依赖于增强的结果来达到诊断目的。然而，如果将突出一些细节作为进一步分析一幅原图像或一系列图像的线索，则增强后的图像是非常有用的。而在其他领城，增强处理后的结果可能就是最终的“产品"。在印刷工业基于图像的产品检测、法院取证、、显微、监视及其许多他领域，增强的主要目的是得到一幅具有较高视觉细节内容的图像。使用模糊技术进行灰度变换和空间滤波3.8我们以介绍模糊集合及其在灰度变换和空间滤波中的应用来结束本章，灰度变换和空间滤波是前儿节探讨的主题。。正如它所证明的那样，这两种应用是图像处理中最常使用模糊技术的领域。在本章最后的参考文献提供了关于模糊集和模糊集在图像处理中的应用方面的切入点。如在下面的讨论中您将看到l9s]的那样，模糊集合在解决那些不以精确概念为基础来表述的问题时，为体现人类知识提供了一个框架。106引言3.8.1与数一个集合是对象(元素)的聚集，集合论是处理集合中操作的工具集。节注释的那样如 2.6.4 学逻辑一样，集合论理所当然也是经典数学的基础之一。集合论的核心是集合成员的概念。我们习惯”集合，它们的成员在传统的二值布尔逻辑情况下，不是真就是假，用Ⅰ表示于处理所谓的“干脆的”，并且我们想要定义集合Z的一个称为年轻人集真，用0表示假。例如，令Z表示为所有人员的集合，。为了形成该子集，我们需要定义一个隶属度函数，它可以对Z中的每一个成员z赋一个合的子集A。值或）值。因为我们处理二值逻辑，隶属度函数简单地定义一一个阈值，，等于或低于该阈值的人考虑为年轻人，而在阈值之上的人考虑为非年轻人。图3.4(a)用20岁的年龄隶属度函数也称为特征函教阈值总结了这一概念，并令A(z)表示刚才讨论的隶属度函数。从A(之）年龄（z）0一个“干脆的”集合和(b)一个模糊集合的隶属度函数图 3.44用于产生(a)使用这一表达，，我们立即会面临一一个困难：年龄为 20岁的人被认为是年轻人，但年龄为 20岁“干脆的”集合的一个基本问题，它在许多实际应用零1秒的人就不是年轻人集合的成员。这是使用中限制了经典集合论的用途。我们需要的所谓年轻的意思是更弹性地在年轻和非年轻间的渐进过渡。图3.44(6)显示了种可。这就使退性。。该函数的关键特性是无限制的评价，这样就可在年轻和非年轻之间允许连续地过渡。“年轻”。现在我们可以做一个声明：如一个人是年轻人(曲线上端的平坦部分）导它可能有”的程度。相对年轻的人(斜坡开始处)，50%年轻的人(斜坡的中间)，不那么年轻的人(斜坡的末端)，等等[注意图3.44(6)中曲线的斜率引人了什么是“年轻”的更加模糊的概念]。这些模糊的声明与我们不太严我们可以用模糊逻辑基础解释非限制评价隶属度函数，并且把使用密地谈论年龄时是一一致的。这样，它们生成的集合看成是模糊集合。这些概念将在下一节中被形式化。3.8.2模糊集合论原理模糊集合论是由L. A. Zadeh在40多年前的一篇论文中引入的(Zadeh[1965]）。如下面的讨论那样，模糊集合为处理不严密信息提供了一种形式。为表达给定应用中集合的广泛定义性，我们采用传统的模糊集合法，即集合符号Z而不是更为传统令Z为元素(对象)集，z表示Z的一类元素，即Z={z}。该集合的集合符号U。称为论城。Z中的模糊集合"A由隶属度函数从A(2）表征，它是与Z的元素相关的在区间[0,1]内的一一个实数。。丛A(2)在z处的值表示A中z的隶属度等级。最接近从A(2)的值与在A中的z的较高的隶属度等级趋于一致，而当从A(2)接近于0时，则相反。。“属于”这个概念在普通集合中很熟悉，但在模糊集合论中却具有不同的含义。对于普通集合，我们说一一个元素属于或O 文献中也便用术语模糊子集来表示A是Z的子集，但模糊集合使用得更为频繁107第3章二都是集合的完全成员，对于不属于一个集合；而对于模糊集合，我们说对于pA.(z)=1的所有从.=0的所有z都不是集合的成员，而从A人)的信众于。和1之间的所有又是集合的部分成员。因此，模糊集合是一个由z值和(赋予z成员等级的)相应隶属度函数组成的序对，即4={z,HA（Z)Ize Z} 3.8-1。当z的值是离散值时，我们可明确地地说明A的当变量连续的时候，该式中集合A有无限个元素。元素。例如，，如果图3.44中的年龄增量限制为整数年，则有4={(1, 1),（(2，1),(3,1),…,（20, 1), （21,0.9),（22, .8), …，（25,0.5)(24, 0.4). …,（29,0.1)}这里，作为一个例子，元素(22,0.8)表示年龄22在集合中的隶属度等级为0.8。年龄为20岁和低于20岁的所有成员都是该集合的完全成员，而年龄为30岁和高于30岁的成员都不是集合的成员。注意，亥集合的曲线是图3.44 6)中曲线上的离散点，所以在A(z)完全定义了A。从另一一角度观察，我们发现个(离散)模糊集合只不过是一一个函数的点的集合，该函数将问题域(论域)中的每个元素映射为一个大于0而小于或等于1的数。这样，我们通常可以交替使用术语模糊集合和隶属度函数。当L。(2）仅有两个值时，例如0和1，隶属度函数退化成我们熟悉的普通(（干脆的)集合A的特征普通集合就是模糊集合的一种特殊情况。。下面，我们考虑涉及模糊集合的几个定义，这函数。。这样，，T些定义是普通集合中相应定义的扩展空集：当且仅当z中的隶属度函数等于零，模糊集合为空集。相等：兰当且仅当对于所有的zeZ有山(2)= 4A(z)，两个模糊集合A和B相等。由A或NOT(A)表示模糊集合A的补集(NOT)，定义为其隶属度函数是下集：由(3.8-2）4z(z)=1- px(z）的集合，对于所有的z= Z当且仅当对于所有的ze Z，有子集：4A(2)≤ Ln(z）(3.8-3）模糊集合A是模糊集合B的子集。并集：对于所有的zeZ，两个模糊集合A和B的并集是具有隶属度函数P, (z)= max[LA(2),ALz(2)」(3.8-4）的并集U(OR)，表示为AUB或AOR B。交集：两个模糊集合A和B的交集是对于所有的ze Z，具有隶属度函数(3.8-5）4,(2)= min[L。(2)Lp(2)」的模糊集合1,表示为AnB或AAND B注意，在处理模糊集合时，可使用熟悉的符号NOT, OR和AND来分别表示补、并和交。例 3.18模糊集合定义的说明。图3.45说明了前面的一一些定义。。图3.45(a)显示了两个集合A和B的隶属度函数。图3.45 (b)显示了集A的补集的隶属度函数，图3.45 C)显示了集合A和B的并集的隶属度函数，图3.45 d)显示了这两个集合的交集的结果。注意，这些图形是我们所熟悉的关于普通集合的补集、并集和交集。196li读者可能在文献中遇到过这样的例子、例如两个模糊集合的交集的隶属度函数曲线下的面积用阴影表示。以指出该操作的结果。这源于普通集合操作。是不正确的。在处理模糊集合时。这仅适用于沿着隶属度函数本身的点。08补集maxlLA（5)从Aza）一A(z) minlLA《a).pzdz）交集(a)两个集合A和B的隶属度函数；(b)A的补集的隶属图 3.45度函数；e)~(d)两个集合的并集和交集的隶属度函数尽管模糊逻辑和概率均在相同的区间[0,1]上操作，但这两种操作却有明显的区别。考虑图3.44中的例子，概率的说法可能是“一个人年轻的可能性是。50%*.而模糊逻辑的说法可能是一个人在年轻人集合中的隶属度等级是0.5”2。这两种说法的区别很重要。在第一种说法中，考虑一个人不是在年轻人的集合里，就是不在年轻人的集合里；我们仅有50%的机会知道这个人属于哪个集合书二种说法预设一个人的年轻程度，，在这种情况下其年轻程度是0.5。。另外一种解释是说这是一平均的”年轻人：不是真年轻，但也不是太接近不年轻。换句话说，模糊逻辑完全不是概率；它又仅处理一个集合中隶属度的等级。模糊逻辑这一概念就在由含混和不精确而不是。在这种情况下，随机性表征的应用中找到了用途。些常用的隶属度函数实际中使用的隶属度函数类型如下所示三角形：l-(a-z)76,(3.8-6）u(z)=11-(z-a)7c，≤z≤a+C其他梯形:l-(a- z)Ic，:≤z<a1z<b(3.8-7）u(z) =1-(z-b)/d，b≤z≤5+d其他人2：-z)7b,≤z≤au(z) =(3.8-8）其他0,灰度变换与空间滤波109S形:<4a≤z8b(3.8-9）S(z;a,b,c)=钟形:S(z;c钟形函数有时也称为II（或功(3.8-10）1(z) =函数。-S(z;c,c+b/2,c+5),. >C截尾高斯形：:≤zSa+C3.8-11）u(z) =民他典型地，为简化公式，，当写成山(z)时，，隶属度函数仅依赖于变量 z。为了用式(3.8-10)的形式。图3.46显示了刚才讨论的隶属度函数的几个例子。前三个函数是分段我们把式(3.8-9)作为一个例外。一个函数是截尾高斯函数。。式(3.8-9)描述了一个重要的S线性的，接着的两个函数是平滑的，最后一形函数，在处理模糊集合时会频繁使用这个函数。该式中S=0.5时,值:=b称为交叉点。如图 3.46 d）图3.46(e)所示的钟形曲线所示，这是曲线改变形状的那个点。不难证明b=(a+c)/2（见习题3.31)。E中，b的值定义为曲线的带宽。角形梯形截尾高斯形199图3.46对应于式(3.8-6)至式(3.8-1)的隶属度函数110模糊集合应用3.8.3我们将关注模糊集的应用基础，并通过一些简单且熟悉的例子来说明这些由此而来在这一节，我们将这些结果应用到3.8.4 节和3.8.5 节的图像处理中。采用这种说明方法，使得对的概念。然后，该内容更容易理解，特别是对该领域的新读者。假设我们感兴趣的是用颜色把给定的水果分为三类:：生的、半熟的和成熟的。假设观察水果成熟的各个阶段得到了如下结论：生的水果是绿色的，半熟的水果是黄色的，成熟的水果是红色的。标志绿、黄和红是颜色感觉的含混描述。。作为起点，这些标志必须以模糊形式来表达，也就是，它们必须被模糊化。这是通过将隶属度定义为颜色(光的波长)的函数来实现的，如图3.47 (a)所示。在本文中，颜色是一个语言学上的变量，而一一种特定的颜色如有固定波长的红色)是一个语言学上的值。通过用隶属度函数将语言学上的值z。映射到区间[0,1]来模糊化，如图3.47 (b)所示。1(z）Hiea(z）颜色（波长）图3.47(a)用于模糊颜色的隶属度函数；(b)对特定颜色z。的模糊化(描述颜色感觉的曲线是钟形曲线；见6.1节的例子。但在处理模糊集合时，通常使用三角形曲线来近似)刚刚解释的特定问题的知识可以用如下形式的IF-THEN模糊规则来形式化：R：IF颜色是绿色，THEN水果是生的。F-THEN规则中THEN左侧的部分通常称为前提(条件）、而右侧的OR部分称为后果(或结论)。R.：IF颜色是黄色，，THEN水果是半熟的。ORR：IF颜色是红色，THEN水果是熟的。这些规则描述了关于该问题的知识的总和；它们确实没有超出思维过程的形式化。该过程的下一一步是寻找一种使用输入(颜色)和由 IF-THEN规则描述的知识基础来创建模糊系统的输出的方法。这一处理称为推断或推理。然而，必须处理每个规则的前提以便产生，在运用推断之前，单个值。正如在这一节末尾所示的那样，前提的多个部分可由AND和OR链接起来。HrektoPlar（tD） 3.8.2 节的定义，这意味着执行最小和最大操，我们首先处理仅包含一一个部分为简化说明，装0.5的前提的规则因为我们处理的是模糊输人，输出本身也是模糊的，，因此，也必须针对输出定义隶属度80  90 100函数。图3.48显示了我们将在该例中使用的模成熟度（%）糊输出的隶属度函数。注意，输出的自变量是图3.48表征输出为生的、半熟的和熟的的隶属度函数成熟的，它不同于输入的自变量。数学图像处理(第三版）3.8.4使用模糊集合进行灰度变换考虑对比度增强这样的一一般问题，这是灰度变换的主要应用之一。我们可以用如下规则说明灰度级图像对比度增强的过程:IF个像素是暗的，THEN使它较暗。F个像素是灰的，THEN使它仍是灰的。个像素是亮的，THEN使它较亮。记住，它们是模糊项，我们可以用图3.53(a)中的隶属度函数来表示暗、灰和亮这些概念。在输出项中・我们可以将“较暗”考虚为暗灰度值的程度（100%的黑是暗色调的极限伯)，将“较亮”考虑为亮色调的程度（100%的白是极限值)，将“灰的”视为中间灰度级中灰度的程度。。这里，听谓的“程度”是一种特定灰度的数量。例如，80%的黑是非常暗的灰色。。如图3.53(6)所示，当作为恒定灰度来解释被修改的强度时，输出隶属度函数是单一值(隶属度函数是常数)。。在区间[0、、1]内，当单一值被来自相应规则的响应强度裁剪时，会出现各种程度的灰度，正如图3.52的第四列那样(但应记住，如图中所示，我们这里仅有一一个输入，而不是两个)。因为在输出隶属度函数中我们处理的是常数，故它遵循式(3.8-18)，即对于任何输入名，输出。由下式给出：ALan（.)×*. +4、（-,X×.+ un （元）×》，（(3.8-22）Aar （Zz)+ eny （Zo）+ brnghn （Zo）该表达式中分子和分母的总和比式(3.8-18)中的简单，因为输出隶属度函数是被模糊值修改(裁剪)过的常数。ia 基于规则的对比度增强：（(a)输入的隶属度函数；（b)输出的隶属度函数模糊图像处理的计算量很大，因为全部模糊处理、所有规则的前提、推断、聚集和去模糊，都必须应用到输入图像中的每个像素。这样，使用像式(3.8.22中那样的单一值，通过简化推断、聚集和去模糊，可有效地减少计算需求。在处理速度是重要要求的应用中，这些节省是很有意义的。列3.19使用基于规则的模糊集的对比度修改的图像增强的说明。图3.45(a)显示了一幅图像，，由于该图像的灰度只占灰度级很窄的范围「见图355 （a中的直方图」给出的是一幅低对比度外观的图像。作为对比的基础，图3.546)是直方图均衡后的结果。正如该结果的置方图显示的那样「见图3.55 6)〕，扩展整个灰度级的确增加了对比度，但在高端和低端引入了使图像过度感光”的外观。例如，爱因斯坦教授的前额和头发的细节大部分都缺失了。图3.54(c)显示了使用前几段讨论的基于规则的对比度修改方法的结果。图355 （显示了所用的叠加在原图像的直方图上的输弟3章117；(c)用基于规则的模糊集合的对比度增强后的结果(a)低对比度图像；(D)直方图均衡后的结果；图3.54比较图3.54(6)和图3.54(c)，我们看到后者在色调上有相当大的改进。例如，注意前额和头发中的细节与图3.54(6)中相同区域的对比。通过研究示于图3.55(d)的3.54(c)的直方图可很容易地解释这种改进的原因。不像均衡过的图像的直方图那样，该直方图保留了原图像直方图的相同的基本特征。然而，暗级别(直方图低端的几个高峰值)的左移很明显，从而暗化了级别。对于亮级别则相反。中间灰度稍微地分离了，比直方图均衡化小了很多。(e)叠加在图(a)上的输入隶属度函数；d)图3.54(c)的直方图图 3.55(a)-(b)图3.54(a)和(G)的直方图；在性能上这一改进的代价是加大了处理的复杂性。。当处理速度和图像春吐量是重点考虑的问题时，可遵循的实际方法是使用楼糊集热术米决定什么是看似可很好地平衡图像的真方图。然后，使用更快的技术，通过把输入图像的直方图映射到一个或多个用模糊方法确定的“理想”如直方图规定化，直方图，来达到类似的结果3.8.5使用模糊集合进行空间滤波当把模糊集合用于空间滤波时，基本方法是定义一一个邻域特性，该特性“截获”滤波器支持检则的本质。例如，考虑检测一幅图像中区域间的边缘。。这在图像处理的应用中是很重要的，例如本节210|前面讨论的锐化和第10章将要讨论的图像分割等。Ei我们可以开发一个基于模糊集合概念的边缘提取算法：“如果一个像素属于平滑区，则令其为白18“黑色”和“白色”是模糊集合。。为了用模糊术语表示“否则使其为黑色"，其中"平滑区”概念，我们可以考虑邻域中心处像素和邻域像素间的灰度差。对于图3.56 (a)中的3×3邻域，中心像素(标为zs）和邻域的每个像素间的灰度差形成了图3.566b)所示的3×3子图像，其中d,表示第；个邻其中亏为灰度值)。。四个 IF-THEN 规则和一个 ELSE规则的简单集合就可以实现本段开始提到的模糊集合概念的本质:F dz是0d。是0THEN z。是白色AND为简化这个例子、我们仅使用了F ds是0 AND ds是0乙。是白色THENz4邻域和中心点的灰度差。使用8邻F d.是0 AND da是0THENzz。是白色城可直接扩展此处显示的方法。IF d.是0AND d,是0 THENz是白色ELSE z是黑色其中，“0””也是一个模糊集合。每个规则的后项定义一个值，中心像素(z。)的灰度被映射到该值上。也就是说,石五37乙吾句“THEN zg是白色”意味着位于模板中心位置的像。这些规则简单地表明，如果前素的灰度被映射为白色。像素邻域灰度邻域图3.56一个3×3像素邻域；边提到的灰度差为0(在模糊意义下)，则中心像素考虑为(b)中心像素种其邻点间的相应灰度差。为简化，讨坦区域的一部分；否则，中心像素就考虑为边缘像素。论当前应用中仅使用了a,.d,L。和4图3.57分别显示了模糊集合0、黑色和白色的可能的隶属度函数，其中我们使用ZE,BL和WH以简化表示。注意，对于一幅具有L个可能灰度级的图，模糊集合 ZE的自变量的范围是[-L+1, L-1]，因为灰度差的范围可以在-L-1)和L-1)之间。图3.58以图形方式显示了上面规定的规则，其中，方面，输出灰度的范围如原图像中那样是[0,L-1]。图际为z的方框指出中心像素的灰度被映射到输出值WH或B。灰度差图 3.57(a)模糊集合0的隶属度函数；b)模糊集合“黑色”和“白色”的隶属度函数iTHENWHwnZEZE规则1规则2ZETHENWHWHZE现则3规则4ELSE[zs上[BL图3.58边缘检测的模糊规则119第3章使用基于规则的模糊集合的空间滤波增强边缘的说明。例3.20，图3.59 (b)是使用刚刚讨论的模糊空间滤波图3.59（a)显示了一幅512×512的人的头部CT扫描图像，包括大脑的轮廓(灰色区域内部)。E方法的结果。注意，提取区域间边缘的方法的效果，图像中的恒定区，因为当前面讨论的灰度差接近）时，THEN 规则有一个很强的响应。这些响应依次裁剪函或呈现灰色，一个常数，从而在图像中产生了所着到数 WH。输出(裁剪过的三角形区域的重心)是L-1)/2和L-1)间的的浅灰色调。该图像的对比度可以通过扩展灰度级来显著地改进。例如，图3.59(c)是通过在K=L-1时执行式(2.6-10)和式(2.611)中定义的灰度标定得到的。最终结果是图3.59(c)中灰度值跨过从0到L-1)的全部灰度级图3.59（a)人的头部的CT扫描图像；(b)使用图 3.57中的隶属度函数和图3.58中的规则的模糊空间滤波的结果；（e)灰度标定后的结果。b)和(c)中淡黑色的图像边缘是为增加清晰度添加的，它们不是数据的一部分(原像由Vanderbilt 大学的David R. Pickens博士提供）小结您刚刚了解到的内容是灰度变换和空间滤波中当前使用的有代表性的技术。本章中所包含的主题都是可以作为发展领域的基础的基本材料而选择的。虽然本章中所用的大多数例子都是关于图像增，并且在与图像增强完全无关的本书剩余章节中您会再次遇到强的，但所介绍的技术都是可以通用的，，但是使用的是频率域的概念。正如愈将要看到的那样，它们。在下一章中，我们将再一次注意滤波，这里研究的线性空间滤波和频率域滤波之间存在着一-对应的关系。参考文献3.1 节中的内容来自 Gonzalez[1986]的书籍。33.2节内容的辅助读物可以在Schowengerdt19831,，也可参阅Tuji等人1991的论文。关于直Poyton[196]和Russ 1999)中找到。关于图像最佳显示的内容，方图处理的早期参考文献有 HummStark[2000]对自适应对比度增强的直方图均衡给出了重要的概括。对比度增强的其他方法由CentenHaertel 1997]及Cheng和Xu[2000]给出了例子。严格的直方图规定化方面进一一步阅读的材料见Coluc, Bolon和 Chassery[2006]的论著。局部直方图均衡方法的延伸内容见 Caselles等人19991和 Zhu等人[1999)的材料。对于图像处理中局部统计应用和实现，，可以参考 Narendra和Fichi981]的署述。。Kim等人[1997]介-种结合梯度处理与局部统计处理来增强图像的有趣方法。关于线性空间滤波器及其实现的附加读物可见LUmbaugl205, Ja1981及2Roneld和Kk1921的材料。排序滤波器在这些参考材料中也有讨论。Wibum1981也概括地介绍了排序滤波器。Pias和vesnos19901所著的书中涉及了中值滤波器和其他非线性滤波器。IEEETanactim i Imagesingt1996)的一期特刊中介绍了非线性图像处理的内容。有关高提升滤波的内容来自Schowngerdt[19831的论著。在讨论图像复原(见第5章)和边缘检测(见第10章)时，还会遇到本章中介绍的许多空间滤波器。3.8节的基础参考材料是L.A. Zadeh撰写的关于模糊逻辑的三篇论文(Zadeh[1965, 1973, 1976])。正如它们建立的模糊逻辑及其应用基础那样，这些论文是精心书写和有详细阅读价值的。。关于模糊逻辑在图像处理中广泛应用的综述可在 Kerre和 Nachtegael2000]的书中找到。。3.8.4 节的中例子是以 Tizhuoosh12000描述的类似的应用为基础的。3.8.5、节中的例子基本上来自Russo和Rampoi4的论著。模糊集合在灰度变换和图像滤波中的应用的其他例子可分别参阅 Patrscu[20041及Nie和Bamer2006]的论著。前面所述的从1965 年到2006年的参考文献，是详细研究在图像处理中使用模糊集合的许多方法的起点。本章中讨论的许多方法的软件实现可在 Gonzalez, Woods和Eddins[20041中找到。中标有星号的习题的详细解答可在本书的网站上找到。该网站还习题包含有基于本章内容的建议项目为了展开一幅图像的灰度，使其最低灰度为C、最高灰度为L-1，试给出一个单调的变换函数*3.1x为正常数的指数式e-”又对于构造平滑的灰度变换函数是非常有用的。从这个基本函数出发，构造具有下列图形形状的变换函数。所示的常数是输入参数，并且您提出的变换必须以特定形式包含这些参数(为了简化您的答案，第三条曲线中不需要参数L）T(r）*(a）试给出实现图3.2(a)所示的对比度拉伸变换的一个连续函数。此函数不仅包含参数m，而且还必须包含参数E，以便控制灰度值由低向高变化时函数的斜率。该函数应归一一化，以使其最小值和最大值分别为0和1。b）画出作为参数E的函数的一组变换，固定值m=L/4，其中L是图像中灰度的级数。c）为使函数如图3.26)的函数那样有效地执行,E的最小值是什么？换句话说,您的函数与图3.2(6）丰一幅二值图像相同的结果。假设使用8比特图像进行处理，并使m=128。可以不同。它仅有产生另外，令C是您正使用的计算机中所能表示的最小正数。一组能够产生4比特单色图像所有单独比特平面的灰度分层变换(例如，变换函数T(r)，在EI0,7]范围内时，T(r) =0，而当r在18,15]范围内时，T(r)= 15，此函数可以产生一幅8比特图像的第4比特平面图像)如果将低阶比特平面的一一半设为零值，对一幅图像的直方图有何影响？6）如果将高阶比特平面的一半设为零值，对一中幅图像的直方图有何影响？试解释为什么离散直方图均衡技术一般不能得到平坦的直方图？*3.63.7假设对一一幅数字图像进行直方图均衡处理。试证明(对直方图均衡后的图像)进行第二次直方图均衡处理的结果与第一次直方图均衡处理的结果相同。38在某些应用中，将输入图像的直方图模型化为高斯概率密度函数是很有用的，高斯概率密度函数的eid形式为121弟3章D,(r)=/2ro其中m和。分别是高斯概率密度函数的均值和标准差。具体处理方法是将m和。看成是给定图像的平均灰度级和对比度。对于直方图均衡，您所用的变换函数是什么？假设图像的像素值是连续的，用一个例子说明有可能存在这样的情况，即由式(3.3-4)给出的变换函数满足31节中的条件(a)和(b)，但其反变换却不能满足条件(a）(a）证明式(3.3.8)中给出的离散变换函数对直方图均衡处理满足3.3.1 节中的条件(a)和(b）5.10*の）证明只有在灰度，。人.01.-1不丢失的情况下，式(3.39）表示的离散直方图反变换才满足3.3.1 节中的条件（a’）和(b)。pAr）3.11幅灰度范围在[0。1]内的图像的概率密度函数p,(r)如右图所示。现对此图像进行灰度变换，使其灰度分布为所示的p,(z）假设灰度值连续,求完成这一要求的变换(表示为r和z的函数)试提出一种如3.3.3节中讨论的局部增强技术的局部直方图修正*3.12方法。3.13有两幅图像f(x,y)和g(rx,y)，它们的直方图分别为，和h。给出根据，和h,确定如下直方图的条件，并解释如何获得每种情形下的直方图:★ (a）f(x,y)+ g(x,y)。Gb）（x,J)- (x,）(c））f(x,y)×g(x,y）。(d）f(x,J)+ 8(x,J)）。e）f(x,y)* g(x, y）右侧所示的图像是很不同的，但它们的直方图却相同。。假3.14设每一幅图像都用一个3×3均值模板来进行模糊处理。a）模糊后图像的直方图还相同吗？试解释原因。b）如果您的答案是不相同，，画出两个直方图。线性空间滤波的实现要求在整幅图像中移动模板的中心点，并且在每个位置计算模板系数与该位置5.15相应像素值的乘积之和(见3.4节)个低通滤波器可以用置所有系数为1的模板来实现，可使用所谓的盒状滤波器或移动均值算法、该方法由仅更新从一个位置到下一个位置变化的计算部分组成。(a）以公式形式给出一一个nxn滤波器的算法，说明涉及的计算规律，以及用于围绕图像移动模板的扫描序列。(b）大规模执行的计算量与盒状滤波器算法执行的计算量的比值，称为计算优势。在本例情况下求，并作为，的函数画一条曲线，其中，>1。由于这两种处理方法的标定参数都是出计算优势，因此在获得计算优势时根本不用考虑它的影响。。假设图像有为0的外部边界，1/n-，，这个边界宽到足以让我们在分析中忽略边界的影响。.16两个空间方向上都小于图像。证明如下重要特性：如果模板的系数之和是0，则得到的卷积阵列(被滤波的图像)中所有元素之和也是0(您可以忽略计算的不准确性)。另外，您可以假设图像的边界已用合适数量的0填充过。(b）如果用式(3.4-1)定义的相关方法来实现滤波，问得到的结果与(a)的结果相同吗？园讨论用一一个3×3低通空间滤波器反复对一幅数字图像处理的结果，可以不考虑边界的影响。应用3.175×5滤波器时有何不同？3.18 *（a）在3.5.2 节中谈到，（相对于背景而言)孤立的暗或亮像素团块，在它们的面积小于中值滤波器面积的一半时，，可被中值滤波器滤除(强迫为邻域的中值)。假设滤波器尺寸为nxn，n为奇数，解释为什么会这样。6)考虑一幅有不同像素团块的图像。假设一个团块中的所有点都比背景亮或暗(同一团块中不同时存在这两种情形)，并且每个团块的面积不大于n12。请请问n符合什么条件时，，有一个或多个这样的团块像(a)中所说的那样被分离出来？ 3.19一个nxn邻域的中值的步骤。a）试给出求一b）试提出一种逐像素地移动邻域的中心来更新中值的技术。(a）在字符识别应用中，文本页用图3.26b)所示的阈值变换函数简化为二值图像3.20。这遵循如下过程背景上的一串即细化字符直到它们成为全"*0°。由于有噪声存在，故二值化和细化处理导致了字符的断开，断开缝隙有1-3个像素宽。修复缝隙的一种方法是对二值图像使用均值模板来模糊它，这样会在缝隙间桥接非零像素。试求出能执行该任务的均值模板的最小尺丁(b）桥接缝隙后，为了转换回二值形式，要对图像进行阈值处理。根据您在(a)中得出的答案，完成这一任务且不再产生断线所要求的最小阈值是多少？ 3.21以下所示的三幅图像是分别通过尺寸为n= 23,25和 45的方形均值模板处理后的模糊图像。图(a和图(c)中左下角的垂直竖条被模糊了，但但竖条与竖条之间的分割仍然很清楚。然而，尽管产生这幅图像的模板要比处理图像(c)的小得多，但但图(b)中的竖条却已经融在了一起。试解释这一现象的原因。老带泰疆游锦中老调赚精领物滑止饭永3.22 考虑图3.34所示的应用，该应用的目的是消除图像中比q×q像素方形包围的物体小的目标。假设想要将目标的平均灰度减少为原来平均灰度的1/10。使用这种方法，那些目标可以接近背景灰度并用阈值法消除。给出平均模板的最小尺寸(奇数)，该模板仅对整幅图像处理一次就可将平均灰度级减少到所希望的程度一个均值模板被用于输入图像以减少噪声，然后再用一个拉普拉斯模板来增强图.23在给定应用中，像中的细节。如果交换一一下这两个步骤的顺序，结果是否会相同？证明如式(36-3所示的拉普拉斯变换是各向同性的(旋转不变的)。您将需要下列轴旋转（角的坐 3.24标方程:x=rcose- y'sinx'sin8+y'cose其中(x,y)为未旋转的坐标，而(r,y)为旋转后的坐标。您在图 338中看到中心为-8的拉普拉斯模板所得到的结果，要比中心为一4的模板所得到的结果女3.25清晰一些。详细说明其原因。219韦3章123参考习题3.25.26a）若使用一个类似拉普拉斯的较大模板，如中心系数为-24的5×5模板，问是否可得到更加清晰的结果？详细解释一下。b）当该模板的大小与图像大小相等时，会发生什么情况？使用该模板来对一幅图像执行非锐化模板处理。假设均值图像使用高斯滤波5.27给定一个5×5模板，器得到。使用式(3.6-6)给出的拉普拉斯定义，证明从一幅图像中减去相应的拉普拉斯图像等同于对图像进*3.28行非锐化模板处理。(a）证明式(3.6-11)给出的梯度幅值是一种各向同性的操作(见习题3.24）5.29(b）如果使用式(3.6-12)计算梯度，证明其将失去各向同性这一性质3.30使用一台CCD电视摄像机对某一一区域用于每天24小时、每月30天对同一区域进行长期观测研究每5分钟拍摄一一次数字图像并传送到中心场所。。场景的照明白天为自然光，晚上为人造光，没有因此总可以获得一无照明的时间，一幅图像。由于照明的范围总是在摄像机的线性工作范围，因此摄像机本身并不需要使用任何补偿装置。另外，使用数字技术对图像进行后处理并归一化，这样就使得图像与恒定照明是等效的。对此，请设计一种方法。愈可以自由使用您希望的任何方法但必须在设计中明确给出所有的假设。证明图3.46d)中的交叉点由b=(a+c)/2给出。.31使用3.8.2 节定义的模糊集合和图3.46中的基本的隶属度函数，形成下列隶属度函数。.32一ba =0.5 7 +6*(a)*3.33在3.8.5 节讨论的模糊滤波方法中，增大邻域的尺寸会产生什么影响？对您的回答解释其原因(您可一个例子来支持您的答案)久用为了减少一幅具有区间[0,L-1]内的灰度值的含噪图像的脉冲噪声影响，如3.8.5节那样，设计.34基于规则的模糊系统。为简化向题，仅在一个3×3邻域中使用差值4,d,4。和4A。在图像的任何位置，令石表示邻域中心的灰度。相应的输出灰度值应是×=23+v，其中，是愈的模糊系统的输出。也就是说，・慈的模糊系统的输出是一个用于减少可能出现在该3×3邻域中心的噪声峰值效应的校正因子。假设出现的噪声峰值间距足够大，因此，不必关心在同一邻域内出现多个噪声峰值。全部使用三角形隶属度函数。这些峰值可以是暗的或亮的。一条模糊语句。(a）给出该问题的一(b）指定 IF-THEN规则和ELSE规则。c）如图3.57那样，以图形方式指定隶属度函数。d）如图 3.58那样，给出规则集的图形表示。(e）请您给出一个类似于图3.52的模糊系统的简略图。2z0频率域滤波滤波器:抑制或最小化某些频率的波或振荡的装置或材料。频率：自变量单位变化期间，个周期函数重复相同值序列的次数。韦伯斯特新学院词典引I言尽管在前一章中对空间滤波做了重点研究，但如果不了解在图像滤波中如何应用傅里叶变换和频率域的基本知识，要彻底理解这一领域也是不太可能的。您不是一位信号处理专家也能深刻理解这些主题，关键在于要关注基本原理以及它们与数字图像处理的关系。本章将重点阐述对初学者来说较为困难的表示方法，并强调图像特征与用于表示这些特征的数学工具之间的联系。本章主要为傅里叶变换的基本原理打下一个基础，并介绍在基本的图像滤波中如何使用傅里叶变换。然后，在第5章、第8章、第10章和第11章中，我们将讨论傅里叶变换的其他应用。本章从傅里叶变换的起源及其应用于数学、科学及工程的众多分支的要点开始讨论。然后，我们从函数取样的基本原理开始,逐步推导一维和二维离散傅里叶变换以及频率域处理的要领。。在这段阐述中，我们还要接触几个重要的取样问题，例如，、混淆，这些处理要求对频率域的理解，且在本章也有很好的覆盖。。接下来是频率域滤波的公式表示，以及与第3章中讨论的空间平滑和锐化滤波技术相对应的部分。我们以在图像处理中实现傅里叶变换的有关问题的讨论结束本章。。因为4.2节到4.4节的内容是基本背景知识，对一准信号处理，，包括傅里叶变换、取样、混淆和卷积定理很熟悉的读者可直接跳到4.5 节，在这里，我们开始讨论二维傅里叶变换及其在数字图像处理中的应用。背景4.14.1.1傅里叶级数和变换简史法国数学家南恩・巴普提斯特，约瑟未・得果叶Aen p s op poure E 1768年生于巴黎与第戎之闸的奥克塞里（Auxemne）镇。他被世人铭记的最大贡献记载在他于1807年发表的传记中和1822年出版的La ZTheorie Aaliuede laCaleur(热分析理论))一书中。此书由Freeman(参见 Freeman1878D在55年后翻译为英文。傅里叶在这个领城的文献是。他指出任何周期函教都可以表示为不同叛率的正弦型和(戌金弦之和的形式，每介正弦项和或余弦廉乘以不同的系数(现在称该和为傅里叶级数)。无论函数多么复杂，只要它是周期的，并且满足某些适度的数学条件，都可以用这样的和来表频率域滤波125示。我们现在认为这是理所当然的，俱在当时，这个概念第一-次出现之后，个复杂函数可以表示为简单的正弦和余弦之和的概念一点也不直观(见图4.1)，所以傅里叶思想遭到怀疑是不足为奇的。甚至非周期函数(但该曲线下的面积是有限的)公WV也可以用正弦和/或余弦乘以加权函数的积分来表八VV八，其作用示。在这种情况下的公式就是傅里叶变换，在多数理论和应用学科中甚至远大于傅里叶级数。V VV/ V用傅里叶级数或变换表示的函数特征完全可以通过傅里叶反变换来重建，而不会丢失任何信息。这是这种表示方法的最重要特征之一，因为它可以使我“傅里叶域"，而且在返回到函数的原始门工作于域时不会丢失任何信息。。总之，，傅里叶级数和变换是解决实际问题的工具，它作为基础工具被广泛地学习和利用。傅里叶概念的最初应用是在热扩散领域，在该领域，人们考虑用微分方程来表示热流动，并并且使一个世纪用这种方法第一次获得了结论。在过去的中，尤其是后50年，傅里叶的思想使整个工业和学术界都空前繁荣。早在 20世纪 60 年代(或更晚些)，数字计算的出现和快速傅里叶变换算法(FFD的“发现”在信号处理领域产生了巨大变革。这图 4.1底部的函数是其上面4个函数的和。1807年,两种核心技术第一次允许人们对从医学监视器和傅里叶关于周期函数可以表示为正弦和扫描仪到现代电子通信的异常重要的信号进行实余弦的加权和的概念遭到了人们的质疑际处理由于我们将仅处理持续时间有限的函数(图像)，所以傅里叶变换是我们感兴趣的工具。在以下节的内容中，将介绍傅里叶变换和频率域。业已证明，傅里叶技术为研究和实现主要的图像处理算法提供了有意义且实用的方法。在某些情况下，这些方法与我们在第3章中介绍的方法类似。4.1.2关于本章中的例子如第3章那样，在这一一章中，多数图像滤波例子是处理图像增强问题。例如，平滑和锐化与对比度处理技术一样，与与图像增强有传统的联系。非常自然，数字图像处理方面的初学者会发现图像增强很有趣并很容易理解。因此，在本章中以图像增强为例不仅可节省本书额外的章节，而且更重要的是我们将为初学者介绍频率域滤波技术提供一个有效的工具。在第5章、第8章、第10章和第11章中，对于其他应用我们用频率域处理方法。4.2基本概念为简化本章的概念出现的进程，我们暂时停止介绍为后面的章节打基础的内容的一系列基本概念。4.2.1复数复数C的定义如下:22C =R+j1(4.2-1）126R表示复数的实部，1是复数的虚部。一个复数C的共轭表示为C"，其定义是实数是1=0的复数的子集。C" =R-jl4.2-20复数从几何的角度可以被看成是平面(称为复平面)上的一个点，其横坐标是实轴(R的值)，其纵坐标是虚轴(1的值)。也就是说，复数R+j1是复平面直角坐标系统中的点(R,1)。有时，，在极坐标下表示复数很有用:4.2-3）C =|C|(cos8 + jsine）其中，ICl-VR"+产是复平面的原点到点(R.）的向量的长度，40是该向量与实轴的夹角。。在第一象限中为向量画一个实轴和虚轴的简图将显示出tan 0 1=(1/R)或8= arctan(1/R)。arctan 函数返回区间T./2./21内的一个角度。然而，因为！和尺T可独立为正和负，、因此我们需要能够得到全域LI-n.n，可通过简单地跟踪1和R的符号来完成。内的角度。。在计算6时，。许多编程语言可通过调用四象限反.MATLAB为此目的提供了函数atan2 GTmag,Real）。正切函数来自动地计算角度。例如，使用欧拉公式=cos8 + jsine4.2-4）其中，e=2.718 28.可给出极坐标下我们很熟悉的如下复数表示：C =|cle"”其中・.I和0的定义如上上。例如，复数1+j2的极坐标表示是√5e”，其中8 =64.4或11弧度(ra）前面的公式还可以用于复函数。例如、变量u的复函数Fu)可表示为Fu)= Ru)+ j1(u)，其中R(u）和(u）分别是实分量函数和虚分量函数。正如前面说明的那样，复共轭函数是F"(u) = R(u)-jl(u），幅值是|F(u)|= JRu)* +1(u），角度是6(u = arctanL(u)/ R(u)]。在本章和下一章中，我们还会多次讨论复函数。4.2.2傅里叶级数正如4.1.1 节指出的那样，具有周期T的连续变量1的周期函数孔0可以被描述为乘以适当系数的正弦和余弦和。我们知道，这个和就是傅里叶级数，它具有如下形式:学f(1) =4.2-6）其中，rJ,,o0n=0, ±1, ±2,4.2-7）是系数。式(4.2-6)可展开为正弦与余弦之和这一事实来自欧拉公式(4.2-4)。在本章的后面我们将回到傅里叶级数。冲激并不是通常意义上的函数4.2.3冲激及其取样特性文心但是，我们在文献中通常会看到冲激函数、员函数和狄拉克6函数线性系统和傅里叶变换研究的核心是冲激及其取样特性。连续变这样的名称，尽管它们都名不副实。量1在1=0处的单位冲激表示为6(0)，其定义是第4章127=060) =4.2-8a）0,≠0它还被限制为满足等式8u)di =14.2-85)物理上，如果我们把1解释为时间，那么一个冲激可看成是幅度无限、持续时间为0、具有单位面积一个冲激具有关于如下积分的所谓取样（sitin的尖峰信号。）特性：f(D)6(t)dt = f(0） 4.2-9）假设f(n)在1=0处是连续的，，这是实际中满足的一个典型条件。取样sit宅面上的意思是分隔，或通过特性得到函数f()在冲激位置(也就是，在前面的公式中为原点1=0）个筛子分拣。一种更为一般的说明涉及位于任意点。的冲激，表的值。取样特性的示为6(-1,)。在这种情况下，取样特性变为(4.2-10）f(OD)6(-to)dt = f(to）它在冲激位置1。处得到一个个函数值。例如，如果f(1) = cost)），使用式(4.2-10)中的冲激6(-r)得到结果（GrD costr) =-1。耶取取样概念的能力立即变得相当明显。。单位离散冲激6(x)在离散系统中的作用与处理连续变量时冲激6()的令x表示一个离散变量。作用相同。其定义如下：=0(4.2-11a）S(x)=x≠0很明显，该定义也满足式(4.2-8b)的离散等效形式:三。00=1(4.2-11b)离散变量的取样特性有如下形式:Eros6o0= /04.2-12或者，更一般地用位置x=瑞处的离散冲激，4.2-13f(x)B(x-x0)= f(X）如前面一样，我们看到，取样特性可简单地得到冲激位置处的函数值。图4.2以图解方式显示了单位离散冲激。与其连续形式不同的是,，离散冲激是一个普通函数。本节后面特别感兴趣的是冲激串sr()，它定义为无限多个分离的周期冲激单元△T之和:2α-nAT）(4.2-14）Ssr(1)=园图4.3显示了一个冲激串。冲激可以是连续的或离散的。1282AT位于x=石处的单位离散冲激。变量x是图4.3一个冲激串图4.2离散的，任何不在×=×处的员都是。连续变量函数的傅里叶变换4.2.4 由S{f(0)}表示的连续变量1的连续函数f(0）的傅里叶变换由下式定义0：Su 0) .0o"ad(4.2-15）一个连续变量。因为1被积分过了，故S{f()}仅是江的函数。为了明确表示这一事实，其中，p也是。f(t)的傅里叶变换可写为我们把傅里叶变换写成S{f(0)}= F(u)；也就是，为了方便，_foe-Pwa(4.2-16）F(u) =通过傅里叶反变换可以获得了a)，即f0)=3-"{F（u)），写为相反，给定F(山)），通(4.2-17）/0= 5（aeoweau即在反变换中变量在被积分过了，并简单地写成f(t，而不是更我们使用了这样一一个事实，良文里，麻烦地表示为/0=8"(D）。式(4.210和式4.2:17)合起来称为傅里叶变换对。它们指出了在一个重要事实，即一个函数可以由其变换来恢复。.1 节中提到的一用欧拉公式，我们可以把式(4.2-16)表示为foJlcos(Zrup- jsin(Zzrun)lan4.2-18)F(（u)=」我们看到，如果f(0）是实数，那么其变换通常是复数。注意，傅里叶变换是/(0)乘以正弦项的展开，正弦项的频率由从的值决定(如早些时候提到过的，变量在被积分过了)。因为积分后左边剩下的故我们说傅里叶变换域是频率域。在这一-章稍后，我们将详细地讨论频率域及其特性。一变量是频率，古全我们的讨论中，1可以表示任何连续变量，频率变量伍的单位取决于口为与前两章中使用的术语保持的单位。、例如，如果，表示单位为秒的时间，则山的单位为周秒・.致、并在杰意后面用于图像，凯变，或者量1用于说明图像时，我们一般将变赫兹(H比)。如果在表示的是以米为单位的距离，则从的单位是周/米，量1的域称为空间域。等等。换句话说，频率域的单位是独立于输入变量的每单位周期的。限的。实践中傅里叶变换的存在性通常不是问题，但理想信号除外，因为这种正弦信号会无限扩展。这些内容可使用通用的冲激函数来处理。我们的主要兴趣在于离散博里叶变换对，它是所有限函教存在的保证，后面我们1很快会看到这一点频率域滤波129例4.1一个简单函数的傅里叶变换。图4.4(a)中的函数的傅里叶变换可由式(4.2-16)得出:Fu=J../oe-wdi Aeriwde-j242ruj2zruJ2ru(ruw）其中，我们利用了三角学恒等式sin8 =（el" -e-3)/2j。在这种情况下，傅里叶变换的复数项精细地合并一个实正弦函数。。前面表达式的最后一步是熟知的sinc函数:sin(rm4.2-19）inc(m)=(rm）其中，sinc(0)=1，对于m的所有其他整数值,sincdm =0。图4.46)显示了 F(u)）的曲线。通常，傅里叶变换包含复数项，且为显示目的，通常处理该变换的幅值(一个实量)，该幅值称为傅里叶谱或频谱:sindruwF(A|= AW(TuW）图4.4(c)显示了作为频率的函数的|F山)的曲线。。我们注意的关键特性是F(山)和|F(的零值位置与“盒函数的宽度W成反比，即波瓣的高度随函数距原点的距离降低，并且函数在在值的正方向和负方向上无限扩展。正如您在稍后将会看到的那样，这些性质对解释图像的二维傅里叶变换谱十分有用。Iw/22/W 一图4.4Ga）一个简单的函数；の)该函数的傅里叶变换：ce)该函数的谱。所有函数在两个方向上都无限扩展列4.2冲激和冲激串的傅里叶变换。位于原点的单位冲激的傅里叶变换由式(4.2-16)给出:F(p)=其中，第三步由式(4.2-9)中的取样特性得出。这样，我们看到，个位于空间城原点的冲激的傅里叶变换，在频率域是一一个常数。类似地，位于1=6的一个冲激的傅里叶变换是r0-=.60-0-anecos(2ruto)- jsin( ZTuo）动公式的第三步由式(4.2-10)中的取样特性得到，最后一行由欧拉公式得到。最后两行是以复平面原点为中心的单位圆的等效表示。30在4.3节，我们将利用周期冲激串的傅里叶变换。得到这个变换并不像我们得到刚才显示的单个冲激的变换那样简单。然而，理解如何推导一个冲激串的变换是十分重要的，，因此这里我们花一些时间来详细推导它。我们从仅在形式上与式(4.2-16)和(4.2-17)的指数符号上有些不同的注释开始。这样，如果函数了0有傅里叶变换FGD)，则在点1求值后函数是Fo)，它一定有变换了(一H)。使用这种对称特性和上面给出的冲激60-）的傅里叶变换是eP”可得其中最后一步是正确的，因为员仅在口=a时不为零，对于”的变换是6(-p+a)=6(u-a)，8(-4+a)或6(u-a)，结果均相同，因此这两种形式是等价的式42-149中的冲激事串srfO）是周期为公T的周期函数，因此由422可知它可表示为一个傅里叶级数:."Ar(1)=其中，参考图4.3，我们看到区间[-AT/2,A7/2]的积分仅包含位于原点的冲激sxrt)。因此，上面的公式变为,.oe-Pa=AT然后，傅里叶级数可展开为尝我们的目的是得到该表达式的傅里叶变换。因为求和是线性过程，得到和的傅里叶变换与求各个分量的傅里叶变换之和是相同的。这些分量是指数形式，在这个例子中，我们早些时候已确立AT因此，周期冲激串。s,r(O）的傅里叶变换Su)是三-~}-2-*}-六三“(一六）SGu)=S{sxr0}=3这个基本结果告诉我们，周期为AT的冲激串的傅里叶变换还是冲激串，其周期为1/AT。。Sxr(h)和S(u）之间周期的这种反比关系与图4.4中盒状函数及其变换之间的关系是类似的。这种特性在本章的其余部分中扮演着主要角色。4.2.5卷积在讨论之前，我们还需要建立一个模块。我们在 3.4.2 节介绍过卷积的概念。在那一节，愈已了解两个函数的卷积涉及一个函数关于原点做翻转(旋转180°）并滑过另一个函数。在滑动过程中的每个位移处我们执行计算，在第3章的情况下是计算乘积之和。在当前讨论中，，我们的兴趣在于具有连续变量，的两个连续函数f(0)和hG)的卷积，因此我们必须用积分代替求和。像之前那样，这两个函数的卷积由算子★表示，卷积定义如下：/0)*0 = ..f(T)ht-r)dt(4.2-20)弟4章其中，负号表示刚刚提及的翻转，1是一个函数滑过另一个函数的位移，而て是积分假变量。现在我们假定函数从一。扩展到~在图3.4.2中我们说明了卷积的基本机制，而且在本章稍后和第5章中我们会再次说明它。此时我们的兴趣在于寻找式(4.2-20)的傅里叶变换。我们从式(4.2-15)开始：3{/60*0}- _[二 rm-r "-J7r “r-re-a」l方括号中的项是h(-r)的傅里叶变换。我们在本章稍后将证明如果颠倒（0),和 A）的顺序。H（(upe-zu"，其中从(u）是ha）的傅里叶变换。。在前S{h(t-T)}=以得到相同的结果，故卷积满足交公式中利用这一事实可得换律。s{0*k0)=  r[ue-w" ]a =A0nD  r-" a HunyFGun）回顾一下 4.2.4节，我们将口所在的域称为空间城，而将山所在的域称为频率城，前面的公式告诉我们，空间域中两个函数的卷积的傅里叶变换等于两个函数的傅里叶变换在频率域中的乘积。反过来，，那么我们可以通过计算傅里叶反变换得到空间域的卷积。。换句话说如果有两个变换的乘积，f(0★ht)和H(山)F(山)是傅里叶变换对。这一结果是卷积定理的一半，并可以写为f (n)★ht)←H(u)F(A）(4.2-21）双箭头用于指示右边的表达式是通过对左边的表达式执行傅里叶变换得到的，而左边的表达式是通过求右边的表达式的傅里叶反变换得到的遵循类似的推导可得到卷积定理的另一半:f (r)h(n)→H(u)★F(山）(4.2-22）它说明频率域的卷积类似于空间域的乘积，两者分别与傅里叶正、反变换相联系。正如在本章稍后您将看到的那样，，卷积定理是频率域滤波的基础。取样和取样函数的傅里叶变换4.3在这一节，我们将利用42 节的概念系统地阐述取样的数学基础。这将从基本原理开始引导我们学习取样函数的傅里叶变换。取样4.3.1用计算机处理之前，连续函数必须转换为离散值序列。正如 2.4 节介绍的那样，这是用取样和量化来完成的。在下面的讨论中，我们将详细地研究取样。参考图4.5，考虑一个连续函数f()，我们希望以独立变量1的均匀间隔(AT)取样。我们假定函数对于1从一。到。扩展。如4.2.3节讨论的那样，模拟取样的一种方法是用一个AT单位间隔的冲激串作为取样函数去乘以了()，、即fo)6u-nAT）4.3-1f(0)= f(0)sz 1) = B其中，ft)表示取样后的函数。这一和式的每一个分量都是由在该冲激位置处fの)的值加权后的冲激,234如图4.5(C)所示。每个取样值由加权后的冲激“强度”给出，我们可通过积分得到它。也就是，序列中的任意取样值。由下式给出：单位间隔取样表明取样率安公T如果AT的单位为秒等于1 AT(4.3-2）_f(n)6t-kAT)dt = f(kAT）1. = 则采样率的单位是取样数/秒、如果AT的单位是米、则取样率的单位其中，我们利用了式(4.2-10)中6的取样特性。式(4.3-2)对任何整数是取样数/米，依次类推。…都成立。图4.5(d)显示了结果，它由原始函数的,-2,-1,0,1,2,等间隔取样组成。ST 2公7(kAT（e)图(a)和图(b)相乘形成的取样后的函数；图 4.5个连续函数；(b)用于模拟取样过程的冲激串；a)由积分并使用冲激的取样特性得到的取样值〔图(c)中的虚线仅供参考，它不是数据的一部分」取样函数的傅里叶变换4.3.2令FA)代表连续函数了(）的傅里叶变换。如前节讨论的那样，取样后的相应函数了(n)是了(D个冲激串的乘积。由 4.2.5 节的卷积定理我们可知，空间域两个函数乘积的傅里叶变换是两个函数在频率域的卷积。这样，取样后的函数f价)的傅里叶变换F(p)是F(p)= S{f(0)}=9{f (n)sxr 1)}= F(p)★S(山）(4.3-3）其中，由例4.2可知so-三("一）4.3-4）频率域滤波13是冲激串s,(O）的傅里叶变换。。由式(4.2-20)中的定义我们可直接得到F(山）和S(p）的卷积：Fu)= F(山)★S(山) =F(rDSu-r)drH从 厂-" (0-- - 三J二*-一-）(4.3-5） 三"一云）其中，最后一步来自于由式(4.2-10)给出的冲激取样特性。式(4.3-5)中最后一一行的求和表明，取样后的函数f(n）的傅里叶变换F(山)是F(p)的一一个拷贝的无限、周期序列，，也是原始连续函数的傅里叶变换。拷贝间的间隔由1/AT的值决定。很明显，虽然f(0)是取样后的函数，但其变换F(山)是连续的，因为它由F(p)的几个拷贝组成，所以F(山)是一个连续函数。图 4.6是前面结果的一个图示总结”。图4.6(a)是函数f(价)的傅里叶变换F(山)）的简图，图4.6）显示了取样后的函数的变换F(u）。正如前节提到的那样，1i/AT是用于生成取样后的函数的取样率因此，在图 4.6(b)中，取样率要足够高，以便在周期之间提供有效的间隔，并保持F(p）的完整性。全图 4.6(c)中，取样率刚好足以保持F(u)，但在图4.6(d)中，取样率低于保持不同F(p)拷贝的最小取样率要求，这样，就不能保持原始变换。图4.6(b)是对信号过取样后的结果，图4.6 (c)和(d)分别是对信号临界取样和欠取样后的结果。这些概念是下一节内容的基础。*(u）1/72/ATi/T1/A7/公T3/47图4.6a一个带限函数的傅里叶变换；O)-(0分别在过取样、临界取样、欠取样条件下取样后的函数的博里叶变换235|236の 为清楚起见，图4.6中傅里叶变换的草图及本章中的其他类似图形。忽略了变换一般是复函数这一事实134+.3.3取样定理我们在24节中直观地介绍了取样的概念。现在，我们考虑形式上的取样过程，并确立一个条件，在该条件下，一个连续函数完全可由其取样集合来恢复。对于以原点为中心的有限区间(带宽)上一…之外的频率值・其傅里叶变换为零的函数f()称为带限函数。图4.7(a)就是这样一个函数，它是图 4.6(a)的一个放大部分。类似地，图4.7(6)是图 4.6C)所示临界取样后的函数的傅里叶变换更详细的视图。较低的1/AT值将导致F(山)中的周期融较高的1/AT值在周期之间会提供更为清晰的间隔。如果能从F(山)中包含的这个函数的拷贝的周期序列中分离出F(p)的一个拷贝，那么我们就可以从取样后的版本复原f0)，其中F(p)是取样后的函数f(t)的傅里叶变换。回顾前节的讨论，F(p)是周期为1/AT的连续周期函数。因此，我们需要一个完整的周期来表征整个变换。这意味着我们用傅里叶反变换从一个单周期就可恢复f0。如叫果拷贝间的间距足够(见图 4.6)，从F(p)提取一个单周期使其等于F(p)是可能的。根据图4.76b)或者如果1/2 AT > Lmu4.3-6)>24Lma则可保证有足够大的间距。该公式指出，如果以超过函数最高频率的两倍的取样率来获得样本，连续的带限函数可以完全地从它的样本集来恢复。这个结论就是众所周知的取样定理。基于这一结果，如果一个连续的带限函数用取样率大于函数最高频率的两倍的取样来表示不会有信息损我们可以说，我们也可以说，以1/△T的取样率对一天。反过来，我一个信号取样的最完全等于最高频率的两倍的取样大频率是=12公7。有时，奈奎斯特取样率对于完美函数的恢复率，称为奈奎斯特取样率。是充分的，但是，也存在引起困难的情况，，如我们稍后在例4.3中说明的那样。这样，取样定理就规定了取样率必须超过奈奎斯特取样率一个带限函数的变换，(b)对同一函数做临界取样得到的变换图4.7a)-为了从原理上了解如何从F(p)复原F(山)，考虑图 4.8，该图显示了一个以略高于奈奎斯特取样率取样后的函数的傅里叶变换。图4.8 6)中的函数由下式定义：JA7，一AmaxSuAsHmaH(u)=4.3-7）其他0,D取样定理i最先提出。同样来自贝尔实数室的ClmuaESu(克芳德・E，山农于1949年式地证明了该定理。早期数字计算系统和现代通信的出现。使得人们开始研究处理数字(取样后的)数据的力法、从而导致了人们于20世纪40年代后期重新开始关注取样定理。频率域滤波135当乘以图 4.8 (a)中的周期序列时，该函数就隔离了以原点为中心的周武(4.3-7中的AT 抵消了式(4.3-5期。然后，如图4.8(c)所示，运通过H(p)和F(u)相乘我们得到F(u)：中的1/ ATF(p)= H(u)F(up）4.3-82旦得到了F(u），我们就可以用傅里叶反变换来复原f(t）：F（ue"wdu(4.3-9）f(t)=式(4.3-7)到式(4.3-9)从理论上证明了，以函数包含的最高频率的两倍的速率取样得到的函数的样本,来恢复一个带限函数是可能的。。正如下一节我们将要讨论的那样，，f(t)必须是带限的这一要求通常意味着f(t)必须从-扩展到。，多实际上这一一条件并不满足。正如稍后将要着到的那样，限制一函数的持续时间会妨碍该函数的完美复原，，除非是特殊的情况。*（A2/A7I（p）图 4.8使用一个理想低通滤波器提取一个带限函数的变换的一一个周期函数H(山）)称为低通滤波器，因为它通过频率范围低端的频率，但是，它会消除(滤除)所有较高的频率。。它还被称为理想低通滤波器，之间，而在位置-处正好相反)，其特性用物理电子元件是不能达到的。我们可以用软件来模拟理想滤波器，但是，像在 4.7.2 节中解释的那样，，尽管这样，也有限制。在这一章后面,，我们还有更多的有关滤波器的内容要叙述。因为滤波器是从函数的取样恢复(重建)原始函数的手段、，因此刚刚讨论的用于此目的的滤波器称为重建滤波器。4.3.4混淆在这一点上，个合理的问题是：如果一个带限函数用低于其最高频率的两倍取样率取样将会发先仕么情况3这相学无煎六芭忠过论的名取样情况,4图2602段160机同，说明厂这一情况239以低于奈奎斯特取样率取样的最终效果是周期重叠，并且不管使用什么滤波器，都不可能分离出变换136的一个单周期。例如，。使用图 4.9(b)中的理想低通滤波器，将会得到如图 4.9(c)所示的一一个变换，变换已被来自邻近周期的频率破坏了。然后，反变换会产生1的一一个破坏了的函数。由函数欠取样导致的这种效果就是周知的频率混淆，或简称为混淆。。在字面上，混淆是一个过程，在这一过程中，个连续函数的高频分量在取样后的函数中用低频“化妆”一词是一致的，其了。这与通常所用的混淆一意思是“错认了”F（L）/A712/ATl(p)F图4.9一个欠取样带限函数的傅里叶变换(图中来自邻近周期的干扰显示为虚线)；Gb)图4.8(b)中所用的同一个理想低通滤波器；；Cc)图(a)和图(b)的乘积。来自邻近周期的十扰导致了混淆，而混淆妨碍了F(up）的完美复原，并因此妨碍了原始带限连续函数的完美复原。请与图4.8比较很不幸，除了下面提到的某些特殊情况外，在取样过的函数中，混淆总是存在的，尽管原始取样过的函数是带限的，在实践中，我们必须要做的是限制函数的时间，在我们限制函数的持续时间时总会引进无限的频率分量。例如，、假设我们想要把带限函数了(）的持续时间限制在区间(0、7内。我们可以让fOn)乘以如下函数来达到0<1≤T1，h(6t) =4.3-10）0、其他这个函数具有与图4.4(a)相同的基本形状，其变换H(p)具有无限扩展的频率分量，如图4.4(6)所示由卷积定理可知，乘积h(n) f()的变换是这两个函数的变换的卷积。虽然f(t)的变换是带限的，将该变换与H(山）卷积，、它包含在另一个函数上滑动一个函数的过程，这就产生一个频率分量无限扩展的结果。因此，没有有限持续时间的函数是带限的。反过来，，一个带限函数一定从-扩展到~根据前一一段说明的原因，我们断定，用有限长度的取样和记录工作，混淆是一个不可避免的事实。在实践中，可以通过平滑输入函数减少高频分量的方法(如对图像采用散焦方法)来降低混淆的影个重要的特例是当江展到~的函数是带限的周期函数时。此时、该函数可被截断并且仍是带限的，前提是该截240。个最斯的周0明及成数)可由一组满是取特定理并在裁斯的区间上获得的两版样不米表示断精确包含整数个周期。137第4章，它必须在函数被取样之前完成，因为混淆是一一个取样问题，而取样问题不响。这种处理称为抗混淆、能使用计算技术“事后取消”混淆。列4.3图4.10显示了混淆的一一个经典例子。。在两个方向上无限扩展的纯正弦波具有单一频率，因此它很明显是带限的假定图中的正弦波(现在忽略图中的大点)用式sin(rut）来表回忆可知，1个周期秒定义为1出.-1.23.处与并且水平轴对应时间（(单位为秒)。函数在1=时间轴相交。indrn）的周期P是2s，其频率是1/P或1/2周期秒。根据取样定理，如果取样率1/AT超过某一信号最高频率的两倍，我们可以由取样后的一组样本来复原该信号。这意味着取样率大于1个样本/秒2×(1/2)=1]或AT <1s时，才能恢复该信号。显然，以准确的两倍频率(1个样本/秒)的取样率对信号取它们都是零。这说明了洋，在1=…,-1,0,1,2,3,…处得到的样本是…sinf-T),sin(O) ,sin(Tr) ,sin(Zz元), …，它取样定理要求取样率超过信号最高频率两倍的原因，就像前面提及的那样。图4.10中的大黑点是以小于1个样本秒的取样率对信号均匀取样后得到的样本(事实上，样本间的间隔超过了2。，它给出的取样率低于12个样本秒。取样后的信号看上去像正弦波，但其频率是原始信号的十分之一。这个频率低于原始连续函数中任何频率的取样后的信号是混淆的一个例子。。只给出了图 4.10中的样本，在这种情况下，混淆的严重程度使得我们无法知道这些样本是不是原始函数的真实描述。正如在这一章稍后您将要看到的那样，图像中的混淆会产生类似的误导结果。图4.10混淆的说明。欠取样后的函数(黑点)看上去像一个频率比连续信号频率低得多的正弦因此与水平轴的零交叉每秒钟出现波。该正弦波的周期是2s，一次，AT是样本间隔4.3.5由取样后的数据重建(复原)函数在这一节，我们将说明由一组样本集合来重建函数实际上可以减少样本间的内插。。即使简单地用显示介质显示一幅图像的行为都要求来自其样本的图像重建。因此，理解取样数据重建的基础是很重要的。卷积是这一理解的核心，因而再度显示了这一概念的重要性。图 4.8和式(4.3-8)的讨论概括了一个带限函数使用频率域方法由其样本完美复原的过程。使用卷积定理，我们可以在空间域得到等价的结果。从式(4.3-8)，F(山)= H(u)F(u），可知f(0)=9*{F(u)}=9"{H(u)F(p)}= ht)★f(）4.3-11）其中，最后一步来自式(4.2-21)的卷积定理。可以证明(见习题 4.6)，将式(4.3-1)给出的了(n)代入式(4.3-11)，然后使用式(4.2-20)，可导出f0的如下空间域表达式:2fGnAT sinc[(-nAT)/A714.3-12）f(t)=242138其中，sinc 函数由式(4.2-19)定义。这个结果并不意外，因为盒状滤波器H(u）的傅里叶反变换是式4.3-12表明，完美重建的函数是用取样值加权的sinc函数的无限和，并且个 sinc 函数(见例4.1)。式有重要的特性，即重建的函数恒等于在多个△T的整数增量处的样本值。。也就是说，对于任何其中人是整数，f0)等于第k个样本f(kAT)。这来自式4.3-12)，因为 sinc0 =1，并且=kAT对于任何其他整数m、 sincom) =0。样本点之间的fn)值是由sinc 函数的和形成的内插。。东实际中，这意味着我们必须找到一种样本间内插有式(4.3-12)要求样本间的内插有无限多项。限的近似方法。正如我们在2.4.4 节中讨论的那样，在图像处理中使用的主要内插方法是最近邻法、双线性法和双三次内插法。在4.5.4 节中，我们将讨论图像内插的效果。单变量的离散傅里叶变换（DFT）4.4本节的主要目的是从基本原理开始推导离散傅里叶变换。到目前为止的材料可看成是这些基本原理的基础，因此，现在我们适当地推导DFT所必需的工具。由取样后的函数的连续变换得到DFT4.4.1正如 4.3.2 节讨论的那样，个取样过的、、带限的、扩展到一到～范围的函数的傅里叶变换，也是扩展到一到～范围的连续的周期函数。实践中，我们处理有限数量的样本，因此本节的目的是推导对应于这种样本集合的DFT式(4.3-5)给出了关于原始函数变换的取样过的数据的变换F(u)，但是，未给出采样后函数fa)本身的变换F(p)的表达式。我们直接由式(4.2-16)中给出的傅里叶变换的定义寻找这样一个表达式:J广二7oe-PwnF(u)= 4.4-1）用式(4.3-1)代替f(t)，我们得到Fun .7oe-P"an-f (0)64-naAT)e(4.4-2） f.e其中，最后一步来自式(4.3-2）。虽然f,是离散函数，但正如我们由式(4.3-5）所知道的那样，其傅里叶变换F(u)是周期为17A7的无限周期连续函数。。因此，我们需要表征F(p)的一一个周期，而对一周期取样是DFT的基础。假设我们想要在周期在=0到p=1/AT之间得到F(山)的 M 个等间距的样本。这可以通过在如下频率处取样得到：(4.4-3）m=0,1,2,…,M -1M AT把丛的这一结果代入式4.4-2，并令Fm表示得到的结果，则有4.4-4)m=0,1,2,…,M -1频率域滤波139这个表达式就是我们寻找的离散傅里叶变换D。给定一个由f(0)的M个样本组成的集合{f,},式(4.44得出一个与输入样本集合离散傅里叶变换相对应的 M个复数离散值的样本集合{Fm}。反之，给定我们可以用傅里叶反变换(IDPFT)复原样本集{f,}:{Fm}，1 =0,1,2,…4.4-5）7=0不难证明(见习题4.8)，把式(4.4-5)的f,代入式(4.4-4)可得出F Fm。三类似地，把式(4.4-4)的F代入式(4.4-5)得到。= /，。这意味着式(4.44)和式(4.4-5)组成了一个离散傅里叶变换对。此外，这些恒等式指出，对于任何其值有限的样本集合，正、反傅里叶变换都是存在的。注意，这两个表达式不明确地依赖于取样间隔△T，，也不依赖于式(4.4-3)中的频率间隔。。因此，离散傅里叶变换对适用于任何均匀取样的有限离散样本集在前面的阐述中，我们使用 m和n来表示离散变量，因为对于推导来说历来都是这样做的。而。特别是在二维情况下，使用x和y表示图像坐标变量并使用。和，表示频率变量更为直观，在这这些变量可理解为整数。这样，式(4.4-4)和式(4.4-5)就变为F(u) = u=0,1,2,…,M -14.4-6)工(4.4-7）x =0,2,….,M -1f(x)为简便起见，我们在上式中使用函数表示代替了下标”。显然，FuD)=F点且fCD)=/。从这一点出发，我们用式(4.4-6)和式(4.4-7)表示一一维DFT对。某些作者通过在式(4.4-6)中包含1M项来代替我。这不会影响两个公式形成一一个傅里叶变换对的证明。们在式(4.4-7)中所示的方法。可以证明(见习题4.9)，傅里叶正变换和反变换都是无限周期的，其周期为M，即F(u)= F(u+kM）4.4-8和f(x)= f(x+kM）4.4-9)考虚到对连绒函数取样的铺果不是周期的・离散函数10是周期历其中，k是整数。数的原因并不明显。解释这一式(4.2-20)中的卷积的离散等价表示是种非正式方法是，T 中的取样结果。果fC0)对于 DFT 对的存在来说必须fGr)★AGr)=f(m)hkx-m 4.4-10）是周期的。因为在前面的公式中的函数是周期的，所以它们的卷积也是周期的。:=0,1, 2,了周期卷积的一个周期。由于这一一原因，在这个公式中，其内在处理通常称为循环卷积，并且直接导致DFT和它的反变换的周期性。这与我们在 3.4.2 节中研究的卷积形成了对比，在该卷积中，位移O 注意糕路4.6中的区河间.1.71/覆盖了该变换的两个背都背的半周期。这意味着要求重新对厂。中的数据排序，以便得到一个周期内规孝从最低到最高的样杰。这是为符号表示的力便线通必须付街的代价，即在m=0.1.M-1处采样、而不使用原点两侧的样本，因为后者警求使用负号.:6.3.节将讨论对变换数据排序的过程。2使思，表示连续究闸生绿及使明从。表工连线舰春变量时.,我们一真非带小心。从现在朝；，我们将使用，和米分别表示一维率收究用变量和一维频事变缝。在处理二维函数时味:我们将使用.和ux.，0米分别表示连续空间变量和频事域变量。芙似地，我们将使用c.,y)和u,)来表示与它们对应的离散变量。，且像在循环卷积中那样区间I0. M-1)是不固定的一个函数完全滑过另一一个函数的要求来决定，直x由一我们将在 4.6.3 节和图4.28中讨论这一区别及其意义。最后，我们指出，式(4.2-21)和式(4.2-22)中给出的卷积定理还可用于离散变量(见习题4.10)取样和频率间隔间的关系4.4.2如果fG)由函数了0）以△7为单位间隔取样后的M个样本组成，则包含集合{/0)}.x0,1,2, …,M -1的记录的持续时间是= MAT4.4-11）离散频率域中的相应间隔u来自式(4.43):(4.4-12）AuM AT由 DFT的M个分量跨越的整个频率范围是(4.4-13）2 = MAu本7这样，由式(4.4-12)和式(4.413)就可以看出，DFT的频率分辨率An取决于连续函数了(0被取样的持续时间7，并且DFT跨越的频率范围取决于取样间隔△T。很明显，，两个表达式给出了T和AT的反转关系。计算DF的机理・列4.4图4.11 a)显示了连续函数f的以AT为单位间隔取样后的4个样本。图4.11 6)显示了x域中的取样值。注意，r的值是0,1,2和3，。它指出我们可以提供fn)的任何4个样本。由式(4.4-6)有F(0)=f(x)=[f(0)+ /0+ f(2)+ f(3)]=1+2+4+4=11FuD的下一个值是F0)=-3+2j类似地，有F(2)=-0+0j)和F(3)=-(3+2）。注意观察，在计算F(u)的每一项时用到了f(x)的所有值如果给定的是FGu)，并且要求计算它的反变换，那么我们可以用相同的方法进行处理，但是使用的是反变换。例如，,FaerouoEra0= u1-3+2j-1-3-21= 4=1/(0)=这与图4.11 6)一致。fG)的其他值可以用相同的方法得到。245|+ 2A7 .。+3572464图4.11一个函数；G)该函数在x域中的样本。在图Ga)中，1是一个连续变量；在图(6)中。x代表整数值第4章1414.5两个变量的函数的扩展在这一节，我们将把4.2节到4.4 节介绍的概念扩展到两个变量。4.5.1二维冲激及其取样特性两个连续变量1和z的冲激6(,z）被定义为如式(4.2-8)所示的形式:8(,z)={(4.5-1a）其他0,8t,z)d dz =14.5-1）如在一一维情况那样,，二维冲激在积分下呈现了取样特性：--f(, z)6(,z)dr dz = f(0,0）4.5-2）或者，更一般地，对位于坐标(6,z)）处的冲激，有4.5-3）如以前那样，我们看到，取样特性在冲激所在的位置产生函数f(α,2的值。对于离散变量x和y，二维离散冲激定义为口x= y=04.5-46(x, y)=10.其他其取样特性为Jf(x,y)6(x,y)= f(0,0）(4.5-5）式中，fα,y)是离散变量x和y的函数。对于图 4.12一维单位离散冲激。。变量x和y是离散的,且位于坐标,.yo）外的冲激(见图4.12)，其取样特6的值在除坐标6,.)0）小的任何位置都为。生为f(x, y)B(x-x,y- yo)= f(Xo, Yo）4.5-6）如以前那样，离散冲激的取样特性在该冲激所在的位置产生离散函数f(x, y)的值。二维连续傅里叶变换对4.5.2令fα,力是两个连续变量1和z的连续函数。则其二维连续傅里叶变换对由以下两个表达式给出：ra. . :。-a4.5-7）和/0.5=-5. -u(4.5-8)24842当涉及图像时，1和z解释为连续空间变量。就像一其中，在和，是频率变量。一维情况那样，变量山和，的域定义了连续频率域。得到一个个简单函数的二维傅里叶变换。列4.5图4.13显示了一一个模仿例4.1中一维情况的二维函数。按照类似于例4.1中使用的过程给出结果 sindruTDl in(RvZ）F(u,V)=（ruT）（rvZ）其幅度(谱)由下面的表达式给出:lsindruTDindrvz2LF(u,D|= A7Z|TuT）|（元vZ）图4.136)显示了关于原点的谱的一部分。正如一维的情况那样，在谱中零的位置与T和Z的值成反比。这样，T和Z越大，则谱将变得更“收缩”，反之亦然。F（从,D)144.13一部分(未按比例画出)，“紧凑”该块沿1轴越长，则沿在轴的谱更请与图 4.4比较4.5.3二维取样和二维取样定理类似于一一维情况中的方式，二维取样可用取样函数(二维冲激串)建模:6(t-mAT,z-(4.5-9）SArz2(6.2)=其中，AT和AZ是连续函数f(,z)沿1轴和z轴的样本sarsz1.z）可的间隔。。式(4.5-9)描述了沿着两个轴无限扩展的周期冲激的集合(见图4.14)。如图4.5中说明的一一维情况那样，用sxy::2平14.2)可得到取样后的函数。如果由区间IL一的矩形之外的傅里叶变换是零，则函数f(,z)称为带限函数；即F(L,v)=0,山>A且L|>Ym(4.5-10二维冲激串图4.14二维取样定理表明，如果取样间隔满足4.5-11）AT<2umma249和143弟 4章(4.5-12）AZ <ZYmax或者关于取样率的表达，(4.5-13）2Lma和.4.5-14)则连续带限函数（(。2可以由其一一组样本无误地恢复。另-种叙述方法是：我们说，如果一一个三维带限连续函数在山和，两个方向上由以大于该函数最高频率两倍的取样率取样获得的样本表示，则没有信息丢失。图4.15显示了图4.6(6)和(D的二维等效图示。个理想的二维盒状滤波器有图 4.13 (a)说明的形式。图 4.15 a)中的虚线部分说明了滤波器的位置，以便达到分离从其样本重建带限函数必要的变换的单个周期,，正如4.3.3节那样。由4.3.4 节，我们知道，如果函数欠取样，则周期将会重叠，并且如图4.156)所示，分离出单个周期是不可能的。在这样的条件下，将产生混淆。里想低通(盒状）滤波器的位置(a)过取样和(b)欠取样带限函数的二维傅里叶变换图4.154.5.4图像中的混淆在这一节，我们把混淆的概念扩展到图像，并讨论一些与图像取样和重取样有关的问题从一维混淆展开，如果只在两个坐标方向上无限扩展，二维连续变量1和z的连续函数通上如在一维情况下那样，常可以被带限。限制一一个函数时间的非常动作将引起在频率域无限扩展的有害的频率分量，正如4.3.4节所解释的那样。因为我们不可能对一个函数无限地取样，所以，正像在取样后的一维函数中所存在的那样，在数字图像中混淆总是存在的。在图像中，存在两种主要的混淆现象：空间混淆和时间混淆。如4.3.4节讨论的那样，空间混淆是由欠取样造成的。时间混淆与图像序列中图像间的时间间隔有关时间混淆最常见的例子之一一是“车轮””效应，即在序列图像(如电影)中具有轮辐的车轮出现倒转的现象。这是由于序列中的帧率低于轮子转动的速度引起的。在这一章，我们重点关注空间混淆。图像中空间混淆的主要表现形式是人为引入的缺陷，如线状特征中的锯齿、伪高光及原图像中不存在的模式的出现。。下面的例子说明了图像中的混淆。251144图像中的混淆。例4.6假定我们有一个很完美的成像系统，没有噪声，并能产生看上去很精细的数字图像，但它能采用的取样数是固定的96 × 96个像素。如果我们用该系统去数字化棋盘模式，子应切合实际地重建。那么它能解决多达96 × 96个大小为1x1像素的方格的模式。在这种限我们将计算机生成的模型和向量图制下，结果图像中的每个像素将对应图案中的一一个方格。我们感兴趣的转换为数字图像时，在无噪声、无失真的条件下对“完美”的场景取是考察当细节(棋盘方格的大小)小于一一个摄像机像素时会发生什么事样是很常见的。情；也就是说，，当成像系统要数字化大于96 × 96个方格的棋盘模式时,会发生什么情况图4.16a)和(6)显示了对棋盘取样的结果，方格的边长分别为16个像素和6个像素。这些结果正如所预料的那样。然而，，当方格的大小减小到稍小于一一个摄像机像素时，如图 4.16(c)所示的严重混淆的图，则会产生如图4.16(b)所示的图像。像就产生了。最后，如果将方格的边长减小到稍小于0.5 个像素时，在这种情况下，混淆的结果看上去还像是一个正常的棋盘模式。事实上，该图像是通过对其方格边长为12个像素的棋盘图像取样得到的。最后一幅图像是较好的提醒，即混淆会产生令人完全误解的结果。图像中的混淆：在图(a)和图(b)中，方格的边长分别是16个像素和6个像素，混图4.16淆在视觉上可以忽略不计。在图(c)和图(d)中，方格的边长分别是0.9174个像素和0.4798个像素，结果中出现了明显的混淆。。注意，图心看起来像是一幅正常的图像通过稍微散焦被数字化的场景来削弱高频可以降低混淆的影响。正如4.3.4 节解释的那样，抗混淆滤波在图像被取样之前在“前端””必须要做。不存在这样的事情，即事后用软件抗混淆滤波器来减小由于违反取样定理导致的混淆的影响。。大多数商业数字图像处理程序包的确都有称为反混淆的特，该术语涉及模糊一幅数字图像以减少由重取样引起的附加混征。然而，如例4.7和例4.8说明的那样，一些商业数字摄像机有真正反混淆滤波嵌人，不是在镜不能用于减少原始取样过的图像的混淆。有，就是在传感器本身的表面上。由于这一原因，很难使用这种摄像机拍摄的图像来说明混淆。头上，图像内插和重取样就像在一维情形中那样，由样本集合完美地重建一个带限图像函数要求在空间域用Ssinc 函数做二维卷积。如433.5节解释的那样，这种理论上的完美重建要求使用无限求和来内插，在实践中，迫使我们不得不寻求某种近似。在图像处理中，二维内插最普通的应用之一是调整图像的大小(放大和缩小)。放大可看成是过取样，缩小则可看成是欠取样。这两种操作和前面几节讨论的取样概念之间的主要区别是放大和缩小用于数字图像。2.4.4 节中已解释过内插。这里我们的兴趣在于说明最近邻、双线性和双三次内插的性能。在这节，我们给出一些关于取样和反混淆问题的例子。当我们想要以整数倍增加一幅图像的尺寸时，过取样相联系的最近邻内插的一一个特殊的情况是采用像素复制的放大操作。例如，将一幅图像放大两倍，我们可以复制每一列。一。这会在本平方向上将图像尺寸放太一倍。然后・，我们复制这幅放大后的图一行，在垂直方向上将图像尺寸放大一倍。。相同的步骤可用于以任意整数倍放大图像。每个像象的每素的灰度级分配由新位置是老位置的精确复制这一事实来预先确定。采用类似于放大图像的方法可缩小图像。欠取样是通过行-列删不使用带限模糊方法对图像重取样的过程称为抽取。253除来实现的(例如，为将图像缩小一半，可每隔一行和一列来删除一频率域滤波145行和一烈)。我们可以用2.4.4*的放大网格模拟来形象化非整数参数收省的概念:，只是我们现在扩张该网格拟合原图像。进行灰度内插，然后、期把网格缩小为规定的足寸。为减少混淆・最好在辅小图像一种替代技术是对原始场景超取样，然后采用行-列删之前稍微模糊一下图像(4.8 节将讨论频率域模糊）除法来减小(重采样)其大小。这可以得到比平滑更清晰的结果，但是，很显然，它要求存取原始场景。如果我们不能访问原始场景(在实践中，这是很典型的)，那么超取样就不是一个好的选择。重取样后的图像中的混淆的说明列 4.7当一幅数字图像被减小时，通常混淆效应将变得更坏、图4.17(a)是为说明混淆的影响而故意创建的幅图像(注意，外衣上所有隔开的较细平行线都被目标磨损了)。图4.17(a)中没有不好的人为缺陷，指出所用的初始取样率对防止可见的混淆是有效的。在图4.170中，图像用行-列删除法缩小为原大小的50%。在该图像中，混淆的影响十分明显(作为例子，可参见目标的滕盖周围的区域)。连续图像的反混淆滤波的数字等效操作是在对图像进行重取样之前平滑图像，以衰减数字图像的高频分量。图4.17(e)显示厂在缩小其尺寸之前，使用3×3均值滤波器(见3.5节)平滑图像的结果。对图4.176)的改进是明显的。为了方便比较，采用像素复制方法将图 4.17(6)和图 4.17(c)放大到原始尺寸。图4.17重取样后的图像上的混淆的说明：：（a)带有视觉上可以忽略的混淆的数字图像；(b)采用行-列删除法将图像尺寸缩小到其原始尺寸50%后的结果。汇混淆清晰可见；（c)在调整图像大小之前，使用一个3×3均值滤波器来模糊(a)中图像的结果。该图像比图(b）更模糊，但混淆不再那样显眼(原图像由加州大学圣巴巴拉分校信号压缩实验室提供）当您处理具有很强边缘内容的图像时，混淆的影响看起来就像是块状图像分量，这称为锯齿下面的例子说明了这一现象。图像缩小中锯齿现象的说明。列 4.8图4.18 a)显示了一幅计算机生成场景的1024 × 1024数字图像，图像中混淆可以忽略。为了使混淆效果(在这种情况下，就是锯齿)更清楚，图4.186b)显示了经过如下操作后的图像:将图(a)缩小到75%.即256×256大小，然后，使用双线性内插法和像素复制法将该图像复原到原始大小。就像在例 4.7中那样，在对图像重取样之前平滑该图像可使混淆的影响不太令人讨厌。图4.186e)是在减小图像尺寸之前使用5×5均直滤波器的结果。正如这幅图像显示的那样,锯齿有效地减少了.采用用于生成图4.18G)的相同方法,图4.18 (c）司样经过了图像缩小与复原为其原始大小的过程。例4.9 图像放大中锯齿现象的说明。全前两个例子中，我们使用像素复制法来放大较小的取样后的图像。如图4.19说明的那样，通常这年不是・种首选的方法。图4.19a)显示了一幅放大为1024×1024像素的图像，它是从图4.18a)所示图像中心截出256 × 256的一部分通过像素复制的方法产生的。注意“斑驳”的边缘。图4.196b)所示放大后的图像是由相同的 256×256像素部分经双线性内插法产生的。在该结果中，边缘相当平滑。例如，瓶颈的边缘和大棋盘方格不像图 4.19(6)中那么斑驳,，，而与图 4.19a)相近。46锯齿的说明：（a)一一幅计算机生成场景的1024×1024数字图像，其混淆可以忽略；(b)减小(a)的原始图 4.18尺寸到25%，再用双线性内插恢复原始尺寸的结果。（C)减小图像尺寸的25%之前，用5×5的均值图4.19图像放大：：（a)一幅大小为1024×1024像素的数字图像，该图像是通过对图 4.18 a)中间截取的256×236 图像使用像素复制法产生的；の)使用双线性内插法生成的图像，图像中的锯齿明显减少莫尔(波纹)模式在结束这一节之前，我们考察一下另外一种人为缺陷，称之为莫尔(波纹)模式O，它们有时是使用周期或近似周期分量对场景取样产生的。在光学中，莫尔模式指的是在两个近似等间隔的光栅之间生的差拍模式。这些差拍模式通常每天都会发生。例如，我们从防昆虫纱窗重叠在一一起，或从电视光栅线与条带材料间所看到的干涉那样。在数字图像处理中，当扫描介质印刷物如报纸和杂志时，或如果它的间隔与取样的间隔可比的时候，通常都会出现这一问题。与取者在具有周期分量的图像中，洋造成的人为缺陷相比，莫尔模式更为常见。例如，图4.20显示了莫尔(波纹)效应，它是使用墨水绘画的，并没有被数字化。分离的情况下，这些模式都是干净的，且没有干扰。然而，将一种模式叠加到另一种模式上时，会产生三一幅其频率在原始模式中均不出现的差拍模式。注意，在特殊情况下，由两个点的模式所产生的莫尔(波纹)效应，是我们在下面的讨论很感兴趣的效应。a bc d图 4.20莫尔(波纹)效应的例子。它们是油墨画而不是数字化后的模式。一个模式叠加在另一个模式上在数学上等价于两个模式相乘将一报纸和其他印刷材料使用所谓的半色调点，它们是黑色圆点或椭彩色打印使用红点、绿点和蓝点圆点，其大小和变化的连接方式用于模拟灰色调。作为一个规则，来产生人眼可以识别的连续颜色。O 术语莫尔(moire是二个法语单词而不是人名.它源自首先注意到某些织物上出现干涉图样的织布者;该术语是由单词mohair马日一种使用安哥拉山羊毛织成的布)演化而来的。海毛，第4章147面的数量是典型的：报纸每英寸75点(简称 dpi)来印刷，杂志用133 dpi 来印刷，高质量的小册子用175lpi 来印刷。。图4.21显示了一幅报纸图像以 75 dpi取样时产生的现象。取样格(垂直方向和水平方向)）和报纸图像上点的模式（±45°方向)相互作用，产生使得图像看起来像是布满斑点的均匀莫尔模式4.10.2 节将讨论降低莫尔干扰模式的一一种技术)作为相关的兴趣点，图4.22显示了一一幅以400 dpi取样后以便防止莫尔(波纹)效应的报纸图像。目标的左眼周围区域的放大图像说明如何利用中间色点产生灰度的深浅。点的大小与图像灰度成反比。在亮区域，点较小，或完全没有点(例如，、见眼白部分)。在浅灰区域，点较大，如眼睛下部所示。在较暗的区域，当点的大小超过某个指定值(典型地为50%)时，允许点沿着两个指定方向连接起来形成一个互相连接的网格(见眼睛的左侧)。在某种情况下，点仅沿一一个方向连接，如眉毛下面的右上方区域。图4.21以75dpi取样、、大为246×168像素的报纸图像，显图4.22幅报纸图像及其局部放大图像、局部放大图示了莫尔模式。这幅图像中的莫尔模式是在±45°方像说明了如何安排半色调点以渲染灰度的色调向的半色调点与南北方向的取样网格之间产生的干扰4.5.5二维离散傅里叶变换及其反变换类似于4.3节和4.4节的材料中的推导过程，可得到下面的二维傅里叶变换(DFT)：F(u,V) =(4.5-15）=0 y=0其中，f（(x,y)是大小为M xN的数学图像。。与一维中的情况一样，有文献中，我们有时会在 DFT而不是式(4.5-15)必须对离散变量u和v在u=0,1,2,…,M-1和v=0,1,2,iDFT的前面看到常数1MN。这时，该德致表示岁 (WM.包命年N-1范围内求值"。个更为对称给出变换厂u,)），我们可以使用傅里叶反变换(IDFT)得到（(x,y:的变换对。。这些公式都是正确的，但前提条件是要保持致Zru,vJeu /》(4.5-16）f(x,y) =MN A0 v=0其中，=.2.….M -1,y=0.1.2..M-1。式(4.5-15)和式4.5-16)构成了二维离散傅里叶变换对。本章的其余部分是以这两个公式的特性和它们在频率域图像滤波的应用为基础的。节中提及的那样、记住、在本章中我们1分别使用,2)和山,”)来表示二维连续空间变量和频率城变量。在二维离散情2358况下，我们使用(Kx,y）表示空间变量，而使用《u,)表示频率城变量。1484.6二维离散傅里叶变换的一些性质我们将介绍二维离散傅里叶变换及其反变换的一些性质在这一节，4.6.1空间和频率间隔的关系空间取样和相应频率域间隔的关系如 4.4.2节中解释的那样。假定对连续函数f(t,z)取样生成了一幅数字图像（(x,y，它由分别在，和z方向所取的MxN个样点组成。令A7和△Z表示样本间的间隔(见图4.14)。那么，相应离散频率域变量间的间隔分别由(4.6-1）Au=MAT(4.6-2）Ay =VA2给出。注意，频率域样本间的间隔与空间样本间的间距和样本数成反比。4.6.2平移和旋转直接代入式(4.5-15)和式(4.5-16)可以证明傅里叶变换对满足下列平移特性(见习题4.16）(4.6-3）4.6-4）也就是说，用指数项乘以了（(x,y)将使 DFT的原点移到点《o.%）；反之，用负指数乘以Fu,)将使f(x.y)）的原点移到点(x,.Jo）。正如我们在例4.13中说明的那样，平移不影响Fu.）的幅度(谱)使用极坐标x=rcos6，y =r sin6,u = ocos p,v = 0 sinp可得到下列变换对：(4.6-5)则Fu,，）也旋转相同的角度。它指出，若f(x,y)旋转6。角度，。反之，若Fu,v)）旋转一个角度，f(x,y)也旋转相同的角度。周期性4.6.3如在一维情况中那样，，二维傅里叶十变换及其反变换在u方向和，方向是无限周期的，即F(u,v)= F(u+k,M ,y) = F(u,v+k,N) = F(u+k,M1,v+k,N）(4.6-6）f(x, y)= f(x+人,M,y)= f(x, y+k,N)= f(x+k,M,y+k,N）(4.6-7）其中，人和k是整数。变换及其反变换的周期性在基于 DFT 算法的实现上是重要的特性。考虑图4.23(a)中的一一维谱节描述的那样，在区间[0,M-- 1]中，变换数据由两个在点M12处碰面的背靠背的半个周期组成。针对显示和滤波目的，在该区间中有一个变换的完整的周期会更为方便，因为完整周期中数据是2359连续的，如图 4.23 6b)那样。由式(4.6-3)可得频率域滤波149一F(u-uo）换句话说，用一个指数项乘以f(x)将位于原点的数据F0)移动到位置u。。如果我们令山。==M 72则指数项变为eJ"，因为x是整数，故它等于(-1)"。在这种情况下，f(xX-D*=F(u-M /2）即用(-"乘以f(x)将位于原点的数据F(O)移动到区间[0,M- 1]的中心位置，像期望的那样，它对应于图4.23 (b)。两个背靠背的周期在此相会*."M/2个背靠背的周期在此相会个周期(M个样本M/24个背靠背的周期在此相会棋快DFT的周期周期在此相会M × N数据阵列Fu，）图 4.23傅里叶变换的中心:(a)显示了无限个周期的一一维DFT；(b)在计算Fu)之前，由(-1)*乘以f(α)得到的移位后的DFT；（GO)显示了无限个周期的一一个二维DFT。。实线区域是由式(4.5-15)得到的M×X数据阵烈“x2。该阵烈电4个四分之一周明组威；R在计算东)之前，由(一D乘以了(x,y)得到的移位后的DFT。现在数据包含一个完整的位手中心的周期，这与图(b)二维情况下，用图形来显示该情况有些困难，但原理是一样的，如图 4.23 ()所示。代替使用两个半周期，现在有4个四分之一无一周期在点(1/2.2处碰面。虚线矩形对碗于二维DPT的无限个周期。正像一维情况那样，，如果我们移动数据，，以便F(0,0）处在点(M/2.M/2)处，可简化其可视化259程度。。在式(4.6-3)中令而o.%)=（M/2.0/2)，可得到如下表达式:150(4.6-8）f(x, y)(-1)*’←F(u-M/2,v-N72)以便如希望的那样，使F(0.0）处在由区间I0,M-11和0.N/-11定义的频率矩形的利用该式移动数据，。我们将在本章稍后的例4.11和图 4.24中说明这些概念。中心处。图 4.23 (d)显示了这一结果。4.6.4对称性任意实函数或虚函数w(x,y)可表示为一个奇数部分和-个偶函数分析得到的一一个重要结果是，数部分(其中每一个都可以是实部或虚部)的和：(4.6-9）w(x,y) = w。(x, y)+ w。(X, y）其中，偶数部分和奇数部分定义如下4.6-10a）4.6-10b)把式(4.6-10）和式4.6-10)代入式(4.69)给出恒等式w(x,y)= W(x,y)，王这样，就证明了后一公式的正确性。由前面的定义有4.6-11a）~(x,y)= w。(-x,-)）和 4.6-11b)v(x, y)=-w.(-x,-y）偶函数是对称的，奇函数是反对称的。因为DFT和 IDFT中的所有指数都是正的，当我也就是说，门谈论对称(反对称)时，我们指的是关于序列中点的对称(反对称)，一维阵列中心)。在式(4.6-11)中，点右侧的指数考虑为正，其左侧考虑为负(在二维情况下类似)。在我们的操作中，仅考虑非负的指数项更为方便，在这种情况下，奇和偶的定义变为(4.6-12）w。(x, y)= w。.(M -x,N-y）(4.6-12b）~(x, y)=-w。(M -x,N-y）其中，M和N分别是二维阵列的行数和列数。由初等数学分析我们知道，两个偶函数或两个奇函数的积是偶函一个奇函数的咨要自己动手证明样本之和为零，可关于愿点或跨越一个偶函数和一个奇函数的积是奇函数。另外，，离散函数为奇一个周期的任何其他区间画出一维一方法是其所有样本的和为零。这些特性导致了一函数的唯一一个重要结正弦波的一个周期。论，即对于任意一个离散偶函数吨和一个离散奇函数叫、Sw.(x,J)w。(x,J)=0(4.6-13）换句话说，，因为式(4.6-13)的自变量是奇数，则求和的结果是零。函数可以是实函数或复函数。频率域滤波151例4.10偶函数和奇函数。虽然很容易就可看出连续函数的奇偶性，当处理离散序列时，这些概念就不那么直观了。下面的说明将帮助我们弄清前面的概念。考虑一维序列fDf(2)f(3)}={21 1r1}f ={f(0)其中，M=4。为了检验偶性，必须满足条件了02=7（4-2，也就是说。。我们要求f0)=./4). 92=（(2)./60= 73). f0)=70因为f(4)在被考察的范围之外，且它可以为任何值・则ro的值对于偶函数的测试是不重要的。我们看到,阵列中的值满足接下来的三个条件，则该序列是偶序列。事实上，我们得出结论，任何4点偶序列必须有下列形式:{a bca}，仅需第二点和最后一点相等。即在4点偶序列中一个很有趣的特性，即其第一项w。0.0永远是0，它遵循直接源自式(4.6-10)的一个事实。奇序列有考虑一维序列5101}8={80 gのg(2)83}{0由于序列中的各项满足g0=-8(4-3)，因此我们很容易地确认这是一个奇序列。例如。g0D=-8(3)。任何4点奇序列都有形式{0 -b :05}也就是说，当M是偶数时维奇序列有在位置。和M12处的点总是零的特性。当M是奇数时，第一项仍必须是零，其余项形成等值的对，但符号相反。前面的讨论指出,序列是偶序列还是奇序列还取决于序列的长度。例如・我们已经证明序列10-1.,0}既不是奇序列，也不是偶序列，虽然其“基本”结构表现为奇序是奇序列。。然而，序列{0列。在解释 DFT的结果时，这是一个重要的问题。在这一章稍后我们将读者可自行证明这个二维序列是说明偶函数和奇函数的 DFT具有一些非常重要的特征。因此，常常有这奇序列种情况了解一个函数是奇函数还是偶函数在解释基于 DFT的图像结果中扮演着重要的角色。。例如，序列在二维情况中也有相同的基本考虑。0导致的序列就既不是奇序列也不是偶序列。注意，该阵列是奇序列。但在添加另行（和另一的内部结构是一个如3.6.4节讨论的Sobel模板。我们将在例4.15中再回顾这个模板。利用前面的概念，我们可以建立 DFT 及其反变换的一一些重要的对称性质。一个常用的性质是实函数了(x,)的傅里叶变换是共轭对称的，即4.6-14）F"(u,v)= F(-u,-）传轭对称也称为哈密特对称。术语反哈密特有时用于指共轭反对称。如果厂(x,）》是虚函数、则其博果叶变换是共轭反对称的：r"(-.-0)=上-F(u,v)。式(4.6-14)的证明如下:数学图像处理(第三版jzr(uxl M+ylN）F"u, p)=f(x, y)ex=O == F(-u,-V)其中，第三步源自f(x, y)是实函数这一事实。使用类似的方法可以证明虚函数的变换所表现出的共轭对称性。表 4.1列出了DFT的对称性和相关的性质，这些性质在数字图像处理中很有用。回忆可知，双箭头表示傅里叶变换对，即对于表中的任意一行，右边的性质可由拥有左边性质的函数的傅里叶变换来满足，反之亦然。例如，第5条性质可读为：：实函数fα,y)的傅里叶变换是F"(u,y)，其中用(一x,-y）而（(x,y)的离散傅里叶变换Fu,)是复函数，反之亦然。代替(,J)，二维 DFT及其反变换的某些对称性质。Ru,V)和（L,)分别是夜4.1F(u,v）的实部和虚部。术语复函数指出一个函数有非零实部和虚部空间域*频率域”f(x.y实函数7 *(u,)=F(-u,-v）f(x,y)虚函数T(x,y)实函数Ru,，）偶函数;:1u.,）奇函数T(x,y)虚函数Ru.y）奇函数:αu,，）偶函数白y）实函数**(u,)复函数白f(-x,-y)复函数"(-u,-y)复函数←*(x,y)）复函数F*(-u,-D）复函数f(x.)实函数和偶函数F(u,)实函数和偶函数.y)实函数和奇函数F(u,，）虚函数和奇函数(x, y)虚函数和偶函数F(u,，）虚函数和偶函数f(x.y)）虚函数和奇函数,)）实函数和奇函数f(xy）复函数和偶函数台Fu,)复函数和偶函数12）台Fu,.)）复函数和奇函数f(x.y)复函数和奇函数乙可知A:X:和，是离散(整数)变量，x和临在区间(0.M -11内，y和，在区间[I0.N》-1个复函数是偶函数意味着其实部和虚部都是偶函数。称一个复函数为奇函数同样意味内。称一个着其实部和虚部都是奇函数。表4.1中性质的一维说明例 4.11根据早些时候讨论过的偶函数和奇函数的概念，以及在例4.10中的说明，下面的一维序列及它们的变换是表4.1中所列性质的简单例子。右侧圆括号内的数字是Fu）的单个元素；类似地，在最后两个特性中,对于f(α)也类似性质fG）Fu4}{(10-2+2jX(-2)( -2-3)）}4}{（C2.50.5 -0.5j)( -0.5j)( -0.5 -0.5)1}台{(5(IXI(1)}263。{0 -1 0 1}{t02)0OX-2)26510j{2{(5j)G)6)6)}153第4草1}=（(O( -2X0D)2）}j101(4+4)03 +2)0+ 2)03 +2)） ←（10+10)4+20(-2+2)4+ 2）12{0 + 0j02-2j)(0 + 0j)( -2-2)）13{(0 + 0jX1 + 1j)(0 + 0j(-1-1j)}34}的实函数具有傅里叶变换,该变换的实部{10例如,在性质3中,我们着到有元素{1-2}一个实偶函数的傅里叶变换也是一个实偶函数。-1}是奇函数。性质8告诉我们，老偶函数，虚部{O2 0一个偶复函数的傅里叶变换也是复偶函数。其他性质的例子可以用同样的方法来分析。生质12说明，一些对称性质。例4.12证明表4.1中DFT的一在这个例子中，我们证明表4.1中的一些性质，熟练运用这些重要的性质，以便为解答本章末尾的一些习题打下基础。我们仅由左侧给出的性质证明右侧的性质。使用类似于此处给出的方式，可以用右侧给出的性质证明左侧的性质。考虑性质3，它读做：如果f(x, y)是实函数，则其DFT的实部是偶函数，而其虚部是奇函数；类似地，如果一个DFT分别具有偶函数的实部和奇函数的虚部，则其 DFT是一个实函数。这一性质的正式证明。Fu,v)通常是复函数，因此它可以表示为一个实部和一一个虚部之和，即F(u,y)= R(u,v)+ jI(u,D）然后，有F"(u,v) = R(u,y)-jl(u,）。此外，有F(-u,-b)= R(-u,-V)+ jI(-u,-）。但是，正如早期正明的那样，如果（(x.,y)是实函数，则基于前两个等式有Ru, )= （-u.-b）和Iu,)=-1-u.-）。根据式(4.6-11)和式(4.6-11)的观点，这就证明了R是一个偶函数，而1是一个奇函数。下面，我们证明性质8。如果f(x,y)是一个实函数，那么由性质3可知F(u,)的实部是偶函数，此为证明性质8，我们所要做的所有的工作是证明：如果f(Gx,y)是实偶函数，则Fu,D）的虚部是0(即厂是实函数)。证明步骤如下:iam(ur/M+yINf(Gx,yJ)eTF(u,y)=上式可写为F(u,)=一-SS偶函数・偶函数1-251偶函数・偶函数1-E偶函数・偶丽数」*=0 y=实函数第4步来自欧拉公式以及cs和sin分别是偶函数和奇函数的事实。由性质8我们还知道，除了是实函数之外、f也是偶函数。在倒数第二行中、包含虚部分量的仅有的一项是第二项、根据式4614可知它是0。这样，如果f是实偶函数，则F是实函数。。正如早些时候解释的那样，因为/是实函数，所以F也是偶函数。该结论得证。最后，我们证明性质6的正确性。由DFT的定义，2656 =6266154由于周期性，有了(-x,-y= /M-x,N-y)。如果现在定义m=M-r和n=N-y则S{/(-x-9}=1=0 7=0G为确保求和本身是正确的。可用个维变换试一下，并手工扩展一些求种。)因为exp -iz《整数01=1它遵循下式:注意此处我们未更改变量。我们计算的是了-x-)的DFT，因此只s{f(-x.-9}-f(m,n)e是简单地将该函数插入到了等式中;就像处理任何其他函数一样。名论得证。4.6.5傅里叶谱和相角因为通常二维DFT一般是复函数，因此可使用极坐标形式来表示：ru.)=|/（,)“”(4.6-15）其中，幅度Fu, D|=[R"(u,)+ F"《u,，)」(4.6-16）称为傅里叶谱(或频谱)，而1(u.,）4.6-17)p(u, )= arctanR(u,V）称为相角。回忆 4.2.1 节的讨论arctan必须使用一个四象限反正切来计算，如MATLAB的atan2(Tmag，Real)函数。最后，功率谱定义为P(u,v) =|F(u,D)| =R(u,v)+1′(u,v)4.6-18)如之前那样，R和1分别是厂山,)的实部和虚部，并且，所有的计算直接对离散变量u= 0.1,2…,M-1和，=0.1,2, ,M-1进行。因此，IF u,p), ou,y）和P山，D)是大小为M×N的阵列。实函数的傅里叶变换是共轭对称的〔见式(4.6-14)]，这表明谱是关于原点偶对称的:IFu,v)|=|F(-u,-の)4.6-19）相角关于原点奇对称:4.6-20)中(u, )=-4(-u,-)）它来自式(4.5-15）F(0,0) = 2x=0 y=0它指出零频率项与f(α,y)的平均值成正比，即F(0,0 = MN 4.6-21）f表示f的平均值。从而有其中，266lF(0.0)|= MNlf(x,y)(4.6-22）频率域滤波因为比例常数 MV通常很大，典型地，IF(O,.0)是谱的最大分量，它可能比其他项大几个数量级。所以 F(O,0)有时称为变换的直流(dc)分量。这一术语源自电气工因为原点处的频率分量u和，是0，在电气工程中，“dc”表示直流(即频率为零的电流)全，例4.13一个简单函数的二维傅里叶谱。图4.24(a)显示了一幅简单的图像，图4.24(6)显示了该图像的谱，其值被标定到区间[0,255]，并以图像形式显示。空间域和频率域的原点都在左上角。在图4.24 6)中，两件事情是很明显的。如期望的那样，变换的原点的周围区域包含了最高值(在图像中表现为最亮)。然而，注意，，谱的4个角包含有类似的高值。。为中心化该谱，如式(4.6-8指出的那样，原因是在前一节中讨论的周期性。，在计算 DFT之前，我们简单地用(-1y*乘以a)中的图像。图4.24(c)显示了结果，很明显它更易于观察(注意关于中心点的对称性)。由于直流项支配着谱的值，，在显示的图像中，其他灰度的动态范围被压缩了。为了给出那些细节，如3.2.2 节描述的那样，我们执行一次对数变换。图4.24(d)给出了1+ loglFu, D)的显示，细节再现的提高是明显的。本章和后续几章中的多数谱均按这种方式标定过。b c d图 4.24a)图像；(b)在4个角显示亮点的谱;(c)中心化后的谱；(d)经对数变换后、增加了细节的结果。谱的零交叉在垂直方向较靠近，，因为图(a)中的矩形在该方向上较长。全书所用的坐标习惯把空间域和频率域的原点放在左上角处由式(4.6-4)和式(4.6-5)可知，谱对图像平移是不敏感的(指数项的绝对值是1)，它随旋转图像以相同的角度旋转。图4.25说明了这些特性。图4.256)中的谱与图4.24(d)中的谱是相同的。很清楚，在图4.24 (a）和图4.256)中的图像是不同的，因此，如果它们的傅里叶谱是相同的，则基于式4.6-15)，它们的相角。图4.26 确认了这一点。图4.26a)和b)是图4.24a)和图4.25(a)的DFT的相角阵列(以图像显示)注意，相位图像之间缺少类似性，虽然它们所对应的图像间的唯一一差别是简单的平移。通常，相位角图像的视觉分析很少能得到直觉的信息。例如，在45°角方向，・一个直觉的期望是图4.26Q)中的相角应对应于图4.25(6)中的旋转图像，而不是图4.24(a)的图像。事实上，如图4.266)所示，旋转后图像的相位角有一个很强的方向，它比45°小得多。i b图4.25（a)平移后的图4.24(a)中的矩形；(b)相应的谱；（c)旋转后的矩形；の相应的谱。对应于平移矩形的谱与图4.24(a)中的原图像的谱相同DFT的谱的分量决定正弦波的幅度，这些正弦波结合起来可形成结果图像。在一幅图像的 DFT26956中・众任何偷牢的频本处，较大的桶度意味着图像大该规光的正弦波比经突出i。反之，较小的幅度意如图4.26所示，虽然相位分量的贡献很不直观，但它恰恰很重要。相味着图像中出现的正弦波较少。这样，当二维 DFT的幅度是一个阵列时，其分量决定了位是各个正弦分量关于原点的位移的度量。图像中的灰度，相应的相位则是一个角度的阵列，它携带较多的关于图像中可辨别的物体定位的信息下面的例子进一步阐明了这些概念。Ga)对应于图4.24(a)中中心化后的矩形图像的相角阵列；b)对应于图 4.25 a）中平移后的图像的相角阵列；（e)对应于图4.25(e)中旋转后的图像的相角阵列傅里叶谱和相角的进一步说明列4.14图4.276b)是图4.27(a)的 DFT的相角。该阵列将通过视觉分析引导我们将其与对应图像中的特性关联起米。然而，在决定形状特点时，相位的重要性在图4.27(0中是很明显的，它仅仅用相位信息《也就是，用公式IFu, 01=1计算式(4.6-15)的反傅里叶变换得到。尽管灰度信息已丢失了(记住，该信息由谱携带)，但图像中关键的形状特性是不会在图4.27(a)中弄错的。图4.274是仅使用式(4.6-15)的谱并计算其 DFT得到的。这意味着若将指数项置为1，这也同样意味着置相位角为0，结果不会是意外的。它仅包含灰度信息，直流项占支配地位。图像中没有形状信息，因为相位已置为零了。最后，图4.27(e)和(f)再一次证明了在确定一幅图像的特性内容时相位所起的支配作用。图4.27(e)是使用图4.24a)中矩形的谱和对应于妇女图像的相角计算式(4.6-15)的 IDFT得到的。妇女的形状显然支配了这一结果。反之，矩形支配了图4.27(6)，它是使用妇女图像的谱和矩形的相角计算得到的。图4.27Ja)妇女图像；(b)相角；（c)仅使用相角重建的妇女图像；(d)仅使用谱重建的妇女图像；（e)使用对应于妇女图像的相角和对应于图4.24(a)中矩形的谱重建的妇女图像；(D使用矩形的相角和妇女图像的谱重建的图像第4章1574.6.6二维卷积定理将式(4.4-10)扩展至两个变量可得到下面的二维循环卷积的表达式4.6-23）f(x,y)*h(x,J)= f (m,n)h(x-m, y-n）m=0 =其中，x=0, 1,2, …,M一y =0,1,2,…,M-1。如式(4.4-10)那样，式(4.6-23)给出了一个二维周期序列的一个周期。二二维卷积定理由下面的表达式给出：4.6-24）f(x, y)★h(x, y)令F(u, D)H(u,v）反之4.6-25f（(x,J)h(x,y)令F(u,D)* H(u, D）其中，F和H是使用式(4.5-15)得到的，且与之前一样，双箭头用来表示表达式的左边和右边组成了傅里叶变换对。在本章其余部分，我们的兴趣是式(4.6-24)，该式表明乘积F(u, p)Hu,)的 IDFT是、即了和力的二维空间卷积。。类似地，空间卷积的DFT是频率域中相应变换的乘积。(x,y)★h(x,y)，式(4.6-24)是线性滤波的基础，并且如4.7节中解释的那样，是本章讨论的所有滤波技术的基础。因为在这里我们处理的是离散量，傅里叶变换的计算使用 DFT算我们将在 .11 节中讨论计算法执行。如果我们选择使用两个函数变换的乘积的 IDFT来计算空间卷DFT的有效方法。积，则必须考虑在4.6.3节中讨论过的周期性问题。我们给出一一个关于亥问题的一。图4.28左边一列执行两个函数f和h的卷积，它使用式(3.4-2)的一维等式，，因为两个函数具有相同的尺寸，该卷积写为f(x)*kx)=,f(xD)h(x-m）这个等式与式4102制同、但是，对位移X的要求是它必须足够大，以便使反转的久完全滑过.换句话说，该过程包括：(1)关于原点求h的镜像(即使内旋转180°）〔见图4.28 6e)],、(2)以数量x平移镜像函数〔见图4.28 (d） ]，(3)对每一个平移的x值，计算前面公式右边的全部乘积之和。依据图14.28.这意味着对每个x值用图4.28 (d)中的函数乘以图4.28 (a)的函数。位移x的范围是要求h完全滑过厂的所有值。。图4.28 (C)显示了这两个函数的卷积。注意，卷积是位移变量：的函数，并且，在这个例子中，要求h完全滑过f的x的范围是从0到799.如果我们使用DFT和卷积定理得到与图4.28左列相同的结果，我们必须考虑DFT表达式中固有的周期。这与图4.2846)和图4.28.68)中对两个周期函数进行卷积是等价的。卷积过程与我们刚才讨论的相同，但是，现在这两个函数是周期函数。按前一段介绍的方法处理这两个函数将得到图4.28 G)所，很明显，它是不正确的。。因为，我们卷积两个周期函数，所以卷积本身也是周期的。示的结果，K4.28.中，周期的靠近使它们互相干扰而导致所谓的缠绕错误。根据卷积定理，如果我们计算两个400点的函数了和内的DFT，两个函数相乘，然后，计算反DFT，那么我们将得到如图4.28 6)所示卷积的 400点的错误的一段。幸运的是，解决缠绕错误问题很简单。考虑分别有A个样本和B个样本的两个函数fx)和hcx),可以证明(BrighamI1988D，如果我们把。添加到这两个函数中，使它们具有相同的长度，用尸来表示，然后，可以这样选择以避免缠绕：(4.6-26)bz3158(m400/(X)*8(*）00 600 8果叶变换十算的范围图 4.28左列：用3.4.2 节讨论的方法得到的两个离散函数的卷积。图(e)中的结果是正确的。列：相同函数的卷积，但考虑了DFTI的周期性。注意图0)中来自邻近周期的数据是如何产生缠绕错误而得不到正确卷积结果的。要得到正确的结果，必须对函数进行填充个函数有400个点，我们应该使用的最小全我们的例子中，每零可添加到函数的开始处:分别799，这意味着我们需要在每个函数的结尾处添加 399个0。直是P添加到函数的开始处和结尾处。但将这种处理称为0填充。。作为练习，读者可以自己证明：如果图4.28 (6D零添加到函数的结尾处更为简单和图4.28 g)中的函数的周期已通过至少填充 399个0的方法加长了，其结果就是一个周期卷积，其中每个周期都与图4.28e)中的正确结果相等。对DFT使用卷积定理将得到与图4.28(e)相同的799点的空间函数。其结论是：若要使第3章介绍的“直接”卷积公式法与，后者必须对函数补足周期再计算它们的变换。DFT方法产生的卷积结果相同，形象地表示二维下的例子较为困难，但是，我们可以得出关于缠绕错误及对函数补0的相同的结论。令C）和M:)分别是太小为4A4和LCXD像素的图像阵列。在循环卷积中的缠绕错误可以通过对这两个函数进行零填充来避免，方法如下:27z4频率域滤波1590≤x≤A-1和0≤y≤B-1J f(x,J)4.6-27）f,(x,y)=(0.4<x≤P或B≤)≤Qh(x,J).0≤x≤C-1和 0≤y≤D-14.6-28h,(x,J)）r≤x≤P或 D≤y≤Q其中，4.6-29）P>A+C-14.6-30)填充后的图像大小为P×Q。如果两个阵列大小相同，都是M×N，则要求P>2M -14.6-31）4.6-32我们将给出一个例子来说明图像上出现缠绕错误所带来的影响。-般来说，DFT算在 4.7.2 节，、因此最好选择户和Q为满足上面方程的最小偶整数。如果两个阵列法对偶数尺寸的阵列执行较快，则意味着P和Q选择为该阵列大小的两倍。大小相同,在图 4.28 (a)和图 4.28 (b)中，两个函数的值在取样间隔的尾端方便地变为0。如果这两个函数中有一一个函数或两个函数的值在取样区简单的切趾函数是位于取样间的尾端不是0，当把）添加到函数上以消除缠绕错误时，，就将创建数据中心的三角形，它会在取样数的两端过渡到0。这称为布特沃斯一个不连续的函数。这类似于用一个“盒子”与一个函数相乘，在频其他一率域它意味着原始变换与一一个sinc 函数的卷积(见例4.1)，依次地，和汉宁窗我们甚至可以使用高斯函数。在5:115节中，我们]将这将造成一一个由sinc 函数的高频分量导致的所谓频率泄漏。泄漏会在会回到加窗问题。图像上产生块效应。虽然漏泄从来没有被完全消除过，但可以用另外个函数乘以取样函数来明显地加以减少,，这个函数在取样数据的两端平滑地过渡到接近于零，从而咸弱”的（高频分量)急剧过渡。当在图像重建(如高清晰度图形)中希望保真度高的时候，这中称为开窗或切趾的方法是重要的考虑。如果您需要开窗，较好的方法是使用二维高斯函数(见4.8.3。该函数的的优点是其傅里叶变换也是高斯的，这样会产生较低的泄漏。门)。4.6.7二维离散傅里叶变换性质的小结表4.2总结了本章中介绍的主要的 DFT定义。4.11.1 节将讨论可分性，4.11.2 节将讨论用正变换算法得到反变换。第12章将讨论相关表4.3总结了一些重要的DFT对。虽然我们的关注点在离散函数上，但表中的最后两项是仅针对因在于它们在数字图像处理中非常有用。。微分对可用于推导式(3.6-3)中定义的拉普拉斯变换的频率域公式(见问题4.26)。高斯对将在4.7.4 节讨论表4.1到表4.3总结了使用DFT时的有用性质。这些性质中的许多种是本章剩余材料的关键内容，1274有些性质则会在后续几章中用到。276160DFT定义及相应表达式小结表4.21 fG,y)的离散傅里叶十变换(DFT）F (u,V）2) FL,)的离散傅里叶反变换(DFTDIN3）极坐标表示Fu.)=F《.以JFu,u川=[R"u,w)+7《4,.谱R= ReaI(F）)：I(u,V）相角k(u,V)6）功率谐Pu.,v)=|Fu,v7）均值F(u,v)= F(u+人,M,)= F(u,v8）周期性(,和后为整数)y+kzN)= f(x+k,M,y+k,N）Jasxkx.- EZromxnMe-）卷积艺Zr"m,”)Akx+m10）相关f(x,y)☆A(x, )二维DFT可以用先沿图像的行(列)计算一维DFT变换，然后沿结果的列(行)计算i）可分性维变换。见4.11.1节jarur Mty/wMNf"(x,J)=12）使用正变换算法得到傅里叶反变换各式指出・将,F.2柳公计美正变换的算法出式有侧)中、将得到Myr"αx.y）复共轭并除以MN就可给出希望的反变换。见4.11.2 节表 4.3。第12项和第13项中的闭合表达式仅对连续变量有DFT对的小结。效。通过对闭合形式的连续表达式取样后，它们也可用于离散变量bF对见表4.11）对称性2）线性4K(x,)+56,.)b3aK(L.)+5《.）f(Gx,Je3）平移性(一般J(x.JXC-1"”= F(u-M /2,u-N72）平移到频率矩形的中心M12,N2）fGr-M/2.y-N2)= Fu.DJ-)"”J(0,0 +6%)= F(0.9+6）s）旋转sine u=ocosp v=0J(6,3)*人x,)e. Fu,)An）5）卷积定理(x.)AGx,y)e F"a,)H(u,)））相关定理f"(x,y)h(x,y)台 F(u,b)☆H(山,y）S）离散单位冲激8(x,J)=1e-ouart））矩形函数rectla,小eab-10）正弦函数sin(Zzuor+ 27ny)e号I6u+ Muo, + M4o)-6u-Muo,v- Mo）】277第4章161续表DFT对- I6u+ Mov1）余弦函数+ Nuo)+ 8(u- Miuo， -%)月面的傅里叶变换对仅连续变量可推导、如之前那样，用，和z表示空间变量，用以和，表示频率变量。对连绞函数取样后・这些结果可用于 DPT处理。12）微分〔右边的表达式假定了((3品 GBru)"(jzry" F（u.v）13）高斯CA是常数）假定这些函数已经过0填充而得到了扩展。卷积和相关满足结合律、交换律和分配律。频率域滤波基础4.7在这一节中，我们将为本章剩余内容中讨论的所有滤波技术奠定基础。频率域的其他特性4.7.1我们从观察式(4.5-15)开始，，式中F(u，D)的每一项都包含有用指数项修改过的fCx, y)的所有值这样，除了不太重要的情况外，将一幅图像的某些特定分量与其变换直接联系起来通常是不可能的，然而，关于傅里叶变换的频率分量和一幅图像的空间特性间的关系可以做出某些一般的叙述。例如・因为频率直接关系到空间变化率、因此直观地将傅里叶变换中的频率与图像中的亮度变化模式联系起来并不困难。我们在4.6.5 节已经说明过，变化最慢的频率分量(u=v =0)与图像的平均灰度成正比当我们远离变换的原点时，低频对应于图像中变化缓慢的灰度分量。例如，在一幅房间图像中，这些可能对应于墙和地板的平滑灰度变化。当我们从原点移开更远一些时，较高的频率开始对应于图像中越来越快的灰度变化。这些是物体的边缘，或由灰度急剧变化来表征的其他图像分量。正如 2.6.7 节介绍的那样，频率域中的滤波技术是以如下处理为基础的：修改傅里叶变换以达到特殊目的，然后计算 IDFT返回到图像域。遵循式(4.6-15)，我们所用变换的两个分量是变换的幅节涵盖了变换的这两个分量的基本性质。在那里，，我们已了解到，相位分量度(谱)和相角。4.6.5 +的视觉分析通常并不是很有用，然而，产生该谱的图像的大致特点提供了某些很有用的指导。例如，考虑图 4.29(a)，它是一块集成电路的扫描电子显微图像，放大了近2500倍。除了器件本身的有趣结构之外，我们注意到两个主要特性：近似±45°方向的很强的边缘和两个由热感应故障导致的白色氧北突起物。图4.29(6)中的傅里叶谱显示了沿±45°方向的突出分量，这些分量对应于刚刚提到的边缘沿垂直轴仔细观察，可看到一一个稍微左偏垂直轴的垂直分量，该分量是由氧化突起物的边缘导致的。注意该频率分量与垂直轴的夹角是如何对应于长的白色物体(关于水平轴的)倾斜度的，还要注意垂直频率分量中的零是如何对应于氧化突起物的狭窄垂直范围的。277图 4.29Ga)已损坏集成电路的SEM图像、D)图(a)的傅里叶谱(原图像由加拿大28安大略省哈密尔顿市 MeMar大学材料研究所的J.M. Hudak博士提供62这些对应关系通常是在频率域与空间域之间建立的典型联系。。正如在本章稍后我们要说明的那样，恰恰是这些总体联系的类型与前面提到的频率内容和图像灰度变化率之间的伴随关系，，可以导致某些非常有用的结果。在下一节中，我们将说明修改图4.29(a)的变换中的各种频率范围的效果频率域滤波基础4.7.2文一幅图像的傅里叶变换然后计算其反变换得到处理后的结果组成。由此，若频率域滤波由修改一给定一幅大小为MxN的数字图像了(G,.)，则我们感兴趣的基本滤波公式有如下形式:g(x, )=9"[H(u,y)F(u,v)](4.7-1）其中，S"是IDFT，Fu,の)是输入图像fCx,y)的DFT，Hu,v)是滤波函数(也简称为滤波器,或者滤波传递函数),Ac、 )是滤波后的(输出)图像。函数厂、歼和g是大小与输门是实对称函数而了是实函人图像相同的M×N阵列。如2.6.1 节定义的那样，乘积Hu, p)F (u，）则式(4.7-1)中的数(通常是由阵列相乘形成的。滤波函数修改输入图像的变换来得到处理后的夜反变换通常包含有由舍人输出 gα,y)。使用关于中心对称的函数可显著地简化Hu，の)的技术条其他计算错误引起的寄生复数项。，它要求Fu，v)也被中心化。节解释的那样，这是通过在、如 4.6.3因此.我们通常取 IDFT的实部来形成函数g。计算变换前使用(-D)"'乘以输入图像来完成的"。现在，我们能够考虑滤波过程的一一些细节了。我们可以构建的最简单的滤波器之一是滤波器 H(u、V)当我们建立乘积Hu,D)F（。)时，该滤波器将抑制Fu.,)的直它在变换的中心处是0，而在其他处是1。充项而“通过”（即保留不变)所有其他项。我们从式(4.6-21)知道，直流项决定图像的平均灰度，如此，将其置。会把输出图像的平均灰度减小为0。K图4.30显示了使用式(4.7-1)时这一操作的结果。二.客平均表明在在众灰度。因此。尽管图430说明了原理，但不是原图胡望的那样图像变得更暗了象的真实描述，因为所有负灰度为显示目的都被修剪过(置为O）1如早些时候说明的那样，变换中的低频与图像中缓慢变化的灰度分量有关，，如室内的墙面和室外少云的天空等。另一方面，，高频由灰度的尖锐过渡造成，如边缘。因此，我们认为衰减高频而通过低频的滤波和噪声等。器 H(u，v)(近似称为低通滤波器)将模糊一幅图像，其有相反特性的滤波器(称为高通滤波器)将增强尖锐的细但是将导致图像对比度的降低。图4.31说明了这些效注意图4.31 (e)和图 4.30 之间的相似性。原因是所示图4.30将傅里叶变换中的F(M/2,M2)项置0.导致了与图4.30相同的基本的高通滤波器消去了直流项，对图 4.29a)中的图像滤波后的结果效果。。对滤波器加上一个小常数不会影响尖锐性，，但是它的确能防正直流项的消除，，并保留色调，如图4.31 ()所示。式4.7-1)涉及频率域中两个函数的乘积，由卷积定理，这意味着空间域的卷积。我们从4.6.6的过论知道・如果向题中的函数未被填充、可以料到会产生混淆误差。当我们用式.712而没有填充时，考虑一下会发生什么情况。图4.32a)显示了一幅简单的图像，图 4.32 6)是使用图 4.31 a)所示形式的高斯低通滤波器对图像低通滤波后的结果。如预料的那样，图像被模糊了，然而，模糊是不D许多二维DT的软件实现如MTLAB)并不要求变换关于中心对称。这意味着我们必须安排滤波函数・、以便其数据格式与非中心对称变换的数据格式相同(即让原点在在上角)。最终结果是生成和显示滤波器更为困难。在我们的讨论中、为便于显示、我们使用中心对称的变换，这对于清楚理解滤波的概念至关重要。只要保持了一致性。实践中可使用任意一种方法。频率域滤波163均匀的；顶部的白边被模糊了，、而两侧的白边未被模糊。在应用式(4.7-1)之前，根据式(4.6-31)和式(4.6-32)填充输入图像，将导致图4.32(C)所示的滤波后的图像。这正是我们期望的结果。图 4.31行：频率域滤波器一行：使用式(4.7-1)得到的相应的滤波后的图像。在图(c）中我们使用a=0.85来得到图(GD（滤波器本身的高度是1)。请将图(D与图4.29(a)比较a)一幅简单的图像；)无填充时使用高斯低通滤波器的模糊结果；C)填图4.32充后的低通滤波的结果。请比较图(b)和图(c)中垂直边缘的明亮区域图4.33说明了图4.32(b)和(c)之间差异的原因。图4.33中的虚线区域对应图 4.32(a)中的图像如 4.6.3 节解释的那样，图4.33（a)显示了使用 DFT的固有周期性。想象一下该模糊滤波器的空间表示与该图像卷积。当滤波器通过虚线框起来的图像区域的上方时，它将包围该图像的一部分及其右上方周期图像底部的一部分。一个暗区域和一个亮区域在滤波器下方时，结果是一一幅中等灰度的模糊图像。然而，当滤波器通过图像的右上侧时，滤波器将只包围图像中的亮区域及其右侧的相邻区域。个常数的平均仍是该常数，在这个区域滤波将无效，图4.320b)给出了结果。用0填充图像以在周期序列的周围建立一个平坦的边界，如图4.33 6)所示。将模糊函数与图 4.33 6)所示填充过的“马赛克”图像卷积，给出了图 433(6)所示的正确结果。从这个例子您可以看到，错误地填充一幅图像会导致错误的结果。如果滤波的目的仅仅是粗糙的视觉分析，那么有时可以跳过填充步骤。到目前为止，讨论集中在输入图像的填充上，但是，还包含一个滤波器，该滤波器可以在空间域或频率域中来规定。然而，填充是在空间域完成的，这就提出了空间填充和直接在频率域指定滤波器间的关系这个重要问题。初看起来，个可能的结论是；处理频率域滤波器填充的一一种方法是构建一个与图像尺寸相同的滤波器，计算该滤波器的IDFT得到相应的空间滤波器、在空间域填充这个空间滤波器，然后计算其DFT返回到频率域。图4.34所的一维例子说明了这种方法的缺陷。图4.34 (a)显示了频率域中的一164，因此，我们由表4.1中的性质8可知其 IDFT一维理想低通滤波器。。该滤波器是实的和偶对称的，。图4.34(6b)显示了用(-1)"乘以频率域滤波器的元素的结果，并计算其 IDFT以也是实的和偶对称的。得到相应的空间滤波器。该空间函数的两端不是0，因此，如图4.34(c)所示，对该函数进行0填充创建了两个不连续的函数(在函数的两端填充与在一端填充效果相同，只要所用的0的总数相同即可)数使用DFT时二维图像固有的周期性。a)未填充图像的周期性；6)使用0填充(黑)后图像的周期性。中心的图 4.33虚线区域对应于图4.32a)中的图像(为清楚起见，两幅图像中的细白线重叠在一起，它们不是数据的一部分D.4图4.34a)在(中心对称的)频率域中指定的原始滤波器；(b)计算图(a)的IDFT得到的空间表示；(C)将图(6)填充至其两倍长度后的结果(注意不连续点)；(d)通过计算图(c)的DFT得到的相应的频率域滤波器。注意，图(c)中的不连续导致了振铃现象(为简化视觉分析，点已连接起来，因此曲线看起来是连续的)为了回到频率域，我们计算填充后的空间滤波器的DFT。图4.34 d)显示了这一结果。正如在例4.1中您所预料的那样，空间滤波器中的不连续在其频率域中产生了振铃。理想滤波器的定义见433节的末尾如果以另一一种方法来观察，我们从一个例子知道，一个盒函数的傅里165叶变换是个其频率分量无限扩展的sinc 函数，因此我们期望盒函数的反变换也有相同的属性。一个理想的(盒状)频率域滤波器的空间表示具有无限扩展的分量。因此，任何实现0填充的就是说，滤波器的空间截断将引入不连续性，它通常会在频率域导致振铃现象(在这种情况下，如果它在0交又处做填充，可避免截尾，但我们感兴趣的是一般的过程，，而不是所有的滤波器都有0交叉)。前面的结果告诉我们，因为我们不能处理无限数量的分量，所以不可能使用理想的频率域滤波器见图4.34 (a）并且，同时使用零填充来避免缠绕错误。。因此，需要有一个可以接受的限制性决策。我们的目标是在频率域使用一个特定形状的滤波器(包括理想滤波器)而不必涉及截断问题。。一种方法，其尺寸与填充过的图像一样（记住，是对图像0填充，然后，在频率域创建滤波器，，使用 DFT时，图像和滤波器的大小必须相同)。当然，这将导致缠绕误差，因为未对该滤波器使用填充。但在实践中，该错误可通过图像填充提供的间隔有效地减轻，它对振铃也更好。平滑滤波器(如图 4.31中的那些)存王的问题更少。特别地，为了直接在频率域使用特定形状的滤波器做处理，，本章中我们采用的方法是把图像填充为P×Q大小，并构造相同维数的滤波器。正如早些时候说明的那样，P和Q分别由式(4.6-29)和式(4.6-30)给出。我们将以分析滤波变换的相位角来结束这一节。因为 DFT是复数阵列，我们可以将它表示为实部和虚部:F(u, )= R(u,v)+ j1(u,v）(4.7-2）然后，式(4.7-1)变为scx.,= "[1(u,D)RC,)+ jfu. (u.)）(4.7-3)相位角不能以刚刚描述的方法由滤波来更改，，因为当虚部和实部之比由式(4.6-17)形成时，H(u，D)就消去了。等同地影响实部和虚部而不影响相位的滤波器称为零相移滤波器。本章中仅考虑这种类型的滤波器。即使相位角的很小变化，也会对滤波输出有很大的影响(通常是我们不希望的)。图 4.35说明了如标-样简单的变化所带来的影响。图4.35 a)显示了用0.5乘以式(4.6-15)中的角度阵列得到的图像，不改变IF u, D)，然后计算 iDFT。基本形状保持不变，但灰度分布失真很大。图4.35(6)显示了用0.25乘以相角的结果。该图像几乎无法识别。图 4.35(a)使用0.5乘以式(4.6-15)中的相角然后计算iDFT得到的图像；Gb)使用0.25乘以相角得到的结果。两种情况下的谱没有变化频率域滤波步骤小结4.7.3前两节的内容可以总结如下:给定一幅大小为MXN的输入图像了Gx、 p)，从式(4.631)和式4.6-32)得到填充参数尸和Q。典型地，我们选择P2M和Q=2N。283对fGx.,)添加必要数量的0，形成大小为P×Q的填充后的图像x,y）。用(-1)**乘以f(x, )移到其变换的中心计算来自步骤3的图像的DFT，得到厂Fu，）、对称的滤波函数Hu,，)，其大小为P×Q，中心在(P)2,Q/2)处。用阵列相乘生成一个实的、形成乘积Gu, D)= H(u,DF(u,D)；即GGi,k)=H(i,kDFG,k）。得到处理后的图像:如前所述、关于中心对称有助于形象地描述滤波过程并生成滤波函s,(x.={reu[s"【(uw.)]}-D”数本身，但它不是基本的需求。其中，为忽略由于计算不准确导致的寄生复分量，选择了实部，下标p指出我们处理的是填充后的阵列。通过从gJx, )的左上象限提取MxN区域，得到最终处理结果gα,y)。图4.36说明了上述步骤。图中的符号解释了每一个图像源。。如果它被放大，，图 4.36 (c)将会显示图像中插人的黑点、因为。为了显示・负的灰度被裁剪为。了。注意图436)中图像暗边的特点・它是使用零填充处理后由低通滤波造成的。图4.36 幅大小为M×N的图像:b)大小为P×Q填充后的图像；（c)用-1”乘以几的结果;(OF,的谱；e)大小为P×Q的关于中心对称的高斯低通滤波器；(D乘积HF,的谱；（g(-1Gh)裁剪g,的前M行和前八列得到的最终结果g与H",的IDFT 的实部的乘积g,；4.7.4空间和频率域滤波间的对应空间域和频率域滤波间的纽带是卷积定理。。在4.7.2 节，我们把频率域中的滤波定义为滤波函数AL.)与输入图像的傅里叶变换厂u,)的乘积。给定一个滤波器Hu, )，、假定我们想要找出其空间域。如果我们]令fGx, )= 6. y)，它来自表4.3的Fu. ) =1。然后，由式4.7-1)可知滤波的等价表示。后的输出是$"[Hu,，p)]。但这是频率域滤波器的反变换，，它对应空间域的滤波器。反过来，遵循类似的分析和卷积定理，给定一个空间滤波器，，我们可以用该空间滤波器的傅里叶正变换得到其频率域表示。因此，两个滤波器形成了傅里叶变换对:(4.7-4）h(x,y)=H(u,，）其中，hcx, )是一一个空间滤波器。因为该滤波器可以由频率域滤波器对一个冲激的响应得到，所以Akx,.y9）D如果Hu,D)由一一个给定的空间滤波器准hG,x)2生成。则可按如下方式形成人.xy):将该空间滤波器的大小填充为AQ，使用-一D""栗286以扩展后的阵列，并计算结果的DPFT来得到H(uの。例4.15给出了这个过程。频率域滤波167有时称为Hu，)的脉冲响应。还有，因为式(4.74)的离散实现中的所有数值都是有限的，这样的滤波器称为有限冲激响应(FIR)滤波器。这些仅是在本书中考虑的一一类线性空间滤波器我们在3.4.1 节中介绍了空间卷积，，并讨论了其与式(3.4-2)有关的实现，它涉及不同尺寸的卷积函数。当我们根据卷积定理和DFT谈到空间卷积时，正如图 4.28解释的那样，它它意味着我们对周期一原因，如之前解释的那样，式(4.6-23)称为循环卷积。此外，在DFT的意义上，函数卷积。由于这一卷积包含相同尺寸的函数，反之，，在式(3.4-2)中，典型地，函数是不同尺寸的。，我们宁愿使用式(3.4-2)和较小的滤波器模板来实现卷积滤波，因为在硬件和(或)固在实践中，件实现时速度快而容易。然而，滤波的概念在频率域更直观。取两个域的特性的优点的一个方法是在频率域规定一个滤波器,，计算它的IDFT，然后，如构建较小的空间滤波模板那样，用反变换的结果得到全尺寸的空间滤波器（更正式的方法将在4.11.4 节中介绍)。这在下一节中再说明。。在这一节稍，给定一个小的空间滤波器，我们得到其全尺寸频率域表示。这后，我们将给出相反的过程，在这里种方法在频率域分析较小的空间滤波的特性是很有用的。记住，在下面的讨论中，傅里叶变换及其反变换是线性处理(见习题4.14)，因此讨论只限于线性滤波在下面的讨论中，我们使用高斯滤波器来说明如何运用频率域滤波器指定第3章中讨论的一些小模板的系数。基于高斯函数的滤波器特别重要，，因为如表 4.3 注释的那样，，一个高斯函数的正、反傅里叶变换都是实高斯函数。为便于说明原理，这里仅讨论一维高斯滤波器。。二维高斯滤波器在这一章稍后再讨论。令 Hu)表示一维频率域高斯滤波器：(4.7-5）其中，。是高斯曲线的标准差。空间域中的相应滤波器由 Ha)的傅里叶反变换得到(见习题4.31:(4.7-6)一个傅里叶变换对，两个分量都是高斯的和实的函数。这便这些公式少很重要，原因有二：(1)它们是于分析，因为我们不必涉及复数。另外，高斯曲线很直观，并易于操作。（2)函数表现为互易的。当Hu)有一个较宽的外形时(o值较大),hn)有较窄的外形，并且，反之亦然。事实上，当α接近无限时，Hu姜近一一个常数函数，并且h()趋近于一个冲激，这意味着在频率域和空间域都不能滤波。图4.37(a)和图4.376)显示了频率域高斯低通滤波器和空间域对应的低通滤波器的曲线。。假定我们想。这两个滤波器之间的关键相似要使用图 4.37(6)中hx)的曲线形状作为指导规定一一个小空间模板的系数。性是它们的所有值都是正的。。这样，我们就得出一个结论，我们使用一个全部带正系数的模板就可在空间域中实现低通滤波(如我们在35.1节中所做的那样)。作为参考，图4.376)中显示了在3.5.1 节中讨论的两个模板。注意前一段讨论的滤波器宽度间的互易关系。频率域滤波器越窄，其衰减的低频越多，引起的模糊越大。在空间域，这意味着必须使用较大的模板来增加模糊，正如例3.13中说明的那样。更复杂的滤波器可以使用式(4.7-5)给出的基本高斯函数来构建。例如，我们可以用高斯函数的差来构造一一个高通滤波器:(4.7-7）其中，A>B,0, >02。空间域中的相应滤波器是he = 5zo,ae*o、√2zo,e-ro(4.7-8）图 4.37(c)和图 4.37 4)显示了这两个公式的曲线。我们再次注意到宽度的互易性，但这里最重要的特286の像表4.3中提及的那样・、商斯函数的闭合形式的正反傅里叶变换仅对连续函数有效。要使用离散公式，我们只需对连续的高斯变换取样。这里使用离散变量表明我们正在处理取样后的变换168了这一特点性是，hcx)有一个正的中心项及在其两侧的负项。。显示在图 4.37(d)中的小模板““捕捉”这两个模板在第3章中用做锐化滤波，即我们目前所知道的高通滤波器。H(u）7(u）图 4.37（a)频率域中的一维高斯低通滤波器；(b)对应于图(a)的空间低通滤波器；（c)频率域中的高斯高通滤波器；の对应于图(C)的空间高通滤波器。所示小二维模板是我们在第3章中用过的空间滤波器虽然我们已经做了许多努力，但我们确信，如果没有刚刚建立的基础，要真正理解频率域滤波。在实践中，，频率域可被视为一“实验室"，在这里，我们取频率内容和图像表观之间是不可能的。相应的优点。。如本章后面多次展示的那样，，有些在空间域异常困难的或不可能直接用公式表达的任务在频率域却变得很容易。-旦我们在频率域通过实验选择了一一个特定的滤波器，该方法的实际实现通常是在空间域完成的。。一种方法是指定试图捕获空间域中全部滤波器函数的“本质””的小空间模板・。更正式的方法是使以数学或统计规则为基础近似设计一个二维数字正像我们在图4.37中解释的那样。滤波器。在4.11.4节中将再次接触这个主题。由小空间模板得到频率域滤波器。例4.15在这个例子中，我们从一个空间模板开始，并说明如何产生相应的频率域滤波器。然后，我们比较用频率域滤波和空间技术得到的滤波结果。。当希望比较给定的空间模板相对于一个或多个频率域全滤波器候选者的性能时,或者深人理解模板的性能时,这类分析是很有用的。为简单计，我们使用来自图3.41 (e）中的3×3 Sobel垂直边缘检测器。图 4.38a)显示了一幅600 ×600像素的图像几, y)，我们要对它进行滤波，图4.38 (b)显示了该图像的谱。图4.39 （a显示了这个Sobel模板k,.6透视图在下面解释)。因为输入图像的大小是600600像素而滤波器的大小为3×3，为避免缠绕错误，，我们根据式(4.6-29)和式(4.6-30)将f和h填充为602×602像素大小，Sobel模板是奇对称的，它被嵌入到一一个偶数尺寸的0阵列中(见例4.10)。为保持这种对称性，我们把hx, )的中心放在602×602这个填充后的阵列的中心处。对滤波器生成来说,这是一个很重要的方面。如果我们在形成hJGx, )的过程中，关手填充后的阵列保持奇对称，则由表4.1中的性质9可知Hu,，)将完全是虚函数。如我们在本例末尾显示的那样，这将得到用kG, y)对图像进行空间滤波相同的结果。如果不保持这种对称性，则结果将不再相同用以产生Hu,，)的过程是：(D)用-1)y*乘以hJ, y)以便频率域滤波器“中心化”；2)计算(1)中结果的正DFT；3)考虑寄生的实部(我们知道。，)必须是纯虚函数)，将得到的DFT的实部置0；（4)用-1)"乘以该结果。最后一一步反过来用-1)"…乘以人从以)，它隐含着长t,.)被移到、)的中心。图439 4a)显示了 HIuL,，)的透视图，而图4.396)以图像的方式显示了 Hu,，）。如期望的那样，该函数是奇函数，因而其关图4.39(c)是在 4.7.3 节略述的步骤中使用刚才得到的滤波器对图 4.38 (a)中的图像滤波的结果。正如我们对推导出的滤波器所期望那样，边缘被增强了，所有的恒值灰度区域被减小为0(为了显示，灰度色调进行了标定)。图4.39()显示了在3.6.4 节给出的步骤中使用hc, y)直接在空间域对同一图像滤波的结果，结果相同29l频率域滤波169图 4.38（a)一幅建筑物的图像；b)该图像的谱aD一个空间模板和它的频率域中对应的滤波器的透视图；O)以图像形式显示的滤波器；c)在频率域中使用图4.39图(O)中的滤波器对图4.38 a)滤波后的结果；a)使用a)中的空间滤波器对同一图像滤波的结果。结果相同使用频率域滤波器平滑图像4.8本章剩余部分将涉及频率域中的各种滤波技术。我们从低通滤波器开始。一幅图像中的边缘和其他尖锐的灰度转变(如噪声)）对其傅里叶变换的高频内容有贡献。因此，在频率域平滑(模糊)可通过对高频的衰减来达到；也就是用低通滤波。在这一节，我们考虑三种类型的低通滤波器：理想滤波器市特沃斯滤波器和高斯滤波器。这三种滤波器涵盖了从非常尖锐(理想)的滤波到非常平滑(高斯)的滤波。布特沃斯滤波器有一当阶数值较高时，布特沃斯滤波器接近于理也围。一个参数，称为滤波器的“阶数”。想滤波器。对于较低的阶数值，布特沃斯滤波器更像高斯滤波器。这样，布特沃斯滤波器可看成是两种极端”滤波器的过渡。本节中所有的滤波器都遵循4.7.3 节概述的步骤，因此所有的滤波函数Hu，D可理想低通滤波器4.8.1在以原点为圆心、以D。为半径的圆内，无衰减地通过所有频率，而在该圆外“切断”所有频率的二维低通滤波器，称为理想低通滤波器(ILPF)；它由下面的函数确定：D(u,p)≤D0(4.8-1）H(u, )=3[0,D(u,)> D其中，D是一个正常数，D(u,)是频率域中点仙,)与频率矩形中心的距离，即Du, )=[u-P/2- +v-972)」 4.8-2）1290其中，与以单一样、几和Q是用式(46.30和式(4632）填充后的尺寸。图4.4060）显示了Hu.D0的透视图图40）显示了以图像显示的滤波器。如4.33 资提到的那样，理想这一名称表明在半径为D。的圆170内，所有频率无衰减地通过，而在此圆之外的所有频率则完全被衰减(滤除)。理想低通滤波器是关于原点径向对称的，这意味着该滤波器完全由个径向横截面来定义，如图 4.40 (c)所示。将该横截面旋转360°得到二维滤波器。一个理想低通滤波器(ILPF)横截面,在Hu, )=1和Hu, ) =0之间的过渡点称为截止频率对于，在图4.40所示的情况下，截止频率为Do。ILPF的这种陡峭的截止频率不能使用电子元件来实阿如，现，尽管它们可以在计算机上仿真。对数字图像使用这些“非物理”滤波器的效果将在本节后面讨论。D(u, D）图 4.40(a)一个理想低通滤波器变换函数的透视图；b)以图像形式显示的滤波器；C)滤波器径向横截面本章介绍的低通滤波器可用具有相同截止频率的函数研究其特性而加以比较。建立一组标准截止频率轨迹的一种方法是计算包含规定的总图像功率值P,的圆。该值是通过求每个点(u，)处填充后图像的功率谱分量的和得到的，其中“=0,.1，即P(u,v）宁.4.8-3）其中，P(u,の已在式(4.6-18)中给出。如果 DFT已被中心化，那么原点位于频率矩形中心处、半径为D。的圆将包含α%的功率，其中艺艺Pu,)/1年(4.8-4）则总和取处于圆之内或边界线上的(u,V)值。图4.41 (a)和(b)显示了一幅测试模式图像及其傅里叶谱。谱上重叠的圆的半径分别为10,30,60.160和460像素。这些圆包围的图像功率(α2%)分别为87.0%, 93.1%,95.7%,97.8%和199.2%。谱迅速衰落，总功率的87%包含在半径为10的小圆内。d繁a a a a aaa图4.41(a)大小为688×688像素的测试模式；(b)测试模式的傅里叶谱。。由于填充,、该谱的大小为图像大小的两:92倍，俱是，它是以一半大小来影示的、因此。在克面上是匹配的。在谱上重叠的圆的半径相对于全尺寸的谱图293像来说分别为10,30.0.160和460。这些半径分别包含了填充后图像功率的87.0%.931%.95.7%,97.8%和92%韦 4章171使用一个LPF平滑图像。例 4.16 K4.42 显示了应用图4.41 0)中所示半径的截止频率的LP日的结果。图42 b)对所有的实际目的没，除非模糊的目标是消除图像中的所有细节，但表示最大物体的“斑点”除外。此图像中的严重有意义，模糊表明，图像中的多数尖锐的细节信息包含在被滤波器滤除的13%的功率内。随着滤波器半径的增大，滤除的功率越来越少，导致的模糊也越来越减弱。注意，图4.42 (c)到图4.42(e)中的图像都有“振铃”的特征，随着被滤除的高频内容的数量的减少，图像的纹理变得越来越好。甚至在只滤除了总功率的 2%的图像〔见图 4.42(e)]中，，振铃现象也很明显。。正如稍后您很快将要看到的那样，这种振铃现象是理想滤皮器的一一种特性。最后，= 99.2%时的结果在噪声区域内有非常轻微的模糊，但大部分图像与原图像非常接近。这表明在这种特殊情况下，图像中很少有边缘信息包含在0.8%以上的谱功率中。从这个例子中可以清楚地着到，理想低通滤波器并不是非常实用。然而，作为滤波概念发展的一部研究这种滤波器的特性非常有用。。同时，正如以下讨论所示，通过试图解释 LPF在空间域的振铃特可以得到一些有趣的见解。Lh a aaaa本台兼券康康器d免峰i a aa &a a a aaaa图 4.42a)原图像；b)-()使用LPF滤波后的结果，截正频率分别设置在半径值10,30,.60, 160和460处，如图4.41b)所示。这些滤波器移除的功率分别为总功率的13%, 6.9%, 4.3%,2.2%和0.8%ILPF的模糊和振铃特性可用卷积定理来解释。图 4.43(a)显示了半径为10的正PF的空间表示kG、y)，图4.43(6b)显示了一条通过图像中心的水平线的灰度剖面线。由F LPF 在频率域的刮面图类似于盒状滤波器，因此相应的空间滤波器具有sinc 函数形状是可以预料的。。空间域滤波可以通过 hx,)与图像卷积来实现。将图像中的图 4.43（a)半径为5、大小为100x100的LPF的空间域表每一个像素想象为一它的强一个离散冲激、示；（b)一条通过图像中心的水平线的灰度剖面图度与所在位置的灰度成正比。个 sinc 函一个冲激卷积就是在冲激处复制这个sinc 函数。sinc 函数的中心波瓣是引起模糊的主因，而外侧效与较小的波瓣是造成振铃的主要原因。sinc 函数与图像中的每一个像素卷积为解释LPF的特性提供了个很好的模型。。因为sinc 函数的就越趋近于一个与图像卷积时根本不会导致模糊的冲激。我们现在应已习惯了这种类型的彼此相反295172的特性。我们将说明很小的或没有振铃而达到模糊是可能的，违。在接下来的两节中，这是低通滤波的重要目标。布特沃斯低通滤波器的传递函数通4.8.2布特沃斯低通滤波器席写为此处表达式的平方根。由于此处我们关心的是这种滤波器的基本形截正频率位于距原点D处的n阶布特沃斯低通滤波器(BLPF)的武，因此为计算方便去球了平方根。传递函数定义为4.8-5）H(u, )）=1+[D(u,v)7D厂其中，Du,)由式(4.8-2)给出。图4.44显示了该BLPF函数的透视图、、图像显示和径向剖面图。Hi b c-D(u,D）a)布特沃斯低通滤波器传递函数的透视图；6)显示为图像的滤波器；e)阶数为1到4的滤波器的径向剖面冬 44与 ILPF不同，BLPF传递函数并没有在通过频率和滤除频率之间给出明显截止的尖锐的不连续性。对于具有平滑传递函数的滤波器，可在这样一点上定义截止频率，即使得Hu，の下降为其最大值的某个百分比的点。截止频率点是当Du.D)=D%时的点〔即Hu,)从其最大值1下降为50% 5在式(4.8-5)中，截例4.17使用布特沃斯低通滤波器平滑图像。图4.45显示了将式(4.8-5)中的BLPF应用于图4.45 (a)的结果，其中n = 2，D.等于图4.41 (b)所示的个半径。不像图 4.42所示的LPF的结果，我们注意到，此处模糊的平滑过渡是截止频率增大的函数。此外，使用这种特殊 BLPF 处理过的任何图像中都没有可见的振铃现象，这要归因于这种滤波器在低频和高频之间的平滑过渡。Ha a aaaa鱼湘海源源藩康dd. d茶s s 中a群a a ao aa a aaas a a a aaaa图 4.45Ga)原图像；(b)-(f)使用2阶 BLPF的结果，BLPF297的截止频率位于图 4.41所示的半径处。上。与图42 比较频率域滤波73一阶布特沃斯滤波器没有振铃现象。在二阶滤波器中，振铃现象通常很难察觉，但在空间域的一更高阶数的滤波器中振铃现象会很明显。图4.46 比较了不同阶数的BLPF的空间表示(所有情况下均吏用截正频率5），还显示了通过每个滤波器中心的水平扫描线的灰度剖面图。这些滤波器是使用生成图4.43的相同过程来获得并显示的。为便于比较，使用伽马变换〔见式(3.2-3)」对图4.46中的图像进行了额外的增强。二阶 BLPF的确显示了轻微的振铃和一阶 BLPF[见图4.46(a)丁没有振铃和负值。较小的负值，但远没有在 LPF中那样明显。。正如其余图像所示，、在 BLPF中，高阶滤波器中的振铃现象变得很明显。20阶布特沃斯滤波器呈现出了与ILPF类似的特性(极限情况下，两个滤波器相同)因此，二阶的BLPF是在有效的低通滤波和可接受的振铃特性之间的好的折中。图4.46(a)-(d)阶数分别为1,2,5和20的BLPF的空间表示及相应的通过滤波器中心的灰度剖面图(所有情况下大小均为1000×100，且截止频率为5)。。观察作为滤波器阶数的函数的振铃是如何增加的4.8.3高斯低通滤波器维高斯低通滤波器(GLPF)在4.7.4 节中已介绍过，当时介绍它的目的是用来帮助寻找空间域与频率域之间的重要联系。这些滤波器的二维形式由下式给出:(4.8-6)其中，如式(4.8-2)中那样，D(u，p)是距频率矩形中心的距离。为与本节讨论的滤波器保持一致，这里我们并未像在4.7.4节那样使用一个最高值为1的常量乘数。与以前一样，。是关于中心的扩展度的度量。通过令。=D。，我们可以在本节中使用其他滤波器的表示法来表示该滤波器：-DP (u,p)/2D8(4.8-7）H (u,v)=e其中，D.是截止频率。当D(u, D)= D.时，GLPF 下降到其最大值的0.607处。如表4.3所示,GLPF的傅里叶反变换也是高斯的.这意味着通过计算式(4.8-6)或式(4.8-7)的IDFT得到的空间高斯滤波器将没有振铃。图4.47显示了一一个GLPF函数的透视图、图像显示和径向剖面图，表4.4总结了本节讨论的低通滤波器299图4.47D一个GLPF传逢函数的透视图；0)显示为图像的滤波器：(e)不同D。值的滤波器径向剖面图n是布特沃斯滤波器的阶数低通滤波器。D.是截正频率，夜4.4布特沃斯1.D(u,V)≤DH(u,)=(u,V）1+1Du,)/20了0,Du,)> D0例4.18使用高斯低通滤波器平滑图像。图4.48显示了将式(4.8-7)给出的GLPF应用到图4.48 a)后的结果，其中D。等于图4.416b)中的5个半径。正如二阶 BLPF(见图4.45)的情况那样，我们注意到模糊的平滑过渡是截止频率增大的函数。比较图4.45 (c)和图4.48c)可以看到，对于相同的截正频率，GLPF与二阶 BLPF相比，导致的平滑效果要稍微差一些。。这正如我们所料，因为GLPF的削面图不像二阶BLPF的剖面图那样“紧淡”。但结果还是可以比较的,且我们可以确信在 GLPF 中没有振铃。这是实际中的一一个重要特性，尤其是在任何类型的人工缺陷不可接受的情况如医学成像)下。在需要严格控制低频和高频之间截止频率的过渡的情况下，BLPF是更合适的选择。额外控制滤波器剖面线的代价是可能会产生振铃。daa a aaaa海第票器源晶话daQa ' H34.48a)原图像；b)-(0使用截止频率位于图441所示半径处的GLPF对图像滤波后的结果。请比较图442和图4.454.8.4低通滤波的其他例子在下面的讨论中，我们将说明频率域中低通滤波的几个实际应用。第一个例子来自机器感知领或即字符识别的应用;类似的结果可用3.5节讨论的低通空间滤波技术得到。K4.49显示了一幅低分辨率文本的例子。例如・我们会在传真、复印材料和历史记录中遇到这样的文本。这个特殊的例子中并不存在其他像污点、折痕和破痕这样的困难。。图 4.49(a)中的放大部分生了失真的形状，并且许多字符已断裂。尽管人为填充这些裂缝表明该文件中的学符因分辨率不足产一种方法是，通过模糊输入图像来桥接输入图像中的这些小裂缝。图49(6)显示了如何使用D。= 80的高斯低通滤波器的简单处理图像很好地修复了字符。这些图像的大小为444× 508像素。低通滤波是印刷和出版业常用的一一种技术，在这里用来做预处理，包括3.6.3节中讨论过的去锐“美容”处理是低通滤波在印刷业中的另一北模板。一个应用。图4.504.9.5.中将讨论频率域中的去锐显示了低通滤波的一个应用，与清晰的原图像相比、低通滤波后的图化模板处理。像看上去更平滑、更柔和。对于人脸，主要目的是减少皮肤细纹的锐频率域滤波化程度和小斑点。从图4.506b)和图 4.50(e)中的放大部分可明显看出，眼睛周围的细纹已明显减少。事实上，平滑后的图像看上去更为柔和与美观rams x.e xiten.usingprograAccordingly, theratherEE可中图 4.49Ca)低分辨率文本例子(注意放大图中的断裂字符)；(b)使用GLPF对图像滤波后的结果(断开的字符段已被连在一起)i b c(a)原图像(784×732像素)；()使用D.=100的GLPF对图像滤波后的结果；e)使用D.=图 4.5080的GLPF对图像滤波后的结果。注意图(b)和图(c)中放大部分的皮肤皱纹已减少了图4.51显示了相同图像的两种低通滤波应用，但是具有不同目的。图4.51 （a)是一幅显示了部分墨西哥海湾(暗色)和佛罗里达(亮色)的、大小为808×754的甚高分辨率辐射计(VHRR)图像，该图像由NOAA 卫星拍摄(注意水平传感器扫描线)。水体间的边界是由环流引起的。这幅图像是直观的遥感图像，传感器具有沿着场景扫描方向产生突出的扫描线的倾向(见例4.24中在于物理原因的说明低通滤波是降低这些线的影响的粗略而简单的方法，如图4.51 (6)所示(4.10 节和5.4.1节中将考虑更为有效的方法)。该图像是使用D。=50的高斯低通滤波器得到的。降低扫描线的影响可简化如洋流间边界特征的检测。20l1图4.51aD显示有突出扫描线的图像；b)使用D。=50的GLPF对图像滤波后的结一so3；(c)使用D.=20的 GLPF对图像滤波后的结果(原图像由NOAA提供)176图4.51Gc).显示了使用.=.20的高斯低通滤波器对图像滤波更有意义的结果。这里，对图像滤波的目的是尽可能模糊更多的细节，而保留大的可识别特征。，这种类型的滤波可以作为图像分析例如，具有这种特征的一个例子可能是给定大小的湖系统的预处理的一部分，，该系统在图像库中搜索特征。其例如佛罗里达东南部的奥基乔比湖，如图 4.51(c)所示的一个近似环形的暗区。低通滤波通过消日，1除比感兴趣的平均特征小的其他特征来简化分析。使用频率域滤波器锐化图像4.9在前面几节中，我们说明了通过衰减图像的傅里叶变换的高频成分可以平滑图像。因为边缘和其他灰度的急剧变化与高频分量有关，所以图像的锐化可在频率域通过高通滤波来实现，高通滤波会衰减傅里叶变换中的低频分量而不会扰乱高频信息。。如 4.8 节那样，我们仅考虑径向对称的零相移滤波器。本节中的所有滤波都以 4.7.3 节概述的过程为基础，因此所有的滤波器函数 Hu,p)都可理解为，即离散频率变量的范围是u=0,1,2,,，P-1和v=0.1.2.,0-1。大小为PxQ的离散函数，个高通滤波器是从给定的低通滤波器用下式得到:Hp(u, 0)=1-Hupu,y)）4.9-1），被低通滤波器衰减的频率能通过高通滤波器、其中，Hulu，V)是低通滤波器的传递函数。也就是说，支之亦然。在本节中，我们考虑理想、布特沃斯和高斯高通滤波器。。如前面几节所示，我们在频率域和空司域分别说明这些滤波器的特性。图4.52显示了这些滤波器的典型三维图、图像表示和剖面图。像前，我们看到，布特沃斯滤波器表现为理想滤波器的锐利性和高斯滤波器的宽阔平滑性间的一川一样，，图4.53说明了这些滤波器在空间域的形状。空间滤波器是使用用于生成过渡。紧随该节后面的讨论，图4.43和图 4.46的步骤得到和显示的。理想高通滤波器4.9.1个二维理想高通滤波器(IHPF)定义为D(u,D)≤D4.9-2）H(u,y）D(u,)> D0其中，D。是截止频率，Du，の)由式(4.8-2)给出。这个表达式直接来自式(4.8-1)和式(4.9-1)。正如所预料的那样，IHPF与ILPF是相对的，在这种情况下，IHPF把以半径为D。的圆内的所有频率置零,而毫无衰减地通过圆外的所有频率。如同正LPF那样，IHPF也是物理上无法实现的。但与前面一样，我们这里出于完整性而讨论它，因为HPF可以用来解释空间域中的振铃等现象。。讨论将很简要因为它们与式(4.:-12的方法有关，，我们可以预料HPF和I正LPF一样具有相同的振铃性质，这清楚地展示在454中、这些图像由使用公分别为30:.0和160.个像素的各种IHP对34410)中的原始图像滤波后的结果组成。图4.4中的振铃现象相当”重、以至于产生了失真、物体的边界也被加粗了(看下那个大字母“"）。项部3个圆的显示也不是很好，因为它们不像图像中的其他边缘那样强(这3个目标的灰度很接近于背景灰度，产生了较小的幅度不连续)。观察图4.53(a)中IHPF的空间表示的“点的大小，记住，空间域滤波是空间滤波器与图像的卷积，这一一概念可以帮助解释为什么较小的物体和线条儿乎显示为纯白色。特别应注意图 4.54 (a)中最上一行的3个小方形和垂直细条带。当D.=60时情况有所改善。边缘失真仍很明显，，但现在我们开始着到对于较小物体的过滤。由于现在已很熟悉频本域和空间城的相反关系，我价们年1道这个速波器的点的大小要比0-30的速波器更小。2.-109年果频率域滤波177，失真更小，而且较小的物体已被正确滤除。当然，更像一幅高通滤波后的图像。在这里，边缘更清晰，所有图像的恒定背景在高通滤波后的图像中都是0，因为高通滤波类似于空间域中的差分。图 4.52顶部行：典型理想高通滤波器的透视图、图像表示和剖面图，中间行：典型布特沃斯高通滤波器的透视图、图像表示和剖面图和；底部行：典型高斯高通滤波器的透视图、、图像表示和剖面图b C图4.53a)典型的频率域理想高通滤波器的空间表示及通过滤波器中心的对应灰度剖面图O）典型的频率域布特沃斯高通滤波器的空间表示及通过滤波器中心的应灰度剖面图:(e)典型的高斯频率域高通滤波器的空间表示及通过滤波器中心的对应灰度剖面图178冬4.54使用D.= 30,.60和160的IHPF对图 4.41 (a)中的图像滤波后的结果4.9.2布特沃斯高通滤波器战正频率为D的n阶布特沃斯高通滤波器(BHPF)定义为H(u,V） 4.9-3）1+[D. 7Du,v)]其中Du，)由式(4.8-2)给出。该表达式直接来自式(4.8-5)和式(4.9-1）。图 4.52的中间一行显示了该BHPF函数的图像和剖面图。与低通滤波器一样，我们可以料想到布特沃斯高通滤波器比IHPF更平滑。图4.55显示了D,值与图4.54中的设置相同的2阶BHPF的特性。丰边缘失真比图4.54小得多，甚至对于最小的截止频率值也一样。因为 IHIPF和BHPF 中心区域的点的大小类似〔见图4.53(a)和图4.53(6) 1,，这两个滤波器过滤小目标的性能就可比了。截止频率越大，使用BHPF得到的结果就越平滑。b图4.55使用「对应于图4.41 6)中的〕D.=30.60和160的2阶BHIPF对H图 4.41 a中的图像高通滤波后的结果。这些结果比用IHPF得到的结果平滑得多4.9.3高斯高通滤波器截正频率处在距频率矩形中心距离为D,的高斯高通滤波器(GHPF)的传递函数由下式给出：(4.9-4）其中，Du， の由式(4.8-2)给出。该表达式直接来自式(4.8-7)和式(4.9-1)。图4.52的第三行显示了 GHPF函数的透视图、图像和剖面。。沿用BHPF相同的形式，图4.56中显示了使用GHPF的类似结果。正如所料，得到的结果比前两个滤波器的结果更平滑。即使是对微小物体和细线条使用高斯滤波器滤波，结果也是较清晰的。。表4.5总结了本节讨论的高通滤波器。a b c图4.56使用一D.=30.60和160的GHPF对图 4.41(a)中的图像进行高通滤波后的结果，D,对应着图41 (6)中的各个圆圈。请与图 4.54和图4.55进行比较第4章79高通滤波器。D。是截止频率，表4.5n是布特沃斯滤波器的阶数布特沃斯Du.v)≤D.(a.p)/2D+LD./ Du.广”Du,D)> D6例4.19使用高通滤波法和阈值法增强图像。图4.57（a)是一幅大小为1026 × 962的指纹图像，其污染(一种典型的问题)是很明显的。自动指纹识别的关键步是增强指纹的脊线并减小污染。。增强在人对指纹的解释方面也是很有用的。在这个例子中，我们使用高通滤波法来增强脊线并减小污染效应。脊线的增强使用脊线包含高频这样一个事实来完成，而高通滤波器不会改变高频。另一方面，滤波器减少了低频分量，而低频分量对应图像中慢变化的灰度，例如背景和污染。这样，增强就可以通过减少除高频外的所有特征来达到，在这种情况下，高频是感兴趣的特征。图4.57 (b)是使用截止频率为50的4阶布特沃斯高通滤波器滤波后直D。大约为填充后图像的短维，高通滤波后的图像失去了它的灰度色调，因为的结果。如期望的那样，53%元.。接近于愿点较为理想.直流项已被减小为0。最终结果是高通滤波后的图像中典型的暗色调已为这样会衰减低频，但低频不会完D。在短维的2%至5%是全消除成为主流，这样，就需要附加的处理来增强感兴趣的细节。一种简单的个不错的起点。方法是对滤波后的图像进行阈值处理。。图4.57(c)显示了将滤波后的图像中的所有负值设置为黑、将所有正值设置为白后的结果。注意，脊线变清晰了且污染已明显地减小了。事实上，图4.57(a)所示图像右上方部分中几乎已看不见的脊线在图4.57 (c)中已被很好地增强了。图4.57(a)指纹图像；(b)对图(a)高通滤波后的结果；（c)对图(b)进行阈值操作后的结果(原图像由美国国家标准和技术研究所提供)频率域的拉普拉斯算子4.9.4在3.6.2 节，我们已用过拉普拉斯算子对空间域图像进行增强。。在这一节，我们再重温一下拉普拉斯算子，并说明它可得到与频率域技术的等效结果。可以证明(见习题4.26)拉普拉斯算子可使用如下滤波器在频率域实现:Hu,v)= -4元（uf +v）(4.9-5）或者，关于频率矩形的中心，使用如下滤波器:=-4r*[u- P/2) +(0-012*]=-4r D"u.，4.9-6）H(u,V)=其中，Du,)是式(4.8-2)给出的距离函数。然后，拉普拉斯图像由下式得到：Vf(x,y)=3"{H(u,D)F(u,v)}4.9-7）其中，Fu,)是f(x,y)的傅里叶变换。如3.6.2 节描述的那样，增强可使用下式实现:4.9-8）g(x,y)= f(x, y)+cV' f(x,y)）Bo9数字图像处理(第三版）这里,c=-1,因为Hu, v)是负的。在第3章中,fGx, y)和Vf(x,y)具有可比的数值。然而，用式(4.9-7）计算V fGx,y)会引入已标定系数的DPFT，这些系数的幅度与了的最大值相比可能要大几个量级。这样，f与其拉普拉斯间的差别一一定会被带入可比的范围。处理该问题的最容易的方法是在计算了（G.y）的DFT之前将f(C, )的值归一化到区间[0,11内，并用它的最大值除VP了(x,y)，从而将它带到近似区。然后，可以应用式(4.9-8）甸[-1, 1]内(回忆一下，拉普拉斯算子有负值)。在频率域，式(4.9-8)可写为g(x,y)= 9"{ Fu,y)- H(u,)F（u,)}=5*"{u-Hu,)lF（u,)}=s*"{1+4r' D"u,)lF（u,)} 49-9）虽然这一结果是精致的，但它也存在刚刚提到的标定问题，且伴有归一化系数不容易计算的事实由于这一原因，式(4.9-8)优先选择在频率域中实现，使用式(4.9-7)计算V'f(x,J)，并用前节提到的方法来标定。例 4.20使用拉普拉斯算子在频率域锐化图像。图458()是与图3,38a一样的图像，图剧.586)显示了使用式(49-8)后的结果，其中拉普拉斯算子在频率域用式(4.9-7)计算。标定使用与公式有关的描述来完成。比较图4.58(6)和图3.38(e)，我们可以看到，频率域和空间域的结果在视觉上是相同的。很明显，在这两幅图中，对应于图3370中的拉普拉斯模板在中心有“个-8(习题4.26)。图4.58(b)在频率域中使用拉普拉斯算子增强后的图像。请与图3.38(e)比较(a)原始模糊图像；4.9.5钝化模板、高提升滤波和高频强调滤波在这一节，我们讨论3.6.3 节中介绍过的钝化模板、高提升滤波图像锐化技术。使用频率域方法，式(3.6-8)中定义的模板由下式给出：4.9-10）S mu（X,y)= /(x,y)- fp(X,y）fu(x,9) =3"[HLpu, )F(u,y)](4.9-11）其中，HuJu，)是一个低通滤波器。F《，D是（K、 的博里叶变换。这里，《,)是平滑后的图像、该图像类似于式(3.6-8)中的了(Gx,y)）。然后，如式(3.6-9)那样，有4.9-120该表达式定义了k=1时的钝化模板和k>1时的高提升滤波器。利用前面的结果，我们完全可以使用310涉及低通滤波器的频率域计算来表达式(4.9-12):频率域滤波181s(x.= "{L1+人*1-u,D)]"u.v}(4.9-13）我们可以根据高通滤波器来表达该结果:用式(4.9-1)，=5*"{1+k Hiup u,y)]F（u,D}(4.9-14)g(x, y)力括号中的表达式称为高频强调滤波器。如前面注释的那样，高通滤波器将直流项设置为0，这样，就把滤波后的图像的平均灰度减小为0。高频强调滤波器不存在这一问题，因为高通滤波器上加了1。常数k给出了影响最终结果的高频的比例。高频强调滤波的更一般的公式为s(x,)= 5*"{1k,+人5*1u,D)JF(u,D}4.9-15）其中，k≥0给出了控制距原点的偏移量[见图4.31 Cc） ],k≥0控制高频的贡献。列4.21使用高频强调滤波增强图像。图4.59(a)显示了一一幅大小为416×596的灰度级很窄的胸部X射线图像。该例子的目的是使用高频强调滤波增强该图像。由于X射线不能使用光学镜头聚焦，因此得到的图像通常都会稍微有些模糊。因为这幅特殊图像的灰度偏向灰度级的暗端，所以我们还利用这个机会给出一个如何使用空间域处理来补充频率域滤波的例子。在医学图像处理中，像振铃这样图4.59 6)显示了使用D。=40(大约为填充后图像大小的5%)的一个的人为峡陷是不能接受的。L高斯滤波器对图像进行高通滤波后的结果。如预料的那样，滤波的结果最好避免使用可熊会在处理后的图没有什么特征、俱是，它朦胧地显示了图像中的主边缘。像中引入人为峡陷的速波器。因为。图4.95(c)显示空闸和频率域高斯滤波器是傅里叶了高频强调滤波的优点，其中我们使用了式(4.9-15)，且令人=0.5，k=因此这些滤波器会产生不0.75。虽然图像依旧较暗，但其灰度级色调归因于低频分量没有丢失。会引人人为缺陷的平滑结果。如 3.3.1节讨论的那样，在一个窄范围灰度级中，由灰度级表征的图像是直方图均衡处理的理想的候选者。如图4.59 d)所示，这的确是进一步增强图像的合适方法注意骨骼结构的清晰度和其他三幅图像中均不可见的细节。最终增强后的图像有点噪声，但当图像的灰度级被扩展后，这是X光图像的典型现象。用高频强调和直方图均衡相结合得到的结果优于用任何单独方法得到的结果。图 4.59一幅胸部X射线图像；b)使用高斯高通滤波器滤波后的结果。（c)使用相向滤波器进行高频强调滤波后的结果:d)对图(C)执行直方图均演操作后310的结果(原图像由密歇根大学医学院解剖科学部的Thos R. Gest 博士提供)l1数字图像水印8.38.2 节中的方法和标准构成图像(图片或视频)在数字媒体和互联网上的实际散布。遗憾的是，这，这就把它们的所有者的权利置入风险之中洋散布的图像可被重复且无误差地复制甚至为散布加过密后，解密后的图像也不能被保护。阻止非法复制的方法之一一是把称为水印的一一条或多条信息项插人替在的易受攻击的图像，，在这种方法中，水印不能从图像本身分离出来。如同水印图像的整体部分那它们以各种方法来保护所有者的权益，包括:版权识别。当所有者的权益被侵犯时，数字水印可提供作为所有权证据的信息。用户识别或指纹。合法用户的身份可以在水印中编码，并用于识别非法复制源。客作权认定。。水印的存在可保证一幅图像不被篡改一一假定水印被设计成对图像的任何修改邹将破坏水印自动监视。水印可以通过系统来监测，系统可在任何时间和地点跟踪所使用的图像(可搜索放在Web网页上的图像)。对于征收版税和/或非法用户定位监测很有用。复制保护。水印可制定使用和复制图像的规则(如对 DVD播放器）。在本节中，我们提供一个数字图像水印的简单综述一数字图像水印处理是把数据插入到图像中的过程，以这样的方法可以构成对图像的保护。描述过的这些方法与前一节已有的压缩技术并没有相同之处，尽管它们的确都涉及信息编码。事实上，水水印处理和压缩在某些方面是相对的。压缩的目的是减少用于表示图像的数据量，但水印处理的目的是在图像上添加信息和数据(即水印)。正如我们在本节其余内容中所看到的那样，才水印本身可以是完全可见的或不可见的。可见水印是一幅不透明的或半透明的子图像，或是放在另一幅图像(即用水印处理的图像)之上的图像，因此，它对观察者是显而易见的。电视网络通常把可见水印(依照它的标识的风格)放在屏幕的右上角或右下角。如下面的例子表明的那样，典型地，可见水印处理在空间域执行。例 8.29简单的可见水印。图8.50(b)中的图像是在图8.9(a)中图像的右下四分之一处叠放了图8.50a)中水印的缩小版本。令f。代表水印的图像，我们可把它表示为未加水印图像了和水印w的如下线性组合:(8.3-1）f=(1-α)f +Ow常数α控制水印和衬底图像的相对可见性。如果α为1，则水印是不透明的，并且衬底图像完全是暗的。随着α接近0，会逐渐看到更多的衬底图像和更少的水印。通常，0<a ≤1；在图8.50(6)中，a =0.3。图850(e)是图850b)中已加水印图像和图8.9(a)中没有加水印图像之间的差。灰度128表示0差值。注意，衬底图像透过半透明水印清晰可见。这在图8.506)中和图8.50(6)中所示的差值图像中是很明显的。与前面例子的可见水印不同，，不可见水印裸眼是看不见的。它们不能被感知，但使用一个合适的解码算法是可以恢复的。不可见性是通过作为可见的元余信息插入水印来保证的，如人眼视觉系统所忽略的或不能感知(见8.1.3 节)的信息。图 8.51 (a)提供了一一个简单的例子。。因为8比特图像中的最低阶比特对我们感知图像实质」来自图8.50(a)的水印被插入或上没有效果，在其两个最低阶“隐藏”比特中。使用上面介绍的符号，我们令人-({)）品(8.3-2)638韦8章图像压缩它的两个最高阶比特移到两个最低阶比特的位置、把两个结果相加・产生 LSB水印图像。注意,嵌入的水印在图8.51 a)中是不可见的。把这一图像的最高有效6比特置0，并把其余的值放大到整个灰度范围，水印就可被提取出来，如图 8.51 (b)所示。nage思图 8.50简单的可见水印：（a)水印；（b)加过水印的图像；(c)加过水印的图像和原图像(未加水印图像)间的差一个重要特性是它抵抗偶然的和故意删除它们的企图。对嵌入了易碎的不可见水不可见水印的一印的图像的任何修改，都会破坏这种水印。在某些应用中，如图像鉴定，这是所期望的一种特性如图8.51 (c)和(d)所示,图8.51 (a)中LSB嵌入过水印的图像包含易碎的不可见水印。如果图8.51 (a）中的图像用有损JPEG 来压缩和解压缩，，水印就被破坏了。图8.51 (c)是图8.51 (a)经压缩和解压缩后的结果；均方根误差(rms)是2.1比特。如果我们试图用与图8.51(6)中相同的方法从这幅图像中提取水印，那么结果是不可理解的[见图8.51 (d。虽然有损压缩和解压缩保留了图像中的重要视觉信息，但易碎的水印却被破坏了图 8.51一个简单的不可见水印：：（a)加过水印的图像；(b)提取的水印；高质量JPEG 压缩和解压缩后加过水印的图像；；Gd)从图(心)中提取的水印鲁棒的不可见水印设计用于使图像能经受修改，而不管所谓的攻击是有意的还是无意的。。常见的无意攻击包括有损压缩、线性和非线性滤波、修剪、旋转、重取样和类似的操作。故意攻击包括从打印和重扫描到添加附加的水印和或噪声等。当然，使图像本身处在不可用状态的抗攻击是没有必要的。一个典型图像水印处理系统的基本组成部分。图8.52 (a)中的编码器把水印w,插入图8.52 显示了到图像f中，，产生加过水印的图像f；图 8.52(6)中的解码器提取和验证加过水印的输入f或没有加过水印的输入了中w的存在性。。如果w是可见的，则不需要解码器。如果它是不可见的，解码器可能需要也可能不需要f,和w;的拷贝【在图8.52(6b)中以灰色显示」去做提取或验证工作。如果使用了了和或w，贝则水印处理系统是已知的私钥系统或受限密钥系统；如果不用，，则称为公钥系统或不受限密钥系统。因为解码器必须处理加过水印的图像和没有加过水印的图像，在图8.52 中使用Wo来表示不存在水印。最后，，我们注意到，为确定图像中是否存在w;，解码器必须对提取的水印w,与，做相关操作，并将相关操作的结果与一个预定义的阈值进行比较。阈值用于设置一个可接受“匹639|配”的相似度。396水印插入图像已加水印图像遍梁部"留像K印水印提取t郑然&面水印检测绍像个典型的图像水印处理系统：（a)编码器；（b)解码器图 8.52例8.30基于 DCT的不可见的鲁棒水印・水印嵌入和提取可如前几个例子那样在空间域执行，或变换域中执行。图8.53 a)和(C)显示了图8.9(a中图像的两个基于DCT的水印方法的已加水印版本，方案如下(Cox et al.[19971)：步骤1计算将被加入水印图像的二维DCT伪随机数序列的性质近似随机数的步骤2按幅值定位它的K个最大系数,c,。性质。它并不是真正随机的、因为它取决于一个预先求出的初始值。步骤3通过生成一个K元素伪随机数序列α,0,.…,0。创建一一个水印，这些伪随机数取自均值p=0、方差o*=1的一一个高斯分布。步骤4使用下式，将步骤3得到的水印嵌入到步骤2得到的K个最大DCT系数中:(8.3-3c;=c, (+αo,)。1≤i≤K其中，指定常数α>0（它控制。,更改c,的范围)。使用式(8.3-3)计算的；代替原来的c,。步骤5计算来自步骤4的结果的反 DFT。通过采用由伪随机数形成的水印，并把它们散布到一幅图像感知上的重要频率分量上，α可取得较。同时，水印保持较高的安全性，因为(1)水印由无明显结构的伪随机数组成.小，以降低水印的可见性。2)水印被嵌入到影响整个二维空间图像的多个频率分量中(因此，它们的位置并不明显)，（(3)对它们的攻击也使图像降质(也就是说，图像的大多数重要频率分量必须被改变，以影响水印)。由于在图8.53 a)和(C)中图像的DCT 系数上嵌入了来自伪随机数的水印图像，使图 8.536)和(d)中图像的灰度产生了改变。。很明显，伪随机数必须有一个效果，即在加过水印的图像上它很小以至于着不见。为了显示这一效果，从图8.9(a)所示没有加过水印的图像中减去图8.53(a)和(c)中的图像，并将灰度范围放大到范围0,2551.。图8.536)和()是结果图像；它们显示了伪随机数的二维空间贡献。然而、因为它们已被放大，愈不能简单地把这些图像加到图8.9(a)的图像上，并得到图8.53（a和(G)中的水印图像。正如在图8.53(0)和(c)中看到的那样，它们的实际灰度干扰小到可以忽略不计。一幅事先加过水印图像的一个拷贝，该图像具有水印0,0,.,0。和为了确定一幅特定的图像是否是一步骤1计算该问题中图像的二维DCT。步骤2提取K个DCT系数(对应于水印处理过程中步骤2的,-C。的位置)，并将这些系数表示为己,，2.éx。如果向题中的图像是事先加过水印的图像(没有被修改)，则对于1≤i≤K有6,-<；。如果它是加过水印图像的一个修改过的拷贝（即它受到过某种攻击），则对于1≤1<《有图像压3976,-<（6是;的近似)。否则，向题中的图像将是一幅无水印图像，或是一幅具有完全不同水印的图2,将不会类似于原始的c。Ga)和(c)图 8.9(a)的两个加过水印的版本；b)和(の加过水印的图像和没有加过水印的图像图 8.53间的差(灰度被放大了)。这两幅图像显示了伪随机水印对原图像的灰度贡献(尽管绪放显著）步骤3使用下式计算水印0,0,… ,0x：6-61≤i≤K8.3-4）0=CC；回顾一下，水印是一个伪随机数序列。步骤4。用一个度量，如相关系数，度量,0,0o- 来自步骤》1221节中将详细探讨相关系数。与0,0,,0。（来自嵌入水印过程的步骤3)的相似度，面-0o-1≤i≤K8.3-5）2α-0)Za-の其中，员和の是两个K元素水印的均值。步骤5将度量的相似度y与一个预定义的阈值T进行比较，并进行二值检测判决:8.3-6）其他英句话说，D=1表明水印0,0,,0。存在(关于特定的阈值7；D=0则表明水印不存在。使用这一过程，图8.53(a)中的原始的加过水印的图像，针对其本身度量，得到一个相关系数0999 9即Y=0.999 9。它是一个无错误的匹配。以相似的方法，当针对图8.53 a)中的图像度量时，图8.53(6)中的图像会得到y=0.041 7，对于图8.53(a)中的加过水印的图像，它不可能被弄错，因为相关系数很小。在结束本节时，我们注意到，前例中的基于DCT的水印处理方法可完全抵抗水印攻击，部分原因是，这是一种私钥方法或受限密钥方法。受限密钥方法总是要比非受限密钥方法更灵活。使用图.3 a)中的加过水印的图像，，图8.54说明了该方法抵抗各种常见攻击的能力。如图中所看到的那样长印检测在被执行的攻击范围之外要好得多一得到的相关系数(显示在图中每幅图像的下方)在。在受到高质量但有损(导致7个灰度级的均方根误差)的JPEG 压缩和解压缩.3113到0.9945 间变化。寸，-该图像的可用性显著降低了。使用空间滤波的有效平滑和加入高斯噪声都没有使相关系数降到0.8230 以下。。然把y减小到0.3313。除了图8.53（a）中的有损JPEG 压缩和重建外，所有攻击都大大降低了原始加过水印的图像的可用性。398对图8.53 a)中加过水印的图像的攻击：（a)具有7个灰度级均方根误差的有损JPEG 压缩4 8.54和解压缩图像；(b)具有10个灰度级的均方根误差的有损JPEG 压缩和解压缩图像(注意块效应)；(c)用空间滤波方法平滑处理的结果；（d)加入高斯噪声的图像；(e)直方图均衡后的图像；（)旋转后的图像。2。每一幅图像都是图8.53 a)中加过水印图像的一个修改版本。修改之后，它们不同程度地保留了各自的水印、如每幅图像下方的相关系数指出的那样小结本章的主要目的是介绍数字图像压缩的理论基础，描述最常用的压缩方法，并介绍数字图像水印处理的相关领域。尽管我们的论述本质上是介绍性的，但参考资料提供了可以作为所讨论主题的著述的广泛主体的入门。正如表8.3 和表8.4 中所列国际标准表明的那样，。压缩方法在文献图像存储与互联网和商业视频传播(如 DVD)方面扮演着重要的角色。压绪也是少数几个在商业上广泛要专送、求对普遍接受的标准进行授权使用的图像处理领域之一。由于越来越多的图像以压缩的数字格式进行传播，因此图像水印处理正变得越来越重要。参考文献通常限于8.1 节的本章的介绍性材料是图像压缩的基础，并且第1章末尾引用的大多数一般的图像处理书籍中都能看到不同形式的内容。关于人类视觉系统的其他信息见 Netravali和Limb[1980] Huangl19661Schreiber和Knapp[1958]及第2章结尾处引用的参考资料。关于信息论的更多材料见本书的网站或Abramson[193], Blahut1987]和Berger[1971]著述。山农的经典论文“通信中的数学理论”A mathematicaiTheory of Communication [1948]，奠定了该领域的基础，也是另一一份优秀的参考资料。主观保真度准则在Frendenall和Behrend[1960]中做了讨论。贯穿全章，在许多例子中使用了各种压缩标准。大多数例子都是用Adoe htoshop可免费使用的压缩，这些在 Gonzalez 等人[2004]的著述中描述过。。一般来说，压缩标准是冗长且浦件)和或 MATLAB实现的，复杂的；我们门不可能试图全部覆盖它们。关于某个特殊标准的详细信息可参阅相关标准组织一一国际标准化组织、国际电子技术委员会和或国际电信联盟一一出版的文本。在标准方面的附加参考文献包括HunterRobinson[1980]、Ang等人[191, Fox[1991], Pennebaker 和 Mitchel1992], Bhatt等人[1997, Sikora [1997),Bhakann和Konstanit7. gan等人19 Winberge等人20. Syms01 Michel等人19971和Manjunah等人[2001的著述。图像压缩399.2节中描述的有损和无误差编码技术与8.3节中的水印处理技术，大部分是以本韵引用的原始论文为基础的。所覆盖的算法是这一领域中具有代表性的研究成果，但决不是全部工作。关于 LZW编码的素材源自Ziv。关于算术编码的素材延续了Witen Nel和 Cleay1987的发展。算术和Lempel1977,， 1978]所做的原始工作。编码的一种更为重要的实现在Pennebaker等人[1988]的著述中做了综述。对于无损预测编码的较好论述，Rabani和Jonest1991所著的指南。式(8.2-56)的自适应预测器来自 Graham[1958]的著述。。关于运动补偿的更多材料见S. Solarit197的著述，它还包含一一般的视频压缩和压缩标准的介绍，以及Mitchell等人1997]的著述。3.3 节中基于DCT的水印处理技术以 Cox等人[1997的论文为基础。关于水印处理的更多内容见Cox等人[2001的书籍和Parhi和Nshitni1999]的著述，还可参见S. Mohanty1999]的论文。年多综述性文章致力于图像压缩领域，值得注意的是Netravali和Limb[1980], A. K. Jaint1981]的著述,LE Transactions on Communictions[19811关于图像通信系统的特刊，Proeedings of IEEE[1980]关于图形编码的特刊，Poceedings ofthe IEEL19851关于视觉通信系统的特刊，1EE Trasactions on lmage Processin19941关于图像序列压缩的特刊，以及1IEEE Transactions on Image Processing19961关于矢量量化的特刊。on Mutimedia 等刊物中也包含有关于视频和静止图像压缩、运动补偿和水印处理方面的文章。例如,Robinson[2006], Chandler和Hemami[20051 Yan和Cosman [20031, Boulgouris等人[201], Martin和Bell [201], Chen和Wilson[200], Hartenstein等人[2000], Yang和Ramchandran [2000], Meyer等人200], S等人[1998], Mkherjee和Mitra2003], Xu等人[20051, Rane和Sapiro[01] Hu等人[20061, Pi等人[20061Dugelay 等人[2006]和Kamstra和Heijimans2005]，都可作为进一步阅读和参考的起点习题a）变长编码过程能否用于压缩具有2"个灰度级直方图均衡过的图像？请解释其原因。.1(b）这样一一幅图像是否包含可以用于数据压缩的空间和时间冗余？行程编码的一种变形涉及：（1)只对0行程或1行程(而不是两者)进行编码，，（2)在每行的开始处才配一个特殊的码，以减小传输误差的影响。・种可能的编码对是（x,，），其中x和，分别表示第k个行程的起始坐标和行程。编码(,の)用于表示每个新行。Ca）当对一幅大小为2×2”的二值图像进行行程编码时，推导为确保数据压缩而要求的每条扫描线最大平均行程的一般表达式。(b）计算n=8时的最大允许值。考虑灰度数据为125.18.27.18.18.17.82.5)的一条8像素的线。如果使用4比特精度来均匀量化它，计算量化后的数据的均方根误差和均方根信噪比。虽然量化导致信息损失，但对人眼来说有时它是不可见的。例如，当8 比特像素被均匀量化为更8.4少的比特/像素时，通常会出伪轮廓。使用改进的灰度缩放(IGS)量化方法，可以减少或消除它个和焦(开始时置0の是电当前的8比特灰度值和前一个生成的和的。个最低阶比特形成的。果灰度值的4个最高阶比特是11|。而加 00。替换它。。产生的和的4个最高阶比特被用做编码后的像素值。a）对灰度数据{108,.139, 135,.244, 72,.178. 56.97}构造 IGS编码，计算均方根误差和均方根信噪比(b）对解码后的IGS数据，一中幅大小为1024×1024、熵为 4.2比特/像素「使用式(8.1-7)从其直方图计算得到〕的8比特图像进行霍夫曼编码。(a）所期望的最大压缩率是多少？b）它能得到吗?(e）如果要求较高级别的无损压缩，还应该做什么？以e为底的信息单位通常称为一个奈特(nat)，以10为底的信息单位则称为一个哈特利(Hartle）女8.6计算将这些单位与以2为底的信息单位(比特)联系起来的转换因子。证明，对于一二个有q个符号的零记忆信源，，熵的最大值为log q。兰当且仅当所有信源符号等概率出女8.7现时，熵才能达到最大值。「提示：考虑量1og q-H2)并注意不等式nx≤x-1。8.8(a）对于一个4符号信源，有多少唯一的霍夫曼编码？(b）构建它们。考虑如下大小为4×8的8比特图像：8.99595169243243959521169243243H95243243951691699595169169243243219595169169243243Ka）计算该图像的熵。b）用霍夫曼编码压缩该图像c）计算霍夫曼编码能达到的压缩率和效率 (d)考虑对一对像素而不是单个像素进行霍夫曼编码。。也就是说,，考虑由产生原图像的零记忆信源的第二次扩展产生的图像。当作为像素对着待时，图像的熵是什么？(e)考虑对相邻像素间的差值进行编码。马。新的差值图像的熵是什么？关于压缩图像，它告诉我们做什么？解释(a)，(d)和(e)中熵的差别用图 8.8中的霍夫曼码，对编码串01010001101011进行解码。3.10.11对于0≤n1≤20，计算 Golomb码GJIn）.12针对 Golomb码G,An)，写出解码的通用过程.13为什么用式(8.2-2)的几何概率密度函数不能计算n≥0的非负整数的霍夫曼码？3.14针对指数 Golomb码GC.,(n)，写出解码的通用过程+8.158.16在式(8.2-3)中，对于0<p<1，画出作为p的函数的最佳Golomb编码参数m的曲线8.17给定一算术解码过程是与编码过程相反的过程。用给定的编码模型，女 8.18，对消息0.32256进行解码.19使用8.2.4 节中的LZW 编码算法，对7比特ASCI码字符串“AAAAAAAAAA”进行编码。*8.20为例8.7的LZW 编码输出的解码操作设计一种算法。。由于编码期间使用的字典此时不能使用，所以在对输出进行解码时必须重新生成码书。.21 对BMP编码序列{127,0,5, 25, 29,40, 103,52, 75,82}进行解码。8.22Ga）构造完整的4比特格雷码。545(b）创建一个通用的过程，将格雷码的数字转换成与它等价的二进制码，并用它对0111064z]进行解码使用CCrT Group4压缩算法对如下两行的第二行进行编码：01100110011110011110101000假设初始参考元素α。位于第二行的第一一个元素上(a）列出 JPEG DC系数第3类差的所有成员3.24(b）使用表A.4计算它们的默认霍夫曼编码使用MAD最佳准则、、单像素精度和最大允许的16个像素的位移，找到一个8×8宏块的最佳运动3.25向量需要多少计算？对于14像素精度，它变成多少次计算？使用B帧的优点是什么？8.26对于运动补偿，位画出针对图8.39中编码器的伴随运动补偿视频解码器的方框图。3.273.28一个三阶预测器对自相关函数是式(8.2-49)在p。=0时的形式的一幅图像进行DPCM编码。(a）构造自相关矩阵R和向量r。b）找出最佳预测系数(c）计算使用最佳系数得到的预测误差的方差。推导出L=8时的劳埃德・马克斯判决-重建级别和均匀概率密度函数3.294≤s≤Ap(s)其他8.30来自一所著名研究型医院的一位放射学家最近参加了一次医学会议，会上展示了一种可以通过标准T1(1.544 Mbps)电话线路传输4096 × 4096大小的12比特数字化X光图像的系统。。该系统使用种渐进技术来传输压缩形式的图像，这种技术可在观察站首先重建出X射线图像的相当好的近似图像，然后逐步细化产生一幅无误差的显示。产生第一幅近似图像的数据传输要花5-6秒的时司。在接下来的1分钟时间内，每隔5-6秒(平均)会进行一次细化，在重建的X射线图像中，第次和最后一次细化有最大和最小的影响。这位物理学家对这套系统的印象很好，因为她可以使用第一幅X射线图像的近似开始进行诊断，，而在生成无误差X射线重建图像时就可以完成诊断。在回她的办公室的途中，，她拟定了一份报送给医院领导的采购意向。遗憾的是，医院正值预算紧张时期，，因为最近雇用了一一位年轻有为的电气工程专业毕业生。。为了满足放射学家的要求，院方向年轻的工程师布置了设计这样一一个系统的任务(院方认为设计和构造一个类似的自用系统成本会更低。方要求工程师在下午的工作会议上拿出一个初始框图。由于时间紧且手头只有一本《数字图像处理》教材(当然需要这本书)，工程师只能在概念上设计一一个系统，以满足传输和相关的压缩要求。青构建该系统的概念框图,并详细说明您将建议的压缩技术。证明由式(8.2-62)定义的基于提升的小波变换与使用表8.15中系数实现的传统FWT滤波器组是等价的。依据α,β,",员和K定义滤波器系数。3.32计算一幅JPEG-2000编码图像的子带的量化步长。该图像采用导出式量化，对2L子带的尾数和指数分配8比特数据。您如何在频率域将水印加到一幅图像上？..3以离散傅里叶变换为基础，设计一个不可见水印处理系统。+ 8.34以离散小波变换为基础，设计一个不可见水印处理系统。.35648第9章形体与特征，，面容与肢体，我与兄弟如此相像，以至于人们经常把我当做他，总是把我们的身份搞混享利・桑布鲁克・利，《科克伊尼之颂：双胞胎》引言形态学(morphlogx一词通常表示生物学的一个分支，该分支主要研究动植物的形态和结构。一词语表示数学形态学的内容，将数学形态学作为工具从图像中提取表达和描绘区域里，我们使用同形状的有用图像分量，如边界、骨架和凸壳等。我们对预处理或后处理的形态学技术也感兴趣，比如形态学过滤、、细化和修剪等。在下面几节中，我们将建立并说明数学形态学中的几个重要概念。这里介绍的许多概念可在，维欧氏空间E"中用公式表达，然而，我们的兴趣一开始是在二值图像上，这种图像的各个分量是Z我们的讨论将扩展到灰度图像。的元素(见2.4.2 节)。在9.6节，本章的材料开始从纯粹的输人和输出都是图像的图像处理，转变为输入是图像而输出是从这些，在这个意义上 1.1 节做了定义。像形态学及与其相关概念这样的工具数学基图像中提取属性的处理，“内涵"。本书的余下章节中将探讨和应用其他方法。础的基石，它用来于从图像中提取预备知识9.1数学形态学的语言是集合论。同样，形态学为大量的图像处理问在继续阅读之前、请读者回顾一题提供一种一致且有力的方法。数学形态学中的集合表示图像中的对2.4.2 节和2.6.4 节的内容。。例如，在二值图像中，所有白色像素的集合是该图像的一个完整的形态学描述。在二值图像中，问题中的集合是二维整数空闸Z的元素(见24.2节)，在该空间中一个多元组(二维向量)，这些多元组的坐标是图像中一个白色(或黑色，取决于集合的每个元素都是一章讨论过的灰度数字图像可以表示为其分量在空间Z中的集合在在这种情况下，集合中每个元素的两个分量提供一个像素的坐标，第三个分量则对应于其离散灰度皇。更高维度空间中的集合可以包含其他的图像属性，，譬如颜色和随时间变化的分量。节中基本的集合定义外，集合的反射和平移的概念在形余 2.6.4 集合反射操作类似于空间卷积中执态学中用得也很广泛。。一个集合B的反射表示为B，定义如下：行的番擀专(旋转)操作(见3.4.2 节5)6sol形态学图像处理403(9.1-1）B={wlw=-b, be B}如果B是描述图像中物体的像素的集合(二维点)，则B是B中(α,y)坐标被(-x,-y)替代的点的集合。一个简单的集合及其反射。图 9.1 (a)和(b)显示了一图9.1a!一个集合；(の)该集合的反射；(c)距离为z的平移集合B按照点=6元.3）表示为(B)。的平移定义如下9.1-2）(B),.={clc=b+z, be B}如果B是描述图像中物体的像素集合，则则(B),是B中α,)坐标被(x+z,y9+z)替代的点的集合。图 9.1（()使用来自图9.1 (a)的集合B说明了这一概念。在形态学中集合的反射和平移广泛用来表达基于结构元(SE)的操作：研究一幅图像中感兴趣特性所用的小集合或子图像。。图 9.2的第一一行显示了结构元的几个例子，其中每一个涂阴影的方块表示SE的一个成员。如果给定结构元中的一一个位置是否是该SE集合的成员没有关系时，该位置用“x"，表示一个“不关心”条件，如稍后在9.5.4节中定义的那样。除了元素是SE的成员的定长标记，还必须指定结构元的原点。图 9.2中各种SE的原点义之外，迄一个黑点指出(尽管将 SE 的中心放在其重心处是很普遍的，但通常原点的选择是依赖于问题的)。当SE 对称且未显示原点时，则假定原点位于对称中心处。图面当对图像操作时，，我们要求结构元是矩形阵列。这是通过添加最小可能数量的背景元素(图9.2中所示的非阴影部分形成一个矩形阵列来实现的。。图9.2第二行中的第一一个和最后-个 SE说明了该过程。。该行中的其他SE已经是矩形形式。为众绍在形态学中如何使用结构元，，我们考虑图9.3图9.3(a)和(b)显示了一个简单的集合和一。如前一一个结构元。图 9.2第一行：结构元的例子；第二段提到的那样，，计算机实现要求用添加背景元素的方法把A行：转换为矩形阵列的结构也转换为一个矩形阵列。当结构元的原点位于原始集合的边元。点表示结构元的中心界上时，背景边界要大到足以适应整个结构元(这类似于如O 当对图像操作时、如图.1中的集合、我们使用阴影来表示正考虑集合的成员的点(像素)。在处理二值图像时，感兴趣的集合是对应于物体的像家。我们1使用白色像素来显示这些集合，而其他像素则显示为黑色。术语前景和背景通带分别用于表示图像中为物体和非物体定义的像素集合。404节讨论的空间相关和卷积的填充操作)。在这种情况下，结构元.4.2在后面的说明中，我们会添加足够的大小为3×3，原点位于中心，所以包围整个集合的一个元素的边界的背景点来形成矩形阵列、但在含义，如图9.3（c)所示。就像在图9.2中那样，必须使用最小可能是足够的，明确的情形下・为简化图形，我们假一个矩形阵列「见图9.3 d） ]。数量的背景元素填充结构元，使它成为一定已进行了填充操作。图 9.3一个集合(每个阴影方块都是集合的一个元素)；(b)结构元；（c)使用背景元素填充集合形成的一a)个矩形阵列，并且提供了一个背景边界；《d)矩形阵列形式的结构元；(e)由结构元处理过的集合假定我们定义一个用结构元B在集合A上的操作如下：通过让B在A上运行，，以便B的原点访问A的每一个元素，来创建一个新集合。在B的每个原点位置，，如果B完全被A包含，则将该一个成员（阴影所示)；否则，将该位置标记为非新集合的成员(非阴影所示）位置标记为新集合的终9.3(e)显示了这一操作的结果。我们着到，当B的原点位于A的边界元素上时，B的一部分将不再包含在A中，从而排除了B处在中心位置的点作为新集合的成员的可能。最终结果是集合的边界被如图9.3(e)所示。当我们使用“结构元包含在集合中”这样的术语时，我们明确地指出A腐蚀掉了，女和B的元素完全重叠。换句话说，虽然我们用包含阴影和非阴影的元素阵列来说明A和B，但在确定B是否包含于A中时，我们只考虑两个集合中的阴影元素。这些概念是下一节内容的基础，因此在继续学习之前全面理解图 9.3中的概念是很重要的。9.2腐蚀和膨胀我们通过研究腐蚀和膨胀这两个操作来开始形态学的讨论。这些操作是形态学处理的基础。事实上，本章中讨论的许多形态学算法都是以这两种原始操作为基础的。腐蚀9.2.1作为z*中的集合A和B，表示为AeB的B对A的腐蚀义为（9.2-1）A9B={z1(B), A}表面上、该式指出固对A的腐蚀是一个用z平移的B包含在A中的所有的点乙的集合。在下面的讨。式(92-12是上节杰尾过论的图 23(6)中的侧子的教学公式。因为及论中，假定集合B是一一个结构元。必须包含在A中这一陈述等价于日不与背景共享任何公共元素，故我们可以将腐蚀表达为如下的等价形式：(9.2-2）A9B={z1（(B).nA* =0}其中，如2.6.4 节所定义的那样，A*是A的补集，O是空集。形态学图像处理图9.4(c)中的实线一个例子。A和B的元素显示为阴影，背景显示为白色。图 9.4 显示了腐蚀的一则会导致结构元不再完全包含于A中。这样，一步移动的界限，边界是B的原点进一，若超出该界限，。我们在图9.4(c)中使用阴影显示了该腐亥边界内的点的轨迹(B的原点位置)就构成了B对A的腐蚀。。记住，腐蚀是简单地满足式(9.2-1)或式(9.2-2)的z值的一一个集合。图 9.4(c)和(e)中虚线蚀的结果。所示的集合A的边界仅供参考,它不是腐蚀操作的一部分。图9.4()显示了一个拉长的结构元,图9.4(e）显示了该结构元对集合A的腐蚀。注意，，原来的集合已被腐蚀为一条直线。1/4图9.4a)集合A；(b)方形结构元B；（)B对A的腐蚀，如阴影部分所示；d)拉长的结构元；(e)用拉长后的结构元B对A的腐蚀。C)和(e)中的虚线边界是集合A的边界，仅供参考而显示式(9.2-1)和式(9.2-2)不是腐蚀的唯一定义形式(见习题9.9和习题 9.10 中另外两种等价的定义形然而，，这些式子较之其他公式具有独特的优点，当把结构元B看成是一个空间模板时(见3.4.1节)，它们更直观。例9.1使用腐蚀去除图像的某些部分。假设我们希望去掉图 9.5(a)中连接中心区域到边界焊接点的线。使用一个大小为11x11且元素都是工1的方形结构元腐蚀该图像、如图9.5.6)所示，大多数为1的线条都被去除了。位于中心的两条垂直线被细七了，但没有被完全去除，原因是它们的宽度大于11个像素。把SE的大小改为15x15，并再次腐蚀原图像，如细图25.(c)）万示，所有的连线都去除了L一种替代的力法是，也可以使用1x11的SE对图9.5(6）的图像再进行腐蚀。增大结构元的尺寸甚至会消除更大的部件。例如，使用大小为45×45 的结构元，去除边界的焊接点，如图9.5(4の)所示。a bc dH丰图9.5使用腐蚀去除图像中的部件：a)一幅大小为486×486的连线模板二值图像；b)一653山分别使用大小为11x11,15×15和45×45的结构元腐蚀的图像。SE的元素都是工165406我们可以将腐蚀看成是形态我们从这个例子看到，腐蚀缩小或细化了二值图像中的物体。。事实上，学滤波操作，这种操作将小于结构元的图像细节从图像中滤除(去除)了。在图9.5中，腐蚀执行了一个“线滤波”的功能。我们在9.3节和9.6.3 节将会返回到形态学滤波这一概念。9.2.2膨胀A和B是Z中的集合，表示为A9B的B对A的膨胀定义为(9.2-3）ADB={z1(8),.n4≠0}这个公式是以B关于它的原点的映像，并且以z对映像进行平移为基础的(见图 9.1)。B对A的膨胀是所有位移：的集合，这样，启和A至少有一个元素是重叠的。根根据这种解释，式(9.2-3)可以等价地写为(9.2-4A9B={|[(B).nAls A}一个结构元，A是被膨胀的集合(图像物体)与以前一样，我们假定B是式(9.2-3)和式(9.2-4)并不是当前所用的膨胀的唯一定义(见习题9.11和习题9.12中两种不同但等价的定义)。然而、当把结构元品视为一个卷积模板时，前述定义与其他定义形式相比有显著的优点，这种定义形式更直观。B关于其原点翻转(旋转)，然后逐步移动以滑过整个集合(图像)、这一。然而，，要记住，膨胀以集合操作为基础，因此，是一基本过程类似于3.4.2节中介绍的空间卷积。种非线性操作，而卷积是一种线性操作。与腐蚀不同，腐蚀是一种收缩或细化操作，，膨胀则会“增长”或“粗化”二值图像中的物体。这种特殊的方式和粗化的宽度由所用的结构元来控制。图 9.6(a)显示了与图 9.4中所用集合相同的集个结构元(在这种情况下，8=B，因为SE关于其原点对称)。作为参考,图9.60合,图9.6(6)显示了中的虚线显示了原始集合，实线显示了一个界限，B的原点进一步移动z，若超出了这一界限，会导致B和A的交集为空。。因此，处在该边界上或该边界内的所有点就构成了B对A的膨胀。图 9.6(d)显一个设计用来实现垂直方向膨胀比水平方向膨胀更多的结构元，图9.6(e)则显示了使用这个结构元进行膨胀的结果 b c d e4B图9.6a)集合A；Gb)方形结构元(黑点表示原点)；(c)B对A的膨胀，显示为阴影；(d)拉长的结构元；(e)使用这个结构元对A膨胀。图(c)和图(e)中的点线的边是集合A的边界，仅作为参考而显示列9.2膨服的说明。膨胀的最简应用之一是桥接裂缝。图9.7a)显示了与我们研究过的图4.49相同的带有断裂的字符的图像，在图4.49中是用低通滤波进行连接的。已知断裂的最大长度为两个像素。图9.76)显示了能够修复这些断裂的结构元(注意，替代阴影，我们用1表示SE的元素，而用0表示背景；这是因为现在 SE被当做幅子图像来处理，而不是一幅图形)。图9.7(c)显示了使用这个结构元对原图像进行膨胀后的结果。缝已被桥接。形态学方法较之我们在图 4.49中用于桥接断裂的低通滤波方法的一个直接的优点，就是形一幅二值图像中直接得到结果。。另一方面，低通滤波方法则从一幅二值图像开始，生成一态学方法可在一幅灰度图像，它需要用一个阈值函数将灰度图像转换为二值图像。919y, the0|1|0recoos 19001Ee以（aD)具有断裂字符的低分辨率样品文本(见放大的视图)；图 9.7D结构元；C)图6)对a)的膨胀。断裂线段被连起来了对偶性9.2.3膨胀和腐蚀彼此关于集合求补运算和反射运算是对偶的，即(AeB)* = A°98(9.2-5）(9.2-6）KA9B)* = A'9B式(9.2-5)指出，B对A的腐蚀是B对A°的膨胀的补，反之亦然。当结构元关于其原点对称时(通常如此)，因为B= B，，故对偶性特别有用。这样，我们可以用相同的结构元简单地使用B膨胀图像的背景(即膨胀A")，并对该结果求补就可得到B对该幅图像的腐蚀。类似的说明适用于式(9.2-6)。为了说明建立形态学表达式有效性的一种典型方法，我们正式证明式(9.2-5)的有效性。由腐蚀的定义，我们有(AeB* ={21(B). A}如果集合(B),包含在集合A中，则(B),nA° =0，在这种情况下，上式变为AeB)* ={z1(B).nA4* =0}但是，满足(B),nA* =0的z的集合的补集是满足（B),nA° ≠O的z的集合，因此，AeB)* ={z1(B),nA*≠0}= A* 9B其中，最后一步来自式(9.2-3)。这就结束了该证明。采用类似的推理可以证明式(9.2-6)(见习题9.13)。9.3开操作与闭操作如您所见到的那样，膨胀会扩大一幅图像的组成部分，而腐蚀则会缩小一幅图像中的组成部分。：开操作与闭操作。开操作一般会平滑物体的轮廓、全本节中，我们讨论另外两个重要的形态学操作：析开较窄的狭颈并消除细的突出物。闭操作同样也会平滑轮廓的一一部分，但与开操作相反，，它通常会弥合较窄的间断和细长的沟壑，消除小的孔洞，填补轮廓线中的断裂结构元B对集合A的开操作，，表示为A。B，其定义如下:A。B=(AeB)田B(9.3-1）因此，B对A的开操作就是B对A的腐蚀，紧接着用B对结果进行膨胀类似地，用结构元B对集合A的闭操作，表示为A-B，定义如下:9.3-2）A・8 =(A田BOB上式说明，及对集合A的闭操作就是简单地用B对A膨胀，紧接着用B对结果进行腐蚀开操作有一个简单的几何解释(见图 9.8)。假设我们把结构元日视为一个(扁平的）“传球”。然后，A。因的边界由及中的点建立：当B在A的边界内侧滚动时，B所能到达的A的边界的最远点。开操作的这种几何拟合特性导致了一个集合论公式，该公式表明因对A的开操作是通过拟合到A的B的所有平移的并集得到的。也就是说，开操作可以表示为一个拟合处理:A。B=U{(B),1(B), G A}(9.3-3）其中U{}表示大括号中所有集合的并集。A。B= UI(B)J(0B).C A}a b c dB在4中的平移图9.8(a)结构元B沿集合A的内侧边界滚动(黑点表示B的原点)；b)结构元；（c)粗线是开操作的外部边界；d)完全的开操作(阴影部分)。为清楚起见，在图a)中我们未对A加阴影除了我们现在是在边界的外侧滚动B(见图9.9)之外，闭操作有类似的几何解释。。如下面所讨论的那样，开操作和闭操作彼此对偶，所以闭操作在边界外侧滚动球体是意料之中的事情。。从儿何上讲,当且仅当对包含w的(B),进行的任何平移都有(B),nA≠O时，点w才是A-B的一个元素。图9.9说明了闭操作这一基本的几何性质。图9.9a)结构元B沿集合A的外侧边界滚动；（Gb)粗线是闭操作的外部边界:(e)完全的闭操作(阴影部分)。为清楚起见，在图(a)中我们未对A加阴影例9.3形态学开操作和闭操作的简单说明。558步说明了开操作和闭操作。图 9.10 进手。图,.106a)显示了一个集合A，图.106)）显示了腐蚀处理期659间一个圆盘形结构元的各个位置。当腐蚀完成后，得到图9。106)所示的分离的图形。注意，两个主要部第9章分之间的桥接的消失。桥接部分的宽度与结构元的直径相比要细；也就是说，集合的这部分不能完全包，因此违反了式(9.2-1)的条件。该物体最右边的两个部分也是如此。。圆盘无法拟合的突出部分含结构元，已被消除。。图 9.10)显示了对腐蚀后的集合进行膨胀的处理，图9.10 (e)显示了并操作的最终结果。注意，方向向外的角变圆了，而方向向内的角则未受影响。一结构元对A进行闭操作的结果。我们注意到方向向内的角变类似地，图9.10(f)到()显示了使用同一圆了，而方向向外的角则保持不变。在A的边界上，最左边的突入部分的尺寸明显地减小了，因为在这个位置上圆盘无法拟合。还要注意使用圆盘形结构元对集合A进行开操作和闭操作所得到的物体的各个部分都平滑了。A・8=(49B)G月图 9.10形态学开操作和闭操作。结构元是在图(b)中的各个位置显示的小圆。为清楚起见，SE未加阴影。黑点是结构元的中心如同膨胀和腐蚀的情形那样，开操作和闭操作彼此关于集合求补和反射也是对偶的，A-B)* =(4°。B)(9.3-4)和=(4*.B)AoB)"(9.3-5）我们将该结果的证明作为练习留给读者(见习题9.14)。开操作满足下列性质:a) A。B是A的一个子集(子图像)(b）如果C是D的一一个子集，则C。B是D。B的一个子集。bcol(e） (A。B)。B=A。B。类似地，闭操作满足下列性质:一个子集(子图像）(a)A是A・B的一Gb）如果C是D的一一个子集，则C・B是D-B的一个子集c)（A-B)-B8= A・B注意，由两种情况下的条件(C)可知，算子应用一次后，一个集合的多次开操作或闭操作没有影响。针对形态学滤波使用开操作和闭操作。例9.4形态学操作可用于构造与第3章中讨论的空间滤波概念相类似的滤波器。图9.11 a)中的二值图像显下了被噪声污染的指纹图像的一一部分。这里，噪声本身表现为在黑色背景上的随机亮元素和指纹较亮部分上的暗元素。我们的目的是消除噪声及其对印刷的影响，同时使图像的失真尽可能小。由开操作后紧跟着闭操作组成的形态学滤波器可用来实现这一目的。A日B)由B。B)+81A 8)日eB-4 0)-月图9.11(a)噪声图像；b)结构元；（c)腐蚀后的图像；(d)A的开操作；(e)开操作的膨胀；（f)开操作的闭操作（原图由美国国家标准和技术研究所提供）图 9.11 6)显示了所用的结构元。。图 9.11的余下部分显示了滤波操作一步步的顺序。图 9.11 （6)显示了使用结构元对A进行腐蚀的结果。。背景噪声在开操作的腐蚀阶段被完全消除，因为这种情况下的所有噪声分量都比结构元小。包含在指纹中的噪南元素(黑点)的尺寸实际上却增大工。原因是当物体被腐蚀时，这些元素在尺寸增大的内部边界。。这种增大可通过对图9.11 （C)执行膨胀来抵消。图9.11(d)显示了该结果，指纹中包含的噪声分量的尺寸被减小了，或完全被消除了。刚才描述的两个操作构成了B对A的开操作。我们注意到，，在图9,.11（d中，开操作的实际效果实质560|上是从背景和指纹本身中消除所有的噪声。然而，在指纹纹路间却产生了新的断裂。为防止这种不希望的影响，我们在开操作上执行膨胀，如图 9.11（e)所示。大部分断裂被恢复了，但纹路却变粗了，这是可661第9章由腐蚀来弥补的一种情形。图9.11(0所示的结果构成了图9.11 的开操作的闭操作。最后的结果是噪声斑点清除得相当干净，但这种方法有缺点，即有些指纹纹路没有被完全修复，并还有间断。对这种情况也并非毫无指望，只是因为在保持连续性方面没插入任何的条件而已(我们将在例 9.8中再次讨论这一向题，并在11.1.7 节中论证处理这一问题的方法)。击中或击不中变换9.4形态学击中或击不中变换是形状检测的一个基本工具。我们将借助于图 9.12来说明这一概念图 9.12显示了一个由三种形状(子集)组成的集合A，三种形状分别由C,D和E表示。图9.2(a)到(Ge）中的阴影部分表示原始集合，，而图 9.12 d)和(e)中的阴影部分显示形态学操作的结果。目的是找到三种形状之一的位置，，譬如说D的位置。令每种形状的原点位于其重心处。设D被一个小窗口W包围。关于W的D的局部背景定义为集合差(W-D)，如图 9.12(6b)所示。。图9.12(Cc)显示了A的补集，后面将会用到它。。图9.12 (d)显示了用D对A的腐蚀(虚线仅供参考)。回顾可知，D对A的腐蚀是D的原点位置的集合，这样，D完全包含在A中。换一种方法解释，AeD在几何上可被看成是D的原点的所有位置的集合，在每个这样的位置，D找到A中的一一个匹配(击中)。记住，在图 9.12中，A仅由三个不相交的集合C,D和E组成。图 9.12Ga)集合A；；6)窗口W和关于W的D的局部背景(W-D)；(c)A的补集；dD对A的腐蚀；（e)(W-D)对A°的腐蚀；（D （d)和(e)的交集，如所希望的那样，该交集显示了D的原点的位置。上。黑点是C,D和E的原点663数学图像处理(第三版）图9.12(e)显示了局部背景集合(W-D)对A的补集的腐蚀。图9.12(e)中的外部阴影区域是腐蚀的部分。我们从图9.12d)和(e)注意到，D精确地拟合A内部的位置集合是由D对A的腐蚀和(W-D)对A°的腐蚀的交集，如图 9.12(6)所示。这个交集正好是我们要寻找的位置。换句话说，如果日表示由D及其背景组成的集合，则B在A中的匹配（或匹配集合)，表示为A@B，是9.4-1）A98=(AoD)n[A"e (W -D)]我们可以通过令B=(B,B,)对这种表示法稍微做些推广，其中B是由与一一个目标相联系的B的元素构成的集合，B,是由与相应背景相联系的B的元素构成的集合。。根据前面的讨论，=D,B, =(W -D)。用这种表示方法，式(9.4-1)变为498 =(AOB)n(A"eB,）9.4-2）因此，集合A@B包含了所有的原点，同时，，在这些原点处，B，在A中找到了一个匹配(击中)，B2在A°中也找到了一个匹配。使用式(2.6-19)中给出的集合差的定义，及式(9.2-5)中给出的腐蚀和膨胀间的对偶关系，我们可将式(9.42)写为9.4-3）A9B =(A9B,)n(ADB）然而，式(9.4-2)更为直观。。我们将上述三个公式称为形态学击中或击不中变换。使用与物体有关的结构元从和与背景有关的结构元及的原因基于一个假设的定义一一仅当两个或多个物体形成相脱离的(断开的)集合时，这些物体才是可分的。通过要求每个物体至少被一一个像素宽的背景所围绕，才可保证这一假设的成立。在某些应用中，我我们可能对检测某个集合内由1和0组成的某些模式感兴趣，在这种情况下不需要背景。在这种场合，击中或击不中就简化为简单的腐蚀。正如前面指出的那样，腐蚀依然是匹配的集合，但检测单个物体时不需要额外的背景匹配。这种简化的模式检测方案将用于下节讨论的某些算法中。9.5些基本的形态学算法以前面的讨论为基础，我们现在可以考虑形态学的一一些实际用途。在处理二值图像时，，形态学的主要应用之一是提取用于表示和描述形状的图像成分。特别是我们要考虑提取边界、连通分量、凸壳和区域的骨架的形态学算法。我们1还要探讨几种经常与这些算法相配合使用的预处理或后处理方法(对于区域填充、细化、粗化和修勇)。在介绍每一种形态学处理时，为了弄清楚每种处理的机理，我们将在这小节中广泛地使用“迷你图像”。这些图像以图形的方式显示，用1表示阴影区域，而用0表示白色边界提取9.5.1表示为β(A）的集合A的边界可以通过先用B对A腐蚀，而后执行A和腐蚀的结果之间的集合之差得到，，即β(A)=A-(A9B)(9.5-1其中B是个适当的结构元。图9.13说明了边界提取的机理。这幅图像显示了-个简单的二值物体、一个结构元B和使用式(9.5-1)得到的结果。尽管图9.134b)中的结构元是最常用的，但它从现在开始，我们将不再显式地绝对不是唯一的。例如。使用由1组成的大小为5x5的结构元，将得给出边界填充到2-3个像素宽的边界弟9章413D C d()B对A的腐蚀；d)由A和其腐蚀间的集合差给出的边界图 9.13(a)集合A；(の)结构元B；列9.5用形态学处理提取边界。图 9.14进一步说明了式(9.5-1)和由1组成的3×3结构元的用途。如本章中的所有二值图像那样，进制值1显示为白色，二进制值。显示为黑色，因此该结构元的元素1也被当做白色来处理。由于所用图 9.14(6)中的边界宽度为1个像素。结构元的尺寸，E刻 9.14-幅简单的二值图像，其中1表示白色；(b)使用式(9.5-1)和图9.13(6)中的结构元得到的结果9.5.2孔洞填充个孔洞可被定义为由前景像素相连接的边界所包围的一一个背景区域。在这一节中，我们将针对壤允图像中的孔洞。开发一种禁于集合膨胀、求补和交集的算法。含4表示一一个集合，其元素是8。当给定每个孔洞中的一个点后，目的就是用连通的边界,每个边界包围一个背景区域(即一个孔洞)。1填充所有的孔洞。除了在每一个孔洞中对应于X。中的位置给定的点之外，这一点我们已经置为1了，我们从形成个由0组成的阵列X开始(该阵列与包含A的阵列的大小相同)。。然后，如下过程将用1填充所有的孔洞：X。=(XA_,田B)oA"k=1, 2,3, (9.5-2）其中B是图 9.15 c)中的对称结构元。如果X。。.X-，则算法在选代的第人步结束。然后，集合X。包含所有被填充的孔洞。X,和A的并集包含所有填充的孔洞及这些孔洞的边界。、那么式(9.5-2)中的膨胀将填充整个区域。然而，每一如果左边不加限制，一步中与A"的交集操作将把结果限制到感兴趣区域内。。这是我们如何制约形态学处理以满足希望特性的第一一个例，它被适当地称为条件膨胀。图.15的余下部分进一子。在当前应用中，一步说明了式(9.5-2）的机理。尽管该例子仅有一个孔洞，但在给定每个孔洞区域内的一个点的假设下，很清楚，这一概念可用于任何有限数量的孔洞。例9.6形态学孔洞填充・图9.16a)显示了一幅由内部带有黑色点的白色圆圈组成的图像。这样的图像可以通过将包含磨光的球体(如滚珠)的场景用阈值处理分为两个层次而得到。球体内部的黑点可能是反射的结果。我们的目的是通过孔洞填充来消除这些反射。图9.16a)显示了在一个球体中选择的一个点，图9.16)）显示了填充一数字图像处理(第三版）。最后，图9.16c)显示了填充所有球体后的结果。因为黑点是背景点还是球体内部的点必须邪分的结果。是已知的，所以完全自动化这一过程要求在算法中建立附加的“智能”。在9.5.9 节中，我们将给出一个基于形态学重建的全自动方法(见习题9.23)。孔洞填充：(a)集合A(显示为阴影)；(b)A的补集；(e)结构元 B；《d)边界图 9.15内的初始点；(e)~(h)式(9.5-2)的各个步骤；(i)最终结果[(a)和(h)的并集」终 9.16值图像(区域内部的白点是孔洞填充算法的起始点)；(b)填充该区域后的结果；（C)填充所有孔洞后的结果连通分量的提取9.5.3连通性和连通分量的概念已在2.5.2节中介绍过。从二值图像中提取连通分量是许多自动图像分令A是包含一个或多个连通分量的集合，并形成一个阵列X。(该阵列的大小与包所应用中的核心。含A的阵列的大小相同)，除了在对应于A中每个连通分量中的一个点的已知的每一个位置处我们已置为1(前景值)外，该阵列的所有其他元素均为0(背景值)。)。如下迭代过程可完成这一目的：X。=(XA-19 B)nAk =1, 2,3,…(9.5-3）其中，B是一个适当的结构元(如图9.17所示)。当X,= Xx-时，迭代过程结束，X。包含输入图像中的所有的连通分量。。注意式(9.5-32与式(9.5-2)的相似性，唯一的差别是用A代替了A"。这并不奇怪，因为此处我们正在寻找前景点，而在 9.5.2 节的目的是寻找背景点。。注意，所用结图9.17说明了式(9.5-3)的机理，k=6时即可收敛。关于事先不要求知道每个连通分量构元的形状在像素间是基于8连通的。如果我们用图 9.15 中的SE，中的一个点的算法，请参间习题24它是基于4连通的，朝向图像底部的连通分量的最左侧元素将不会被检测到，因为对图的其余部分它是8连通的。如孔洞填充算法那样，假定在每一个连通分量内都已知一个点，式(9.5-3)对于任何在A中的有限数量的连通分量都是可用的第9章提取连通分量：（a)结构元；b)包含有一个连通分量的集合的阵列；（c)在连图 9.17通分量的区域中包含一个1的初始阵列；dD～(g)式(9.5-3)的各个迭代步骤使用连通分量检测包装食品中的外来物。例9.7连通分量经常用于自动检测。图9.18 a)显示了一一幅含有碎骨的鸡胸X射线图像。经过处理的食品在包装和/或运送之前能检测出这样的物体是很有意义的。在这种特殊情况下，骨骼的密度使得它们的正常灰度值与背景不同。这就使得使用单一一阈值(阈值处理在3.1节介绍过了，10.3 节中将进行更详细的讨论）将骨骼从背景中题取出来成为一件简单的事情。结果是剧9180)）所示的二焦图像。这幅图中的最显著特征是保留下来的点聚集为物体(骨头)，而不是彼此孤立的毫无关系的点。我们”尺寸的物体才能对经阈值处理的图像进行腐蚀后而保留下来。在这个例子可以确定，只有具有““有效”中，我们将“有效””尺寸的物体定义为：使用元素为1、大小为5x5的结构元腐蚀图像后保留下来的任何物体。图9.18 (c)中显示了腐蚀的结果。。下一步是分析保留下来的物体的尺寸。我们通过提取图像中的连通分量来标记(识别这些物体。图 9.18(0)中的表格列出了提取的结果。总共有15.个连通分量，其中4个尺寸较大。这足以确定包含在原图像中的重要的不希望的物体。如果需要，使用第11章讨论的技术进一步描述其特性(比如物体的形状)是可能的。连通分量连通分量的像素数菜图 9.18(a)含有碎骨的鸡肉X射线图像；b)经阈值处理后的图像；；（c)使用元素为1568大小为5×5的结构元腐蚀后的图像；；（aD)图(c)的连通分量中的像素数(图像由NrTB Eletonsce Grae OmbH Dieholz.Cemanywwtraycom提供）416凸壳9.5.4如加果在集合A内连接任意两个点的直线段都在A的内部，则称集合A是凸形的。任意集合s的凸壳。集合差H-S称为S的凸缺。正如11.1.6节和11.3.2节中详细讨论的那样，凸H是包含于S的最小凸集。壳和凸缺对于物体描绘是很有用的。。这里,，我们介绍一种获得集合A的凸壳CA)的简单形态学算法。令,7=1.2.3.4表示图9.19Ga)中的4个结构元。这个过程可通过执行下式实现:x' =《X.,OB')UA i=1, 2.3,4和人=1. 2.3,49.5-4)当该过程收敛时(即当X{ = XL,时)，我们令D' =X：。则A的凸壳为其中X8=A。9.5-5）C(A)=该方法由反复使用砂对A做击中或击不中变换组成；当不再发生进一步变化时，我们执英句话说，行与A的并集运算，结果称为D'。这一过程使用B重复(应用于A)，直到不发生进一步的变化，此往复。得到的4个D的并集组成了A的凸壳。注意，我们使用不需要背景匹配的击中或击不中变换的简化的实现，如 9.4节末尾所讨论的那样。图9.19说明了式(9.5-4)和式(9.5-5)给出的过程。图9.19 (a)显示了用于提取凸壳的结构元。每个“x”项表示“不考虑”结构元的原点均位于其中心处。的条件。这意味着，如果结构元模板下A的3×3区域在该位置匹配模板的模式，则说结构元在A中找到了一个匹配。对于一个特殊的模板，当A中的这个3×3区域的中心为0时，而在阴影模板元素下的3个像素为1时，才会出现模式匹配。。不必顾及该3×3区域内其他像素的值。此外，关于图9.19(a)中的符号B′是由B一顺时针旋转90°得到的。中口。P 第8十中十中料期明日十中HH日田由出伊十SB田田H出口十村LLL上图 9.19a)结构元；(b)集合A；（c)-()使用图a)中的结构元得到的收敛结果；g)凸亮；h)显示了每不结构元的责献的凸壳图9.19(6)显示了一个寻找凸壳的集合A。从x =4开始,式(9.5-4)经过4次迭代后,得到图9.19(c）中的集合。然后令X8 =A，并再次使用式(9.5-4)，得到图 9.19(d)中的集合(在这种情况下，仅经过两步即可收敛)。接下来的两个结果是以同样的方式得到的。。最后，图9.19(c),(d)，(e)和()中集合形成的并集得到图 9.19(g)显示的凸壳。每个结构元的贡献突出显示在图 .1960)所示的组合集合中。一个明显的缺点是凸壳可能超出确保凸性所需的最小尺寸。减少这种影响的一种简上述过程的一第9章单方法是限制生长，以便凸壳不会超过初始点集在水平和垂直方向上的尺寸。对图9.19中的例子施加这种限制产生图 9.20所示的图像。更复杂的边界可用于进一步限制具有更多细节的图像的生长。例如，我们可以沿垂直、水平和对角线方向使用原始点集的最大尺寸。。像这样的改进所付出的代价是额外增加了算法的复杂性和计算需求。9.5.5细化结构元B对集合A的细化可表示为A88，它可以根据击中或击不中变换来定义:图 9.20将凸壳生长算法限制到原始点集沿垂直方向和水平A8B= A-(A@B) = An(A@BD）(9.5-6）方向的最大尺寸的结果如前一节那样，我们仅对与结构元的模式匹配感兴趣，月所以在击中或击不中变换中没有背景运算。针对对称地细化A的一种更有用的表达方式是以结构元序列为基础的:{8}={B",B,B，…，B”}(9.5-7）使用这一概念，我们现在可以使用一一个结构元序列将细化定义为其中B”是B“旋转后的形式。但18{B}=（…(A48B')8B5 .)8B”）(9.5-8）这种处理是A被B细化一次，然后，得到的结果被B”细化一次，如此进行下去，直到A被B”细化一整个过程不断重复，直到得到的结果不再发生变化。。每次单独的细化均使用式(9.5-6)来执行。一组通常用于细化的结构元，图9.21 (6)显示了将要使用刚才讨论的过程来细化图 9.21 (a)显示了的集合A。图 9.21 Cc)显示了A被B细化一次后得到的结果。图9.21 (d)到(k)显示了用其他结构元细化多次的结果。使用B》进行第二次细化后得到了收敛的结果。图9.21(0显示了细化的结果。最后，图 9.21 (m)显示了转换为m连通的细化集合(见2.5.2节)，以消除多重路径。原点4= A,6户中E中已转换为m还通的A此后不再变化图 9.21a)用于细化的经旋转后的结构元序列；b)集合(c)使用第一一个结构元细化得到的结果：d)~G)使用接下来的7个结构元细化得到的结果(使用671第7个和第8个结构元细化得到的结果间没有变化)；G)再次使用前4个结构元细化得到的结果；(D)收敛后的结果；（m)转换为m连通的结果粗化9.5.6粗化是细化的形态学对偶，定义如下：(9.5-91・B = AU(A@B)其中B是适合于粗化处理的结构元。与细化一样，粗化处理也可以定义为一一个系列操作:AO{B}=（(…(AOB')o BP) …)O B”）(9.5-10）用于粗化的结构元与图 9.21 (a)所示的结构元具有相同的形式，但所有1和0要互换。然而，针对粗化的分离算法在实际中很少用到，取而代之的过程是先对问题中集合的背景进行细化，而后对结果求补集。。换句话说，为粗化集合A，我们先形成C=A°，而而后细化C，然后再求C°。图 9.22说明了这过程。由于依赖于A的性质，，这个过程可能产生某些断点，如图 9.22 d)所示。因此，通过这种方法的粗化处理通常会跟随一个后处理以消除断点。注意，根据图9.22 (e)可知，，细化后的背景形成了粗化。这一有用的特性在使用式(9.5-10)粗化的直接执行中并不存在，并且，它是使用背处理的一个边界。景细化来实现粗化的主要原因之一终 9.22(a)集合A；(b)A的补集；(c)对A的补集进行细化得到的结果;(d)对(e)求补得到的粗化后的集合；（e)没有断点的最终结果骨架9.5.7如图 9.23所示，集合A的骨架SA)的概念直观上相当简单。由该图我们可以推出:Ga）如果z是S(A)的一个点，并且(D).是A内以z为中心的最大圆盘，则不存在包含(D),且位于A内的更大圆盘(不必以z为中心)。圆盘(D),称为最大圆盘。G）圆盘(D),在两个或多个不同的位置与A的边界接触。A的骨架可以用腐蚀和开操作来表达，，即骨架可以表示为(Serra[ 1982)S(A)=Us(A）(9.5-11其中，(9.5-12）Sx(A)=(AekB)-(AekB)oB式中，B是一个结构元，而(AekB)表示对A的连续k次腐蚀：AGkB) =(…(AQB)9B)3…)9B(9.5-13）K是A被腐蚀为空集前的最后一次迭代步骤。换句话说,572K =max{kI(AOkB)≠0}(9.5-14）形态学图像处理419图 9.23（a)集合A；b)中心在A的骨架上的最大圆盘的不同位置；（C)位于A的骨架的不同线段上的另一个最大圆盘；（d)完整的骨架式(9.5-11)和式(9.5-12)给出的公式表明，SA)可以作为骨架子集SA(A)的并集来得到。。此外，还可证明使用下式可由这些子集来重建A：JGSx(A)GkB）(9.5-15）其中(SA(A)9kB)表示对S,(A)的k次连续膨胀，即(SA(A)GkB) (（(…(S（A)9B)9B)9…)0B）(9.5-16)计算简单图形的骨架。列9.8图924 说明了刚才讨论的概念。第一列显示了原始集合(顶部)和使用结构元积的两次腐蚀。注意,对A再进行一次腐蚀将产生空集，因此在这种情况下K=2。第二列显示了使用B对第一列中的集合进行的开操作。结合图9.8 中讨论的开操作的拟合特性，这些结果很容易解释。第三列只包含第一列和第二列间的集合差。纸JSA(A）AGkBAekB)。BSA(A）674式(9.5-11)到式(9.5-15)的执行。原始集合位于左上角，其w形态学骨架位于第四列的底部。。第六列底部为重建的集合最终得到的骨架不仅比需要的更粗，而且更重要第四列包含两部分骨架和最终结果(该列的底部)。由于在前述的形态学骨架公式中设有任何条件保证连通性・所以该结果是意料之中的是它是不连通的的。形态学在给定集合的腐蚀和开操作中产生一个精致的公式。然而，如同通常情况下一样，骨架要求最大限度的细化、连通，且受到的腐蚀最小，就需要像11.1.7节中探讨的算法这一类有试探性的公式。第五列显示了So(A),S,(A)田B和(S,(A)92B)=(SQ(A)9B)9B。最终,最后一列显示了根据式(9.5-15）重建的集合A，该集合是第五列所示膨胀后的骨架子集的并集。裁剪9.5.8裁剪方法本质上是对细化和骨架算法的补充，因为这些过程会保留某些寄生分量，因而需要用后处理来清除这些寄生分量。。我们首先探讨裁剪问题，然后以前面小节中介绍的材料为基础探讨形态学上的解决方法。因此，我们抓住这个机会说明如何通过到现在为止讨论过的几种技术的联合使用解决这一问题。在手写字符的自动识别中，通常使用的方法是分析每个字符的骨架形状。这些骨架经常带有许。毛刺是在腐蚀过程中由组成字符的笔画的不均匀性造成的。为处理这“毛刺”(寄生分量)的特征。问题，我们将探讨一一种形态学技术，先假定寄生成分的长度不超过指定的像素数。个手写字符“a”图 9.25(a)显示了一的骨架。该字符最左侧的寄生成分就是我们要消除的部分。解决方案是以通过不断删除寄生分支的终点来抑制寄生分支为基础的。。当然，这也会使得字符的其他分支变短(或删除），但在缺乏其他结构信息的情况下，这个例子中的我们可将端点定义为一个大小为假设是任何具有三个或小于三个像素长度的分支都将被删除。使用一3x3的区域的中心点、该区域满足系列仅设计用来检测端点的结构元对输入集合A进行细化可以得到期图9.25(6b)或(c)中的任何排列。望的结果。也就是说，令(9.5-17）X = A8{B}式中，{8}表示图 9.25(6)和(C)中所示的结构元序列[见式(9.5-7)关于结构元序列]。这个结构元序列由两种不同的结构组成，每种结构对全部8个元素旋转了90。图 9.25 6)中的“x”表示一不必考虑”的条件，在这种意义上，该位置上的像素的值是0还是1无关紧要。在有关形态学的文献中报告的许多结果都是以运用类似图 9.256b)中的单一结构元为基础的，只是沿着整个第一列有不必考虑”的条件而已。这是不完善的。例如，该元素将位于图 9.25 a)中第8行、第4列的点识别为端点，因此将该点消除，从而破坏了笔画的连续性。连续对A应用式(9.5-17)三次，得到图 9.25 d0中的集合X,。下一步是将字符“复原”成其原来的形状，但要去掉寄生分支。为做到这一这一点，首先需要求形成一个包含X,中所有端点的集合X。「见图 9.25(e）K2(X,@8*）(9.5-18）其中，B*是图 9.25 6b)和(心)中所示的相同端点检测子。下一步是用集合A作为限定器，对端点进行三次膨胀：X.=(X,9H)nA(9.5-19)其中，1H是元素值为1的3×3结构元，并且在每一步之后都要与A求式(9.519)是膨胀形态学重建的基交集。如区域填充和提取连通分量的情况一这种有条件的膨胀可一样，础、详见下一节中的解释。以防止在我们关注的区域外产“生值为1的元素，正如图 9.25(0)所示结果证明的那样。最后，，Xg和X,的并集就是我们想要的结果:形态学图像处理(9.5-20）X.=XUX如图 9.25(g)所示。'.BB8)B（己旋转 903*,B*,B,B图 9.25（a)原图像；(b)-(c)用于检测端点的结构元；の)经过三轮细化后的结果；（e)图(心的端点；D以图(a)为条件的端点膨胀；（g)修剪后的图像在更复杂的情况下，使用式(9.5-19)有时会捡回某些寄生分支的“尖端"。当这些分支的端点离骨架很近时，这种情况就会发生。尽管使用式(9.517可以消除它们，但在膨胀过程中会再次捡回这些点，因为它们是A中的有效点。除非整个寄生元素再次被捡回，(这些元素比有效笔画短的情况很少)检测并消除它们就很容易，因为它们都是不连续的区域。此时的一种自然想法是，一定存在一种更为容易的方法来解决这个问题。例如，我们可以保留所有被删除点的轨迹，并将其中合适的点与那些应用式(9.5-17)后留下的端点进行再连接。这样的选，但前面给出的公式的优点是使用简单的形态学结构即可解决整个问题。在实际情况下择是可行的，当这一组工具可利用时，其优点是不必写新的算法。我们只需将必要的形态学函数结合到操作序列中。形态学重建9.5.9迄今为止讨论的形态学概念只涉及一幅图像和一个结构元。在这一节中，我们讨论一种称为形态学重建的强有力的形态学变换，它涉及两幅图像和一一个结构元。一幅图像是标记、它包含变换的起始点，另一幅图像是模板，它约束该变换。结构元用来定义连接性雪O在关于形态学重建的许多文献中・默认情形下结构元假设是各向同性的，且一般称为初级各向同性结构元。在本章的上下文中・678这样的一个结构元的例子是其原点在中心处、元素为1且大小为3×3的阵列。测地膨胀和腐蚀形态学重建的核心是测地膨胀和测地腐蚀这两个概念。令F表示标记图像，G表示模板图像在本讨论中，假定两幅图像都是二值图像，且FcG。令D8(F)表示大小为1的标记图像关于模板的测地膨胀定义为D8"(F)=(FBB)nG(9.5-21）其中，n表示集合的交[这里n可解释为逻辑 AND(与)，因为对二值图像来说集合的交和逻辑 AND操作是相同的]。F关于G的大小为n的测地膨胀定义为D8"(F)= 28'[28"(FP）」(9.5-22其中、D28 .).= 7 在这个递推表达式中，式(9.5-21中的集合求交在每一步中都执行"。注意，交集算子保证模板G将限制标记厂的生长(膨胀)。图9.26显示了一个大小为1的测地膨胀的简单例子。图中的步骤是式(9.5-21)的直接执行。亦记, f皮B膨胀的标记测地膨胀.2!"(7）模板,G冬9.26 测地膨胀的说明类似地，标记F关于模板G的大小为1的测地腐蚀定义为E8°(F)=(Fe B)UG(9.5-23）其中，U表示集合的并(或者OR操作)。F关于G的大小为n的测地腐蚀定义为E8"(F)= E8[E8"(F)」(9.5-24）式(9.5-23)中的并集操作在每一个迭代步骤中执行，并并保证一唯幅图像的测地腐蚀仍然大于或等于其模板图像。如从式(9.5-21)和式(9.5-23）预期的那样，测地膨胀和测地腐蚀是关于集合的补集对偶的(见习题9.29)。图 9.27显示了一个大小为1的测地腐蚀的简单例子。图中的步骤是直接执行式(9.5-23）有限数量图像的测地膨胀和腐蚀经过有限数量的迭代步骤后总会收敛，因为标记图像的扩散或收缩受模板约束。78の尽管使用递归公式来开发形态学重建方法更为直观(就像此处所做的那样)，但它们的实际实现通常基于计算上更有效率的算法(例如，见Vincent1931 Soe203）。本节中所有基于图像的例子均是使用这样的算法生成的。423第9章标记,F被B腐蚀的标记测地腐蚀。2"(）测地腐蚀的说明图9.27用膨胀和腐蚀的形态学重建基于前面的概念，来自标记图像F对模板图像G的膨胀形态学重建表示为R2(F），它被定义为F关于G的测地膨胀，反复迭代直至达到稳定状态；即9.5-25）R2(F)= D8'(F）迭代k次，直至D8(F)= 28*"(FD）。。图9.28 a)继续在图9.26中开始的处理；也就是说，得到D8(F）图9.28说明了使用膨胀的重建。重建的下一步是膨胀该结果，，然后，用模板G与其相“与”（AND)得到D8(F)，如图 9.28 6）“与”（AND)得到D8(F)，等等。重复这一过程，直至达到稳定。如果我们对该例子多执行一一步，会发现D2(F)= D8(F)，因此，采用膨胀的形态学重建的图象由D2（F)= D8(F)给出，这正如式(9.5-25)指出的那样。注意，在这种情况下，重建的图像与模扳相同，因为F包含了值为1的单个像素(这类似于一幅图像与一个冲激的卷积，该卷积简单地复制中激位置处的图像，正如在3.4.2 节解释的那样）披8膨胀的;(F）被8膨胀的D;17）2;(7）2;0)=R"(5采用膨胀的形态学重建的说明。F,G,B和D8(F)来自图 9.26图9.28依照类似的方法，模板图像G对标记图像厂的腐蚀的形态学重建表示为R(F)，它被定义为厂关于G的测地腐蚀，反复迭代直至达到稳定状态；即R(F)= E8（F）(9.5-26)选代人次，真至.520..FR，。作为习题・请级针对腐蚀的形态学重建生成一幅类似于图9.28的图形。。膨胀和腐蚀形态学重建是关于集合补集对偶的(见习题9.30）立用实例形态学重建有很宽的实际应用领域，每种应用都由标记图像和模板图像的选择、月所用的结构元及前面讨论中定义的基本操作的组合来决定。。下面的几个例子说明了这些概念的应用。重建开操作：在形态学开操作中，腐蚀会删除小的物体、而后续的膨胀试图恢复遗留物体的形状。然而，这种恢复的准确性高度依赖于物体的形状和所用结构元的相似性。重建开操作可正确地恢复腐蚀后所保留物体的形状。幅图像F的大小为n的重建开操作定义为来自F的大小为n的腐蚀的F的膨胀重建；即OA'(F)= RP[FOnB)」(9.5-27）(FenB)表示召对厂的，次腐蚀，如9.5.7节中解释的那样。注意，在该应用中，F被用做模其中，对于重建闭操作，可写出一个类似的表达式(见表9.1）板。图9.29显示了重建开操作的一一个例子。在这一说明中，我们的兴趣是从图9.29 4a)中提取长的、垂。重建开操作至少要求一次腐蚀，因此我们首先执行这一步骤。图 9296)显示了图 9.29（4a直笔画的字符。经腐蚀后的结果，该腐蚀采用长度与长字符的(51个像素)平均高度成正比和宽度为1个像素的结构元、为了比较，我们用相同的结构元计算了开操作。图929(e)显示了结果。最后，图9.290)是用式(9.5-27F[即OP(F）〕的重建开操作(大小为）。该结果表明，包含长的垂直笔画的字符被准确F给出的F地恢复了，而所有的其他字符则被去除了。图 9.29(a)大小为918×2018像素的文本图像。长的字符的近似平均高度是Gb)使用大小为51x1像素的结构元对图(a)的腐蚀；(c)使51个像素；用相同的结构元对图(a)的开操作，用做参考；（d)重建开操作的结果填充孔洞：在9.5.2节中，我们开发了一种填充孔洞的算法，该算法在图像中的每个孔洞都已知个起始点。这里，我们开发一个基于形态学重建的全自动化过程。。令α,y代表一幅二值图像，并假定我们形成了一幅标记图像F，除了在该图像的边界位置为1-1之外，在其他位置均为0，即Gx, y)在1的边界上1-1(x, y),F(x, y)={(9.5-28）其他H=[RP(r)」9.5-29）-幅等于1且所有孔洞都被填充的二值图像。形态学图像处理425让我们考虑式(9.5-29)中的各个分量，以了解该表达式事实上是如何填充图像中的所有孔洞的。图9.30(a显示了包含一个孔洞的简单图像，图 9.30(6)显示了它的补集。注意，因为！的补集将所，该操作效果上建立了围绕孔洞的一面有的前景像素(1值)设置为背景(0值)像素，并且反之亦然，元素为0的“墙”。。因为1被用做一个AND(与)模板，，这里我们所做的一切都是在该过程的迭代期间保护所有的前景像素(包括围绕孔洞的墙)。图9.30(c)是根据式(9.5-28)形成的阵列F，图9.30(d）是使用所有元素都为1的3×3 SE(结构元)膨胀后的F。注意，标记F有一个元素为1的边缘(除1为1的位置之外)，故这些标记点F的膨胀在边缘处开始，并且向内处理。图9.30(e)显示了使用1"作为模板对厂进行测地膨胀后的结果。。如刚才指出的那样，我们看到，在这个结果中，，对应于1的前景像素的所有位置都是0，并且对于孔洞像素也是一样。另一一次迭代将得到相同的结果，，如式(9.5-29)要求的那样，求补后给出图 9.30 (f)中所示的结果。操作Hn1*生成一幅图像，该图像中对应于1中孔洞的位置像素值为1，如图 9.30(g)所示。口目F由Bn 1图9.30在简单图像上填充孔洞的说明图 9.31显示了一个更实际的例子。图93106)显示了图9.31 (a)中文本图像的补集，图9.31（(e)是由式9528)产生的标记图像「。除了对应于愿图像边界上的「的位置外，该图像有一个元素为1的边界。最后，图 9.31(d)显示了所有孔洞均被填充后的图像。图9.31a)大小为918×2018像素的文本图像；(b)作为模板图像使用的(a)的补集；(c)标记图像；（d)用式(9.5-29)填充孔洞的结果边界清除：针对后续形状分析的图像物体提取是自动图像处理的基本任务。删除接触(即连接到)边界的物体的算法是、个很有用的工具，因为:1)它可以用于屏蔽图像，以便对进一步处理只保留我们现在提出一个基于形态学重建的边界清除过程。在这一应用中，我们用原图像作为模板，并使用下面的标记图像：11(x,y),C,y)位于1的边界上FGx, y)=(9.5-30)其他0,数字图像处理(第三版)边界清除算法首先计算形态学重建RP(F）(简单地提取接触到边界的物体)，然后计算差x =1-RP(F）(9.5-31）以得到一幅其中没有接触边界的物体的图像X。作为一一个例子，再次考虑文本图像。。图9.32 (a)显示了使用所有元素均为1的3×3的结构元得到的重建RP(F)(注意右侧接触边界的物体)，图 9.32 (b)显示了使用式(9.5-31)计算得到的图像X。如果手边的任务是自动字符识别，则拥有一幅其中没有接触边界的字符的图像最有用，因为这样可以避免不得不识别部分字符的问题(充其量也只是一个困难的任务)：(a)标记图像；(b)没有接触边界的物体的图像。。原图像是图 9.29(a）图9.32 边界清除：二值图像形态学操作小结9.5.10表,9.1小结了前几节中提出的形态学结果。图,.33小结了迄今为止讨论过的用于各种形态学处理的结构元的基本类型。注意，表9.1第三列中的罗马数字是指图9.33中的结构元。2,3,4（旋转 90）34=.5.6, 7,8旋转90°）图933用于二值形态学的5个基本的结构元。每个结构元的原点均位于其中心处。×项表示“不考虑”的值表9.1形态学操作及其性质小结罗马数字指图9.33中的结构元）平移将因的原点平移到点王(B).={wlw=b+z, be B}反射关于集合B的原点映射该集合的所有元素6, be B}求补集下属于A的点的集合K差集A-B=1wlwe A. weB属于A但不属于召的点的集合=AnB膨胀扩展”A的边界(DA国8={z1(B,)nA≠O}腐蚀收缩”A的边界(DAe8={z1(B),=A开操作平滑轮廓，切断狭窄区域，并消除小的孤岛和尖刺(DAoB=(A9B)9B683|闭操作=(A0B)GB平滑轮廓，融合狭窄间断和细长沟堑，并消除小的孔洞(D形态学图像处理427续表罗马数字是指图 9.33 中的结构元）击中或击不中变换点(坐标)的集合，在这样的点处，同时，B在A中可找到一A08=(AOBpn(A"OB）个匹配(击中)，B在A“中可找到一个匹R=(AeB,)-(A9B2）边界提取在集合A的边界上的点的集合(D(A eB）孔洞填充填充A中的孔洞；X是每个孔洞处元素为Ⅰ而其他位置元素KXk. B)nA°；为0的阵列(ID连通分量寻找A中的连通分量；X是每个连通分量中元素为1而其他的B)T1A位置元素为0的阵列(D凸亮寻找集合A的凸壳 CA)，其中conv表示X{= Xi- an)意义x: =(XL,@8')UA:上的收敛i=1, 2,3.4；细化细化集命,A。前两个公式给出细化的基本定义。后两个公式A8B=A-(A@B）表示使用一个结构元序列的细化。实际中通常使用这种方=An(AQB）A8[B}=6…(4 BP) F）)-)9B"）181=18.,8,8，….B"粗化ioB=AU(AQB）粗化集合.A(见前面关于结构元序列的说明)。使用IV，但把)和1颠倒Ao{8}=《…(AOB)o B.….0 B"）育架寻找集合A的骨架SA)。最后一个公式指出A可以由其骨架SAa- s.4子集S・A)重建。在所有3个公式中，K是集合A被腐蚀为空集时的选代次数。符号(AekB）表示B对A连续腐蚀的SA(A)={(A9kB）第人次迭代(D{AekB)。B]}A的重建:1=UsxA)BkB）藏剪是裁剪集合A后的结果。必须指定使用第个公式来得到X・的必教。结构元V用于前两个公式。在第三个公式中，”*2=U(X,aB*）表示结构元15 =(X,0H)nA=X,UX,大小为1的测地膨胀F和G分别称为标记图像和模板图像D8(F)=(F由B)nG大小为n的测地膨胀D8"(65)=D8[2D8*"(7小D8(F)=大小为1的测地腐蚀28(7F)=( B)UG天小为n的测地腐蚀28065)= E8[E8"GF)」E8(F)=F膨胀形态学重建R80*)= D28'(r腐蚀形态学重建满足E8"(67 = 5%*"(r）N(F）= E8"(F）重建开操作(FenB)表示因对厂的n次腐蚀0%"(F)=RPfdrenB)重建闭操作(FBnB)表示B对厂的n次膨胀CH"(F) = RfIGF OnB)]孔洞填充等于输人图像几、但具有所有被填充的孔洞。标记图像F#=[*P(FD」的定义见式(9.5:28685|边界清除X等于输人图像工，但带有所有被删除接触(连接到)边界的X =1-RP"(）686物体。标记图像厂的定义见式(9.5-30数字图像处理(第三版）9.6灰度级形态学节中，我们将把膨胀、腐蚀、开操作和闭操作的基本操作扩展到灰度级图像。然后，我在这一们将使用这些操作来探讨几个基本的灰度级形态学算法。通过下面的讨论、我们将处理形如fCG,. )和G, )的数字函数，其中！(Gx. D)是一一幅灰度级图像，而 bα,y)是一个结构元。。假设这些函数是 2.4.2节中介绍过的离散函数。也就是说，如果Z表示实整数集合，，则坐标(α,y)是来自笛卡儿积Z的整数，，且f和b是对每个α, y)坐标对赋以灰度值(来自实数如果灰度级也是整数，则用Z代替尺。一个实数)的函数。集合R的一灰度级形态学中的结构元所执行的基本功能与二值形态学中所对应的功能相同：它们作为一个探测器”以明确的特性检验一幅给定的图像。灰度级形态学中的结构元属于两类：：非平坦的和平坦的结构元。图9.34显示了每一类的一个例子。图9.34 (a)以图像形式显示了一个半球状的灰度级结构元，图9.34(c)是一个通过其中心的水平灰度剖面。图9.34 6)显示了一个圆盘形的平坦结构元，图9.34 (d)是其对应的灰度剖面(该剖面的形状解释了“平坦”词的由来)。为清楚起见，图9.34中的元素以连续量显示；它们的计算机实现是以数字近似为基础的(见图9.2中最右侧的圆盘形 SE“结”)。由于本节稍后讨论的一一些困难，实际中灰度级结构元并不常用。最后，我们要提及的是，勾元”如在二值情况那样，必须清楚地确定结构元的原点。除非另外提及，本节中的所有例子都以高度为1、平坦的结构元为基础，其原点位于中心处。。灰度级形态学中结构元的反射的定义，如 9.1 节对称的、中的定义一样，且在下面的讨论中我们将它表示为众x,y) = 人-x-y)。平坦结构元灰度剂面灰度剂面不平坦结构元图9.34非平坦和平坦结构元，以及对应的通过其中心的水平灰度剖面。本节中的所有例子均基于平坦结构元9.6.1腐蚀和膨胀当b的原点位于(, J)处时，用一个平坦的结构元b在(, y)处对图像f的腐蚀定义为图像f中与b重合区域的最小值。以公式的形式，结构元素历对一幅图像了在位置α,y)处的腐蚀由下式给出：(9.6-1）其中，用与3.4.2节讨论的相关过程类似的方式，x和y是通过所有要求的值而增加的，以便口的原点能访问f中的每一个像素。也就是说，为寻求上对了的腐蚀，我们把结构元的原点放在图像每像素的位置。在任何位置的腐蚀由从包含在与如重合区域中的f的所有值中选取的最小值决定。例如・则获得一点处的腐蚀要求寻找包含在由仍定义的3×3区域中的如果b是大小为3×3的方形结构元，的9个值中其原点所在的那个点的最小值。类似地，当历的原点位于位置(α, y)处时，平坦结构元历在任何位置(, p处对图像了的膨胀，定义687为图像f中与b重合区域的最大值，即二bss形态学图像处理425让我们考虑式(9.5-29)中的各个分量，以了解该表达式事实上是如何填充图像中的所有孔洞的。图9.30(a显示了包含一个孔洞的简单图像，图 9.30(6)显示了它的补集。注意，因为！的补集将所，该操作效果上建立了围绕孔洞的一面有的前景像素(1值)设置为背景(0值)像素，并且反之亦然，元素为0的“墙”。。因为1被用做一个AND(与)模板，，这里我们所做的一切都是在该过程的迭代期间保护所有的前景像素(包括围绕孔洞的墙)。图9.30(c)是根据式(9.5-28)形成的阵列F，图9.30(d）是使用所有元素都为1的3×3 SE(结构元)膨胀后的F。注意，标记F有一个元素为1的边缘(除1为1的位置之外)，故这些标记点F的膨胀在边缘处开始，并且向内处理。图9.30(e)显示了使用1"作为模板对厂进行测地膨胀后的结果。。如刚才指出的那样，我们看到，在这个结果中，，对应于1的前景像素的所有位置都是0，并且对于孔洞像素也是一样。另一一次迭代将得到相同的结果，，如式(9.5-29)要求的那样，求补后给出图 9.30 (f)中所示的结果。操作Hn1*生成一幅图像，该图像中对应于1中孔洞的位置像素值为1，如图 9.30(g)所示。口目F由Bn 1图9.30在简单图像上填充孔洞的说明图 9.31显示了一个更实际的例子。图93106)显示了图9.31 (a)中文本图像的补集，图9.31（(e)是由式9528)产生的标记图像「。除了对应于愿图像边界上的「的位置外，该图像有一个元素为1的边界。最后，图 9.31(d)显示了所有孔洞均被填充后的图像。图9.31a)大小为918×2018像素的文本图像；(b)作为模板图像使用的(a)的补集；(c)标记图像；（d)用式(9.5-29)填充孔洞的结果边界清除：针对后续形状分析的图像物体提取是自动图像处理的基本任务。删除接触(即连接到)边界的物体的算法是、个很有用的工具，因为:1)它可以用于屏蔽图像，以便对进一步处理只保留我们现在提出一个基于形态学重建的边界清除过程。在这一应用中，我们用原图像作为模板，并使用下面的标记图像：11(x,y),C,y)位于1的边界上FGx, y)=(9.5-30)其他0,数字图像处理(第三版)边界清除算法首先计算形态学重建RP(F）(简单地提取接触到边界的物体)，然后计算差x =1-RP(F）(9.5-31）以得到一幅其中没有接触边界的物体的图像X。作为一一个例子，再次考虑文本图像。。图9.32 (a)显示了使用所有元素均为1的3×3的结构元得到的重建RP(F)(注意右侧接触边界的物体)，图 9.32 (b)显示了使用式(9.5-31)计算得到的图像X。如果手边的任务是自动字符识别，则拥有一幅其中没有接触边界的字符的图像最有用，因为这样可以避免不得不识别部分字符的问题(充其量也只是一个困难的任务)：(a)标记图像；(b)没有接触边界的物体的图像。。原图像是图 9.29(a）图9.32 边界清除：二值图像形态学操作小结9.5.10表,9.1小结了前几节中提出的形态学结果。图,.33小结了迄今为止讨论过的用于各种形态学处理的结构元的基本类型。注意，表9.1第三列中的罗马数字是指图9.33中的结构元。2,3,4（旋转 90）34=.5.6, 7,8旋转90°）图933用于二值形态学的5个基本的结构元。每个结构元的原点均位于其中心处。×项表示“不考虑”的值表9.1形态学操作及其性质小结罗马数字指图9.33中的结构元）平移将因的原点平移到点王(B).={wlw=b+z, be B}反射关于集合B的原点映射该集合的所有元素6, be B}求补集下属于A的点的集合K差集A-B=1wlwe A. weB属于A但不属于召的点的集合=AnB膨胀扩展”A的边界(DA国8={z1(B,)nA≠O}腐蚀收缩”A的边界(DAe8={z1(B),=A开操作平滑轮廓，切断狭窄区域，并消除小的孤岛和尖刺(DAoB=(A9B)9B683|闭操作=(A0B)GB平滑轮廓，融合狭窄间断和细长沟堑，并消除小的孔洞(D形态学图像处理427续表罗马数字是指图 9.33 中的结构元）击中或击不中变换点(坐标)的集合，在这样的点处，同时，B在A中可找到一A08=(AOBpn(A"OB）个匹配(击中)，B在A“中可找到一个匹R=(AeB,)-(A9B2）边界提取在集合A的边界上的点的集合(D(A eB）孔洞填充填充A中的孔洞；X是每个孔洞处元素为Ⅰ而其他位置元素KXk. B)nA°；为0的阵列(ID连通分量寻找A中的连通分量；X是每个连通分量中元素为1而其他的B)T1A位置元素为0的阵列(D凸亮寻找集合A的凸壳 CA)，其中conv表示X{= Xi- an)意义x: =(XL,@8')UA:上的收敛i=1, 2,3.4；细化细化集命,A。前两个公式给出细化的基本定义。后两个公式A8B=A-(A@B）表示使用一个结构元序列的细化。实际中通常使用这种方=An(AQB）A8[B}=6…(4 BP) F）)-)9B"）181=18.,8,8，….B"粗化ioB=AU(AQB）粗化集合.A(见前面关于结构元序列的说明)。使用IV，但把)和1颠倒Ao{8}=《…(AOB)o B.….0 B"）育架寻找集合A的骨架SA)。最后一个公式指出A可以由其骨架SAa- s.4子集S・A)重建。在所有3个公式中，K是集合A被腐蚀为空集时的选代次数。符号(AekB）表示B对A连续腐蚀的SA(A)={(A9kB）第人次迭代(D{AekB)。B]}A的重建:1=UsxA)BkB）藏剪是裁剪集合A后的结果。必须指定使用第个公式来得到X・的必教。结构元V用于前两个公式。在第三个公式中，”*2=U(X,aB*）表示结构元15 =(X,0H)nA=X,UX,大小为1的测地膨胀F和G分别称为标记图像和模板图像D8(F)=(F由B)nG大小为n的测地膨胀D8"(65)=D8[2D8*"(7小D8(F)=大小为1的测地腐蚀28(7F)=( B)UG天小为n的测地腐蚀28065)= E8[E8"GF)」E8(F)=F膨胀形态学重建R80*)= D28'(r腐蚀形态学重建满足E8"(67 = 5%*"(r）N(F）= E8"(F）重建开操作(FenB)表示因对厂的n次腐蚀0%"(F)=RPfdrenB)重建闭操作(FBnB)表示B对厂的n次膨胀CH"(F) = RfIGF OnB)]孔洞填充等于输人图像几、但具有所有被填充的孔洞。标记图像F#=[*P(FD」的定义见式(9.5:28685|边界清除X等于输人图像工，但带有所有被删除接触(连接到)边界的X =1-RP"(）686物体。标记图像厂的定义见式(9.5-30数字图像处理(第三版）9.6灰度级形态学节中，我们将把膨胀、腐蚀、开操作和闭操作的基本操作扩展到灰度级图像。然后，我在这一们将使用这些操作来探讨几个基本的灰度级形态学算法。通过下面的讨论、我们将处理形如fCG,. )和G, )的数字函数，其中！(Gx. D)是一一幅灰度级图像，而 bα,y)是一个结构元。。假设这些函数是 2.4.2节中介绍过的离散函数。也就是说，如果Z表示实整数集合，，则坐标(α,y)是来自笛卡儿积Z的整数，，且f和b是对每个α, y)坐标对赋以灰度值(来自实数如果灰度级也是整数，则用Z代替尺。一个实数)的函数。集合R的一灰度级形态学中的结构元所执行的基本功能与二值形态学中所对应的功能相同：它们作为一个探测器”以明确的特性检验一幅给定的图像。灰度级形态学中的结构元属于两类：：非平坦的和平坦的结构元。图9.34显示了每一类的一个例子。图9.34 (a)以图像形式显示了一个半球状的灰度级结构元，图9.34(c)是一个通过其中心的水平灰度剖面。图9.34 6)显示了一个圆盘形的平坦结构元，图9.34 (d)是其对应的灰度剖面(该剖面的形状解释了“平坦”词的由来)。为清楚起见，图9.34中的元素以连续量显示；它们的计算机实现是以数字近似为基础的(见图9.2中最右侧的圆盘形 SE“结”)。由于本节稍后讨论的一一些困难，实际中灰度级结构元并不常用。最后，我们要提及的是，勾元”如在二值情况那样，必须清楚地确定结构元的原点。除非另外提及，本节中的所有例子都以高度为1、平坦的结构元为基础，其原点位于中心处。。灰度级形态学中结构元的反射的定义，如 9.1 节对称的、中的定义一样，且在下面的讨论中我们将它表示为众x,y) = 人-x-y)。平坦结构元灰度剂面灰度剂面不平坦结构元图9.34非平坦和平坦结构元，以及对应的通过其中心的水平灰度剖面。本节中的所有例子均基于平坦结构元9.6.1腐蚀和膨胀当b的原点位于(, J)处时，用一个平坦的结构元b在(, y)处对图像f的腐蚀定义为图像f中与b重合区域的最小值。以公式的形式，结构元素历对一幅图像了在位置α,y)处的腐蚀由下式给出：(9.6-1）其中，用与3.4.2节讨论的相关过程类似的方式，x和y是通过所有要求的值而增加的，以便口的原点能访问f中的每一个像素。也就是说，为寻求上对了的腐蚀，我们把结构元的原点放在图像每像素的位置。在任何位置的腐蚀由从包含在与如重合区域中的f的所有值中选取的最小值决定。例如・则获得一点处的腐蚀要求寻找包含在由仍定义的3×3区域中的如果b是大小为3×3的方形结构元，的9个值中其原点所在的那个点的最小值。类似地，当历的原点位于位置(α, y)处时，平坦结构元历在任何位置(, p处对图像了的膨胀，定义687为图像f中与b重合区域的最大值，即二bss弟9章形态学图像处理(9.6-2）L f 6b](x, y) =我们用到了早些时候说明过的6.人.:-》的事实。对该式的解释与前一段中的解释相同，但其中，使用的是最大而不是最小操作，并且要记住结构元关于其原点反射，我们用(-s,-0)考虑函数的自变量。这类似于空间卷积，就像3.4.2节中解释的那样。例9.9灰度级腐蚀和膨胀的说明。一个平坦SE(结构元)的灰度级腐蚀计算图像f中与b重合的(α,y)的每一个邻域的最小灰度因为使用一值，因此通常我们希望被腐蚀的灰度级图像比原始图像暗，亮特征的尺寸(关于SE的尺寸)将被减小,一个单位高度和半径为2个像素的圆盘形结构元素对而暗特征的尺寸将会增大。图9.35 (6)显示了使用一图 9.35 (a)的腐蚀。刚才讨论的效果在腐蚀过的图像中清晰可见。例如，请注意小亮点亮度的降低程度，图9.356)中几乎已看不到这些小亮点，，同时暗色特征则变浓了。腐蚀过的图像中的一般背景比原图像的导景要稍暗一些。类似地，图9.35 Ge)显示了使用相同SE膨胀后的结果。其效果与用腐蚀得到的效果相反，即亮特征变浓了，而暗特征降低了。请特别注意图9.35a)中左侧、中间、右侧和底部的较细黑色连线在图9.35 (c)中几乎已看不见了。黑点的尺寸已被减小，但与图9.35 (b)中被腐蚀的小白点完全不同，在小白点却清晰可见。其原因是就结构元的尺寸相比，黑点的尺寸原来就比白点大。最膨胀后的图像中，后，请注意膨胀后的图像中的背景比图9.35 (a)中的背景稍亮。非平坦结构元具有随定义域而变化的灰度级。非平坦结构元b,对图像f的腐蚀定义如下：(9.6-3）feboI(x, J) = min{.f(x+ s, y+1)-b.(s, 1D）这里，我们实际上是从了中减去b，的值来确定任意点处的腐蚀。与式(9.6-1)不同，这意味着使用非平坦结构元的腐蚀通常不受f值的限制，而这在解释结果时会存在问题。亚。因为这一愿因，实际中很少使用另外，与式(9.6-1)比较，，为b，选取有意义的元素和增加的计算负担也是潜在的困难。灰度级结构元；图9.35a)大小为448×425像素的灰度级X射线图像；G)使用半径为2个像素的圆盘形结构元对图像的腐蚀结果；c)用相同结构元对图像的膨胀结果(原图像由Lixi公司提供）采用类似的方式，使用非平坦结构元的膨胀定义如下:9.6-4)段给出的说明同样适用于使用非平坦结构元的膨胀。当b。的所有元素都是常数时(即结构元是平坦的)，式(9.6-3）和式(9.6-4)就分别简化为式(9.6-1)和式(9.6-2)，其中一个标量常数等于该结构元的幅度心如二值情况那样，腐蚀和膨胀是关于函数的补集和反射对偶的，即(reby"(x. y)=(广" Ob)(x. y）lsa430其中，/"=-/(x,y)且万=5(-x,-y)。相同的表达式对非平坦结构元也有效。为清楚起见在下面的讨论中，我们将忽略所有函数的参量以简化表达式，在这种情况下，前一-公式可写为(reb)" = (f*田D.9.6-5）类似地，.f Db)*=（f"e b).9.6-6)当组合用来自身的腐蚀和膨胀在灰度级图像处理中并不是特别有用。像在对应的二值情形那样，推导高级算法时，这些操作会变得强有力，正如下节所示的材料那样。尽管我们在本节剩余内容的例子中9.6.2开操作和闭操作介绍的是平坦结构元，但讨论的概念同样适用于非平坦结构元。灰度级图像的开操作和闭操作的表达式与二值图像的对应操作具有相同的形式。结构元b对图像f的开操作表示为f。b，即(9.6-7）f ob=(feb)田b象之前那样，开操作先只用b对f做腐蚀，随后用b对所得结果做膨胀。类似地，b对f的闭操作表示为了-b，即(9.6-8）fb=(f 6b)Gb灰度级图像的开操作和闭操作关于函数的补集和结构元的反射是对偶的：f"。b(9.6-9）( f・b)" =和(J 。b" = "-6(9.6-10)因为f-f(x,y)，所以式(9.69)也可以写为一(f-b)=(-f。b)，对于式(9.6-10)也类似。图像的开操作和闭操作具有简单的几何解灰度剂面假设我们将一维表面；也就是说，它的灰度值可解释为xy平面厂平坦结构元上的高度值，如图2.18 (a)所示。。然后，b对f的开操作可从几何角度解释为，从f的下表面向上推动开操作是当从f的结构元。在b的每个原点位置，下表面向上推动结构元时，人的任何部分所达到的最高值。这样，另完全开操作就是由b的原点访问了的每一个坐标(,J)所得到的所有值的集合。图 9.36以一维的形式说明了这个概念。假定图 9.36(a)中的曲线是沿图像中的一行的灰度剖面。图9.36 6b)显示了沿曲线底部向上推到不同位闭操作置的一个平坦结构元。图9.36 (c)的实线是完全开操作。因为结构元太大而不能完全拟合曲线上部图9.36维情形下的开操作和闭操作：(a)原始峰值的内侧，故峰值的一一维信号；（b)从信号底部向上推动的的顶部被并操作剪切条曲线的下侧和上侧滚动一个圆米平坦结构元素；（c)开操作；《dの沿信号顶说明。在三维情形下，圆可用球体掉了，剪切的量与结来替代，得到的过程称为滚球算法。部向下推动的平坦结构元素；（e)闭操作691构元能够到达峰值的形态学图像处理431百，开操作用于去除较小的明亮细节，而保持整体灰度级和较大的明亮特征相对不变距离成比例。通常，图9.36)是闭操作的图形说明。很明显，结构元从曲线的顶部向下推动，同时平移到所有位置。当结构元从曲线的上侧滑动时，通过寻找结构元的任何部分所能到达的最低点，如图 9.36 (e)所示，就可构建闭操作。灰度级开操作满足如下性质:a）f 。bJfb）如果介→，则(f・b)-J(f,-"b）。c）（f ob)ob=(f。b)。符号e.r用来表示纪的域是r的域的一个子集，且对于e的域中的任何(G,y)，不有e(x,) ≤KX,J)。类似地，闭操作满足如下性质：a）fJf・b6）如果，。，则(,-b)3(65-b)）。c）（f-b)-b =(f-b）这些性质的用途类似于二值图像中的对应性质。灰度级开操作和闭操作的说明。例9.10图9.37将图9.36中说明的一维概念拓展到了二维。图9.37(a)与我们在例9.9使用的图像相同路2920）是使用单位高度和光径为3个像素的网盘形结构元得到的开操作结果。如预料的那样，历有亮特征的灰度都降低了，降低的程度取决于这些特征相对于结构元的尺寸。该图与图,3.0)相比，我们看与腐蚀的结果不同，开操作对图像的暗特征影响可忽略不计，，也不影响背景。类似地，。图 9.37(c)显示了使用半径为5的圆盘形结构元得到的闭操作结果(小的圆黑点比小白点大，因此要达到可与开操作相比的结果，需要更大的圆盘形结构元)。在这幅图像中，亮的细节和背景相对来说未受影响，但削弱了暗特征，削弱的程度取决于这些特征相对于结构元的尺寸。图 9.37幅大小为448×425像素的灰度级X射线图像；(b)使用半径为3个像素的圆盘形结构元得到的开操作结果；（c)使用半径为5个像素的结构元得到的闭操作结果9.6.3些基本的灰度级形态学算法许多形态学技术是以迄今为止介绍的灰度级形态学概念为基础的。下面的讨论中我们将说明这些算法。形态学平滑1691因为开操作把制比结构元小的亮细节，而闭操作抑制暗细节，所以它们常常以形态滤波的形式L园结合起来被用于图像平滑和噪声去除。考虑图9.38 （a），它显示了一锅使用×射线波段拍摄的天鹅星432。为当前讨论的目的，座环超新星图像(关于该图像的细节请参阅图1.7)假设中心的亮区域是我们感兴趣的目标，而较小的分量是噪声。我们的目的是去除噪声。图9.38 6b)显示了用一个半径为2的平坦圆盘(结构元)对原始图像开操作，再用相同尺寸的SE(结构元)进行闭操作的结果。图9.38 Cc)和(d分别显示了使用半径为3和5的结构元进行相同操作得到的结果。。如期望的那样，该图像序列显示了消除作为结构元尺寸的函数的小分量的改进。。在最后的结果中，我们着到，感兴趣的目标已被提取出图像底部的噪声分量未被完全去除，原因在于它们的密度图9.38的结果是以对原始图像进行开操作，然后再闭操作为基础的。有时使用的一个过程是执行交替顺序滤波，在该过程中，对原始图像以开操作-闭操作顺序开始，但后续步骤对前一步骤的结果再执行开操作和闭操作。。这种类型的滤波在自动图像分析中很有用，滤波过程中每一步的结果都针对对于相同大小的结构元，与图9.38中说明的方法相比，这种方法会个指定的度量进行比较。通常，产生更为模糊的结果。a b c d图 9.38a)由NASA 的哈勃望远镜在X射线波段拍摄的天鹅星座环超新星的566×566 图像；（6)-(d)分别使用半径为1, 3和5的圆盘形结构元对原图像执行开操作和闭操作顺序的结果(原图像由NASA提供)形态学梯度膨胀和腐蚀可与图像相减结合起来得到一幅图像的形态学梯度，在这里，由g来定义:8 =(f Bb)-(fGb)(9.6-11）。膨胀和腐蚀的差强调了区域间的边界。同质区域不膨胀粗化一幅图像中的区域,，而腐蚀则细化它们。受影响(只要SE 相对较小)，因此相减操作趋于消除同质区域。最终结果是是边缘被增强而同质区域的贡献被抑制掉了的图像，从而产生“类似于微分”（梯度)的效果图9.39 显示了一个例子。图9.39.(a)是一幅头部CT扫描图像，接下来的两幅图像是使用所有元素都为1的3×3结构元对该图像进行开操作和闭操作的结果。注意，刚刚提到的粗化和收缩。图9.39 (d）是使用式(9.6-11)得到的形态学梯度，其中，区域间的边界被清楚地描绘出来了，这与二维微分图像的预期相同。氢9.39(a)512×512的头部CT扫描图像；b)膨胀的结果；（c)腐蚀的结果；(d)形态学梯度，697计算图(b)和图(e)间的差(原图像由 Vanderbilt大学的David R.Pickens博士提供)694形态学图像处理顶帽变换和底帽变换图像相减与开操作和闭操作相结合，会产生所谓的Top-hat（顶帽)变换和boto-hat(底能帽)变换。灰度级图像f的顶帽变换定义为f减去其开操作:(9.6-12）Ti. )=/-(。b）类似地，f的底帽变换定义为f的闭操作减去/：B,aG（f）=（f・b)-f(9.6-13）这些变换的主要应用之一是，用一个结构元通过开操作或闭操作从一一幅图像中删除物体，而不是拟合被删除的物体。然后，差操作得到一幅仅保留已删除分量的图像。。顶帽变换用于暗背景上的亮物体，。由于这一原因，当谈到这两个变换时，常常分别称为白顶帽变换和黑而底帽变换则用于相反的情况。民帽变换顶帽变换的一个重要用途是校正不均匀光照的影响。正如我们将在下一章中看到的那样，合适(均匀)的光照在从背景中提取目标的处理中扮演核心的角色。称为分割的这一处理是自动图像分析中执行的第一步。一种常用的分割方法是对输入图像进行阈值处理。为了说明，考虑图 9.40 (a)，它显示了一幅大小为600×600的米粒的图像。该图像是在非均匀光照下得到的，如图像底部及最右侧的暗色区域就是明证。。图9.40(b)显示了对该图像使用10.3.3节讨论的 Otsu最佳阈值处理方法得到的结果。非均匀光照的最终结果导致了暗区域的分割错误(一些米粒没背景部分被错误地分类了。图9.40(e)显示了对该图像使有从背景中提取出来)，且在图像的左上角，青用一个半径为.40的圆盘形结构元进行开操作的结果。这个结构元足够大以致不会拟合任何物体如这些物体被消除了，仅留下一个近似的背景。阴影模式在该图像中很清楚。。通过从原图像结果那样，订中减太该图像(即执行顶帽变换)，背景应会变得更均幻。手实的确如此，如田1.40)所示。背绿并不是非常均匀，但亮和暗之间不再存在极端的差别，这就足以得到正确的分割结果，其中所有的米粒以前，该图像是使用Otsu方法得到的均被检测出来,，如图 9.40(e)所示。: d e冬 9.40使用顶帽变换校正阴影:(a)大小为600×600的原图像；（b)阈值处理后的图像；()用平径为 40的圆盘形结构元进行并操作的图像；の)顶帽变换的图像(图像减去其开操作)；（e)顶帽变换的图像经阈值处理的结果粒度测定1696在图像处理方面，，粒度测定是属于判断图像中颗粒的尺寸分布的领域。实践中，颗粒很少能完。形态学可间接用于估计颗粒的尺美地被分离，一个困难的任务。寸分布，而不需要识别并测量图像中的每个颗粒。这种方法原理上非常简单。对对于比背景亮且具有规则形状的颗粒，该方法由使用逐渐增大的结构元对图像执行开操作组成。。基本概念是，某个特殊尺寸的开操作应会对包含类似尺寸的颗粒的输入图像的区域产生最大的效果对于每一次并操作，计算该开操作中像素值的和。该和有时称为表面区域，它会随着结构元的增大而减小，如我们早些时候注释的那样，因为开操作会降低亮特征的灰度亥过程会得到一一个这样的数字的一维阵列，阵列中的每个元素等于对应于阵列中该位置的结构元素的大小的开操作中的像素之和。为了强调连续开操作间的变化，我们计算一一维阵列的相邻元素的差。为了形象化该结果，我们画出了该差的图形。。曲线中的峰值表明了图像中颗粒的主要大小分布。、考虑图9.41 a)，它是两种不同大小的木钉的图像。作为一个例子，。对木钉中的木颗粒可能需要引入不同的开操作，因此，平滑是一一种合理的预处理步骤。。图9.41 (6)显示了使用早期讨论过的形态学滤波器平滑后的图像，该滤波器用半径为5的圆盘形结构元。图9.41 (c)到(D显示了使用半径为10,20,25和30的圆盘形结构元对图像进行开操作的例子。注意，在图9.41 d)中，由于较小木钉，灰度的贡献几乎已被消除。。图9.41 (e)中，大木钉的贡献已被显著地降低了，图9.41 (f)更厉害。〔观察图9.41 (e）靠近图像右上方的大木钉比其暗得多，因为它的尺寸较小。如果我们试图检测有缺陷的木钉，那么这将是有用的信息1a2 F象；（c)-(f)分图 9.41a)大小为531×675的木钉图像；别用半径为10.20.25和30像素的圆盘形结构元对图像进行开操作后的结果(原图像由 MathwWorks公司的Sev Edins博士提供39.42.:显示了该差值阵列的曲线。。如前边提到的那样，我们期望半径附近的差值较大（曲线中的峰值），在该处结构元足够大，以包围近似相同直径的组颗粒。。图9.42中的结果有两个明显的峰值，这清楚地表明图像中存在两种主要的物体尺寸纹理分割图9.43(a)显示了一一幅在亮背景上添加了暗斑点的噪声图像。该图像有两个纹理区域：右边大斑点组成的区域和左边小斑点组成的区域。。目的是以纹理内容4 9.42表面区域中的差，它是圆盘形结构为基础找到两个区域的边界(我们将在11.33 节讨论纹29元半径，的函数。两个峰值表明理。如早期解释的那样，将一幅图像分为区域的处理图像中存在两个主要的颗粒尺寸称为分割，分割是第10章的话题。形态学图像处理435感兴趣的物体比背景暗，并且我们知道，，如果使用一个比小斑点大的结构元对图像做闭操作，这些斑点将被删除。在图 9.43 (b)中，使用半径为30个像素的圆盘形结构元对输入图像做闭操作的结果表明情况的确如此(斑点的半径近似为 25像素)。因此，我们得到了一幅亮背景上带有暗的大斑点的图像。如果我们使用尺寸大于这些斑点间的间隔的结构元对该图像做开操作，则最终结果应该是这样一幅图像，在该图像中，斑点间的亮的间隔已被删除，留下了暗的斑点，并且这些斑点之间现在已成为相同的暗间隔。图9.43 (c)显示了使用半径为60的圆盘形结构元得到的结果。图 9.43纹理分割：（a)由两种斑点组成的大小为600×600的图像；6)对图(a)执行闭操作后删除了小斑点的图像；（e)对图(b)执行开操作后删除了大斑点间的亮间隔的图像；(d)将图(C)中两个区域间的边界叠加到原图像上后的结果。边界是使用形态学梯度操作得到的使用一个其元素全为1且大小为3×3的结构元对该图像执行形态学梯度操作将给出这两个区域间的边界。图9.3(4)显示了将形态学梯度操作结果叠加到原图像后所得到的边界。该边界右侧的所有像素表示属于由大斑点表征的纹理区域，而该边界左侧的所有像素属于由小斑点表征的纹理区域。您将发现，若使用图9.36中对开操作和闭操作的图形模拟，那么我们可更直观地理解这一例子。9.6.4灰度级形态学重建灰度级形态学重建基本上按照与9.5.9 节针对二值图像所介绍的相同的方法来定义。令/和g分别代表标记图像和模板图像。。我们假设f很容易理解这些表达式是G,)的函数。为简化表示，我们省略了Cα.）和g是大小相同的灰度级图像，且/≤ 8。f关于g的大小为1的测地膨胀定义为Dg(f ）=(f Gb)人g.9.6-14人代表点方式的最小算子。该式指出，大小为1的测地膨胀是由先计算b对f的膨胀・然后选择在每一个α、)点处该结果和g间的最小者。。如果如是一一个平坦结构元，则膨胀由式(96-2)给出，否则膨胀由式(9.6-4)给出。了关于g的大小为n的测地膨胀定义为D:"G )= D2[2""Gr7」(9.6-15）并有DgGf)=/类似地，f关于g的大小为1的测地腐蚀定义为(9.6-16）Eg(f)=(feb)vg其中，、表示点方式的最大算子。f关于g的大小为n的测地腐蚀定义为E"0 = 2[E:"（0）(9.6-17）脚并有ES(f)=f灰度级标记图像f对灰度级模板图像g的膨胀形态学重建定义为f本节中表达式间的对偶关系列表见习题9.33关于g的测地膨胀反复迭代直至达到稳定；即(9.6-18）NR(/)=D2G）并有k应使D;"( )= D5*"(G）。f对g的腐蚀的形态学重建类似地定义为(9.6-19）R(f） = EA（f）并有人应使E%( = E*"(G）如在二值情况那样，灰度级图像重建的开操作首先腐蚀输入图像，并用它作为标记图像幅图像f的大小为n的重建开操作定义为先对f进行大小为n的腐蚀，再由f的膨胀重建；即OA"（f )= R/I(fenb)](9.6-20其中，(fenb)表示b对f的n次腐蚀，如9.5.7 节解释的那样。回忆式(9.5-27)针对二值图像的讨论,重建开操作的目的是保护腐蚀后留下的图像分量的形状类似地，图图像f的大小为n的重建闭操作定义为先对f进行大小为n的膨胀，再由f的腐蚀重建；即CA"(f)= R/f[(f Onb)](9.6-21，先其中，f Bnb)表示历对f的n次腐蚀。。因为对偶性，图像的重建闭操作可以用图像的求补得到，得到重建开操作，然后再求结果的补。最后，如下例所示，称为重建顶帽的一一种有用技术是从一幅图像中减去其重建开操作。例9.11使用形态学重建展平复杂的背景在这个例子中，我们用规格化图 9.44(a)中不规则图像背景的一一些步骤来说明灰度级重建的用途，即仅留下恒定灰度背景上的正文。这一问题的解决是形态学概念的能力的很好的说明。我们从抑制各个键顶部的水平反射开始。。在图像中反射比任何单个字符都宽，因此，我们应该能在腐蚀操作中用一条长的水平线通过执行重建的开操作抑制它们。该操作将产生包贪键及其反射的背景。从原图像减去这个背景(即个重建顶帽操作)将从原图像中消除水平反射和变化的背景。郑行一一条大小为1×71像素的水平线对原图像执行重建开操作的结果。图 9.446)显示了在腐蚀操作中用一一个开操作就除去字符，但是，得到的背景将不会如图 9.44()所示那样均匀（例如，我们已经能够仅用比较两幅图像中各个键之间的区域)。图 9.44d)显示了从图 9.44 a)中减去图 9.46)的结果。如期望的那样，水平反射和背景的变化被抑制了。为便于比较，图 9.44（e)显示了执行刚才的顶帽变换的结果(如本节之前讨论的那样，即从图像中减去“标准的”开操作)。从图9.44（C)中背景的特征可以预料,图9.44（e)中的背景不像图9.44 d)中的那样均匀。一步是从键的边缘删除垂直反射，这在图 944d)中非常明显。通过使用一个其宽度近似等于这些反射的线状结构元来执行一个重建开操作，我们可删除垂直反射(在这种情况下，结构元的宽度约为11个像素)。图9.44(6)显示了对图 9.44(d)执行该操作的结果。垂直反射被抑制了，有用学符的垂直笔划也被知化了CtasuN中的D，因此，我们不得不寻找一种饮恢复该字符的方法。由于被抑制的字符悲常靠近其他字符，因此，，如果我们水平地膨胀遗留下来的字符，则膨胀后的字符将与先前被抑制字符所占的区域重叠。。使用大小为1x21的线状结构元膨胀图 9.4()后得到的图 9.44(g)的结果显示事实的确如此。1701形态学图像处理此时所有余下的问题是复原被抑制的字符。考虑图9.44(g)中膨胀后的图像和图9.44（D中重建顶帽一幅图像。图9.44 (h)显示了最小值图像(虽然该结果着起来接近我们的目图像间点方式的最小值形成的一但SIN中仍遗漏了D。在灰度级重建中，通过将这幅图像作为标记图像，并将膨胀后的图像作为模板图像〔见式(9.618）1、我们得到如图 9.46)所示的最终结果。。这幅图像表明所有字符都已完全地从。图9.46中的背景都是均匀的。原图像的不规则青景，包括键的背景中提取出来了。(b)用腐蚀中的一条71像素长的水平图 9.44a)大小为1134×1360 像素的原图像;线对图(a)的重建开操作；（c)用相同的线对图(a)的开操作；（d)重建顶帽操作；（e)顶帽操作；(D)用11个像素长的水平线对图(d)的重建开操作；个像素长的水平线对图了的膨胀操作；Gh)图(d)和图(g)的最小操g)使用21 个作;6)最后的重建结果(原图像由 MathwWork公司的Steve Eddins博士提供）小结本章介绍的形态学概念和技术构成了从一幅图像中提取感兴趣特征的一组强有力的工具。形态学图像处理最吸引人的一一个方面就是来自形态学技术已有发展的广泛的集合论基础。实现方面的一显著优点是膨胀和腐蚀都是基本操作，它们是各类形态学算法的基础。正如下章所示，形态学可以作为广泛应用的图像分割程序的基础。如第 11章中讨论的那样，形态学技术在图像描述中也起着重要的作用。参考文献Sera1982]的书籍是关于形态学图像处理的基础性参考资料，也可以参阅Serra[1988], Giardina和Dougherty[988]及Haralick和 Shapirol 19921的著述。与我们的讨论相关的其他早期参考文献包括Blum[1967]438。关于二值形态学和灰度级形态学的综述见Lantuejoult1980], Maragost1987]和Haralick 等人[1987]等的著述。Basat和gonzalez[19921及 Basart等人[1992]的著述。这组参考文献为9.1节到9.4 节涵盖的内容提供了丰富的背景。9.5 节和 9.6 节中材料的较好综述见 Soile[2003]的论著。实现形态学算法,如9.5节和9.6节中给出的算法的重要刊物见Jones和Svalbel 1994], Park和Chin 19951]. Anelli等人[19981及 Shaked和Bruckstein1998]的论文。关于实现灰度级形态学算法Sussner 和Ritter1997],的实践细节见Vincent1993]的论文，也可以参阅 Gonzalez, Woods和Eddins2004]的书籍。关于形态学图像处理理论和应用的其他读物见Goutsias和Bloomberg200]的图书和Pautem2000]的一-期特刊。也可以参阅 RosenfeldL2000]编辑的参考文献。Marchand-Maillt和 Sharaiha[20001关于二值图像处理的书籍及Riter和Wilson20011关于图像代数学的书籍也是重要的文献。关于形态学技术在图像处理方面的应用的当前工作请参阅Kim[20051及 Evans和Liu2006]的安标有星号的习题的详细解论文心可在本书的网站上找到。该网站中还包含有基于本章内容而建议的项目。习题其他网格排列本书中的数字图像嵌人了方形排列的网格，且像素允许是4,8或m连通的。。然而，玉也是可能的。特别地，有时也会使用6连通的六边形网格排列(见下面的图形)。a）如何将图像从方形网格转换到六边形网格？b）讨论由方形网格和六边形网格表示的物体的形状旋转不变性。是否像在8连通情况下那样(见2.5.2 节)，可能存在有歧义的对角线配置？c）在六边形网格中，是・・女（a)针对把4连通的二值边界转换为m连通的边界(见2.5.2 节)给出一个形态学算法。可以假设边界是全连通的，且边界的宽度为1个像素。b）您的算法的操作需要用每个结构元进行多于一次的迭代过程吗？试解释原因c）愈的算法的性能是否与应用结构元的顺序无关？如果您的回答是无关，请证明之；否则请举出一个例子，说明您的过程与应用结构元的顺序有关。只要B的原点包含于B中，，则结构元B对集合A的腐蚀就是A的一个子集。给出腐蚀AeB位于一个例子。A之外或部分位于A之外的一下列4种说法是正确的。请给出能证明这些说法正确的论据。（a)通常是正确的；(b)到(Gd)仅对数字集合才是正确的。为了证明(b)至(d)的正确性，请画出一个离散的方形网格(如习题9.1所示)，并针对每种情况，，使用由该网格上的点构成的集合给出一个例子。(提示：在仍能确定这些说法的尽可能保持每种情况下的点数最少。正确性时，一个凸结构元对一个凸集的腐蚀仍是- (a）用一一个凸集(b）用一一个凸结构元对一个西集的膨胀并不总是凸的。Cc）一个数学西集内的点并不总是连通的。d）有可能在在一个这样的点集，在该集合中，连接每个点对的线位于该集合内，但该集合不是凸的女9.5参考所显示的图像，给出生成图(a)至图(dの所示结果的结构元和形态学操作。请清晰地说明每个结L构元的原点。图中的虚线表示原始集合的边界，仅供参考显示。注意图(d)中的所有角都是圆角。形态学图像处理4391 "|I 1[Ld）令A表示右图中阴影所示的集合。参考所示的结构元(黑点表示原点)，画出下列形态学操作的结果:2.6(a)(AeB*)6B*(b）(AGB")6B(c）(AeB*)9B"(d）（A9B)9B(a）反复膨胀一幅图像的极限效果是什么？中限幕假设不使用只有一个点的结构元。(b）为使(a)的答案成立，您能从其开始的最小图像是什么？2.8a）反复腐蚀一幅图像的极限效果是什么？假设不使用只有一个点的结构元。(b）为使(a)的答案成立，您能从其开始的最小图像是什么？9.9腐蚀的另一种可替换定义是eB=={we Zflw+be A，对于每个be B}正明该定义等价于式(9.2-2)中的定义。9.10(a）证明习题9.9中给出的腐蚀定义，仍等价于如下腐蚀的另一一个定义：I 1AD-bA G8 =(若用b代替-b，则该表达式称为两个集合的闵可夫斯基相减。）(b）证明(a)中的表达式也等价于式(9.2-2)的定义。膨胀的一个可替换的定义是女9.11498={we Zflw=a+b、对于一些ae A和be B}正明该定义等价于式(9.2-4)中的定义9.12 Ga）证明习题9.11中给出的膨胀定义，等价于如下关于膨胀的另一个定义：A田8=U(A)该表达式也称为两个集合的闵可夫斯基相加。b）证明(a)中的表达式也等价于式(9.2-4)中的定义。2.13证明式(9.2-6)和式(9.2-5)中对偶表达式的正确性。03★9.14证明对偶表达式(A-B)" =(A*。B)和(A。B)* =(4*・B)的正确性。409.15证明下列表达式的正确性：一个子集(子图像）k(a) A。B是A的一一个子集，则C。B是D。B的一个子集。b）若C是D的c) (A。B)。8=AoB证明下列表达式的正确性〔假设B的原点包含在B中，且习题9.14和习题9.15为真]:9.16一个子集(子图像）(a) A是A・B的一b)若C是D的一一个子集，则C・B是D-B的一个子集。c）(A・B)・B=A・B。9.17参考下图所示的图像和结构元。画出经如下操作后集合C,D,E和C=AOB,D=C田B;E=DGB;F= E9B。初始集合矿是什么：CA由显示为白色的所有图像分量组成，但结构元B除外。。注意,这些操作仅是先用B对A进行简单的开操作，接着用及对开操作的结果进行闭操作。愈可以假设B刚好大到包围每个噪声分量。考虑下图所示的3幅二值图像。左侧的图像由边长为1,3,5,7,9和15像素的方块组成。女9.18。中间的图像是使用大小为13x13像素、元素为1的方形结构元对左侧图像进行腐蚀生成的，除了最大的几个之外，消除了所有的方块。最后，右侧的图像是使用相同的结构元对中间图像膨胀后的结果，其目的是恢复最大的方块。您知道，先腐蚀再膨胀实际上是对图像的开操作，并且您还知道开操作通常不能将物体恢复为原始形式。请解释这种情形下为何能完全重建较大的方块。画出对右侧图像应用击中或击不中变换得到的结果和结构元。9.19清楚地指出愈为结构元选取的原点和边界。用于区分图像中细化后物体的三个特征(湖泊、湖湾和线段)如下UT K图所示。开发一种区分这些形状的形态学/逻辑算法。算法的输之一。输出必须是输人的特征。可以假设这些特入是这三种形状征的宽度都为工像素，且每个特征都是完全连通的，然而，它们出现时的方向可以是任意的。构元时L705|线段湖泊707水在下列每种情况下，讨论愈期望得到的结果是什么9.21形态学图像处理441a) 9.5.2 节中孔洞填充算法的起始点是物体边界上的一点。b）该孔洞填充算法中的起始点位于物体边界之外。ce）使用 95.4 节中给出的算法，计算习题 96 中图形的凸壳外表特征是什么。请画出计算出的凸壳。假设L为4个像素.22* (a）若使用图9.15 Cc)中给出的结构元来替代图 9.136b)中给出的结构元，试讨论对提取边界的影响。b）在式(9.5-2)给出的孔洞填充算法中，若使用元素值为1、大小为2×2的结构元代替图 9.15（c）听示的结构元，，请问会有什么影响？2.23★ (a）针对图 9.16中的自动化例子，请提出一一种方法(使用9.1节到9.5 节的任何技术)。可以假设球体互不接触，并且不接触图像的边界。b)重复(a)，但允许球体以任意方式接触，包括接触边界9.24节中给出的提取连通分量的算法，要求在每个连通分量中有一一个点是已知的，以便提取所有9.5.3一幅包含任意数量(未知)连通分量的二值图像。。请提出一种完全自动化地提取的点。假如您已有假设属于连通分量的点标记为1，背景点标记为0。所有连通分量的过程.25给出一个基于膨胀重建的、能提取一幅二值图像中的所有孔洞的表达式。2.26参考9.5.9 节中的孔洞填充算法:a）如果f的所有边界点都是1，解释会发生什么情况。b）如果(a)中的结果是您所希望的结果，请解释原因。如果不是，请解释如何改进该算法，以便算法能像您所期望的那样工作。如果结构元是值为1的单个点，解释二值图像的腐蚀和膨胀将会发生什么情况。对于您的回答，9.27请给出原因。9.28如式(9.5-27)和 9.6.4 节中解释的那样，重建开操作可保持腐蚀后保留的图像分量的形状。请问重建闭操作的作用是什么？。也就是说，女9.29证明测地腐蚀和测地膨胀(见9.59 节)关于补集对偶。、证明E8"(F)=1D9I1Dg"(F")ITr，反之D8°(F)=[E8[E82(F")]"。假定结构元关于其原点对称。.30证明膨胀重建和腐蚀重建(见 9.5.9节)关于补集对偶。也就是说，证明R(F)=[R慧(F")"，反之，RE(F)=1R2(F")F"。假定结构元关于其原点对称。亦然，提出一个论据证明：9.31ab [(F OnB)F =(F* GnB)，其中(FGnB)]表示B对F的n次腐蚀。(b） [(FGnB)"* =(F*SnB）证明二值重建闭操作与重建开操作关于补集对偶，即O%°(F)=ICA"(F")"并且，类似地，2.32CA"(F)= [OA"(F“)厂”。假设结构元关于其原点对称。.3证明下列灰度级形态学表达式的正确性。您可以假设b是一个平坦结构元。回忆一下，f“(x, y) =f(x,y)且b(x,y)=b(-x,-y)）。（a）腐蚀和膨胀的对偶性：:(f Gb)* = f" GBb和(f Bb)* = f"ObOD）（C-b) = /*。万和(。b* *-56t (e） D;"( )=1E91E;-"( " )Tr和E;"G )=10D91D:"G")T"。假设一个对称结构元。(d） Rg(f ）=[R. f")广和Rs（f)=[Rg（f")厂。e）Gf Omb)" =(f"mb)，其中，（ OmDb)表示b对f的n次腐蚀。还有，I(G Omb)r = （f"enb。707( OA"(f )=[CA”Gf" )"和CA”Gf)=[0%°(F")J"。假设结构元关于其原点对称708数字图像处理(第三版)9.34在图 9.43 中，建立两个不同纹理区域间的边界并不困难。考虑下图，它显示了二个由大圆区域包围的小圆区域。a）用于生成图 9.43(dの的方法也可用于该图像吗？解释您的理由，包括为使该方法处理而需要做出的任何假设。(b）如果您的回答是肯定的，请画出边界的外表特征。幅灰度级图像fα,)被非重叠的噪声尖刺所污染，J.35它们可以用半径为Rm幅度为SKma≤ Am的较小的圆柱形干扰来建模。一种清理该图像的形态学滤波方法。(a）请开发一b)重复(a)，但现在假设最多存在4个重叠的噪声尖刺。显微应用中一个预处理步骤是从两组或更多组重叠的类似颗粒(见右图)9.36 中分离出单个独立的一种圆颗粒。。假设所有颗粒的大小相同，提出一种产生3幅图像的形态学算法，这3幅图像分别仅由如下物体组成一(a）仅与图像边界融合在一起的颗粒。b）仅彼此重叠的颗粒。c）没有重叠的颗粒。9.37-家高技术制造工厂获得了一份制造形如下图的高精度垫圈的政府合可。合同要求使用一个图像系统来检测所有垫圈的形状。在合同文本中，形状检测是指检测垫圈内边缘和外边缘的偏差。。您可以假定：（一幅可接受的蛰圈的“金”像是可用的(关于该习题而言的一一幅完美图像)；(2）该系统中最终使用的成像和定位系统的精度可高到足以允许您忽略数字化和定位引起的误差。假设您被聘为该系统视觉检测部分的顾问。请基于形态学/逻辑操作，提出一种检测方案。请以方框图的形式给出您的答案。整体等于其部分之和欧几里得整体大于其部分之和Max Wertheimer引言从前一一章的资料开始了一个转变，即从输入和输出都是图像的图像处理方法，转到了输入为图像而输出为从这些图像中提取出来的属性的图像处理方法(在1.1节中的定义的意义上)。分割是这一方向的另一个主要步骤。分割将图像细分为构成它的子区域或物体。。细分的程度取决于要解决的问题也就是说，在应当感兴趣的物体或区域已经被检测出来时，用中，兰，就停正分割。例如，在电子元件的自动检测中，我，客观地确定是否存在特定的异常现象，如丢失元件或断裂的连线。门关注的是分析产品的图像，。超过识别这些元素所需细节的分割是没有意义的。异常图像的分割是图像处理中最困难的任务之一分割的精度决定着计算分析过程最终的成败因此，应该对改进准确分割的可能性给予相当的关注。在某些情形下，比如在工业检测的应用中，少对环境某些范围的典型控制还是可能的。有经验的图像处理系统设计师总是非常关注这种机会。在其他应用中，比如自主目标获取，系统设计者无法控制操作环境，常用方法是将注意力集中于传感器类型的选择上，在减少图像无关细节的影响的同时，很可能增强感兴趣物体。一个很好的例子是军方使用红外线成像来检测有着较强热特性的物体，如运动中的装备和部队。本章中的多数分制算法均基于灰度值的两个基本性质之一:不不连续性和相似性。。在第一类中，方法是以灰度突变为基础分割一幅图像，比如图像的边缘。在第二类中，主要方法是根据一组预定义的准则将一幅图像分割为相似的区域。阈值处理、区域生长、区域分基于多个灰度(亮度)值的分割技术裂和区域聚合都是这类方法的例子。在本章中，我们将讨论和说明这的计论，见67节和10381些方法，并说明综合运用不同种类的方法可以改善分割的性能，例如，边缘检测就结合了阈值处理的技术。我们还将讨论基于形态学的图像分割。。这种方法特别有吸引力，因为它基于本章第一部分给出的技术，结合了分割的一些值得肯定的属性。最后，我们将以分割中运动线索运用的简单讨论结束本章。10.1基础知识T令R表示一幅图像占据的整个空间区域。我们可以将图像分割视为把R分为n个子区域R,R,.…，712R,的过程，满足:数字图像处理(第三版）gR, =R。a）(b）R,是一关于连通集的时论、请参阅252节。一个连通集，i=1,2,…,n 。(c））R,nR,=0，对于所有i和j,i≠j。i=1,2,.…，n(d）Q(R,)= TRUE,(e Q(R,U R)= FALSE，对于任何R和尺的邻接区域。其中，Q(R。）是定义在集合R。的点上的一个逻辑属性，并且0表示空集。。如2.6.4 节中定义的那样，。如2.5.2 节中讨论的那样，若R和R,的并形成一符号U和n分别表示集合的并和交。一个连通集，则我门说这两个区域是邻接的条件(a)指出，分割必须是完全的；也就是说，每个像素都必须在一一个区域内。条件(6)要求一区域中的点以某些预定义的方式来连接(即这些点必须是4连接的或8连接的，就像2.5.2节中定义的那样)。条件(c)指出，各个区域必须是不相交的。条件(d涉及分割后的区域中的像素必须满足的属例如，如果R,中的所有像素都有相同的灰度级，则Q(R,) = TRUE。最后，条件(e)指出，两个邻接区域,和R,在属性Q的意义上必须是不同的一。我们看到，分割中的基本问题就是把这样，一幅图像分成满足前述条件的多个区域。通常，针对单色图像的分割算法基于处理灰度值的两类特性之不连续性和相似性。在第一类特性假设这些区域的边界彼此完全不同，且与背景不同，从而允许基于灰度的局部不连续性来进行边界检测。基基于边缘的分割是这一一类中所用的主要方法。第二类中基于区域的分割方法是浪据事先定义的一一组准则把一一幅图像分割成相似的几个区域。图10.1说明了前述概念。图10.1 (a)幅在恒定灰度的暗背景上叠加一个恒定灰度区域的图像。这两个区域构成了整个图像区域正示了一图 10.1(6)显示了基于灰度的不连续性来计算内部区域的边界所得到的结果。边界内侧和外侧的点，因为在这些区域中灰度不存在不连续性。为了分割该图像，我们对该边界上或该边都是黑色(0)，界内的像素分配了一个个灰度级(譬如白)，而对该边界外部的所有点分配了另一个灰度(譬如黑）图 10.1 C)显示了这一处理方法的结果。我们看到，该结果满足本节开始时说明的条件(a)到(c)。条件(心的属性是：如果一个像素位于边界上或边界内，则将其标为白色；否则标为黑色。我们看到，在图10.1 （c）对于标为黑色和白色的点，该属性为“真”。类似地，，两个分割后的区域(物体和背景)满足条件(e)。下面三幅图像说明了基于区域的分割。图10.1 (d)类似于图10.1 (a)，但内部区域的灰度形成了幅纹理模式。图10.1 (e)显示了计算该图像的边缘的结果。很清楚，灰度中的大量寄生变化使得识别一边界很困难，因为很多非零灰度变化连接到了边界上，故基于边缘的分割不是一种原图像中的唯合适的方法。。然而，我们注意到，外部区域是恒定的，因此，我们需要解决的这个简单分割问题的全部就是区分纹理区域和恒定区域的一个属性。像素值的标准差是完成该任务的一一种度量，因为在纹理区域标准差非零，而在其他区域标准差为零。图10.1 (f)显示了将原图像分成大小为4×4 的几个子区域后的结果。若某个子区域中的像素的标准差为正(即如果属性为““真”），则将该子区域标记为白色；其他为零。其结果是在区域边缘周围有“块”效应出现，因为4x4 的方块组被标记为相同的灰度。最后，注意这些结果也满足本节开始处说明的5个条件。-般来说、Q可以是一一个复合表达式。例如，如果风中像素的平均灰度小于m，且如果它们的灰度的标准差大于α，其中mHlα。是指定的常数，则QKR)= TRUE。445图10.1(a)包含恒定灰度区域的图像;良，该图像是由灰度不连续性获得的；（o)将(b)显示内部区域边界的图像,图像分割成两个区域后的结果；)包含一个纹理区域的图像：e)计算边缘后的结果。注意，由于存在大量连接到原始边界的小边缘，仅使用边缘信息是很难找到一条唯一的边界的；的)基于区域特性的分割结果10.2点、线和边缘检测本节将集中在以灰度局部剧烈变化检测为基础的分割方法上。我们感兴趣的三种图像特征是孤立点、线和边缘。边缘像素是图像中灰度突变的那些像素，而边缘(或边缘线段)是连接的边缘像素的集合(关于连接性的定义、见235.22)。边缘检测器是设计用来检测边缘像素的局部图像处理力法:线可视为一条边缘线段、该线两侧的背景灰度要么远亮于该线像素的灰度，要么远暗于该线像素的灰102.4节中讨论的那样，线会引起所谓的度。事实上，如下节及“屋顶当我们说到线时，实际上是指那力缘”类似地，孤立点可视为一条线，只是其长度和宽度都为一个像素。些较细的结构，它通常只有几个像素粗，譬如数字化后的建筑设计图背景知识10.2.1中的线，或卫星图像中的道路。，假设平均处理类似于积分,正如在2.6.3 节和3.5.1 节我们所着到的局部平均平滑一幅图像那样，对于灰度的突变，局部变化可以用微分来检测应该并不奇怪。由于变化非常短促，因此一阶微分和二阶微分特别适合于这种目的。数字函数的导数可用差分来定义。就像3.6.1 节中解释的那样，近似这些差分的方法有多种，但对于用于一阶导数的任何近似，我们要求：（1)在恒定灰度区域必须为零；（2)在灰度台阶或斜坡开始处必须不为零：(3)在沿灰度斜坡点处也必须不为零。类似地，对于所用的二阶导数的近似，我门要求：（1)在恒定灰度区域必须为零；(2)在灰度台阶或斜坡的开始处和结束处必须不为零；(3)沿灰度斜坡必须为零。因为我们处理的图像样本间的增量定义为1，因此在，最大可能的灰度变化也是有限的，是数字量，，故它们的值是有限的，式1.2-10的推导中使用了Ax=1。且在其上发生变化的最短距离是在两个邻接像素间的距离。我们按如下方式来得到一一维函数fo)在点x处的导数的近似：将函数f(x+Ax)展开为关于x的泰勒级数，令Ax=1，且只保留该级数的线性项(见习题10.1)。结果是数字差分(10.2-1）光我们考虚一个两变量的翻终两数，2为工表示的一致性，这里我们使用了偏微分，此时、亿15我们将处理沿两个空间轴的偏微分。很明显，当函数了只有一个变量时，有a/ 0x*=4 /d446对式(10.2-1)关于x微分，我们得到一一个二阶导数表达式2=/(2=f(x+1)-f′(x）Rx众= f(x+2)- f(x+1)- f(x+1)+ f(x)=f(x+2)-2f(x+1)+ f(x)其中，第二行来自式(10.2-1。这一展开是关于点x+1的。我们的兴趣是关于点x的二阶导数，故将上式中的变量减1后，得到f10.2-2）=f"(x)= f(x+1)+ f(x-1)-2f(x）。为了说明这很容易证明式(10.2-1)和式(10.2-2)满足本节并始时说明的关于一阶和二阶导数的条件。，该图像中包含有不同的实心物体、、一条线和单个噪声点。图10.2 (b）图10.2(a)显示了一一幅图像显示了近似通过该图像中心的水平灰度剖面(扫描线)，其包括孤立点。实心物体和沿扫描线的青景之间的灰度过渡显示了两种类型的边缘：斜坡边缘(左侧)和台阶边缘(右侧)。正如稍后我们要讨论的那。图10.2(C)显示了剖面线的简化，，构成曲线的洋，灰度过渡涉及较细物体，如常称为屋顶边缘的线。一条线和物体的边缘时在数量上分析一阶导数和二阶导数的特点刚好足够我们在遇到一个噪声点、性。在这幅简化图中，斜坡的过渡跨越4个像素，噪声点是单个像素，线为3个像素粗，灰度台阶的过渡发生在邻接像素间。为简化起见，灰度级数限制为8级。图像条带因LTo[o To |6|o|o「o[o|i3ilolo lolo|z|717|7|・・阶导数阶导数图10.2(a)图像:(b)通过该图像中心的水平灰度剖面，包括孤立噪声点:：(c)简化后的剖面线(为清楚起见，，点已用虚线连接起来)。图像条带对应于灰度剖面曲线，方框中的数字是剖面线中所示的点的灰度值。导数是使用式(10.2-1)和式(10.2-2)得到的图像分+47现在我们考虑当从左到右横穿该剖面时一阶导数和二阶导数的性质。首先，我们注意到在灰度斜坡的开始处并沿着整个灰度斜坡，一阶导数不为零，同时二阶导数仅在斜坡的开始处和结尾处不为零。因为数字图像的边缘类似于这种类型的过渡，故我们断定一一阶导数会产生“粗”边缘，而二阶导数则会产生细得多的边缘。接下来，我们遇到孤立噪声点。该点处的二阶导数响应幅度远强于一阶导。这样，我们数响应幅度。这并不意外，因为在增强剧烈变化方面，二阶导数要比一阶导数更为激进。就可以预期，在增强细节(包括噪声)方面二阶导数远强于一阶导数。在本例中线是如此之细，以至于它也是更精细的细节，并且我们再次看到二阶导数的幅度更大。最后，我们注意到在斜坡和台阶边缘中，进入边缘和离开边缘过渡时的二阶导数的符号相反(从负到正或从正到负)。正如我们在 10.2.6 节中“双边缘效应””是可用于定位边缘的一种重要特性。二阶导数的符号也可用于确定显示的那样，这种个边缘是从亮到暗(负二阶导数)过渡还是从暗到亮(正二阶导数)过渡，这里，当我们移进边缘时,就观察到这个符号。总之，我们得出如下结论:D)一阶导数通常在图像中产生较粗的边缘；2》三阶导数对精细细节，如细线、孤立点和噪声有较强的响应；（3)二阶导数在灰度斜坡和灰度台阶过渡处会产生双边缘响应；（4）二阶导数的符号可用于确定边缘的过渡是从亮到暗还是从暗到亮。用于计算图像中每个像素位置处的一阶导数和二阶导数的可选择方法是使用空间滤波器。对于图10.3中的3×3滤波器模板，该过程是计算模板系数与被该模板覆盖的区域中的灰度值的乘积之和。参考式(3.4-3)，模板在该区域中心点处的响应是也就是说，(10.2-3）R=wZ +*2.+…+ *%乙,Wkz。其中z是像素的灰度，该像素的空间位置对应于模板中第人个系数的位置。。3.4 节和3.6节中已详细讨论了对图像中所有像素执行这种操作的细节。换句话说,，基于空间模板的导数的计算是用这些模板对一幅图像进行空间滤波，正如在那些章节描述的那样"。10.2.2孤立点的检测基于前一-节得到的结论，我们可知点的检测应以二阶导图10.3一个普通的3×3空间滤波器掩模数为基础。由3.6.2 节的讨论，，这意味着使用拉普拉斯:afv”f(x, )=10.2-4axoy其中，偏微分用式(10.2-2)得到：(10.2-5）axf和10.2-6）力の像343节中解释的那样，式(19:2-232努么是由式(434+1)给出的空间相关的简化表示，要么是由式3.42给出的空间卷积的简化表示。因此・当在一幅图像中的所有位置处计算R时，结果都是一个阵列。本章中的所有空间滤波操作都是使用相关完成716的。在热些情形下・我们通擀会健用术语“模板与图像卷积"。但是，我们仅在速波器是对称速波器时才使用这一术语，因为718这一情形下相关和卷积会产生相同的结果。48故拉普拉斯是10.2-7）V/f(x, y)= f(x+1, y)+ f(x-1, y)+ f(x, 9+1)+ f(x,y-1)-4f(x,Jy)我如3.6.2节中解释的那样，该表达式可以用图337a)中的模板来实现。此外，，如该节描述的那样,们可以把式(10.2-7)扩展为包括对角项，并使用图3.376b)中的模板。使用图10.4 (a)中的拉普拉斯模板，它与图3.37(b)中的模板相同，，如果在某点处该模板的响应的绝对值超过了一一个指定的阈值，么我们说在模板中心位置(α,y处的该点已被检测到了。在输出图像中，这样的点被标注为1，而所有其他点则被标注为0，从而产生一一幅二值图像。换句话说，输出是使用如下表达式得到的:「R(x, y)1≥710.2-8）8(x, y)=其他0,该式简单地度量一个像素及其8个其中，g是输出图像，T是一个非负的阈值、R由式(10.2-3)给出。相邻像素间的加权差。从直观上看，这一概念是一个孤立点的灰度将完全不同于其周围像素的灰度，因而，使用这种类型的模板可很容易地检测出这个孤立点。考虑的重点仅仅是灰度的不同对于研究孤立点已很充分了。注意，通常对于一个导数模板，这些系数之和为零表明在恒定灰度区域模板响应将是0。模板；6)带有一个通孔的涡轮叶片的X射线图像。该通孔含图 10.4(a)点检测(拉普拉斯)有一个黑色像素；e)模板与图像卷积的结果；《d)使用式(10.2-8)得到的结果，结果中显示了一个点(为便于观看，该点已被放大)(原图像由X-TEK Systems有限公司提供例10.1图像中孤立点的检测。借助于图10.460)，我们来说明如何从一幅图像中将孤立点分割出来。该图像是一一幅喷气发动机涡。图像右上象限中的叶片有个通孔，该通孔中已嵌入一个黑色像素。图10.4(c）轮叶片的X射线图像。是将点检测模板应用到该幅X射线图像后的结果，图10.4(d显示了当T取图10.4c)中像素的最高绝对值的90%时，应用式(10.2-8)所得到的结果。在这幅图像中，这个单一像素清晰可见(为增加其可视性，该像素已被人为放大)。这种类型的检测过程相当特殊，因为它基于单个像素位置处灰度的突变，这些位置被检测模板区域中的同质背景所围绕。当这一条件不能满足时，则本章中讨论的其他方法会更适5合于检测灰度变化。图像分割44910.2.3线检测基于102.中的讨论、我们知道・、对于线检测・可以预期二阶导复杂度更高的检测是线检测。数将导致更强的响应，并产生比一阶导数更细的线。这样，对于线检测，我们也可以使用10460二阶导数的双线效应必须做适当的处理。下面的例子说明了这一处理过程。中的拉普拉斯模板，记住，例10.2用拉普拉斯进行线检测一幅 486×486电子电路的接线掩模的一部分(二值图像)，图10.5 (6)显示了其拉普拉图10.5 (a)显示了斯图像。因为拉普拉斯图像包含有负值，为便于显示，做比例调节是必要的。如放大部分显示的那样，中等灰度表示零，较暗的灰色调表示负值，而较亮的色调表示正值。在放大部分，双线效应清晰可见。首先，负值看起来可通过取拉普拉斯图像的绝对值来简单地处理。然而，如图 10.5(c)所示，该方法一个更合适的方法是仅使用拉普拉斯的正值(在有噪声的情形下，我们使用超过正阈会使线的宽度加倍。值的那些值，去掉那些由噪声导致的零附近的随机变化)。如图10.5(d)中的图像所示，这种方法产生了更细的线，，这些线更有用。注意，在图10.5(6b)到图10.5 (d)中，当线的宽度比拉普拉斯模板的尺寸宽时，这些线就被一一个零值“山谷”分开了。i b c d图 10.5Ca)原图像；(b)拉普拉斯图像，放大部分显示了拉普拉斯的正/负双线效应；C)拉普拉斯的绝对值；d)拉普拉斯的正值当把这个3x3 滤波器居中放在一条宽为5个像素的恒定灰度线上时，其响这是预料之中的。例如，应将为零，这样就产生了刚才提到的效应。当我们谈论线检测时，假设这些线要细于检测子的尺寸。不满足这一假设的线最好当做区域，并使用本节稍后讨论的边缘检测方法来处理。图10.4(a)中的拉普拉斯检测子是各向同性的，因此其响应与方向无关(相对于该3×3拉普拉斯模、水平方向和两个对角方向)。通常，我们的兴趣在于检测特定方向的线拔的4个方向：垂垂直方向一幅具有恒定背景并包含各种线(方向为0°，考虑图 10.6 中的模板。一个模板对一。假设使用第一20°）的图像进行滤波。最大响应将出现在图像中通过该模板中间行的一条水平线处。通过勾画一1的简单阵列，并画一条水平穿越该阵列的具有不同灰度(假七系为回忆 2.4.2节可知图像轴约定如设为5)的线，，可很容易地验证这一点。类似的实验表明,，图10.6中的。原点位于左上角、正，轴指向正）轴指向有方。本节中讨第二个模板对于 45°方向的线有最佳响应；第三个模板对于垂直线有仑的线的角度是指相对于正工轴度最佳响应；第四个模板对于-45°方向的线有最佳响应。每个模板的首量的角度。例如、垂直线的角度为一个比其他方向更大的系数(如 2)加权。每个模板中的系数选方向用一+45°线向右下方向延伸。之和为零，这表明恒定灰度区域中的响应为零。790 当其系数之和为零的掩模与一幅图像进行卷积时，结果图像中的像素之和也为零(见习题亿z21像素。比例调节的目的是，使所有的负值适合于显示。线检测模板。角度是相对于图2.18 b)中的坐标轴系统的图 10.6令R,.R、.R,和尺表示图10.6 中从左到右的各个模板的响应，其中R值由式(10.2-3)给出。假设个模板对一幅图像滤波。在该图像中的某个给定点处，如果使用这4个注意、这里使用R米表示模板响对于所有j≠k有IRJ>IRJ，则称该点可能与模板人方向的一条线更相应，而10.1 节中则用来表示区域.似。例如，如果在图像中的某个点处，对于； = 2.3.4有1R,|>IRJ，则请不要混淆。说该点可能与一条水平线更相似。。换句话说，我们可能对检测特定方，我们会使用与该方向相关的模板，并对其输出进行阈值处理，就像向上的线感兴趣。。在这种情况下，在式(10.1-2)中那样。换句话说，，如果我们对检测图像中由给定模板定义的方向上的所有线感兴趣则只须简单地对该图像运行这个模板，并对结果的绝对值进行阈值处理。留下的点是有最强响应的点，对于1个像素宽度的线来说，相应的点最接近于模板定义的方向。下例说明了这一过程。例10.3特定方向线的检测图 10.7a）显示了前一例子中所用的图像。假设我们的兴趣在于寻找所有的宽度为1个像素、方向为45*的线。为了这学目的，我们使用图10.6中的第二个模板。图10.76)是用该模板对图像滤波后的结果。如之前那样，图10.7(6)中比背景暗的色调对应于负值。图像中有两个取向为+45°方向的主要线段:个在左上方，一个在右下方。。图10.7(C)和d显示了图10.7(6)中对应于这两个区域的放大部分。注意,另一图 10.7G)中的直线段比图10.7(e)中的该线段亮得多。原因是图 10.7a)中右下方线段的宽度为1个像素，而左上方线段的宽度则不是。该模板被“调谐”到检测+45°方向的」个像素宽的线，我们期望，当检测这样的线时，其响应较强。图10.7(e)显示了图10.76)的正值。因为我们的兴趣在于最强响应，我们令T等于图10.76e)中的最大值。图10.7(0使用白色显示了其值满足条件g2T的点，其中。是图10.76e)中的图像。该图中的孤立点是对模板也有类似强响应的点。在原图像中，这些点与它们的邻点都按这样一种方法米取向，即模板在这些位置会产生最大的响应。。用图10.4a)中的模板可检测这些孤立点，然后删除这些点；或者可以使用上一章中讨论的形态学算子来删除这些孤立点。边缘模型10.2.4边缘检测是基于灰度突变来分割图像的最常用的方法。我们从介绍一些边缘建模的方法开始・然后讨论一些边缘检测力法:边缘模型根据它们的灰度剖面来分类。台阶边缘是指在1个像素的距离上发生两个灰度级间理想的过渡。图10.8 a)显示了一个垂直台阶边缘的一部分和通过该边缘的一个水平剖面。例如，用于诸如固体建模和动画领域的出现在由计算机生成的图像中的台阶边缘。这些清晰、理想的边缘可出现车1个像素的距离上，不需要提供任何使它们看上去“很真实”的附加处理(如平滑)。在算法开发中,一个台阶边缘模型数字台阶边缘常用做边缘模型。例如，10.2.6 节中讨论的坎尼边缘检测算法就是用一推导的。图像分割451(a)接线板掩模图像；(b)使用图10.6 中的+45°线检测子模板处理后的结果；图 10.7(C)图(b)左上方区域的放大观察图;(d)图(b)右下区域的放大观察图；（e)将图(6)中所有负值置为零后的图像；()其直满足条件g≥7的所有点(白色)，其中g是图(e)中的图像〔为便于查看，图(D中的点已被放大」从左到右分别为一一个台阶模型、个斜坡模型和一个屋顶边缘模型(理想表示)及它们的相应灰度剖面图 10.8实际中，数字图像都存在被模糊且带有噪声的边缘，模糊的程度主要取决于聚焦机理(如光学成像中的镜头)中的限制，而噪声水平主要取决于成像系统的电子元件。在这种情况下，，边缘被建模为个更接近灰度斜坡的剖面，如图 10.8(6)中的边缘。。斜坡的斜度与边缘的模糊程度成反比。在这一一个边缘点现在是斜坡中包含的任何点，而一奘型中，不再存在一条细的(1像素宽）轨迹。相反，条边缘线段将是一组已连接起来的这样的点。边缘的第三种模型是所谓的“屋顶”边缘，这种边缘具有图10.8 (c)所示的特性屋顶边缘是通过一个区域的线的模型，屋顶边缘的基底(宽度)由该线的宽度和尖锐度决定。在极限情形下，当其基底为1个像素宽时，屋顶边缘只不过是一条穿过图像中一一个区域的一条1像素宽的线。例如，深度成像中，当细物体(如管子)比它的等距离的背景(如墙)更接近传感器时，出现屋顶边缘。管道更亮，因而产生了一幅类似于图10.8.(c)中模型的图像。如先前提及的那样，经常出现屋顶边缘的其他领域是在数字化的线条图和卫星图像中，此时如道路这样的较细特征可由这种类型的边缘建模。三种类型边缘的图像并不罕见。虽然模糊和噪声会导致与理想形状的偏差，包含所有三，但图像中有适当锐度和适中的噪声的边缘确实存在类似于图10.8中边缘模型的特性，女如图10.9所示的剖面图10.8中的模型允许我们在图像处理算法的开发中写出边缘的数学表达式。这些算法的性能将取决于实际边缘和在算法开发中所用模型之间的差别。图10.10(a)显示了从图日 10.86b)中的一段中提取出来的一幅图像。图10.10 6b)显示了一条水平灰度剖面线。该图形还显示了灰度剖面的一阶导数和二阶导数。如10.2.1节中讨论的那样，当沿着灰度剖面从左到右移动时，我们注意到，在斜坡的开始处和在斜坡上的各个点处，一阶导数为正。而在恒定灰度区D有着几个像素的剧烈斜率的斜坡边缘，通常被当做台阶边缘处理，自的是由同一图像中斜率更为舒缓的斜坡来对它们进行微分域的一一阶导数为零。。在斜坡的开始处,二阶导数为正；在斜坡的结束处,二阶导数为负；在斜坡上的各点・三阶导数为零，在恒定灰度区域的各点处,二阶导数为零。对于从亮到暗过渡的边缘，刚刚讨论的处，导数的符号则正好相反。零灰度轴和二阶导数极值间的连线的交点称为该二阶导数的零交叉点图 10.9显示了(放大后的)实际斜坡(左下台阶(右上)和屋顶边缘剖面的一一幅大小为 1508×1970的图像。在由小圆所示短线段指出的区域中，剖面从暗到亮。斜坡和台阶剖面分别跨越9个像素和2个像素。屋顶边缘的基底是3个像素(原图像由Vadertit大学的David R. Pickens博士提供）由这些观察我们可以得出结论：一阶导数的幅度可用于检测图像中的某个点处是否存在，二阶导数的符号可用于确定一个边缘像素位于该边缘的暗的一同样，一侧还是亮的一侧。我们注意到围绕一条边缘的二阶导数的两个附加性质：：（1)对图像中的每条边缘，二阶导数生成两个值(一条不希望的特点)；（2)二阶导数的零交叉点可用于定位粗边缘的中心，正如我们将在本节稍后将要说明的那样。某些边缘模型可用来在进入和离开斜坡的地方平滑过渡(见习题10.7）。然而，使用这些模型得到的结论与使用一个理想斜坡得到的结论相同，具用后者可简化理论公式。最后，尽管迄今为止我们的注意力限制在一一维水平剖面上，但类似的结论适用于图像中任何方向的边缘。我们简单地定义了个在任何期望的点与边缘方向垂直的剖面，，并用刚刚讨论的对垂直边缘相同的方法对结果进行了解释水平灰度剂面阶导数阶导数零交叉冬 10.10a由一条理想垂直边缘分开的两个恒定灰度区城：OD）边缘附近的细节，显示了一一个水平灰度剖面及其一阶导数和二阶导数图像分割453一条有噪声边缘的一阶导数和二阶导数的性质。例10.4擎个图像段的导数计算将在下图 10.8 中的边缘是无噪声的。图10.11中第一列图像段是4个斜坡节中过论。现在，我们的目的只是这些边缘从左边的黑色区域到右边的白色区域过渡(记住，边缘的特写，分析灰度剖面。个单一的边缘)。左上方的图像段无噪声。从黑到白的整个过渡是一第列中的其他三幅图像被均值为零、标准差分别为0.1.1.0和10.0个灰度级的加性高斯噪声污染。每幅图像下面的图形是一个通过图像中心的水平灰度剖面线。月所有图像具有8比特的灰度分辨率,并用0和255分别表示黑色与白色。考虑中间一列顶部的图像。就像我们对图10.106)的讨论那样，左侧扫描线的导数在灰度恒定区域为零。这是在导数图像中显示的两个黑色条带。在斜坡上的各点处的导数是恒定的、并等于斜坡的斜率在导数图像中这些恒定值显示为灰色。当我们沿中间列向下移动时，导数会变得与无噪声情形时越来越不相同。实际上，将中间列中最后一个剖面与斜坡边缘的一阶导数联系起来将会很困难。造成这种有意思的结果的原因是左列图像中的噪声几乎不可见。这些例子很好地说明了导数对噪声的敏感性。如预想的那样，二阶导数对于噪声甚至更为敏感。无噪声图像的二阶导数显示在右列的上部。白色和黑色的细垂直线是二阶导数的正分量和负分量，就像图10.10中解释的那样。这些图像中的灰色表示零个类似于无噪声情况的有噪声二阶导数图像如先前讨论的那样，比例缩放导致零显示为灰色）。唯对应于标准差为0.1的噪声。另两幅二阶导数图像和剖面清楚地表明了检测这些图像中的正分量和负分量的确很困难，而这些分量在边缘检测中确实是非常有用的二阶导数特性。微弱的可见噪声对检测边缘所用的两个关键导数的严重影响的这一事实，是我们应记住的一个重要间题。特别地，在类似于我们刚刚讨论的水平的噪声很可能存在的应用中，使用导数之前的图像平滑处理是应该认真考虑的问题。W的广W青品图 10.11-列：被均值为零标准差分别为0.0, 0.1, 1个灰度级的随机高基所污染的斜坡边缘的图像和灰度剖面。第二列：一阶导数图像和灰度剖面线。第三列：二阶导数图像和灰度剖面线454我们用上面的解释给出执行边缘检测的三个基本步骤:为降噪对图像进行平滑处理。需要这一步的原因已由图10.11的第二列和第三列中的结果做了详细说明。。如先前提及的那样，这是一个局部操作，从一幅图像中提取所有的点，这些边缘点的检测。点是变为边缘点的潜在候选者。边缘定位。这一步的目的是从候选边缘点中选择组成边缘点集合中的真实成员本节剩下的内容探讨实现这些目标的一些技术。10.2.5基本边缘检测一节说明的那样，为了达到寻找边缘的目的，检测灰度变化可用一阶或二阶导数来完成。正如前一在这一节中，我们讨论一阶导数，二阶导数将在10.2.6节中讨论图像梯度及其性质为方便起见，这里重复给出。3.6.4为工在一幅图像了的,.2位置处寻找边缘的强度和方向，所选择节中的一些公式。的工具就是梯度，梯度用Vf来表示，并用向量来定义：美(10.2-9）Vf = gradf ）oyJ该向量有一个重要的几何性质，它指出了f在位置(,y)处的最大变化率的方向。向量Vf的大小(长度)表示为MGx, y)，即M(x,Jy)= mag(Vf )=/8:+83(10.2-10）它是梯度向量方向变化率的值。注意，8.:8,和MCx.)都形是与原图像大小相同的图像，是x和y在f中的所有像素位置上变化时产生的。实殿中，我们通常称后一图像为梯度图像，或者在含义很清楚时简称为梯度。如 2.6.1节中定义的那样，求和、平方和开方操作都是阵列操作。梯度向量的方向由下列对于x轴度量的角度给出：8(10.2-11）x(x, y)=arctan如在梯度图像的情况那样，、 c(x,y)也是与由8,除以g，的阵列创建的尺寸相同的图像。任意点(,y）处一个边缘的方向与该点处梯度向量的方向α(x, y)正交。列10.5梯度的性质。图10.12显示了包含一段真的边缘线段放大的一部分。所显示的每个方块对应于一个像素，我们的兴趣是得到用一个方框强调的点处边缘的强度和方向。灰色像素的值为0，白色像素的值为1。下面我们说明该例元,为计算工方向和》力向的梯度,该有法使用一个关于一点为中心的2X9.邻域、简单地从底一行的像素中减去顶部一行邻域中的像素，得到、方向的偏导数。类似地，我们从右列的像素中减去左列的像素得到y方向的偏导数。接下来，用这些差值作为偏导数的估计，在这一点处有3//3x=-2726L园和af/3 y=2。从而有455可安dy一点处的M(x, y)=2/2由此，我们可以得到这一类似地，相同点处梯度向量的方向遵循式(10.2-11)：α(x,y)=山忆亿,.42.节可知、图像坐标系统的原点位于左上角同。图10.12 (b)显示了该梯度向量及其方向角。伸，正y轴向右延伸。图10.12(c)说明了之前提到的一个重要事实，即某点的边缘与该点的梯度向量正交。。因此，在这个例子中，边缘的方向角是α-90° ==45°。图10.12(a)中的所有边缘点都有相同的梯度，所以，整个边缘段都处在相同的方向上。梯度向量有时也称为边缘法线。。当向量通过除以其幅值〔见式(10.2-10)丁而归一化为单位长度时，结果向量通常称为边缘单位法线。洋度向量边缘方向图10.12用梯度确定某个点处的边缘强度和方向。某点处的边缘垂直于该点处的梯度向量的方向。图中的每个方块表示一个像素梯度算子要得到一一幅图像的梯度，则要求在图像的每个像素位置处计算偏导数of/3×和of/o y。我们处理的是数字量，因此要求关于一点的邻域上的偏导数的数字近似。由10.2.1节，我们可知af(xy)f(x+1, y)-f(x, J）10.2-12)dxdf(x, y)(10.2-13） f(x, y+1)-f(x, y）这两个公式对所有x和y的有关值可用图 10.13中的一维模板通过对C:, )的滤波来执行。当对对角线方向的边缘感兴趣时，我们需要一个二维模板。伯特交叉梯度算子(Roberts[1965)是最早尝试使用具有对角优图 10.13用于实现式(10.2-12)和式(10.2-13)的一维模板子以求对角像素之差为基础：df=(石-23)10.2-14）用于计算梯度偏导数的滤波器模通常称为梯度算子、差分算子和边缘算子或边缘检测子。10.2-15）-46Sy这些导数可以使用图10.146)和(e)中的模板对图像进行滤波来实现。亿30数字图像处理(第三版）2×2大小的模板在概念上很简单，但是它们对于用关于中心点对称的模板来计算边缘方向不是很有用，其最小模板大小为3×3。这些模板考虑了中心点对端数据的性质，并携带有关于边缘方向的更多信息。用大小为3×3的模板来近似偏导数的最简单的数字近似由下式给出:中(10.2-16)=(Z,+z%+ Zz,)-(z,+z2+z3ax尽管这些公式包含了较大的邻成，但我们仍处理灰度值间的差・因此之前讨论一阶导数时得到的结论仍然适用。(10.2-17)=(亿z.+z。+ Zz)-(Z,+z4+ z）Hgb cRobertsobel幅图像的3×3区域(z项是灰度值和用于计算标记点z处的梯度的不同模板图10.14在这些公式中，3x3区域的第三行和第一行之差近似为x方向的导数，第三列和第一一列之差近似为y方向的导数。直观上，我们可以预料这些近似要比用罗伯特算子得到的近似更准确。式(10.2-16)10.14d)和(e)中的两个模板通过滤波整个图像来实现。这两个模板称为Prewit和式(10.2-17）可用图算子(Prewitt[1970)。一个小小的变化是在中心系数上使用一个权值2:对这两个公式的一=z,+22. +z,)-(亿+2z2+4）(10.2-18)和(10.2-19）=(z.+22。 +Z,)-(+2z4 + z,）可以证明，在中心位置处使用2可以平滑图像(见习题10.10)。图 10.14 (f)和(g)显示了用于实现式(10.2-18)和式(10.2-19)的模板。这些模板称为Sobel算子(Sobel1970)Prewit模板实现起来比.Sobel模板更为简单，但它们之间计算上的小差别并不是问题。正如前节提到的那样，Sobel模板能较好地抑制(平滑)噪声的特性这一一事实使得它们更可取,，因为在处理导数时噪声抑制是一个重要的问题。注意，图10.14 中所有模板中的系数之和为零，正如导数算子所预示的那样，恒定灰度区域的响应为零。刚才讨论的模板用于在图像的每个像素位置处得到梯度分量8,和然后，用这两个偏导数估计边缘的强度和方向。计算梯度的幅度时，要求按式10210所示的方法联合使用&.和g。然而，457。经常使用的一种方法是用绝对这种实现并不总是令人满意，因为平方和平方根需要大量的计算开销。值来近似梯度的幅值:MGx. =18.1+|8.1(10.2-20该式不仅在计算上更有吸引力，而且仍保持着灰度级的相对变化。为这一一优点付出的代价是导致滤波，光使用FPrwiu和LSobel这样的模板来计算&.和&时器一般将不再是各向同性(旋转不变)的。然而，，因为这些模板仅对垂直和水平边缘才会给出各向同性的结果。。不管使用这两个公式中这并不是问题，的哪一个，只只有在这两个方向上的边缘其结果才是各向同性的。此外，当使用Sobel 或Prewitt模板时，式(10.2-10)和式（10.20)对垂直和水平边缘给出相同的结果(见习题10.8。可以修改图10.14中的3×3模板，，以便它们沿对角线方向有最大的响应。图10.15显示了另外两个用于检测对角线方向边缘的Prewitt和Sobel模板。a bc d图10.15检测对角边缘的Prewit和Sobel模板例10.6品维梯度幅值和角度的说明。图10.16日说明了两个梯度分量lg和以gJ的绝对值响应，以及由这两个分量之和形成的梯度图像。梯度的水平和垂直分量的方向性在图10.166)和(c)中很明显。注意，图 10.166b)中屋顶的瓦片、砖块的水平接缝和窗户的水平线段比起其他边缘要强得多。相比之下，图10.16G)中正面和窗户的垂直分量更强。一幅图像涉及的主要特性是边缘时，如梯度幅度图像，通常使用边缘图这一术语。在图 10.16(a)中，图像的灰度被标定在I0.1范围内。在本节讨论的各种边缘检测方法中。我们使用这一范围内的值来简化参数的选择。a bcd(a)灰度值已标定为范围[0,。1内的、大小为834×1114的原图像；图 10.16用图10.14(D)中的Sobel模板滤波图像得到的x方向上的梯度分量；Gc) lgJ用图10.1489中的模板得到的y方向上的梯度分量；《a)梯度图像J.J +k」图10.17显示了使用式610.2-12计算得到的梯度角度图像。通常，对于边缘检测而言，角度图像不像幅度图像那样有用，但它们可以作为用梯度幅值从图像中提取的信息的补充。例如，图10.16a)中的恒定灰度区域，诸如斜屋顶的前边缘和前墙顶部的水平条带，在图10.17中都是恒定的，这说明在这些区域中的所有像素位置处的梯度向量方向是相同的。。正如我们在10.2.6 节说明的那样，在坎尼边缘检测算法732|的实现中，角度信息起着重要的支撑作用，坎尼边缘检测算法是在本章中我们讨论的最先进的边缘检测za方法58图10.16 (a)中所示原图像的分辨率相当高(834×1114像素)，且在图像获取的距离上，墙砖对于图像细节的责献仍。这种精细的细节在边缘检测中通常是不符合需F分显著。要的，因为它往往表现为噪声导数计算会增强这种噪声从而使图像中主要边缘的检测变得复杂。减少精细细节的-种方法是对图像进行平滑处理。图10.18显示了与图10.16中相同的图像序列，但先使用一个大小为5×5的均值滤波器对原图像进行了平滑(关于平滑滤波器，见3.5 节)。现在每个模板的响应几乎未显示出由砖块造成的影响，得到的使用式(10.2-11)计算的梯度角度图 10.17结果几乎都是主要的边缘。图像。在该图像中的恒定灰度，水平和垂直 Sobel模板不区区域指出这些区域中所有像素在图10.16和图10.18中，分±45°方向的边缘是很明显的。如果沿对角方向强调边缘位置处的梯度向量的方向均相同很重要，则应使用图10.15中所示的一一个模板。图10.19(a）和(6)分别显示了45*和-45°的Sobel 模板的绝对响应。。在这些图中平滑后图像的最大边缘强度(幅度）会随着平滑模板尺寸的增加而减小这些模板的较强的对角响应很明显。两个对角模板对水平边缘和垂见习题10.13)直边缘都有类似的响应，但正如所期望的那样，它们在这些方向上的响应要比之前讨论的水平和垂直模板的响应弱。与图10.16中的相同图像序列，但在边缘检测之前，用大小为5×5的均值滤波器对原图像进行了平滑图10.18图 10.19对角边缘检测：(a)使用图」10.15(c)中的模板得到的结果；（b)使用图10.15d)中的模板得到的结果。两种情况下的输入图像都是图 10.18 a）与阈值处理相结合的梯度10.18中的结果说明，，在计算梯度前对图像进行平滑处理，边缘检测可做更多的选择。实现一种方法是对梯度图像进行阈值处理。例如，图10.20(a)显示了图10.16(d)经阈相同的基本目标的另一值处理后的梯度图像，此时其值大于或等于梯度图像的最大值的33%选择用于生成1020)的朗值的月的，是消除砖块导致的多数较小边的像素显示为白色，而低于该阈值的像素则显示为黑色。该图像与734缘。回忆可知，这是在计算梯度前平我们看到阈值处理后的图像中边缘更少，并且图10.18 (d)进行比较，735滑图 1016中的图像的基本目标。图像分割459这幅图像中的边缘要尖锐得多(例如，见屋瓦中的边缘)。另一方面，在阈值处理后的图像中，许多边如确定屋顶远边缘的45°线，被断开了。家,当目的是突出主要边缘并尽可能维护连接性时，实践中通常平滑处理和阈值处理两者都使用。图 10.20 (6)显示了图10.18 (d)经阈值处理后的结果，它是平滑后图像的梯度。该结果显示断开的边些；例如，，比较图10.20(a)和(b)中的45°边缘。当然，这些由于模糊处理其灰度值严重豪减少了一峰低的边缘(即屋瓦中的边缘)可能因阈值处理而完全消除。在10.2.7 节我们再回来讨论边缘断线的问题图10.20a)图10.16)中图像经阈值处理后的图像，阈值选择为图像中最高值的33%该阈值刚好高到足以消除梯度图像中的多数砖块边缘；b)图10.18（(0)中图，它是使用等于图像中最高值的33%的阈值得到的象经阈值处理后的图像，更先进的边缘检测技术10.2.6前一节中讨论的边缘检测方法是以用一个或多个模板对图像进行滤波为基础的，而未对图像特性和噪声内容采取预防措施。在这--节，我们讨论更为先进的技术，尝试考虑诸如图像噪声和边缘本身特性的因素改进简单的边缘检测方法。Marr-Hidreth边缘检测器最早的成功地尝试将更高级的分析结合到边缘检测处理之一应归边缘检测与图像尺寸无和 Hildreth[1980]。。正如前节所讨论的那样，，当时，边缘检考虑图10.8(0中的屋顶边如果图像的尺寸减小，则边缘则方法是以使用较小的算子为基础的(如 Sobel模板)。Mar和Hildet会更细・正明了：（1)灰度变化与图像尺寸无关，因因此他们的检测要求使用不司尺寸的算子；（2)灰度的突然变化会在一阶导数中引起波峰或波谷，或在二阶导数中等效地引起零交义(就像我们在图10.10中见到的那样）式(10.2-21)与二维高斯概率密度函数这些概念建议，用于边缘检测的算子应有两个显著的特点。。第淀义的不同在于常数项1/2r o个和最重要的特点是它应该是一个能计算图像中每一点处的一阶导数果在某个给定应用中期望得到一或二阶导数的数字近似的微分算子。。第二，它应能被调整””以便在精确的表达式，则乘以常数可添加任何期望的尺寸上起作用，，因此，大的算子也可用于检测模糊边缘到式(10.2-23的最终结果中小的算子可用于检测锐度集中的精细细节。Marr和Hildreth论证过，满足这些条件的最令人满意的算子是滤波器VG，如在3.6.2 节中定义的那样，V”是拉普拉斯算子(o3/ar +3 /ay3)，而G是标准差为α（有时口也称为空间常数)的二维高斯函数C10.2-21）G(x, y)=为求VG的表达式，我们执行如下微分:a'G,2 + ′G,）=9部V-G(x, y)=axoy(10.2-22）小长小整理各项后给出如下最终表达式:+y*-20己v'Gx y)=1(10.2-23）该表达式称为高斯拉普拉斯(LoG)。图10.21 (a)到(c)显示了一个 LoG 的负函数的三维图、图像和剖主意图10.2109中刹面与图4.37e面(注意 LoG的零交叉出现在理+y/=0′处，它定义了一一个中心位中高通滤波器之间的相似性。这样，我们可期望 LoG 的作用类似于一于原点、半径为√2o的圆)。因为图 10.21 (a)中显示的形状，， LoG 函高通滤波器。数有时也称为墨西哥草帽算子。图 10.21 (d)显示了一个5×5 的模板，它近似于图 10.21 (a)中的形状(在实践中，我们会用该模板的负模板)。这个近似并不是唯一的，其目的是获取,LC.函数的基本形状；根据图 10.21 Ga)，这意味着一个正的中心项由紧邻的负区域包围着・中心项的值以距原点的距离为函数而增大，而外层区域的值为零。系数之和必须为零，从而模板的响应在恒定灰度区域为零。F交义图10.21(a)负LG的三维图；(6)显示为-幅图像的负LoG图；CcO显示了零交义的图a)的横截面；《d)对图(a)中形状5×5模板的近似、实际中将使用该模板的负值任意尺寸的模板可以通过对式(10.2-23)取样并标定系数以使系数之和为零来生成。生成LoG滤737波器的一种更有效的方法是以希望的nn 尺寸对式(10.2-21取样、然后将结果阵列与一个拉普拉斯模图像分割461一个系数之和为零的模板对图像阵列卷积产生一板进行卷积"，例如图 10.4(a)中的模板。因为用一个元素之和也为零的结果(见习题3.16 和习题10.14)，故这种方法自动满足 LoG滤波器系数之和为零的要求。在本节的后面将讨论 LoG滤波器尺寸的选取问题。选择算子VG的基础有两个基本概念。第一，算子的高斯部分会模糊图像，从而在尺寸上将结沟的灰度(包括噪声)降低到远小于α的程度。与3.5 节中讨论的和图10.18中使用的平均形式不同的是高斯函数在空间和频率两个域平滑图像(见4.8.3 节)，因而在原图像中引入不存在的人为干扰(如振令)的可能性很小。另一个概念涉及V”，即滤波器的二阶导数部分。尽管一阶导数可用于检测灰度突变，但它们是有方向的算子。另一方面，，拉普拉斯有各向同性(旋转不变)的重要优点，这不仅符合人，而且对任何模板方向的灰度变化有相等的响应，从而避免了使用多个约视觉系统特性(Marr[ 1982]）模板去计算图像中任何点处的最强响应。Marr-Hildreth算法由L0G滤波器与一幅输入图像几,y)卷积组成，，即g(C,J)=1V'Gx, J)] ★/(α,y）(10.2-24)然后寻找gα, J)的零交叉来确定f(,y)中边缘的位置。因为这些都是线性操作，故式(10.2-24)也可写为g(x, y)=V'[G(x,y)★f(G, y)](10.2-25）它指出我们可以先使用一个高斯滤波器平滑图像，然后计算该结果的该表达式是使用式3.4-2)在空间拉普拉斯。这两个公式给出了相同的结果。城中实现的。也可使用式(4.7-1)在频擎域中实现。Marr-Hildreth边缘检测算法可小结如下:用一个对式(10.2-21)取样得到的nxn的高斯低通滤波器对输人图像滤波。计算由第一步得到的图像的拉普拉斯，例如，使用图10.4(a)的3×3模板[第一步和第二步实现式(10.2-25）上找到步骤2所得图像的零交叉。为确定高斯滤波器的大小，仍采用位于二维高斯表面下其均值在±3o之间的99.7%。这样，作种经验法则，一个大小为nxn的LOG 离散滤波器，其n值应是大于等于6的最小奇整数。n小“截断”LoG函数，截断的程度与模板的大小成反比；F该值的滤波器模板会；而使用较大的模板对结果的影响不大。在滤波后的图像gC, )的任意像素p处，寻找零交叉的一种方法是用以p为中心的一个3×3邻域。P点处的零交叉意味着至少有两个相对的邻域像素的符号不同。有4种要测试的情况：左右、上/下和两个对角。如果&G,.)的值与一个阈值比较(一种通常的方法)，那么不仅相对邻域的符号不同，而且它们的数值差的绝对值还必须超过这个阈值。。这时，我们称p为一个零交试图通过查找满足8叉像素。下面的例10.7中将说明这一方法。标:.)米找到零交叉是不实际的，零交叉是Marr-Hildreth边缘检测方法的关键特征。前段中讨论的因为噪声和或计算不准确。方法是很有吸引力的，因为它实现简单，并且通常能给出好的结果。如果在某个特殊应用中使用这一方法找到的零交又位置的准确性不够，，那么可采用由 Huertas andMedioil1986]提出的采用亚像素精度来寻找零交叉方法。D LoG是个对称选波器。所以使用相光或卷积的字卿速波将产生相同的销果。为与关于这一主题的文献保持一致，这果我们使用卷积流一术进来表示线性滤波。此外、也为该者提前了解这一术语，因为在其他内容中也会遇到它。记住，342节木针对这一主题给出的注释很重要。462Mar-Hidreth边缘检测算法说明。列10.7图10.22 a)显示了早先使用过的建筑物图像，图10.22 b)是 Marr-Hidreh算法的步骤1和步骤2得其中α=4(约为图像短边长度的0.5%)和n=25(如早先讨论的那样，大于等于6o的最小奇整到的结果，如在图10.5中那样，这幅图像中的灰色调已被标定过。图10.22 6)显示了使用上面讨论过的阈值为数)。女所有的边缘形成了一个闭环。这种所谓的意大利通心粉效应是零的3x3邻域方法得到的零交叉。注意，所使用零阈值方法的严重缺点(见习题10.15)。我们使用正阈值避免闭环边缘。图10.224の)显示了使用近似等于LoG 图像最大值的4%的阈值的结果。注意，很容易地检测出了大正如我们在下一节要说明的多数的主要边缘，并且滤掉了一些“无关”特征，例如砖块和屋瓦的边缘。工那样，使用前节讨论的基于梯度的边缘检测技术实际上是不可能得到这种类型的性能的。。使用零交叉检测边缘的另一个重要结果是可得到一一个像素宽的边缘。这一特性简化了诸如边缘连接的后续阶段的处理。(a)大小为834×1114 像素、灰度值已标定到范围[0、1]的原图像；b) Mar-ildeh 算法的图 10.22= 25；(c)使用零阈值的图(b)的零交叉(注意步骤1和步骤2得到的结果，其中α闭环边缘)；《a)使用等于图GD)中图像的最大值的4%的网值时，找到的零交义。注意细边缘考虑到早先提及的灰度变化取决于数值范围的事实，有时所用的过程是使用各种o值来对一幅图像进行滤波。然后，所得零交叉边缘图与仅为全部图形保留的公共边缘相结合。这种方法可得到很有用实践中它多被用做使用单一滤波器选择合适的o值的设计工具。的信息，但由于其复杂性，Marr an Hildreth[1980]指出过，使用高斯差分(DOG)来近似式(10.2-23)中的LoG滤波器是可能的时2o;DoGx, Jy)=(10.2-26）2Tof2TO“通道”就方实验结果表明，在人的视觉系统中，某些其中o,>O。商斯差分是一个高通滤波器向和频率而论是有选择性的，且可以使用式(10.2-26)以 1.75:1 的标见4.7.4节中的讨论。准差比率来建模。Mar和Hldreth建议过，使用1.61的比率不仅可保持这些观察的基本特性，而且还可对LoG 函数提供一个更接近的“工程”近似。为在L0G和DoG之间进行有意义的比较，对于LOG，o值必须按照如下公式选择，以便LoG 和 DoG具有相同的零交叉(见习题10.17):505gi(10.2-27）05尽管LoG和DoG的零交叉相同，但它们的幅度大小会不同。我们可以通过标定当使用这个o值时，这两个函数使得它们兼容，以便它们在原点处有相同的值。图10.23(a)和(6)中的剖面线是分别使用标准差比率1:1.75和1:1.6产生的(按照惯例，所显示的曲线被反转了，就像在图10.21 中那样)。LOG剂削面线显示为实线、而DG剖面线显示为虚线。所示曲线是通过 LoG和 DoG 阵列中心的灰度剖面线，这两个阵列分别是通过对式(10.2-23)(前面有常数1/2no"）和式(10.2-26)取样产生的。所有曲线在原点处的幅度均被归一一化为1。如图「10.23(6)所示，1:1.6的比率在 LoG和DOG 函数之间产生了一个更接近的近似。第10章163LoG 和 DoG滤波操作均可直接使用一维卷积代替二维卷积来实现(见习题101.9）。对于一个大小为nxn的滤波器，这样做可将每次卷积所需的乘法和加法次数，，从二维小为MxN的图像和一卷积的与nMV成正比，减少到一维卷积的与n MV成正比。这种实现上的差别是很有意义的。例如,如果n=25，则一维卷积实现的乘法与加法操作次数将比二维卷积实现少12倍。图 10.23a)用比率为1.75:1的标准差的LOG(实线)和 DOG(虚线)的负值剖面线，()使用1.6：1的比率得到的剖面线坎尼边缘检测器虽然其算法更为复杂，但本节讨论的坎尼检测器Cannyl1968B)是迄今为止讨论过的边缘检测器中最为优秀的。坎尼方法基于三个基本目标:低错误率。所有边缘都应被找到，并且应该没有伪响应。也就是检测到的边缘必须尽可能是真实的边缘。已定位边缘必须尽可能接近真实边缘。也也就是由检测器标记为边缘边缘点应被很好地定位。约点和真实边缘的中心之间的距离应该最小。一个点。也就是真实边缘周围的局部最一的边缘点响应。对于真实的边缘点，检测器仅应返回一个单一大数应该是最小的。这意味着在仅存一一边缘点的位置，检测器不应指出多个边缘像素。坎尼的工作的本质是从数学上表达了前面的三个准则，并试图找到这些表达式的最佳解。通常寻找一个满足前述目标的、严格形式的解是很困难的(或不可能的)。。然而，一维台阶边缘使用数字最佳化会得到这样一对由加性高斯白噪声污染的顷率段中是连续且均匀的。结论，即对最佳台阶边缘检测器的一一个较好近似"是高斯一一阶导数:电则是幅度值分布为高斯的高斯白噪南是许多真实世界情形的较好近似、并县可产生数学上可处理的(10.2-28）dx白噪声的一个有用性质是把该结果推广到二维情况会涉及识别一维方法是否仍适用于边缘法L线的方向(见图 10.12)。因为预先法线方向未知，这就要求在所有可能的方向上应用一维边缘检测器。二维高斯函数平滑图像，计算结果的梯度，然后使任务可由如下方法来近似：首先使用一个环形二用梯度幅度和方向来估计每一一点处的边缘强度和方向。令f(α,y)表示输入图像，GGx,y)表示高斯函数：10.2-29）G(x, y)=e我们用G和f的卷积形成一幅平滑后的图像了,(x,）：f,(x, J)=G(Gx, y) *10.2-30) f(x, y）741742D Canyt19861证明，使用高斯近似与使用最优数值解相比，所得结果仅差约20%。这种幅度差在多数应用中通常是难以察觉的。像10.2.5 节讨论的那样，在这一一操作源自计算梯度幅度和方向:M(x, y)= /8R+83(10.2-31）8α(x,y) = arctan(10.2-32）其中，8,=0/,0αx，8,=3/, 0y。图10.14中的任何滤波器模板对都可用来得到g。和g,。式(10.230一个大小为nxn的高斯模板实现的，其大小将在下面讨论。记住，是使用一，M(x,y)和α(x,y)是与计算出它们的图像的尺寸相同的阵列。因为它是使用梯度产生的，典型地，M(x,y)在局部最大值周围通常包含更宽的范围(回忆10.2.节中关于使用梯度得到边缘的讨论)。下一步是细化那些边缘。。一种方法是使用非最大抑制。这可通过几种方式来做，，但该方法的本质是指定边缘法线的许多离散方向(梯度向量）。例如，在个3×3图10.24(a)显示了一个水平边缘的两个可能方向。因为我们必须把所有可能的边缘方向量化为四个方向，故必须定义一，我们考虑一一个水平方向的边缘。一个方向范围，在该范围内，。我们由边缘法线的方向来确定边缘方向，边缘法线方向可以直接使用式（10.2-32)从图像数据得到。如图 10.246)所示，如果则我们称该边缘为水平边缘。边缘法线方向的范围是从-22.5°到22.5°，或者是从-157.5°到157.5°，贝图 10.24 (c)显示了对应于所考虑的四个方向的角度范围。157.5°-157.5°五缘法线老治老货器、力缘PBsP边缘法线57.5*45°边缘12.5°112.5董直边缘57.367.55”边缘水平边缘图 10.24个3x3邻域中，个水平边缘(灰色)的两个可能方向；6)一个水平边缘a)在的边缘法线的方向角α的值的范围（灰色)；(c)在一一个3x3邻域中，4种类型的边缘方向的边缘法线的角度范围。每个边缘方向都有两个范围，以对应的灰色显示74|园O 记住，每个边缘均有两个可能的方向。例如。其法线为0r的边缘和法线为180r的边缘是同一个水平边缘。465对令d,d,4,和d,表示刚才讨论的3×3区域的四个基本边缘方向：水平、-45°、垂直、+45°。于在α(x,y)中以每一点(x, y)为中心的3×3区域，我们可给出如下非最大抑制方案:寻找最接近c.tx)的方向4如果M(x,y)的值至少小于沿d。的两个邻居之一一，则令g(x,y)=0(抑制)；否则，令gx(E.)=M(x.)），这里8xx.）是非最大抑制后的图像。。例如，参考图 10.24(a)，令G。y)在p.处，一个水平边缘通过，。，在步骤2中我们感兴趣的像素是，,和么。图像积A(x.）)仅包并假设一含细化后的边缘；它等于抑制了非最大边缘点的M(x,y）最后的操作是对gw(x,y)进行阈值处理，以便减少伪边缘点。在10.2.5 节中，我们使用单阈值进行阈值处理，其中低于该阈值的所有值均置为零。如果我们设的阈值过低，则仍会存在一些伪边缘(称为伪正值)。如果阈值设得过高，则会删除实际上有效的边缘点(伪负值)。坎尼算法通过使用滞后阈值试图改进这一状况，如我们在10.3.6 节中讨论的那样，使用两个阈值:个低阈值T,和一个高阈值T，。坎尼建议，高阈值和低阈值的比率应为2:1或3:1。我们可以将阈值操作想象为创建两幅附加的图像(10.2-33）s wmCx, y)=8x(x, y) >7m(10.2-34)8M(x,9)=8.(X, y) >21元其中，开始时x.）列和Rxrx.x）均被置为等。网值处理后，..）的非零像素通常比SLx少，但是8sw(x.)中的所有非零像素都将包含在积mLx.）中，因为后一图像是使用一个低阈值形成的。通过令(10.2-35）8ML(x, y)= 8mL(x, y)-8wn(x, y）我们从gwL(x,y)中删除所有来自gm(Cx,y)的非零像素。B8m(x,y)和gm.(x,y)中的非零像素可分别看成是“强”和“弱””边缘像素。阈值处理后，・ 8o Kx,y)中的所有强像素均被假设为有效的边缘像素，并被立即标记。取决于Th的值，一个未被访问的边缘像素po6b)在gmL(Gx, y)中将所有的弱像素标记为有效边缘像素，用8连通性的连接方法连接到p。则跳到步骤(d)，否则返回步骤(a)。(a)将gmL(x,y)中未标记为有效边缘像素的所有像素置零。在这一过程的末尾，将来自gmL(x,y）的所有非。像素附加到gwn (x,)，用坎尼算子形成最终的输出图像。我们使用了两幅附加的图像gwm(x, )和R8mLCx.y)来简化讨论。在实际中，滞后阈值处理可在非最大押制期间直接执行，并且，可以通过形成一个与它们相联系的强像素和弱像素的列表在go(x,）中直接实现总结一坎尼边缘检测算法是由下列基本步骤组成的：用一个高斯滤波器平滑输入图像。2.计算梯度幅值图像和角度图像对梯度幅值图像应用非最大抑制。743用双阈值处理和连接分析来检测并连接边缘。745尽管非最大抑制后的边缘比原来的梯度边缘细、但仍保持了比1像素粗的边缘。为得到1个像素粗的典型地，紧跟步骤4，用一遍边缘细化算法(见9.5.5 节)。边缘，正如先前提到的那样，平滑是用指定的大小为nx”的高斯模板与输入图像进行卷积来完成的r-Hildreth算法有关的方法决定n值。也就是，用对式(10.2-29)我们可以使用前面章节讨论过的与Marr，从而使n是大于或等于6o的最小奇整数，以便基本上提供高斯滤波取样所产生的一一个滤波器模板，平滑能力。如果实际考虑要求一一个较小的滤波器模板，则折中方案是较小n值的平滑效器的“完美”果会差一些关于实现的最终意见：正如先前讨论Marr-Hildreth边缘检测器那样，式(10.2-29)中的二维高斯函一维高斯函数的乘积。这样，坎尼算法的步骤1就可用维卷积公式来表达，即一次数被分解为两个一一乡一行(列)进行操作，然后再对处理结果中的列(行)操作。此外，如果我们使用式(10.2-12）对图像中的和式（(10.2-13)中的近似，则也可将步骤2中要求的梯度计算以一维卷积来实现(见习题10.20。坎尼边缘检测方法说明。例10.8图10.25(a)显示了我们熟悉的建筑物图像。为了比较，图10.25(6)和(c)分别显示了先前在图10.206b中用阈值化后的梯度得到的结果和在图10.22d)中使用Marr-Hildeth检测子得到的结果。回忆一下，选取生成这两幅图像所用的参数来检测主要边缘，同时要减少“无关”特征，如由砖块和屋瓦引起的边缘。图 10.25(d显示了用坎尼算法得到的结果，使用的参数为：T, =0.04，T, =0.10（低阈值的 2.5倍),7=4，以及对应于大于6o的最小奇整数的、大小为 25×25的模板。这些参数可交互式地选择，以达到前面章节中对梯度和Mr-Hildreth图像扫描规定的目标。将坎尼图像与这里给出的几个阈值仅应在相对其他两幅图像比较，我们看到主要边缘在细节上的明显改进，同时，在情形下考虑。多数算法实现会涉及坎尼结果中抑制了更多的无关特性。例如，注意坎尼算法检测到了图像各个标定步骤，如将图像的值域标定为范围.1。从这一例子可以看上部镶嵌在墙砖中间的水泥条带的两个边缘，然而，阈值处理后的梯度出，不同的标定方案明显会要求不图像中则消除了这两个边缘，并且，Mar-fireth 留像中则仅包含上面同的阈值。一个边缘。在滤除无关细节方面，坎尼图像确实不包含由屋瓦引起的的一单个边缘；在其他两幅图像中却不是这样。在坎尼图像中，关于连续性、细度和笔直度等线的质量也很这种结果使得坎尼算法成为边缘检测的一种首选工具出众。b c dGa)大小为834×1114像素、灰度值标定为范围[0,。11内的原图像；()平滑过的图图10.25像经阈值处理后得到的梯度图像；；(c)使用 MarrHideth算法得到的图像；d)使用坎尼算法得到的图像。注意，与其他两幅图像相比，坎尼图像有明显的改进例10.9本节中讨论的三种主要边缘检测方法的另一说明。作为本节中讨论的三种主要边缘检测方法的另一比较,考虑图10.26a)，它显示了一幅大小为512×512的头部 CT 图像。在这个例子中，我们的目的是提取大脑外轮廓(图像中的灰色区域)、脊髓区域轮廓(直对着鼻子的后边、朝着大脑前)和头部外轮廓的边缘。在消除眼部和大脑区域中与灰色有关的边缘细节时，我们希望生成尽可能最细且连续的轮廓,。图10.26 0b)显示了一一幅阈值处理后的梯度图像，它已先用一个5×5均值滤波器平滑过。达到所示结弟 10章+67果要求的阈值是该梯度图像的最大值的15%。图10.26 (c)显示了使用Marr-Hidreth边缘检测算法得到的结果，所用的阈值为0.002, =3，模板大小为19×19像素。图 10.26(d)是使用坎尼算法得到的，所用的7, =0.05、7, =0.15（低阈值的3倍)，0=2，模板大小为13×13，像Mar-Hlidet情况那样，它对应于大于6o的最小奇整数。在边缘质量及消除无关细节的能力方面，图10.26中的结果相当接近前一一例子中的结果和结论。还要注意，坎尼算法是唯一一能为大脑后边界产生完整无断裂的边缘的过程，它也是在消除原始图像中与灰度物质有关的所有边缘时，，有可能发现最好轮廓的过程。图10.26(a)大小为512×512像素、灰度值已标定到范围[0，1内的原始头部CT图像；(b)平滑后的图像经阈值处理后的梯度图像；（c)用Marr-Hildreth算法得到的图像;(d)用坎尼算法得到的图像(原图像由 Vanderbit大学的David R. Pickens博士提供）坎尼算法改进性能所付出的代价是比早些时候讨论的两种方法实现起来更复正像预期的那样，场杂，同时执行时间会更长。在某些应用中，如实时工业图像处理，成本和速度需求通常要求我们使用更简单的技术，主要是阈值梯度方法。当关注的主要是边缘质量时，通常会使用 Marr-Hidreth算法和坎尼算法，特别是坎尼算法。边缘连接和边界检测10.2.7理想情况下，边缘检测应该仅产生位于边缘上的像素集合。实际上，由于噪声、不均匀照明引起的边缘间断，以及其他引入灰度值虚假的不连续的影响，这些像素并不能完全描述边缘特性。因此，-般是在边缘检测后紧跟着连接算法，所设计的算法将边缘像素组合成有意义的边缘或区域边界。在这一节中，我们讨论三种基本的边缘连接方法，它们是实际中使用的有代表性的技术。第一种方法需一个3×3 邻域)的知识；第二种方法要求区域边界上的点已知；第三种要有关局部区域中边缘点（如一技术是处理整个边缘图像的全局方法。局部处理连接边缘点最简单的方法之一一是在每个点(，y)处的一一个小邻域内分析像素的特点，该点是用前节讨论过的技术之一声明了的边缘点。根据预定的准则，将所有的相似点连接起来，以形成根据指定准则满足相同特性像素的一条边缘。在这种类型的分析中，用于确定边缘像素相似性的两个主要性质是：（1)梯度向量的强度(幅度)；(2)梯度向量的方向。第一个性质基于式(10.2-10。。令S,表示一幅图像中以点C、为中心的一个邻域的坐标集合。如果M (s,1)-M(x,Jy|≤E10.2-36）其中E是一个正阈值。梯度向量的方向角由式(10.2-11)给出。如果数学图像处理(第三版）(10.2-37）lc(s, t)-α(x,y)|≤A一个正角度阈值，则S,中，坐标(s,)处的一个边缘像素有一一个与(x,处像素类似的角度。其中A是10.2.5 节中注释的那样，，G,y)处的边缘的方向垂直于该点处梯度向量的方向如果既满足幅度准则，，也满足方向准则，则S中，生坐标为(s,，)的像素被连接到坐标为(,y)的像素。在图像中的每个位置重复这一处理。。当邻域的中心从一个像素移到另一个像素时，必须将已连接的点记录下来。一个简单的记录过程是对每组被连接的像素分配不同的灰度值。前面的公式计算代价很高，因为必须检验每个点的所有邻点。一种特别适合于实时应用的简化由如下步骤组成：计算输入图像f(x,y)的梯度幅度阵列M(x,y)和梯度角度阵列α(x,y)。形成一幅二值图像g，任何坐标对(α,y)处的值由下式给出：M(x, y)>7m且α(x, y)= A±7。1,3(x, y其他0,其中，Tm是一个阈值，A是个指定的角度方向，±T。定义了一个关于A的可接受方向“带宽”扫描g的行，并在不超过指定长度K的每一行中填充(置1)所有缝隙(0的集合)。注意，按照定义，缝隙一定要限制在一一个1或多个1的两端。分别地处理各行，它们之间没有记忆。为在任何其他方向0上检测缝隙，以该角度旋转g，，并应用步骤3中的水平扫描过程。然后，将结果以-6旋转回来。当兴趣在于水平边缘连接和垂直边缘连接时，步骤4就变为一个简单的过程，在该过程中，g被，结果再被旋转回来。这是实践中最常用的方法，如下例所示，这种方法可以旋转90°，扫描各行后，产生很好的结果。通常，图像旋转是代价很高的计算处理，因此，在要求多角度方向上的连接时，把步骤3和步骤4组合成单个放射状扫描过程更为实用。例10.10使用局部处理的边缘连接。图10.27a显示了一辆汽车尾部的图像。该例的目的是说明用前述算法来寻找大小适合车牌的矩形的应该矩形可以通过检测强的水平和垂直边缘构成。图10.276)显示了梯度幅度图像M(x,y)，图10.27()和10GO显示了该算法步骤3和步骤4的结果，其中，令Tm等于最大梯度值的30%，，A=90°，，1.=45°填充了全部25个或更少像素的缝除(约为图像宽度的5%)。为检测车牌壳的全部拐角和汽车的后窗，要求使用一个较大范围的容许角度方向。图10.27(e)是前两幅图像逻辑年“或”（OR)操作的结果，图10.27（6D是使用9.5.5节讨论的细化过程细化图1.27e)得到的。如图10.16的)所示，在图像中清楚地检测到了对应于车牌的矩形。由于美国汽车牌照的宽高比有与众不同的2:1的比例，所以利用这一事实从图像的所有矩形中简单地分离出牌照是一件简单的事情。这域处理通常，图像中感兴趣区域的位置已知或可以确定。这意味着在相应的边缘图像中关于像素的区域成员的知识是可用的。在这种情况下，我们可以使用在区域的基础上连接像素的技术，所期望的结果是该区城边界的近似。对这类处理的一一种方法是函数近似，这里，我们对已知点拟合一条二维曲线。典型地，我们的兴趣在于快速执行的技术，它可对边界的基本特性产生一个近似，例如端点和凹点。多边形近似尤其有吸引力，，因为在保持边界表示(如多边形的顶点)相对简单的情况下、它们可以捕捉基本形状特性。。在这一节，我们将阐述和说明一种适合这一目的算法。图像分割469图 10.27（a)一幅大小为534×566的汽车后部图像；：b)梯度幅度图像；C)水平连接的边缘像素；d)垂直连接的边缘像素；e)前两幅图像的逻辑“或”(OR)；GD用形态学细化得到的最终结果(原图像由Perceptics Corporation是供)L。图1.28显示了表示一条非在说明该算法之前，，找们用一个简单的例子来讨论该过程的机理。闭合曲线点的集合，其中端点标记为A和B。按照定义，这两个点是多边形的顶点。开始，我们计算通过A点和B点的一一条直线的参数。然后，计算曲线上所有其他点到这条直线的垂直距离，，并5生最大距离的点(目的是解决任意性)。如果该距离超过了指定的阈值7，选拌广则将标为C的相应点宣布为一一个顶点，如图10.28 (c)所示。然后，建立从A到C和从C到B的直线，，从而得到从A至C间的所有点到线AC的距离。如果距离超过了T，相应于最大距离的点被宣布为一个顶点D:否则，对于该线段就没有新的顶点要宣布。类似的过程用于C和B之间的点。图10.28 6)显示了结果，图102846》鼎示了下一步的筑果。继续这一选代过程，真到没有点满足舰值测试为止。图10.28 60显示了最终的结果，正如愈看到的那样，该结果是拟合给定点的曲线形状的一种合理近似。-山十图10.28多边形拟合算法迭代说明750|751数学图像处理((第三版刚才解释的过程中隐含了两个重要的需求。首先，必须指定两个起始点；其次，，所有的点都必须排序(即按顺时针方向或逆时针方向)。当任意一个二维点集未形成一个连通路径时(如典型的边缘无论是点属于边界线段(开放曲线)，还是属于一条边界(闭合曲图像中的情况)，它并不总是很明显，线)。给定已排序的点后，我们可以用分析点间的距离推断我们处理的是开放的还是闭合的曲线。我们穿过这些点的序列时，相对于其他点的距离的两个连续点间较大的距离是开放曲线的一个好的指。如果点间的分离趋于均匀，，那么我们很可能处理的是一一条闭合曲线在这种情况下，对于选取两个起始点我们有几种选择。。一种方法是选择点集中的最右边的点和最左边的点。另一种方法是寻找曲线的极端点(11.2.1节中讨论了一种这样的方法)。寻找一个多边形拟合开放和闭合曲线的算法描述如下：关于创建已排序点序列的算法，1.令P是一个已排序序列，显然，这些点是一幅二值图像中的1见11.1.1节。。指定两个起始点A和B。它们是多边形的两个起始顶点。直点。指定一个阈值7，以及两个空堆栈“开"（OPEN)和“闭”(CLOSED）中，并把及放到“开”和“闭”中。如果尸中的点对应于一条闭合曲线，则把A放到“开”3.-条开放曲线，则把A放到“开”中，而把。如果点对应于一务为堆栈名称使用的OPEN和“闭”。放到可非闭合曲线和闭合曲线一个顶点到“开”中最后一个顶点的线计算从“闭”中最后一无关。坪堆栈名称仅指出一个存储最终(CLOSED)顶点或过渡期间(OPEN的参数。的顶点的堆栈计算步骤4所得的直线至户中所有点的距离，序列把它们放到步骤4所得的两个顶点之间。选择具有最大距离Dmm的点Vmmna(解决任意性问题)“开”堆栈的末尾。。转到步骤4。，从“开”中移除最后一个顶点，并把它作为“闭”的最后一否则，一个顶点插入。如果“开”非空，转到步骤4。否则，退出。”中的顶点就是拟合P中的点的多边形的顶点。“闭”下面的两个例子说明了该算法的机理。例10.11用多边形近似连接边缘。考虑图 10.29(a)中的点集P。假设这些点属于一条闭合曲线，且它们已按顺时针方向排序(注意有些点并不相邻)，A和B分别被选为尸中的最左侧点和最右侧点。这些是起始顶点，如表10.1所示。选取序一个点作为最左侧的点A。图10.2906)仅显示了A和B间线段上方的点(标为C)，该点满足算列中的第一法的步骤6，因此将它指定为一个新顶点，并将它添加到J“开”堆栈内的顶点中。表 10.1的第二行显示了被检测的C，第三行表明它作为最后一个顶点被添加到“开”中。图10.296)中的阈值了约等于在网格图中的一格半。在图10.29 6)中，直线AB下方有一个点，该点也满足步骤6。然而，因为这些点已被排序，注意，在故一次只能检测这两个顶点间的点的一个子集。该线段下方的其他点将在后面检测，如图 10.29(e)所示。关键是总要按给出的顺序来追踪这些点。表10.1说明了导致图 10.29 0)中的解的各个步骤。图中检测到了4个顶点，并且该图用直线段连接区4个顶点形成了一个近似给定边界点的多边形。注意，尽管是按顺时针方向追踪这些点而生成的顶点但表中检测到顶点,C,.A.D,B是按逆时针方向的。若输入是一条开放曲线，那么顶点将是顺时针顺序的导致这种差异的原因是初始化”和“闭””堆栈的方法。对开放和闭合曲线形成的堆栈“闭””的差别也会导致闭合曲线中第一个顶点与最后一个顶点的重复。这与只给出顶点如何来区分开放和闭合多边形是一致的。733第10章sP8图10.29(a)一条顺时针路径中的点集(标为A和B的点被选为起始顶点)；(b)点亡到过A和B的直线的距离是A和B间所有点中最大的，并且通过了阈值测试，因此C是一个新顶点；(d)-(g)算法的各个进程；h)用直线连接形成一个多边形所显示的最后的顶点。表10.1说明了一一步步的细节表10.1例10.11机理的详细步骤已处理的曲线段主成的顶点闵.ABA）BC）3,C3,ACA）B,C,AAB)3.D3,C,A,DB.C.A.D,8例 10.12一幅图像的边界的多边形拟合。一个更为实际的例子。图 10.30(a)中的输入图像是一幅大小为550×566图10.30显示了多边形拟合的一的牙齿X射线图像，其灰度已标定到区间[0, 1。该例的目的是提取牙齿的边界，该方法对于法院运用对照数据库匹配这一领域非常有用。图10.30b)是使用Soble 模板和阈值T= 0.1(最大灰度的 10%)得到的梯度图像。如预期的那样，X射线图像中的噪声成分很高，因此，第一步是降噪。因为该图像是二值图像，故形态学技术可很好地适用于这一目的。图 10.30Cc)显示了滤除大多数噪声后的结果，如果在 3×3邻域内有5个或更多个像素为1，则置像素为1，否则置像素为0。虽然噪声已减少了，但某些噪声点仍清晰可见。图1030显示了形态学收缩后的结果。它进一步将噪声降低为孤立的点。这些噪声是用例9.4中描述的方式使用形态学滤波消除的「见图10.30C）。在这一点上，图像由粗边界组成，这些边界可通过流行的形态学骨架的方法来加以细化，如图10.30(6)所示。最后，图10.30(g)显示了预处理中最后一步去除毛刺后的结果，，如9.5.8 节讨论的那样。接着，我们用一个多边形来拟合图10.30g)中的点。图10.30Gh)-G)显示了用多边形拟合算法的结果，其中阈值分别等于图像宽度的0.5%,1%和2%(即7=3,6和12)。前两个结果较好地近似了边界，但第三753个处在临界状态。所有这三种情况中，过度的锯齿清楚地表明需要进行边界平滑。图10.30(k)和の显示T一个一维均值模板分别与图(G)和图G)中的边界卷积后的结果。所用的模板是元素为1的1×31阵列，约472，图10.306中的结果在保护重要形状特征方面仍是临界的(即为对应图像宽度的5%正如所期望的那样，右侧严重失真)。另一力画，图10300中的结果显示了有效地边界平滑和形状特征的合理保留。例如，图像以合理的保真度保留了左上方尖点的圆度和右上方尖点的细节。图 10.30一幅大小为550×566像素的人的牙齿图像；(b)梯度图像；C)滤除大多数噪声的结果；（G)形态学收缩的结果；（e)形态学清除的结果；(f)骨架；（g)去除毛刺；Gh)~Gj)使用阈值约为图像宽度的0.5%，1%和2%(即7 = 3,6和12的多边形拟合；(k)使用一个大小为1x31(约为图像宽度的5%)的一维均值滤波器平滑图G)中边界后的结果；()使用相同滤波器平滑图(h)中边界后的结果上例中的结果是使用本节讨论的多边形拟合算法所能得到的典型结果。该算法的优点是实现简且产生的结果通常是可以接受的。在11.1.3节中，我们将讨论一种更完善的过程，通过计算最小周长多边形可产生更接近的拟合。使用霍夫变换的全局处理前两节中讨论的方法可用于这样的场合，即属于各个目标的像素的知识至少部分可用。例如，在区域处理中，只有当我们知道它们是一个有意义区域边界的一部分时，连接给定的像素集才有意义。通常，我们不得不工作在无结构的环境中，在这种环境中，我们所拥有的一切只是一幅边缘图像，没有关于感兴趣目标可能在哪里的知识。在这种情况下，所有像素都是连接的候选点，这样，必须基于预先定义的全局性质接受或删除某些点。在这一节中，我们介绍一种基于像素集是否位于指定形状的曲线上的方法。一旦检测到，这些曲线就会形成边缘或感兴趣的区域边界。一个位于直线上的子集若给定一幅图像中的”个点，假设我们希望找到这些点中一一种可行的解决方法是先找到所有由每对点确定的直线，然后寻找靠近特定直线的点的所有子集。这种方法涉及-.1)2-”条直线，然后，对于每个点，要与所有直线执行(ononon- )2~r”次比较。这种方子找 n(n-法因为计算量太大而基本上没有应用价值一种替代方法，通常称为霍夫变换。考虑x平面上的一个点(众,y)）和斜霍夫[Hough 1962]提出一截式形式为y,=ax,+b的一条直线。通过点(,y,)的直线有无数条，且对α和历的不同值，它们都然而，将该等式写为b=一x,a+y，并考虑αb平面(也称为参数空间)，将得到满足方程y,=4x,+b。红一直线的方程。此外，第二个点(,:x)在参数空间中也有一条与之相关联的直线，固定点(x,y)的单一除非它们是平行的，否则这条直线会与积:)）相关联的直线相交干点(:.2），其中“为斜率・你是事实上，这条直线上的所有点在参数空间中都有包含y平面中点(α,y)和点Cx,y）的直线的截距。相交于点(a',b)的直线。图10.31说明了这些概念。图10.31(b)参数空间(ab xy平面；・可以画出对应于》平面中所有点(:2X)的参数宅间真线、并且空闸中的主聚直线可以原理上，一个实际在参数空间中通过确定的点来找到，大量的参数空间的线在此点处相交。然而，这种方法的一困难是，当该直线逼近垂直方向时，a(直线的斜率)会趋于无限大。解决该困难的方法之一是使用条直线的法线表示:xcos8 + ysin = P(10.2-38图10.32(a)示例了参数p和8的几何解释。*水平直线有0=0°，p等于正的x截距。类似地，垂直直。p等于正的y截距；或者有0=-90°，p等于负的y截距。图10.32 (6)中的每条正弦线有6 =90°，由线表示通过x平面中一一个特殊点(Cx,yx)的一族直线。图10.3206)中的交点(p,e)对应于图10.32 a）中通过点(G,y)和点(G,)y）的直线。xcos + ysin图10.32Ga)xy平面中直线的(p,B)参数化；(b） pe平面中的正弦曲线，交点(P,0）对应于通过y平面中点(x,y,）和点（(x,y)的直线；（）pe平面划分为累加单元霍夫变换计算上的魅力在于可将p0参数空间划分为所谓的累加单元，，如图 10.32 (c)所说明的那其中L和-…》是所期望的参数值范围-90*≤0≤90°和-D≤p ≤D，其中D是图像中对角之间的最大距离。位于坐标4。)处的单元具有累加值AG,)，、它对应于与参数空间坐标(p,.0，）相关联的正方形。最初，将这些单元置为零。然后，对于y平面中的每个非背景点(×x,yx)），令0等于02756轴上每个允许的细分值，同时使用方程p = x cos8 + yp sine解出对应的p。对得到的p值进行四舍五人，得到沿p轴的最接近的允许单元值。如果选择的一个e,值得到解P。，则令A(p,.4)=A(p,.4)+1。这一过程结束后，Ai.0中的值P将意味着y平面中有P个点位于直线xose ysin e， = ，,上。平面中的细分数量决定了这些点的共线性的精确度。。可以证明(见习题10.24)，刚刚讨论的这种方法的计算次数与x平面中非背景点的数量n成线性关系。列10.13基本霍夫变换性质的说明图 10.33 显示了基于式(10.2-38)的霍夫变换。图 10.33 a)显示了一幅大小为101xi01像素具有五个，图1.33 6)显示了使用p轴和β轴的单位细分将每个点映射到pβ平面上的结果。）的取标记点的图像,值范围为±90*，，p轴的范围为士√2 D，其中D是图像中对角点间的距离。如图 10.33 ()所示，每条曲线。点1的映射得到的水平直线是具有零幅值的正弦曲线的一种特殊情形都有不同的正弦曲线形状。图 10.33 6b)中标为A(不要与累加值混淆)和B的点显示了霍夫变换的共线性检测性质。点A表示对应于y图像平面内点1,3和5的曲线的交点。点A的位置指出这三个点位于一条过原点(p=0)且方向为5°的直线上[见图10.32(a)】。类似地，在参数空间中相交于点B的曲线指出点2,3和4位于方向为一-45且与原点的距离为p= 71(即从图像原点到对角的对角线距离的一一半，已四舍五入为最接近的整数值)的直线上。最后，图10.33 6)中标为Q,R和S的点说明了这样一个事实，即霍夫变换展示了在参数空间左边缘和右边缘处的一种反射邻接关系。这一性质是0和p在±90边界改变符号的结果。图10.33（a)包含5个点的、、大小为101×101像素的图像；(b)对应的参数空间「为便于观着，图(a)中的点已被放大丁尽管到目前为止我们关注的重点始终在直线上，但霍夫变换也适用于形如g(v.26)=0的任何函其中，是坐标向量，e是系数向量。例如，，位于圆(x-c,)* +(y-cp)* =cs(10.2-39）上的点可以使用刚才讨论的方法来检测。不同之处是存在3一个三维参数空间中，这三个参数导致了类似立体的单元和形如 Ai ，、)的累加器。该过程是增加c,和心满足式（102-39)的心,，并更新与三元组（G,2.6,)相关联的累加单元。很清楚，霍夫变换的复杂性取758决于给定函数表达式中的坐标和系数数量。霍夫变换有可能进一步推广到检测无简单解析表达式的曲如变换为灰度级图像那样的应用。本章末尾包含了处理这些扩展功能的一些参考文献。线，东我们现在回到边缘连接问题上来。基于霍夫变换的一种连接方法如下：使用本节中先前讨论的任何技术得到一幅二值图像指定p0平面中的细分。对像素高度集中的地方检验其累加单元的数量检验选中单元中像素间的关系(主要针对连续性）在这种情况下，连续性通常以对应于给定的累加单元计算不连续像素间的距离为基础。如果缝隙的长度比指定的阈值小，与给定单元相关联的一条直线中的缝隙则被桥接起来。注意，可能仅以方向为基础聚合直线这样的事实是一个可用于整个图像的全局概念，它仅要求我们考察与指定的累加单元相关联的像素。与与前两节中讨论的方法相比，这是一个明显的优点。下例说明了这些概念。使用霍夫变换连接边缘列10.14图 10.34 (a)显示了一幅航拍的机场图像。该例的目的是使用霍夫变换提取主要跑道的两条边。解决这样的问题可能很重要，例如，涉及飞行器自动导航的应用图 10.34(a)一幅大小为502×564的机场航拍图像；b)使用坎尼算法得到的边缘图1像；《()霍夫参数空间(方框强调了与长垂直线相关联的点）；（a图像平面中对应于方框所强调的点的直线；（e)已叠加到原图像上的直线第一步是得到一一幅边缘图像。。图1034 0)显示了使用坎尼算法得到的边缘图像，算法中使用的参数和过程与例10.9中使用的相同。为计算霍夫变换，使用10.25节或 10.2.6 节中讨论的任何边缘检测技术可得到类似的结果。图10.34(c)显示了6以1°递增和p以1个像素递增得到的霍夫参数空间。感兴趣的跑道偏离正北方向约1°，，所以，我们选取对应于±90°并包含最高数量的单元，因为跑道在这些方向面向最长的线。图10.34.(0)的边缘上的小白框强调了这些单元。结合图10.33 6)）如先前提及条线是等价的(即它们是两条垂直线)。图10.34d)显示了对应于刚才讨论的两个累加单元的直线,图 10.34 e）显示了已叠加到原图像上的这些直线。这些直线是通过连接不超过图像高度的20%(约10个像259素)的所有间隙得到的。这些直线清楚地对应于感兴趣跑道的边缘。476注意，解决这一问题的唯一关键知识是跑道的方向和观察者相对于跑道的位置。换甸话说，自动导航飞行器应该知道，如果跑道朝北，且飞行器的飞行方向也是北，跑道会垂直地出现在图像中。其他相关的方向可采用类似的方式处理。全世界的跑道的方向在飞行图上都是可用的，且使用GFS(全球定位系统)可很容易得到飞行方向的信息。该信息还可用于计算飞行器和跑道之间的距离，这样，允许我们估计这些参数，例如相对于图像尺寸的直线的预期长度，就像我们在该例中所做的那样。阈值处理10.3由于阈值处理直观、实现简单且计算速度块，因此图像阈值处理在图像分割应用中处于核心地位。在3.1.1节已介绍了阈值处理，自那时起在各种讨论中我们就使用过阈值处理。在本节，我们将，并用比迄今为止已有的更为一般化的方式阐述该技术。以更为正式的方式讨论阈值处理，10.3.1基础知识在前面的章节中，，我们采用首先寻找边缘线段，然后试图将这些线段连接为边界的方法来识别区域。在这一节中，我们将讨论基于灰度值和/或灰度值的特性来将图像直接划分为区域的技术。灰度阈值处理基础假设图10.35 (a)中的灰度直方图对应于图像f(G, J)，该图像由暗色青景上的较亮物体组成，以这样的组成方式，物体像素和背景像素所具有的灰度值组合成了两种支配模式。从背景中提取物体的一个将这些模式分开的阈值T。然后，, fGx, y)>T的任何点α,y)称为种明显方法是选择一一个对象点；否则将该点称为背景点。换句话说,分割后的图像g(G,y)由下式给出：1f(x, y) >710.3-1）g(x, y)=(0,f(x,y) ≤7个适用于整个图像的常数时，该公式给出的处理称为全局阙当T是尽管我们遵从使用灰度0来表示值处理。当T值在一幅图像上改变时，手我们使用可变闽值处理这个术背景像素而使用灰度米表示物体。术语局部阈值处理或区域阔值处理有时用于表示可变阈值处理，像素的约定，但在式(10.3:1中也可使用任何两个明显不同的值此时，图像中任何点α, y)处的T值取决于(, y)的邻域的特性(例如邻域中的像素的平均灰度)。如果T取决于空间坐标(α, y)本身，则可变阈值处理通常称为动态闽值处理或自适应阈值处理。。这些术语的应用并不普遍，在关于图像处理的文献中，话读者可能会着到它们交替地使用图10.35 (b)显示了一一个更为困难的阈值处理问题，它包含有三个支配模式的直方图，例如，，这三个支配模式对应于暗色背景上的两个明亮物体。这里，，如果（(x,)<7，则多阈值处理把点《x,y)分类为属于背景；如果T<J(x,.) 7,，则分为一一个物体；如果f(x. >7,，则为分另一个物体。即分割的图像由下式给出：f(x, y) > 75a,(10.3-2）g(x, y)=也T<f(x,J)<≤T2f(x,) ≤7其中，α,b和c是任意三个不同的灰度值。在10.3.6节中，我们将讨论双阈值处理。要求两个以上阈值的分割问题很难解决(通常是不可能的)，而较好的结果通常可用其他方法得到，如 10.3.7节中讨论亿a」的可变阈值处理方法或10.4 节中讨论的区域生长方法。韦10章477可被(a)单阈值和(6)双阈值分隔的灰度直方图图10.35我们可以凭直觉推断灰度阈值的成功与否直接关系到可区分的直方图模式的基于前面的讨论，谷的宽度和深度。而影响波谷特性的关键因素是：（1)波峰间的间隔(波峰离得越远，分离这些模式的2)图像中的晚声内容(模式随噪声的增加而展宽)；(3)物体和背景的相对尺寸；（4)光源九会越好)；的均匀性；（5)图像反射特性的均匀性。图像阈值处理中噪声的作用作为噪声如何影响一幅图像的直方图的说明，考虑图10.36 (a)。这幅简单的合成图像中没有噪声因此，其直方图由两个波峰模式组成，，如图10.36(の)所示。将该图像分割为两个区域是很容易的任务,一个阈值放到两个模式之间的任何位置。图10.36 (b)显示了被均值为零、标准差为10个灰度只需将一级的高斯噪声污染了的原始图像。尽管相应的直方图模式现在较宽〔见图10.36 (e））」，但它们的间隔故它们之间波谷的深度足以使得两个模式更易于分开。个波峰之间的中间位置的一卫够大，。放在两阈值就可以很好地分割该图像。图10.36(c)显示了受到均值为零、标准差为50个灰度级的高斯噪声污染该图像的结果。。如图10.36 (6)中所示的直方图那样，现在情况是如此严重，以至于无法区分两个模式。若没有附加的处理(如10.3.4节和10.3.5 节中讨论的方法)，我我们对于分割这样的图像寻找合适的阈值就没有什么希望。图10.36(a无噪声的8比特图像；b)带有均值为零、标准差为10个灰度级的加性高斯噪声的图像:(e)带有均值为零、标准差为50个灰度级的加性高斯噪声的图像：a-(D相应的直方图光照和反射的作用冬10.37说明了光照对一幅图像的直方图的影响。图10.37 (a)是来自图10.36 6b)的噪声图像图10.37 (d)显示了它的直方图。像先前那样，使用一个单阈值很容易分割该图像。我们可以通过一直方图显示在图10.37(e)中。图10.37 （c)显示了这幅图像与该阴影模式的乘积。如图10.37()所示，波峰之间的较深的波谷在模式的分离点处被污染了，如果没有附加的处理(见，10.3.4节和10.3.5 *)，分。如果光照非常均匀，但图像的反射不均匀也会得到类似的结果。例如，物体的表面或离是不可能的。背景自然反射变化的情况就是如此。(a)带有噪声的图像；(b)在[I.2,0.6]范围内的灰度斜坡图10.37图像；（C)图(a)和图()的乘积；《d)～()相应的直方图前面章节中的关键是在使用阈值或其他分割技术的图像成功分割斜坡图像的真方图是均匀照明和反射起到了核心作用。。因此，在可能的情况下，在解决分实现完美的均匀性取决尺寸和灰度比特数。。当不可能控制这些参割的问题中控制这些参数应是首先考虑的问题。5的256级斜坡图数时，有三种针对该问题的基本解决方法。第一种方法是直接校正这个均匀的直方图，像有一种阴影模式。例如，非均匀(但固定的)光照可以用相反的模式与图像钼同灰度级数的斜坡图像则没有均匀的直方图。相乘来校正，相反的模式可以用一个恒定灰度的平坦表面成像来得到。第二种方法可通过用诸如 96.3 节中介绍的顶帽变换处理来尝试校正全局阴影模式。第三种方法是使用可变阈值近似处理非均匀性，，如10.3.7节讨论的那样。基本的全局阈值处理10.3.2正像前节说明的那样，当物体和背景像素的灰度分布十分明显时，可以用适用于整个图像的单个(全局)阈值。在大多数应用中，通常图像之间有较大变化，即使全局阈值是一种合适的方法，对每幅图像有能力自动估计阈值的算法也是需要的。下面的迭代算法可用于这一目的：为全局阈值T选择一个初始估计值。在式(10.3-1)中用T分割该图像。这将产生两组像素：G,由灰度值大于T的所有像素组成Gz由所有小于等于T的像素组成。3.对G,和G,的像素分别计算平均灰度值(均值Dm和m计算一个新的阈值：4.(m,+m）5.重复步骤2到步骤4，直到连续迭代中的T值间的差小于一个预定义的参数A7为止。图像分+79一个相当清晰的波谷时，这个简单的算法工作得很好。当与物体和背景相关的直方图模式间存在一在速度是一个重要因素的情形下，参数A7用于控制迭代的次数。通常，A7越大，则算法执行的迭代次数越少。所选的初始阈值必须大于图像中的最小灰度级而小于最大灰度级(见习题10.28)。图像的平均灰度对于7来说是较好的初始选择。例10.15全局阈值处理图 10.38 显示了用前述算法以阈值估计为基础分割的例子。图10.38 a)是原图像，图10.386b)是该图，该直方图显示有一一个明显的波谷。用T=m(平均图像灰度)开始，并令A7 =0，应用前述迭像的直方图，代算法经过3次迭代后，，得到阈值T=125.4。图10.38 (c)显示了使用阈值7= 125来分割原图像得到的结果。如期望的那样，从直方图清晰的模式分离中，物体和背景间的分割相当有效。图10.38(a)带噪声的指纹；(b)直方图；（c)使用全局阈值对图像分割的结果(为清蜥起见，边界是加上去的)(原图像由美国国家标准和技术研究所提供）通过对输入图像成功地进行阈值处理并在每一步计算均值说明了前述算法，因为以这种方式来介绍该算法更为直观。然而，有可能根据图像的直方图表达的全部计算开发一种更有效的过程，它仅仅计算一次(见习题10.26)。10.3.3用Otsu方法的最佳全局阈值处理阈值处理可视为一种统计决策理论问题，其目的是在把像素分配给两个或多个组(也称为分类）的过程中引入的平均误差最小。这一问题已知有一一个精致的闭合形式的解，称为贝叶斯决策规则(见2.2.2 节)。该解仅以两个参数为基础：即每一类的灰度级的概率密度函数(PDF)和在给定应用中每类出现的概率。遗憾的是估计 PDF并不容易，通常采取假定一个 PDF形式的可行方法来简化该问题，例如，假设它们是高斯函数。即便采用了简化，用这些假设求解的过程也可能是复杂的，并且对实际应用也不总是合适的。本节中讨论的称为QOIsu方法(Otsu979)是另一种有吸引力的方案。该方法在类间方差最大的情况下是最佳的，即众所周知的统计鉴别分析中所用的度量。。基本概念是好阈值分类就它的像素灰度值而论应该是截然不同的，，反过来说，就它的灰度值而言给出最好的类间分离的阈值就是最好的(最佳的)阈值。。除了其最佳性之外，Otsu方法有一个重要的特性，即它完全以在一幅图像的直方图上执行计算为基础，、直方图是很容易得到的一维阵列。令1.,.2.…L-1)表示一幅大小为MxN像素的数字图像中的L个不同的灰度级，n,表示灰度级为之图像中的像素总数《MW MwN=。、+，"，。  “。_口一化的直方图见33节)其有分园i的像素数480由此有量p,=n,/MN，F(10.3-3）n,>0=1，现在，假设我们选择一个阈值了15 =k.0<k<L-1.并使用它把输入图像网值化处理为两类C;和C其中，C,由图像中灰度值在范围[0,]内的所有像素组成、C,由灰度值在范围[k+ 1,.L-1]内的所有像索组成。用该阈值，像素被分到类C,中的概率P,()由如下的累积和给出：R(k）(10.3-4）i=0换一个角度看，这是类C,发生的概率。例如，如果我们置k=0，则任何像素分到类C,中的概率为零。类似地，类C,发生的概率为(10.3-5RB(6)=,=1-P(k）由式(33-18)，分配到类C;的像素的平均灰度值为m,465 iRu/Cc）Zi"C/070/ R(C）(10.3-6）P(k）其中・、R(6)由式(10.3-4)给出。式(10.3-60第一行中的PGi/C;)项是值；的概率，已知i来自类C。该式中的第二行来自贝叶斯公式：P(A/B)= P(B/A)P(A)/ P(B）第三行遵循这样一个事实，即给定i的C,的概率PC,7)为1，因为我们只处理来自类C,的i值。此外，P(0)是第注个值的概率，很简单，、它是直方图p(）的第i个分量。最后，P(C)是类C,的概率，由式(10.3-4)我们知道它等于R(k）类似地，分配到类C中的像素的平均灰度值为王iP(i/Cz）m,(k)=(10.3-7）P,6)左直至级k的累加均值由下式给出:(10.3-8m(k）三而整个图像的平均灰度(即全局均值)由下式给出:(10.3-9）图像分481下面两个公式的正确性可通过直接代入前面的结果来验证：10.3-10）Rm + Bm- =m6(10.3-11）R+P.其中，为有利于清楚地说明，我们暂时忽略了k项。为了评价级别k处的阈值的“质量"，我们使用归一化的无量纲矩阵:2日(10.3-12）Gc己是全局方差[即图像中所有像素的灰度方差，如式(3.319)给出的那样]，其中，2i-mGPn，(10.3-13）o另为类间方差，它定义为oz= R(m, -mo)/+R,(m,-me)）(10.3-14）该表达式还可写为oi= RR(m m2）10.3-15）(mcPR(-P）m。和m如先前说明的那样。该式的第一行来自式(10.3-14其中，式10315)的第二步仅在R大于0且式(103102和式(123-1)。第二行来自式(10.3-5）到式(10.:9)。这种于1时才有意义，鉴于式io3-11).形式在计算上稍微有效一一些，因为全局均值m。仅计算一次，故对k这表明B必须满足相同的条件的任何值仅需要计算两个参数m和片。从式(10.3-15)的第一行我们可以着出，下两个均值m,和m。彼此隔得越远，oz越大，这表明类间方差是类之间的可分性度量。因为己是一个常数，由此得出，也是一个可分性度量，且最大化这变量等价于最大化o为。然后，目标是确定阈值k，它最大化类间方差，，就像本节开始时说明的那样注意，式(10.3-12)隐含假设了o >0。仅当图像中的所有灰度级相同时，这一方差才为零，这意味着仅存在一类像素。同样、这也意味着对于常数图像有n=0，因为来自其自身单个类的可分性为零。再次引入k，我们有最终结果:10.3-16)DcLmoR(k)-m(k)1口3(k)=(10.3-17）R(k)[L- R(k)1从而最佳阈值是k"，其最大化o云(k):Oz(k*)=。-"2,.6i）(10.3-18)换句话说，为寻找公”，我们对人的所有整数值「保持上述0<R4)<1的条件]简单地计算式10318.、阿482大的各个值做平均。。可以证明(见习题10.33)，在0<R(k)<1的条件下，总存在一个最大值。对于所有的k值，计算式(10.3-17)和式（10.3-18)的代价相对较小，因为k所具有的整数值的最大数量是L。输入图像就可像之前那样进行分割:旦得到kf(x,Jy) > k*1,g(x, y)=(10.3-19）0,f(x, y) ≤k*其中，x= 0, 1,2.…，M-1和y = 0, 1,2,.…,N-1。注意，仅仅用fG, y)的直方图就可以得到计算式（10.3-17)所需的所有参量。除了最佳阈值外，与分割图像有关的其他信息可从直方图中提取。例如，在最佳阈值处计算出的类的概率R(k")和R,(k")，指出了经阈值处理后的图像中由该类(像素组）所占据的面积部分。。类似地，均值m,(k")和m,(k")是原图像中类的平均灰度的估计在最佳阈值处计算的归一化度量，，即nk"），可用于得到类别尽管我们的兴趣是最佳阀值公°处的可分性的定量估计，同时给出了很容易对一幅给定图像进行阈值处理，值、但该不等式对于范用I0, L-1内的任何k值均成立。的概念。运这一度量的值域为0≤n(k") ≤1(10.3-20)，且仅由灰度等于0和L-1的二值如先前提到的那样，仅由单一且恒定灰度级的图像就能得到下界，图像就能得到上界(见习题10.34)。Otsu算法小结如下主计算输入图像的归一一化直方图。使用p,i=0,1,2,.,L-1表示该直方图的各个分量。2.用式（10.3-4)，对于k=0,1,2, …,L-1，计算累积和R(k）。3.用式(10.3-8)，对于k=0,1,2,…,L-1，计算累积均值m(k）。用式10.3-9)计算全局灰度均值m。用式(10.3-17)，对于人=0,1,2,…,L-1，计算类间方差o;(k）。得到Otsu阈值k"，即使得G;(k)最大的k值。如果最大值不唯一，用相应检测到的各个最大值人的平均得到人"7.在k=k"处计算式(10.3-16)，得到可分性度量n下面的例子说明了前述概念。使用Otsu方法的最佳全局阈值处理。列10.16到10.39(a)显示了聚合细胞的光学显微镜图像，图10.39 6)显示了其直方图。该例子的目的是从背录中分割出分子。图 10.39 (C)是使用前节给出的基本全局阈值处理算法聚合细胞是使用聚合物人工生成导到的结果。。因为直方图没有明显的波谷，，且背景和物体间的灰度差别的细胞・种细胞可用于向人体内的目标区域退小，所以算法未完成期望的分割。图10.39(4)显示了使用Otsu方法得输送药物。到的结果。该结果明显好于图 10.39(c)中的结果。。使用基本算法计算出的阈值是 169.，而使用Otsu方法计算出的阈值是 181，后者更接近图像中定义为细胞的较亮区域。可分性度量n是0.467。有趣的是,将Otsu方法应用于例10.15中的指纹图像,得到的阈值和可分性度量将分别为125和0.944结果并不意外。事实上，由于原来的模式间的分离度相对较大，并且它们之间的波谷较深，所以可分性度量较高。483第 10章图10.39a)原图像；b)直方图(为突出低值中的细节，。高峰已被裁剪)；（c)用10.3.2 节的基本全局算法得到的分割结果；；d)用Ots。方法得到的结果(原图像由宾夕法尼亚大学的Daniel A Hammer 教授提供）用图像平滑改善全局阈值处理10.3.4正如在图 10.36 中解释的那样，噪声可将一个简单的阈值处理问题变为一个不可解决问题。当噪声不能在源头减少，并且阈值处理又是所选择的分割方法时，那么通常可增强性能的一种技术是在阈值处理之前平滑图像。。我们用一个例子来说明这一一方法图10.404a)是来自图10.36(e)的图像，图10.406b)显示了其直方图，图10.40(e)是使用 Ousu方法对图像进行阈值处理后的结果。白色区域中的每个黑点和黑色区域中的每个白点是阈值处理的误差，所以分割很不成功。图10.40(d)显示了使用一个大小为5×5(图像大小为651×814像素)的均值模扳平滑噪声图像后的结果，，图10.40(e)是其直方图。由于平滑处理，直方图形状的改进很明显，因此我们预料对平滑后的图像进行阈值处理所得到的结果将近于完美。如图 10.40(6)所示，事实的确如此。经平滑和分割后的图像中，，物体和背景间的边界稍微有点失真是由于对边界的模糊造成的。事实上，一幅图像侵蚀得越多，分割后的结果中的边界误差就越大。我们应该预料到，我们平滑一i e图10.40a)来自图10.36 的噪声图像；b)该图像的直方图；（c)用Otsu方769法得到的结果；（d)用一个大小为5×5的均值模板平滑噪声图像的770；（e)结果图像的直方图;；(的用Otsu方法阈值处理后的结果结果；下面我们考虑降低图 10.40a)中相对于背景的区域大小所带来的影响。图10.41 (a)显示了该结这幅图像中的噪声是均值为零、标准差为10个灰度级(相对于前一例子中的50)的加性高斯噪富。直方图没有清晰的波谷，因此我们应该预料到分割会失败，图 10.41（C)中如图10.41 (b)所示，的结果确认了这一事实。图10.41 (d)显示了使用大小5×5的均值模板对图像进行平滑后的结果图10.41 (e)是其直方图。如预料的那样，最终结果减小了直方图的扩散，，但分布仍是单峰形式。如，分割再一次失败了。失败的原因可归于这样一一个事实，即区域太小，以至于该区图10.41 (f)所示，域对直方图的责献与由噪声引起的灰度扩散相比无足轻重。在这种情形下，下一节讨论的方法可能更成功。图10.41(a)噪声图像；；(b)其直方图;；（c)用 Otsu方法得到的结果；d)用大小为5×5的均值模板平滑噪声图像后的结果；(e)结果图像的直方图；(们)用Osu方法对图像进行阈值处理后的结果。两种情形下，阈值处理均失败利用边缘改进全局阈值处理10.3.5基于前四节中的讨论，，我们得出如下结论：如果直方图的波峰是高、窄、对称的，且被深的波阈值的机会是相当大的。改进直方图形状的一种方法是仅考虑那些位于谷分开，则选取一个“较好”・种直接且明显的改进是直方图很少依赖物体和背景的相对大或靠近物体和背景间的边缘的像素。大背景区域上一个小物体(或相反)组成的图像的直方图将会有一个较大的波峰，因为一种例如,类型的像素高度集中。在前一节中我们已了解到，这可能会导致阈值处理失败。如果仅用位于或接近物体和背景间的边缘的像素，则得到的直方图将有几个高度近似相同的波峰。此外，像素位于物体上的概率将近似等于其位于背景中的概率，从而改进了直方图模式的对称性最后，如下段中指出的那样，用满足某些基于梯度和拉普拉斯算子的简单度量的像素有加深直方图波峰间的波谷的倾向。刚才讨论的方法假设物体和背景间的边缘是已知的。很明显，该信息在分割期间是不可用的因为寻找物体和背景间的分界线正好也是分割所要做的工作。然而，根据 10.2 节中的讨论，一像素是否位于边缘上的迹象可通过计算其梯度或拉普拉斯来确定。例如，，在一个边缘的过渡处，拉普拉斯的平均值为零(见图 10.10)，，因此，根据拉普拉斯准则选取的像素所形成的直方图的波谷应该很少。这一特性往往会产生上面讨论的较深波谷。实际上，无论是使用梯度图像还是使用拉普拉斯图像得到的典型结果相比较，后者比较有利，因为它在计算上更有吸引力，同时也是一一个各向同性边缘检测器第 10章图像前述讨论可小结为如下算法，其中f(G,y)是输入图像:无论是、用10.2 节讨论的任何一种方法来计算一幅边缘图像，立普拉期图像的梯度图像的幅度.x. )梯度的幅度还是拉普拉斯的绝对值都可以。。在这种情况每幅图像指定并隶两个指定一个阈值T。以得到标用步骤2中的阈值对步骤1中的图像进行阈值处理,当需要对有效的边缘点施“强边缘像素二值图像8,(*x,y。在从(x,.y)中选取对应于的下一步中，该图像用做一幅模板图像心仅用了(Gx.)中对应于8 4×,.)中像素值为1的位置的像素计算直方图用步骤4中的直方图全局地分割f(Gx, )，例如使用Otsu方法。如果将了设置为小于边缘图像的最小值的任何值，根据式(10.3-1)，8r(Cx,Jy)将由全1组成，意味着f(α, y)的所有像素将用于计算图像的直方图。在这种情况下，第”个百分比是大于给定集合内所有数字的n%的最小数字。例如前述算法变成使用原始图像的直方图的全局阈值处理。习惯上以百分如果读者在一次测验中得到了9比的形式来指定了值，百分比通常设置得较高(如 90%)，以便在计算分，且该分数大于参加此次测验的中用梯度/拉普拉斯图像中的较少像素。下面的例子说明了刚才讨论的所有学生中的85%的学生得到的分概念。第一个例子使用梯度，第二个例子使用拉普拉斯。在两个例子数，则读者在测试分数中位于第85个百分比处。无论使用哪一种方法都可得到类似的结果。重要的问题是生成一幅合适的导数图像例10.17用以梯度为基础的边缘信息改进全局阈值处理。图 10.42a)和(b)显示了来自图 10.41的图像和直方图。您可以看到，这幅图像不能用平滑后紧跟着阈值处理来分割。这个例子的目是解决利用边缘信息的问题。图10.42(e)是在99.7%处经阈值处理后的梯变幅度图像。图 10.424)是用输入图像与这个(模板）图像相乘形成的图像。图10.42(6e)是图 10.42(d)中非零元素的直方图。注意，该直方图具有先前讨论的重要特性，即它有被一一个较深的波谷分开的对称模式。这样，尽管原始带噪声图像的直方图未提供成功进行阈值处理的希望，，但图 10.42(e)中的直方图表明，从背景中提取出小物体的阈值处理的确是可能的。图10.42(0中的结果表明事实的确如此。这幅图像是这样得到的：以图 10.42(e)的直方图为基础，用Oisu方法得到一个阈值，然后将该阈值全局地应用到图10.42 4)中的带噪声图像。其结果近于完美。例10.18用拉普拉斯为基础的边缘信息改进全局阈值处理。在这个例子中，我们考虑一个更为复杂的阈值处理问题。图10.43(a)显示了一幅酵母细胞的8比特图像，其中，我们希望用全局阈值处理得到相对于亮点的区域。首先，图 10.436)显示了该图像的直方图，图10.43(c)是把 Osu方法直接用于所示的直方图的图像上得到的结果。我们看到，Otsu方法未能实现检测亮点这一原始目标，并且，尽管该方法能隔离出某些细胞区域本身，但右侧的几个分割后的区域却没有分开。Otsu方法计算出的阈值是42，可分性度量是0.636。用范围[0,255]内的灰度级115作为T值进行阈值处理.这个T值近似对应拉普拉斯图像绝对值中的99.5%.所以在这个水平上阈值处理应该得到一个稀疏的像素集合，如图 10.4364)所示。注意，在该图像中，多点聚集在亮点的边缘附近，这正如从前面的讨论所预料的那样。图10.43 (e)是图(a)和图(d)之积的非零像素的直方图。最后，图10.43 6)显示了以图10.43(e)中的直方图为基础，采用 Otsu方法全局地分割原图像后的结果。该结果与图像中亮点的位置一一致。用Oisu方法计算出的阈值是115,可分性度量是0.762.这两个值都要高于使用原始直方图得到的值。774486图10.42a)来自图 10.41 （a)的带噪声图像；Gb)该图像的直方图；(c)在99.7%处经阈值处理后的梯度幅度图像；；（d)图(a)和图(c)之积形成的图像；（e)图(d)所示图像中非零像素的直方图；以直方图(e)为基础，用Otsu阈值处理分割图像的结果。阈值为134，在该直方图中处在两个波峰间的近似中间的位置图 10.43(a)酵母细胞图像；(b)图(a)的直方图；《c)使用图(b)中的直方图，用 Otsu方法对图(a)进行分割；(d)经阈值处理后的绝对拉普拉斯图像；（e)图(a)和图(d)乘积中的非零像素的直方图；（价以(e中的直方图为基础，使用Otsu的方法对原图像进行阈值处理后的结果(原图像由南加利福尼亚大学的Susan L. Fosburg 教授提供）通过在可变的百分比处设置阈值，我们甚至还可以改善细胞区域的分割。例如，图10.44显是示了使用前段中的相同步骤得到的结果，但阈值设置在55 处，它近似拉普拉斯图像最大绝对值的5%。该值位于图像中的所有值的539%。很明显，这个结果好于图10.43(e)所示对原始图像的直方图用Osu的方法得Lz到的结果。图像分割87多阈值处理10.3.6迄今为止，我们关注的是用单一全局阈值对图像进行分我们可将10.3.3 节中介绍的阈值处理方法扩展到任意数量射。。的阈值，因为以这种方法为基础的可分性度量也可以扩展到任意数量的分类(Fukunhagal1972)。在K个类C,C,,C。的情况下，类间方差可归纳为下面的表达式:艺R(m, -mo）(10.3-21）5B其中，图 10.44使用图10.43 4)-(D中解释的相可过程、对图10.43(a)中的图(10.3-22）像进行分割后的结果，但对绝对拉普拉斯图像进行阈值处10.3-23）理时，使用了一个较低的阈值并且，mo是由式(10.3-9)给出的全局均值。K类由K-1个阈值来分离，这些值k;.k人k元是式(10.3-21)的最大值:of(k;，kz，(10.3-24）,o%Kk，人z k-）虽然这个结果通常很完美，但当分类数量增加时它会开始失去意义，因为我们仅处理个变量(灰度〉事实上，通常类间方差是依据以向量描述的多个变量来计算的(Fukunal1972)）。实际中，当我们有，那么使用多个全局阈值处理就被视为一种可行的方理由相信使用两个阈值可以有效地解决问题时，法。要求两个以上阈值的应用，通常使用更多的灰度值来解决。。而该方法使用的是附加的描述子(譬如彩色)，并且这种应用是以如10.3.8 节描述的模式识别问题来筹划的。对于由三个灰度间隔组成的三个类(这三个类由两个阈值分隔)，类间方差由下式给出：带有两个网值的阈值处理有时也称为滞后阔值处理(10.3-25）oi= R(m, -me)* + R,(m, -mo) + B(m -mo）其中，B =(10.3-26）P，和(10.3-27）如在式(10.3-10)和式(10.3-11)中那样，如下关系成立：(10.3-28）Pm, +Pm, + P3ms和(10.3-29）因此，我们门看到，P项、m项，以及口。都是人和人。的函教。两个最佳闽值人；和人；是使得o;(k,.人,） 口z7数学图像处理(第三版）大的值。换句话说，如在10.3.3节讨论的单阈值情况那样，我们用下式寻找最佳阈值:oz(k;,k5)=(10.3-30）_,Cz(k，k2）max,(该值是1，因为在）灰度处寻找阈值没有意义；还要记住，增该过程由选择第一个人值开始量值为整数，因为我们处理的是灰度)。接着，人的所有值在大于人和小于L--1的范围内增加(即然后，将k增大到其下一个值，。人。的所有值再次在大于人的所有值范围内增加。重复该过程，，直到k,=L-3为止。该处理的结果是个二维阵列of(k,ka)，最后一步是在该阵列中寻找最大值。直。对应于最大值的。值和k,值就是最佳阈值人'和kz"。如果存在几个最大值，则对应于人和人,的值被平均以得到最终的阈值。。然后，阈值处理后的图像由下式给出:J(x. <6a，8(x, )=k;< （(x. <6(10.3-31）f(x.J)>人2其中，α如和c是任意三个有效的灰度值。最后，我们注意到，在10.3.3 节中为单一阈值定义的可分性度量可直接扩展到多个阈值:oik:52n;,kz)=(10.3-32）D60是来自式(10.3-13)的总图像方差。其中，例10.19多个全局阈值处理・图 10.45 (a)显示了一一幅冰山的图像。。这个例子的目的是把图像分割成三个区域：暗背景、冰山的明。由图 10.45(6)中的图像直方图可以看出，解决这一问题需要两个阈值是很明显的。亮区域和阴影区域。按上面讨论的过程得到阈值k;*=80和k* =177，由图 10.45(6)注意到，它们靠近两个直方图波谷的中心。图10.45(G)是在式(10.3-31)中使用这两个阈值得到的分割。可分性度量是 0.954。这个例子能做到这样好的主要原因在于能寻找到三个具有明显可分模式的直方图，该图有适度宽度和深度的波谷。图 10.45(a)冰山图像；(b)直方图;(c)用双 Otsu阈值将图像分割为三个区域（原图像由NOAA提供）10.3.7可变阈值处理正如10.3.1 节中讨论的那样，例如噪声和非均匀光照这样的因素对阈值处理算法的性能起着重要作用。我们在10.3.4 节和10.3.5节说明过，图像平滑和使用边缘信息可以得到有益的帮助。然而，第10章常常会出现这种情况，即用迄今为止所讨论的任何方法解决问题时，要么这种类型的预处理不切实际要么对这一情形的改进简单而无效。在这种情况下，更为高级的且复杂的阈值处理涉及可变阈值问题在这一节中，我们讨论选择可变阈值的各种技术。图像分块可变阈值处理最简单的方法之一一是把一幅图像分成不重叠的矩形。这种方法用于补偿光照和/或反射的不均匀性。。选择的矩形要足够小，以便每个矩形的光照都近似是均匀的。我们用一一个例子来说明这一方法。例10.20通过图像分块的可变阈值处理图 10.46(a)显示了来自图10.37 (c)的图像，图10.46(6)显示了其直方图。当讨论图 10.37(c)时，我们可得出这样的结论:使用一一个全局阈值不能分割该图像,图10.46(c)和(d)已确认了这一事实,图10.46(c）和(d)分别显示了使用 10.3.2 节中讨论的迭代方案和 Otsu方法分割图像后的结果。两种方法产生了可比较的结果，结果中大量的分割错误显而易见。图 10.46(e)显示了已细分为6个矩形区域的原图像，图10.46)是对每幅子图像应用 Otsu全局方法得到的结果。。尽管分割结果中的一一些错误仍然是可见的，但在一一幅分割起来十分困难的图像上，图像细分产生了合理的结果。。分析每幅子图像的直方图，很容易就可解释这种改进的原因。如图 10.47所示，每幅子图像都由一个双模式直方图来表征，两个模式之间有一个较深的波谷，这是我们所知的将导致有效全局阈值处理的一个事实。s S图 10.46(a)带噪声阴影的图像；(b)该图像的直方图；（c)用来自10.3.2 节的全局迭代算法对图a)的分割；d)使用Otsu方法得到的结果；(e)分为6幅子图像后的图像；(D分别对每幅子图像应用Otsu方法的结果当感兴趣物体和背景占据合理的可比大小的区域时，通常图像细分工作得较好，如图10.46所示。不是这种情况时，典型地，该方法会失败，因为细分可能只包含物体或背景像素。虽然使用附加的技术来确定何时一个细分包含两种像素可以解决这一情况，但解决不同情况所要求的逻辑会变得很复杂。在百这种情况下，使用这一节其余部分讨论的方法可能更好490基于局部图像特性的可变阈值处理更为与前一节中讨论的图像细分方法相比般的方法是在一幅图像中的每一点(α,y)计算阈值该阈值是以一个或多个在(α,y)邻域计算的特性为基础的。虽然这可能是似乎有点费力的处理，但现代算法和硬件允许进行快速的邻域处理，特别是对于像逻辑操作和算术操作这样的普通函数一幅图像中每个点的一个邻域内的像素找们用一的标准差和均值来说明局部网值处理的基本方法。这两个量对于确定局部阈值非常有用，因为它们是局部对比度和平均灰度的描述子。令o。和m,表图10.47图10.46(e)中6幅子图像的直方图示一幅图像中以坐标(α，)为中心的邻域S,所包含的像素集合的标准差和均值(关于局部均值和标准差的计算，见3.3.4 节)。下面是可变局部阈值的通用形式:(10.3-33T, =ao, +bmy其中，α和b是非负常数，且10.3-34）1.=aO,,+bmc其中，m。是全局图像均值。分割后的图像计算如下：1,f(x,y) >7.(10.3-35）g(x, y)=0,J(x.y) <T、该式对图像中的所有像素位置进行求值，并在每个点(,y)处使用邻域S,其中，f(α，y)是输入图像。中的像素计算不同的阈值使用以、9的邻域计算出的参数为基础的属性，有效的权值可显著增强局部网值处理(计算量会适度增加)：Q(局部参数)为真g(x, y)=10.3-36）Q(局部参数)为假其中，Q是以邻域S。中像素计算的参数为基础的一个属性。例如，考虑如下基于局部均值和标准差的属性Qo,m.）其，f(x, y) > ao,AND f(x, y) > bm,(10.3-37）Q(O,, m,)/=假，其他主意，式式(10.3-35)是式(10.3-36)的一种特殊情况，、它是在了(x,. >7,时令Q为真、而在其他情况下令0为假得到的。在这种情况下，该属性仅简单地基于一个点处的灰度。基于局部图像特性的可变阈值处理。例10.21图 10.48a)显示了来自例10.18的酵母图像。。该图像有三个主要的灰度级，因此也许双阈值处理是一种较好的分割方法的假设是合理的。图 10.48 6)是使用10.3.6 节中说明的双阈值处理方法得到的结果。如图所示，从背景中分离出明亮区域是可能的，但是，在图像右侧的中等灰度区域没有完全分割〔回忆781图像分割我们在例10.18中，遇到的与图10436)类似的问题。为说明局部阈值处理的用法，我们用大小为3×3的邻域对输入图像中的所有α》计算局部标准差・。图1.4860显示了结果。注意、微明的外部线是如何正确地刻画细胞的边界的。接着，我们使用全局均值替代m,来形成式(10.3-37所示形式的一个属当背景近似恒定，并且所有物体的灰度高于背景灰度或低于背景灰度时，选择全局均值会给性。通常，出较好的结果。在完成的属性规范中，使用了值a = 30和b= 1.5(在类似这样的应用中，这些值通常是通过试验确定的)。然后，用式（10.3-36)来分割图像。如图 10.48 (d)所示，结果与输入图像中的两类灰度的大部分区域十分接近。尤其要注意所有的外部区城完全被正确分割了，且大多数较亮的内部区域也已被正确地分开了。Ga)来自图10.43的图像；；b)用10.3.6 节中讨论的双阈值处理方法图 10.48分割的图像；（c)局部标准差图像；d)用局部阈值处理得到的结果使用移动平均种特殊情形是以幅图像的扫描行计算移动平均为基础的刚才讨论的局部阈值处理方法的在速度是一种基本要求的文档处理中，这种实现相当有用。典型地，为减少光照偏差，扫描是以Z子形模式逐行执行的。令z,表示步骤人+1中扫描序列中遇到的点的灰度。这个新点处的移动平均(平均灰度)由下式给出:n(k+1) =10.3-38）=k+2-。这个初始值严格来说并不正确，因为单点的平均其中，n表示用于计算平均的点数，且m0)= 24/n。是该点自身的值。然而，、我们使用m0) =./n，因此，第一次开始计算式10.3-38)时，并不要求特一个角度看，如果图像的边界填充了n-1个0,它就深的计算。从另一是我们将得到的那个值。该算法仅初始化一次，不是在每行都初始化。个表达式在人时:平均是便用可因为对图像中的每个点都计算移动平均，因此，用式(10.3-35)实现分用点形成的。类似地、第二个表达，其中7, =bm，如是常数，m,是在输入图像中的点C、, )处使用式在人≥n+1时有效。式(10.3-38)得到的移动平均。列10.22用移动平均的文档阈值处理。图 10.49 (a)显示了一幅以斑点灰度模式遮蔽的手写文本图像。这种灰度遮蔽形式是使用摄影闪光灯得到的典型图像。图10.49 (b)是使用Otsu 全局阈值处理方法分割的结果。。全局阈值处理不能克服灰度变化并不意外。图1049(6）显示了采用移动平均的局部阈值处理的成功分割。一个经验是令n等于平均笔画宽度在这种情况下，平均宽度是4个像素，因此我们在式(10.3-38)中令n=20并使用b=0.5的5倍。作为这种分割方法有效性的另一一个说明，我们使用了与前一段中相同的参数来分割图 10.50(a)中的图像，该该图像被正弦型灰度变化污染了，当文本扫描仪的电源未适当接地时，会出现这种典型的变化。1783如图10.50(b)和(c)所示，分割结果类似于图10.49中的那些结果492图 10.49(a)被斑点遮蔽污染的文本图像；（b)使用 Otsu方法的全局阈值处理的结果；（c)使用移动平均的局部阈值处理的结果H图10.50(a)被正弦亮度遮蔽污染的文本图像；；b)使用Otsu方法的全局阈值处理的结果；c)使用移动平均的局部阈值处理的结果有趣的是，使用相同的n值和b值，两种情形下均得到了成功的分割结果，这说明了这种方法的相，当感兴趣的物体与图像尺寸相比较小(或较细)时，基于移动平均的阈值处理会工作得对稳定性。通常，很好。打印图像和手写文本图像满足这一条件。多变量阈值处理10.3.8迄今为止，我们已涉及了基于单个变量(灰度)的阈值处理。在某些情况下，传感器可产生多个可利用的变量来表征图像中的每个像素，这样，就允许进行多变量闽值处理个显著的例子就是彩色成像，其中红(R)、绿(G)和蓝(B)分量用于形成一一幅合成彩色图像(见第6章)。在这种情况下每个“像素””由三个值来表征，并且可以表示为一一个三维向量:,.6:2:3)"，其分量是一个点的RGB彩色。。这些三维点通常称为体素，以便与图像元素相对应表示体积元素。如 6.7 节中讨论的某些细节那样，多变量阈值处理可视为一种距离计算。假设我们想要从一幅彩色图像中提取具有指定颜色的所有区域，比如说，微红色。含表示我们感兴趣的平均做红色。基于这二参数来分制彩色殿像的一种方法是计算任意彩色点z和平均彩色α间的距离测度D,四)。然后，我们按如下方式分割输入图像：1,D(z,a)<1(10.3-39）0,其他共中・7是一个潮值。当然・要在输人图像中的所有坐标上执行距离计算・以便广生相应的分潮值注意、该公式中的不等式与我们在式(10.3-1中对于一个单变量阈值处理所用的不等式是相反的，原因是等式D0c.) =.7T定义了一个容积(见图 6.43)，并且它更直观地把分割后的像素值想象为包含在个容积中，而使背景像素值位于该容积的表面或外部。令DG,a) =- (α. )，式(10.3-39)便可简化为式(10.3-1）。78493图像分割。这样，阈值很明显，条件fG,y) >T基本上表示f的值和实线的原点间的欧氏距离超过了T值。处理就是基于距离测度的计算，并且，式(10.3-39)的形式依赖于所用的测度。通常，如果z是一一个 n维向量，我们从2.6.6节可知n维欧几里得距离定义为D(z,a）=lz-al=[(z-a)"z-a).10.3-40）等式DG,の) =7描述了欧几里得空间中(图 6.4.3中显示了一个三维例子)的一个球(称为超球)更有用的距离测度是所谓的马氏(Mahalanobis)距离，定义为D0(, a)=[z-a)"c"'(z-a)F10.3-41其中，如12.2.2 节讨论的那样，C是z的协方差矩阵。D(,)=7描述了一一个n维超球(图6.43 显示一个三维例子)。当C=1时，即为么阵时，该表达式就简化为式(10.3-40节中已给出了一个关于使用这些表达式的详细例子。我们在王 12.2 节中还要讨论使用我们在6.7基于决策函数的模式识别技术来分割图像的问题，这种问题可看成是多类、多变量阈值处理问题10.4基于区域的分割如10.1 节中讨论的那样，分割的目的是将一幅图像划分为多个区在继续阅速下文前，建议读者回域。在10.2 节中，我们其于灰度级的不连续性尝试寻找区域间的边界F 10.1节中介绍的术语。来解决这一问题；而在10.3 节中，，分割是通过以像素特性分布为基础的阈值处理来完成的，如灰度值或彩色。在本节中，我们讨论以直接寻找区域为基础的分割技术10.4.1区域生长正如它的名字所暗示的那样，区域生长是根据预先定义的生长准则将像素或子区域组合为更大。基本方法是从一组“种子”点开始，将与种子预先定义的性质相似的那些邻域像素添加区域的过程。到每个种子上来形成这些生长区域(如特定范围的灰度或颜色)。如稍后在例10.23中显示的那样，通常我们可基于问题的性质来选择一组或多组开始点。当先验知识不可用时，这一过程是在每个像素处计算相同特性的集合，最终，在生长过程期间，根据这些特生集合把像素分配给各个区域。如果这些计算的结果显示了一族值，则那些特性靠近这些族的中心的像素可以作为种子使用。相似性准则的选择不仅取决于所面对的问题，，还取决于现有的图像数据类型。例如，土地利用卫星成像分析非常倚重彩色的使用。如果彩色图像中没有可用的固有信息，那么解决这个问题将非常困难，甚至无法解决。如果图像是单色的，就必须使用一组基于灰度级和空间特性的描绘子(如矩或纹理)对区域进行分析。在第11章中，我们将讨论那些对区域特征有用的描绘子。如果在区域生长过程中没有使用连通属性，那么单独的描绘子会产生错误的结果。例如，设想仅有三个不同灰度值的像素的随机排列。将具有相同灰度级的像素组合形成一个“区域”，而不考虑连通性，会产生对当前讨论的内容毫无意义的分割结果。区域生长的另一个向题是终止规则的表示法。当不再有像素满足加入某个区域的准则时，区域生长就会停止。一像东度值、纹理和影色准则杰质上都是局部的、都没有考虑区域生长的“历史”。增强区域生长算法能力的其他准则利用了候选像素和已加入生长区城的像素间的大小、相似性等概念（如494候选像素灰度和生长区域的平均灰度的比较)，以及正在生长的区域的形状。这类描绘子的使用是以期望结果的模型至少部分可用这一假设为基础的。令(x.D表示一个输人图像阵列:SA:.)表示一个种子阵列，阵列中种子点位置处为1，其他位置处为0:2表示在每个位置G、处所用的属性。假设阵列f和S的尺寸相同。基于8连接的一本区域生长算法可说明如下关于连通分量,请参阅2.5.2节和.5.3 节；关于腐蚀，请参阅9.2.1 节。在SGx,Jy)中寻找所有连通分量，并把每个连通分量腐蚀为一个像素；把找到的所有这种像素标记为1，把S中的所有其他像素标记为0在坐标对(,y)处形成图像f。：如果输入图像在该坐标处满足给定的属性Q，则令10(x.,)=1，香则令了o(x,y)=0。令g是这样形成的图像：即把了。中为8连通种子点的所有1值点，添加到S中的每个种子点用不同的区域标记(如1，2, 3, …）标出g中的每个连通分量。这就是由区域生长得到的分割图像我们通过一个例子来说明这种算法的机理列10.23使用区域生长的分割。图10.51 (a)显示了一条焊缝(水平深色区域)的8比特X射线图像，该图像中含有几条裂缝和孔隙(水平横穿图像中心的明亮区域)。我们用分割有缺陷的焊缝区域来说明区域生长的应用。这些区域可用于焊缝检测，包括有关历史学习的数据库或控制自动焊接系统。工作的第一一步是确定种子点。从向题的物理性质着，我们知道裂缝和孔隙与实的焊缝相比，对X射线的衰减要小,因此，我们预料包含这种类型缺陷的区域要比X射线图像中的其他部分明显亮一些。我门可用在高百分比处设置阈值对原始图像进行阈值处理来提取种子点。图 10.51 (6)显示了图像的直方图,图10.51 Cc)显示了用等于图像中灰度值的99.5%的阈值对图像进行阈值处理后的结果，在这种情况下，阈值为254(见 10.3.5 节关于百分比的说明)。图10.51 (d)显示了将图 10.51 (c)中的每个连通分量用形态学腐虫为一一个单点后的结果。接下来，我们必须确定一个属性。在这个例子中，我们的兴趣是把满足如下要求的所有像素添加到每个种子中：》对于种子是8连接的，并且6)与种子相似。若使用灰度差作为一种相似性度量，则应用于每一个位置(,y)处的属性是TRUE,种子和点(x,y)处的像素间灰度差的绝对值≤T其他FALSE个指定的阈值。虽然这个属性是基于灰度差的，并且使用单个阈值，但我们可指定更复杂的其中，T是方案，即对每个像素应用一个不同的阈值，并使用不同于差值的其他属性。在这种情况下，前述的属性足以解决该问题，如这个例子的其余部分说明的那样。从前面的章节我们知道,最小的种子值是255,因此,使用254的阈值对图像进行阈值处理。图10.51显示了图10.51 (a)和(c)所示图像的差的绝对值。。图 10-51 Ge)中的图像包含了用于计算每个位置,)处的属性的所需要的差值。图10.51 (D显示了相应的直方图。我们需要，以便用于建立相似性属性一个阈值，该直方图有三个主要模式，因此我们首先把10.3.6 节中讨论的双阈值处理技术用于差值图像。在这种情兄下，导致的两个阈值是7, =68和T, =126，我们着到，它们相当靠近直方图的波谷【短暂地离开一活题，我们用这两个阈值分割了图像。图1051（g)显示了使用双阈值不能解决缺陷的分割问题，尽管阈值处在主要波谷的中1z8第10章图像分割图10.51；b)直方图；（c)初始种子图像；の最终种子图像(a)有缺陷焊缝的X射线图像；(为清楚起见，，点已被放大)；e)图(a)和图(c)之差的绝对值；(①)图(e)的直方图;g)使用双阈值进行阈值处理后的差值图像；b使用最小双阈值进行阈值处理后的差值图像。。GD用区域生长得到的分割(原图像由X-TEK Systems有限公司提供)图10.51 )显示了仅使用7对差值图像进行阈值处理的结果。黑点是其属性为“真”(TRUE)的像素”GFALSE)的像素。这里，重要结果是焊缝的良好区域中断定为失败的点，因此，其他点是属性为“假”这些点将不包含在最终结果中。在外部区域的点将由区域生长算法作为候选点来考虑。然而，步骤3将拒绝外部点，因为它们与种子不是8连接的。事实上，如图 10.51(6)所示，这一步导致了正确的分割，这表明连接性的使用是这种情况下的一个基本需求。最后，注意，在步骤4中，我们对由该算法找到的所有区域使用了相同的值。在这种情况下，它确实做得很好。10.4.2区域分裂与聚合-节中讨论的过程是从一组种子点来生长区域。另一种可供选择的方法是首先将一幅图像细分为一组任意的不相交区域，然后聚合和或分裂这些区域，并力图满足 10.1 节中阐述的分割条件。F面讨论分裂和聚合的基础知识。>R表示整幅图像区域，并选择一一个属性Q。对R进行分割的一种方法是依次将它细分为越来越小的四象限区域，以便对于任何区域R有Q(R,)=TRUE。我们从整个区域开始。如果Q(R) = FALSE,那么将该图像分割为4个象限区域。如果对于每个象限区域Q为FALSE，则将该象限区域再次细分为四个子象限区域，依此类推。这种特殊的分裂技术有一一个方便的表示方法，即用所谓的四义树形式表示，即每个节点都正好有4个后代。如图10.52所示(对应一个四义树的节点的图像有时称为四分区域或四分图像)。注注意，树根对应于整幅图像，而每个节点对应于该节点的4个细分子节点。在这种情况仅R,被进一步再细分。如果只使用分裂，那么最后的分区通常包含具有相同性质的邻关于区域相邻的讨论，请参阅b2.5.2 节。接区域。这种缺陷可以通过允许聚合和分裂得到补救。要满足10.1节数字图像处理496也就是说，只有在中提出的分割约束条件仅要求聚合满足属性Q的组合像素的邻接区域。Q(RyUR,)= TRUE时，，两个邻接区域R和R。才能聚合(b)对应的四又树。尺表示整个图像区域图10.52a)被分割的图像；前述讨论可以小结为如下过程，在该过程的任何一一步中，我们对满足Q(R,)= FALSE 的任何区域R,分裂为4个不相交的象限区域。当不可能进一步分裂时，对满足条件Q(Ry UR,)= TRUE的任意两个邻接区域,和R,进行聚合。当无法进一步聚合时，停止操作。习惯上要规定一个不能再进一一步执行分裂的最小四象限区的尺寸。前述的基本原理可能有多种变化。例如，在步骤2中，如果两个邻接的区域R,和R,各自都满足。这将导致简单得多(且快得多)的算法，因为属性，则我们允许聚合这两个区域会得到有意义的简化。属性的测试被限制在各个四分区域。正如下例所示，这种简化仍能产生较好的分割结果。例10.24用区域分裂和聚合进行分割・图 10.53(a)显示了天鹅星座环的一幅大小为566×566的X射线波段的图像。这个例子的目的是把围绕致密中心的不太密集的环状物质的图像分割出来。感兴趣区域有一些有助于分割的明显特征。首先，我们注意到该区域中的数据具有随机性质，这表明其标准差应大于背景和较大的相当平滑的中心区的标准差(背景的标准差近于0)。类似地，来自外环的包含数据的一一个区域的均值(平均灰度)应大于暗背景的均值而小于较大且亮中心区域的均值。从而，我们应该能够用下面的属性分割感兴趣的区域：TRUE,o >a且0<m<b其他FALSE,，m和口是一个四象限区域中的像素的均值和标准差，α和b为常数。民中，对感兴趣外部区域中的几个区域的分析表明，这些区域中的像素的平均灰度未超过125，而标准差总是大于10。图10.53 6)到(d)显示了对α和占使用这些值和允许的四象限区域的最小尺寸从32变到8得。一个四象限区域中满足属性的像素置为白色，而该区域中的其他像素则置为黑色。根据截获到的结果。的外部区域的形状，最好的结果是使用大小为16×16的四象限区域得到的。图10.53(d)中的黑色方块是大小为8×8的四象限区域，该区域中的像素不满足属性。使用较小的四象限区域将导致此类黑色区域数量的增加。使用比此处说明的大的区域会导致更多“类似块”的分割。注意，在所有情况下，分割后的区域(白色像素)从背景中完全分隔了平滑的内部区域。这样，分割就有效地把图像分成了三个明显的区域，这些区域对应于图像中的三个主要特征：背景、密集区域和稀疏区域。若使用图10.53中的任何那样，使用基于边缘或阈值的分割不可能得到这些结果。791第10章497 b c d图 10.53（a)由 NASA 的哈勃望远镜在X射线波段拍摄的天鹅星座环超新星的图像；（b)-(a)分别将允许的最小四象限区域尺寸限制为32×32,16×16和8×8像素时得到的结果(原图像由NASA提供如前面的例子所使用的那样，基于一个区域内像素灰度的均值和标准差的特性试图定量化该区域的纹理(关于纹理的讨论，见1.33 节)。纹理分割的概念是以在属性上使用纹理测度为基础的。换句话我们可以使用本节讨论的任何一用指定基于纹理内容的属性简单地执行纹理分割。一种方法,用形态学分水岭的分割10.5，我们已经讨论了基于三种主要概念的分割：（a)边缘检测，b)阈值处理和(C)区域生长。迄今为止，每种方法都有其优点(例如全局阈值处理具有速度优势)和缺点(例如，在基于边缘的分割中，需要进行后处理，如边缘连接)。在本节中，我们将讨论基于所谓的形态学分水岭概念的方法。在下面的讨论中将更为明显，形态学分水岭分割将其他三种方法中的许多概念进行了具体化，因此通常会产生更稳定，包括连接的分割边界。这种方法为在分割中结合基于知识的约束提供了一个简单的框架。的分割结果，背景知识10.5.1分水岭的概念是以三维形象化一幅图像为基础的：两个空间坐标作为灰度的函数，如图2.18(a)”解释中，我们考虑三种类型的点：(a)属于一个区域最小值的点；(b)把。在这种“地形学”川亦。一个水滴，如果把这些点放在任意位置上:.木滴一定会下落到一的最小值点；(C)处在看成是一该点的水会等可能性地流向不止一个这样的最小值点。对于一个特定的区域最小值、满足条件(b)的点的集合称为该最小值的汇水盆地或分水岭。满足条件(c)的点形成地表面的峰线，这种峰线称为分割线或分水线基于这些概念的分割算法的主要目标是找出分水线，其基本思想非常简单，如下面类似的说明那样。假设在每个区域的最小值上打一个洞，并且让水通过洞以均匀的速率上升，从低到高淹没整个当不同的汇水盆地中上升的水聚集时，修建一个水坝来阻止这种聚合。水将达到在水线上只能也形。兰见到各个水坝的顶部这样一个程度。这些大坝的边界对应于分水岭的分割线。因此，它们是由分水岭算法提取出来的(连接的)边界。借助于图10.54，我们可以进一步解释这些概念。图10.54(a)显示了一幅灰度图像，图10.54(b)是幅地形俯视图，其中“山峰”的高度与输入图像中的灰度值成正比。为了便于解释，这些结构的背面已被遮戒，以便不会与灰度值混淆、因为我们只对三维表示的普通地形感兴趣。为了阻止上升的水从图像的边缘溢出，我们可以想象整个地形(图像)的四周已被比最高山峰更高的水坝包围起来，最高的山峰的值是由输入图像灰度级可能具有的最大值决定的。假设在每个区域的最小值处打一一个洞〔如图 10.54(6)中的深色区域所示]，并且让水以均匀的速率上，其中显示为浅灰色的“水”从低到高淹没整个地形。图10.54 (C)说明了被水淹没的第一个阶段，仅覆盖了图像中相对较暗的青景区域。在图 10.544)和(e)中，我们看到水现在已分别上升至第一个和第二个马一个汇水盆地。第一个征兆如图 10.54(0)所 9」汇水盆地。当水继续上升时，最终会从一个汇水盆地溢出到另498。这里，水实际上从左侧盆地溢出到了右侧的盆地，因此构筑了一个较短的“水坝”（由几个单一的像奈组成》米阻止水在这一水位汇合(构筑水坝的细节将在下一节讨论)。随着水位的不断抢升，更加明显的这幅图在两个汇水盆地之间显示了一条更长的坝，另一条水坝在右侧盆地的顶效果如图 10.54(g)所示。部。构筑后一一水坝的目的是阻止来自盆地中的水与来自对应的背景中水的汇聚。该过程一直持续，直到达到水的最高水位(对应于图像中的最高灰度值)。最终的水坝对应于分水线，这些分水线就是我们希望的分割结果。，该例的结果显示为叠加到原图像之上的一。在图10.54 (h)中，一条1像素宽的深色路径一条连通的路径，这样，在两个区域间就给出了连续的边界。注意，条重要的性质就是分水线组成(c)-(d)被水淹没的两个阶段；（e)进一步淹没的结果；刻 10.54(a)原图像；b)地形俯视图；自两个汇水盆地的水开始汇聚(两个汇水盆地之间构筑了一个较短的水坝)；（g)较长的水坝；)最终的分水(分割线(原图像由CMMEcole des Minesde Paris公司的S.Beucher博土提供一是从背景中提取近乎一分水岭分割的主要应用之一一致(类似于水滴)的物体。由变化较小的灰度表。因此，我们经常见到分水岭分割方法用于一幅图像的梯度，而不是图像本征的区域有较小的梯度值。，汇水盆地的区域最小值就可很好地与对应于感兴趣物体的较小梯度值联系起来。叶。有了这一一表示法，水坝构建10.5.2在讨论之前，让我们考虑一下如何构建分水岭分割算法所需的水坝或分水线。水坝的构造是以二值图像为基础的，这种图像是二维整数空间Z的成员（见2.4.2 节)。构建分离二元点集的水坝的最简方法是使用形态学膨胀(见9.2.2 节)。图 10.55说明了如何使用形态学膨胀来构建水坝的基础。图10.55 (a)显示了第n-1步淹没的两个汇水盆地。图 10.55.0)显示了第n步淹没的结果。水已从一个盆地溢出到了另一个盆地，所以，必顶构建水坝来阻止这种情况的发生。为了与很快将要引入的符号一致，令M,和M,表示两个区域中的最小值点坐标的集合。然后，将汇水盆地中点的坐标集合与这两个在溢出的第n-1步处的最小值点的坐标集合联系起来，在第n-1步溢出处，两个最小值分别表示为C,,M)和C,(M)。它们是冬10.55 a)中的两个灰色区域。令 CIn- 1]表示这两个集合的并集。图10.55 (a)中有两个连通分量(关于连通分量的讨论，见2.5.2 节)而图10.55 b)中只有一个连通分量，该连通分量包含了如虚线所示的前两个分量。。两个连通分量变成连通分量的事实表明两个汇水盆地在第n步淹没中已被聚合了。，令4表示这个连通分量。注意，来自n-1步的两个连通分量可以通过使用简单的“与”操作(an Cn-1)从，中提取出来。我们还注意到，属于单个汇水盆地的所有点形成了一个单一的连通分量。